{"version":3,"file":"ui-components-BQV0FG4t.js","sources":["../../src/store/gameStore.ts","../../src/ui/components/TitleScreen.tsx","../../src/ui/state/battleSlice.ts","../../src/ui/state/queueBattleSlice.ts","../../src/ui/state/teamSlice.ts","../../src/ui/utils/contentAvailability.ts","../../src/ui/state/towerSlice.ts","../../src/ui/state/saveSlice.ts","../../src/ui/state/storySlice.ts","../../src/ui/state/inventorySlice.ts","../../src/ui/state/rewardsSlice.ts","../../src/ui/state/battleConfig.ts","../../src/ui/state/gameFlowSlice.ts","../../src/ui/state/overworldSlice.ts","../../src/ui/state/dialogueSlice.ts","../../src/ui/state/devModeSlice.ts","../../src/ui/state/store.ts","../../src/ui/sprites/sprite-list-generated.ts","../../src/ui/sprites/catalog.ts","../../src/ui/sprites/SimpleSprite.tsx","../../src/ui/sprites/mappings/abilityIcons.ts","../../src/ui/sprites/mappings/portraits.ts","../../src/ui/sprites/mappings/overworldSprites.ts","../../src/ui/sprites/mappings/battleSprites.ts","../../src/ui/components/OverworldMap.tsx","../../src/ui/utils/text.ts","../../src/ui/components/BattleLog.tsx","../../src/ui/components/PostBattleCutscene.tsx","../../src/ui/components/VictoryOverlay.tsx","../../src/ui/components/DefeatOverlay.tsx","../../src/ui/components/BattleManaBar.tsx","../../src/ui/components/BattlePortraitRow.tsx","../../src/ui/components/BattleActionMenu.tsx","../../src/ui/components/ModeLabel.tsx","../../src/ui/components/BattleUnitSprite.tsx","../../src/ui/types/BattleUIPhase.ts","../../src/ui/constants/animationTiming.ts","../../src/ui/hooks/useBattleSpeed.ts","../../src/ui/components/QueueBattleView.tsx","../../src/ui/components/MainMenu.tsx","../../src/ui/components/EquipmentIcon.tsx","../../src/ui/components/EnemyPortalTile.tsx","../../src/ui/components/PreBattleTeamSelectScreenV2.tsx","../../src/ui/components/EquipmentChoicePicker.tsx","../../src/ui/components/RewardsScreen.tsx","../../src/ui/components/ShopScreen.tsx","../../src/ui/components/PartyManagementScreen.tsx","../../src/ui/components/ShopEquipScreen.tsx","../../src/ui/components/DjinnDetailModal.tsx","../../src/ui/components/DjinnCollectionScreen.tsx","../../src/ui/components/TowerHubScreen.tsx","../../src/ui/components/CreditsScreen.tsx","../../src/ui/components/EpilogueScreen.tsx","../../src/ui/components/PauseMenu.tsx","../../src/ui/components/DialogueBoxV2.tsx","../../src/ui/sprites/BackgroundSprite.tsx","../../src/ui/components/SaveMenu.tsx","../../src/ui/components/GameErrorBoundary.tsx"],"sourcesContent":["import { createWithEqualityFn } from 'zustand/traditional';\nimport { immer } from 'zustand/middleware/immer';\n\nexport type ScreenType = 'title' | 'overworld' | 'battle' | 'menu' | 'team-select' | 'shop' | 'compendium' | 'rewards' | 'team-management' | 'djinn-collection' | 'tower' | 'credits' | 'epilogue';\n\nexport type ModalType = 'inventory' | 'settings' | 'dialogue' | 'pause' | 'team-management' | 'djinn-collection' | 'save' | 'help';\n\nexport interface FlowState {\n    screen: ScreenType;\n    modal: ModalType | null;\n    isTransitioning: boolean;\n}\n\nexport type BattlePhase = 'idle' | 'playerTurn' | 'enemyTurn' | 'victory' | 'defeat';\n\nexport type BattleEventType = 'attack' | 'ability' | 'item' | 'system';\n\nexport interface BattleEvent {\n    id: string;\n    type: BattleEventType;\n    description?: string;\n}\n\nexport interface BattleState {\n    enemyId: string;\n    phase: BattlePhase;\n}\n\nexport interface InventoryItem {\n    id: string;\n    name: string;\n    quantity: number;\n}\n\nexport interface InventoryState {\n    items: InventoryItem[];\n    capacity: number;\n}\n\nexport interface BattleRewards {\n    experience: number;\n    currency: number;\n    items: InventoryItem[];\n}\n\nexport interface BattleSession {\n    battle: BattleState;\n    rngSeed: number;\n    turnNumber: number;\n    eventQueue: BattleEvent[];\n    rewards: BattleRewards | null;\n}\n\nexport interface TeamMemberStats {\n    hp: number;\n    maxHp: number;\n    attack: number;\n    defense: number;\n}\n\nexport interface TeamMember {\n    id: string;\n    name: string;\n    level: number;\n    stats: TeamMemberStats;\n}\n\nexport interface SaveSlot {\n    id: string;\n    name: string;\n    createdAt: number;\n    updatedAt: number;\n}\n\nexport interface PlayerData {\n    team: TeamMember[];\n    inventory: InventoryState;\n    currency: number;\n    storyFlags: Set<string>;\n    saves: SaveSlot[];\n}\n\nexport interface GameSlice {\n    flow: FlowState;\n    setScreen: (screen: ScreenType) => void;\n    startTransition: (screen: ScreenType) => void;\n    openModal: (modal: ModalType) => void;\n    closeModal: () => void;\n    setTransitioning: (isTransitioning: boolean) => void;\n    resetFlow: () => void;\n}\n\nexport interface StartBattleParams {\n    enemyId: string;\n    rngSeed?: number;\n}\n\nexport interface BattleSlice {\n    battleSession: BattleSession | null;\n    startBattle: (params: StartBattleParams) => void;\n    endBattle: () => void;\n    queueBattleEvent: (event: BattleEvent) => void;\n    advanceTurn: () => void;\n    setBattlePhase: (phase: BattlePhase) => void;\n    clearBattleEvents: () => void;\n}\n\nexport interface TeamSlice {\n    playerData: PlayerData;\n    setTeam: (team: TeamMember[]) => void;\n    addTeamMember: (member: TeamMember) => void;\n    updateTeamMember: (memberId: string, updater: (member: TeamMember) => TeamMember) => void;\n    removeTeamMember: (memberId: string) => void;\n}\n\nexport interface InventorySlice {\n    setInventory: (inventory: InventoryState) => void;\n    addItem: (item: InventoryItem) => void;\n    removeItem: (itemId: string, quantity?: number) => void;\n    clearInventory: () => void;\n}\n\nexport type GameStore = GameSlice & BattleSlice & TeamSlice & InventorySlice;\n\ntype GameStoreSetState = (fn: (state: GameStore) => void) => void;\ntype GameStoreGetState = () => GameStore;\ntype EqualityFn<T> = (left: T, right: T) => boolean;\n\nconst DEFAULT_INVENTORY_CAPACITY = 32;\n\nconst initialFlowState: FlowState = {\n    screen: 'title',\n    modal: null,\n    isTransitioning: false,\n};\n\nconst initialPlayerData: PlayerData = {\n    team: [],\n    inventory: {\n        items: [],\n        capacity: DEFAULT_INVENTORY_CAPACITY,\n    },\n    currency: 0,\n    storyFlags: new Set<string>(),\n    saves: [],\n};\n\nconst createGameSlice = (set: GameStoreSetState, _get: GameStoreGetState): GameSlice => ({\n    flow: initialFlowState,\n    setScreen: (screen) =>\n        set((state) => {\n            state.flow.screen = screen;\n        }),\n    startTransition: (screen) => {\n        // Start fade to black\n        set((state) => {\n            state.flow.isTransitioning = true;\n        });\n\n        // Wait 150ms, change screen at peak darkness\n        setTimeout(() => {\n            set((state) => {\n                state.flow.screen = screen;\n            });\n\n            // Wait another 150ms, then fade back in\n            setTimeout(() => {\n                set((state) => {\n                    state.flow.isTransitioning = false;\n                });\n            }, 150);\n        }, 150);\n    },\n    openModal: (modal) =>\n        set((state) => {\n            state.flow.modal = modal;\n        }),\n    closeModal: () =>\n        set((state) => {\n            state.flow.modal = null;\n        }),\n    setTransitioning: (isTransitioning) =>\n        set((state) => {\n            state.flow.isTransitioning = isTransitioning;\n        }),\n    resetFlow: () =>\n        set((state) => {\n            state.flow = { ...initialFlowState };\n        }),\n});\n\nconst createBattleSlice = (set: GameStoreSetState, _get: GameStoreGetState): BattleSlice => ({\n    battleSession: null,\n    startBattle: ({ enemyId, rngSeed }) =>\n        set((state) => {\n            const seed = rngSeed ?? Date.now();\n            state.battleSession = {\n                battle: {\n                    enemyId,\n                    phase: 'playerTurn',\n                },\n                rngSeed: seed,\n                turnNumber: 1,\n                eventQueue: [],\n                rewards: null,\n            };\n            state.flow.screen = 'battle';\n            state.flow.modal = null;\n        }),\n    endBattle: () =>\n        set((state) => {\n            state.battleSession = null;\n            if (state.flow.screen === 'battle') {\n                state.flow.screen = 'overworld';\n            }\n        }),\n    queueBattleEvent: (event) =>\n        set((state) => {\n            if (!state.battleSession) {\n                return;\n            }\n            state.battleSession.eventQueue.push(event);\n        }),\n    advanceTurn: () =>\n        set((state) => {\n            if (!state.battleSession) {\n                return;\n            }\n            state.battleSession.turnNumber += 1;\n        }),\n    setBattlePhase: (phase) =>\n        set((state) => {\n            if (!state.battleSession) {\n                return;\n            }\n            state.battleSession.battle.phase = phase;\n        }),\n    clearBattleEvents: () =>\n        set((state) => {\n            if (!state.battleSession) {\n                return;\n            }\n            state.battleSession.eventQueue = [];\n        }),\n});\n\nconst createTeamSlice = (set: GameStoreSetState, _get: GameStoreGetState): TeamSlice => ({\n    playerData: initialPlayerData,\n    setTeam: (team) =>\n        set((state) => {\n            state.playerData.team = team;\n        }),\n    addTeamMember: (member) =>\n        set((state) => {\n            state.playerData.team.push(member);\n        }),\n    updateTeamMember: (memberId, updater) =>\n        set((state) => {\n            const index = state.playerData.team.findIndex((member) => member.id === memberId);\n            if (index === -1) {\n                return;\n            }\n            const member = state.playerData.team[index];\n            if (member) state.playerData.team[index] = updater(member);\n        }),\n    removeTeamMember: (memberId) =>\n        set((state) => {\n            state.playerData.team = state.playerData.team.filter((member) => member.id !== memberId);\n        }),\n});\n\nconst createInventorySlice = (set: GameStoreSetState, _get: GameStoreGetState): InventorySlice => ({\n    setInventory: (inventory) =>\n        set((state) => {\n            state.playerData.inventory = inventory;\n        }),\n    addItem: (item) =>\n        set((state) => {\n            const existing = state.playerData.inventory.items.find((it) => it.id === item.id);\n            if (existing) {\n                existing.quantity += item.quantity;\n            } else {\n                state.playerData.inventory.items.push({ ...item });\n            }\n        }),\n    removeItem: (itemId, quantity) =>\n        set((state) => {\n            const items = state.playerData.inventory.items;\n            const index = items.findIndex((item) => item.id === itemId);\n            if (index === -1) {\n                return;\n            }\n            const item = items[index];\n            if (!item) return;\n            if (quantity === undefined || quantity >= item.quantity) {\n                items.splice(index, 1);\n            } else if (quantity > 0) {\n                item.quantity -= quantity;\n            }\n        }),\n    clearInventory: () =>\n        set((state) => {\n            state.playerData.inventory.items = [];\n        }),\n});\n\nexport const useGameStore = createWithEqualityFn<GameStore>()(\n    immer((set, get) => ({\n        ...createGameSlice(set as GameStoreSetState, get as GameStoreGetState),\n        ...createBattleSlice(set as GameStoreSetState, get as GameStoreGetState),\n        ...createTeamSlice(set as GameStoreSetState, get as GameStoreGetState),\n        ...createInventorySlice(set as GameStoreSetState, get as GameStoreGetState),\n    })),\n);\n\nexport const useFlowStore = <T>(\n    selector: (slice: GameSlice) => T,\n    equalityFn?: EqualityFn<T>,\n): T => equalityFn\n    ? useGameStore((state) => selector(state), equalityFn)\n    : useGameStore((state) => selector(state));\n\nexport const useBattleStore = <T>(\n    selector: (slice: BattleSlice) => T,\n    equalityFn?: EqualityFn<T>,\n): T => equalityFn\n    ? useGameStore((state) => selector(state), equalityFn)\n    : useGameStore((state) => selector(state));\n\nexport const useTeamStore = <T>(\n    selector: (slice: TeamSlice) => T,\n    equalityFn?: EqualityFn<T>,\n): T => equalityFn\n    ? useGameStore((state) => selector(state), equalityFn)\n    : useGameStore((state) => selector(state));\n\nexport const useInventoryStore = <T>(\n    selector: (slice: InventorySlice) => T,\n    equalityFn?: EqualityFn<T>,\n): T => equalityFn\n    ? useGameStore((state) => selector(state), equalityFn)\n    : useGameStore((state) => selector(state));\n","/**\n * Title Screen Component\n * Entry screen showing game title with animated character sprites\n */\n\nimport { useEffect } from 'preact/hooks';\nimport { useGameStore } from '../../store/gameStore';\nimport './TitleScreen.css';\n\n// Character sprites for the title screen parade\nconst TITLE_CHARACTERS = [\n  { name: 'Isaac', sprite: '/sprites/overworld/protagonists/Isaac_Walk.gif', delay: 0 },\n  { name: 'Garet', sprite: '/sprites/overworld/protagonists/Garet_Right.gif', delay: 0.8 },\n  { name: 'Ivan', sprite: '/sprites/overworld/protagonists/Ivan_Right.gif', delay: 1.6 },\n  { name: 'Mia', sprite: '/sprites/overworld/protagonists/Mia_Right.gif', delay: 2.4 },\n];\n\nexport function TitleScreen() {\n  const startTransition = useGameStore((s) => s.startTransition);\n\n  useEffect(() => {\n    const handleKeyPress = (event: KeyboardEvent) => {\n      // Any key press advances to main menu\n      event.preventDefault();\n      event.stopPropagation();\n      startTransition('menu');\n    };\n\n    const handleClick = () => {\n      // Click anywhere also advances\n      startTransition('menu');\n    };\n\n    window.addEventListener('keydown', handleKeyPress);\n    window.addEventListener('click', handleClick);\n\n    return () => {\n      window.removeEventListener('keydown', handleKeyPress);\n      window.removeEventListener('click', handleClick);\n    };\n  }, [startTransition]);\n\n  return (\n    <div class=\"title-screen\" onClick={() => startTransition('menu')}>\n      <div class=\"title-screen-content\">\n        <h1 class=\"title-screen-logo\">Vale Chronicles</h1>\n        <p class=\"title-screen-subtitle\">Press any key to continue</p>\n      </div>\n\n      {/* Animated character parade at bottom */}\n      <div class=\"title-screen-parade\">\n        {TITLE_CHARACTERS.map((char) => (\n          <div\n            key={char.name}\n            class=\"title-screen-character\"\n            style={{ animationDelay: `${char.delay}s` }}\n          >\n            <img\n              src={char.sprite}\n              alt={char.name}\n              class=\"title-screen-sprite\"\n            />\n          </div>\n        ))}\n      </div>\n    </div>\n  );\n}\n","/**\n * Battle state slice for Zustand\n * Manages battle state, events, and turn progression\n */\n\nimport type { StateCreator } from 'zustand';\nimport type { BattleState } from '../../core/models/BattleState';\nimport { getEncounterId } from '../../core/models/BattleState';\nimport type { BattleEvent } from '../../core/services/types';\nimport { performAction, endTurn, checkBattleEnd, startTurnTick as battleServiceStartTurnTick } from '../../core/services/BattleService';\nimport { makeAIDecision } from '../../core/services/AIService';\nimport { makePRNG } from '../../core/random/prng';\nimport { createRNGStream, RNG_STREAMS } from '../../core/constants';\nimport type { RewardsSlice } from './rewardsSlice';\nimport type { StorySlice } from './storySlice';\n\nexport interface BattleSlice {\n  battle: BattleState | null;\n  events: BattleEvent[];\n  rngSeed: number;\n  turnNumber: number;\n  \n  setBattle: (battle: BattleState | null, seed: number) => void;\n  startTurnTick: () => void;\n  perform: (casterId: string, abilityId: string, targetIds: readonly string[]) => void;\n  endTurn: () => void;\n  dequeueEvent: () => void;\n  performAIAction: () => void; // Auto-execute AI decision for enemy turns\n  preview: (\n    casterId: string,\n    abilityId: string,\n    targets: readonly string[]\n  ) => { avg: number; min: number; max: number };\n}\n\nexport const createBattleSlice: StateCreator<\n  BattleSlice & RewardsSlice & StorySlice,\n  [['zustand/devtools', never]],\n  [],\n  BattleSlice\n> = (set, get) => ({\n  battle: null,\n  events: [],\n  rngSeed: 1337,\n  turnNumber: 0,\n\n  setBattle: (battle, seed) =>\n    set({ battle, rngSeed: seed, turnNumber: 0, events: [] }),\n\n  startTurnTick: () => {\n    const { battle, rngSeed, turnNumber, events } = get();\n    if (!battle) return;\n\n    // Stable per-turn stream for status effects\n    const rng = makePRNG(createRNGStream(rngSeed, turnNumber, RNG_STREAMS.STATUS_EFFECTS));\n\n    // Call service to process status effects\n    const result = battleServiceStartTurnTick(battle, rng);\n\n    set({ battle: result.updatedState, events: [...events, ...result.events] });\n  },\n\n  perform: (casterId, abilityId, targetIds) => {\n    const { battle, rngSeed, turnNumber, events } = get();\n    if (!battle) return;\n\n    // Separate substream for actions\n    const rng = makePRNG(createRNGStream(rngSeed, turnNumber, RNG_STREAMS.ACTIONS));\n    const result = performAction(battle, casterId, abilityId, targetIds, rng);\n\n    if (!result.ok) {\n      console.error('performAction failed:', result.error);\n      return;\n    }\n\n    // Check for battle end\n    const battleEnd = checkBattleEnd(result.value.state);\n    const newEvents: BattleEvent[] = [...result.value.events];\n    if (battleEnd) {\n      newEvents.push({\n        type: 'battle-end',\n        result: battleEnd,\n      });\n\n      // If player victory, process rewards\n      if (battleEnd === 'PLAYER_VICTORY') {\n        const { processVictory } = get();\n        processVictory(result.value.state);\n      }\n\n      // Emit encounter-finished event if we have an encounterId\n      // This is a story-specific event, emitted alongside battle-end for story progression\n      const encounterId = getEncounterId(battle);\n      if (encounterId) {\n        newEvents.push({\n          type: 'encounter-finished',\n          outcome: battleEnd,\n          encounterId,\n        });\n      }\n\n      set({ battle: result.value.state, events: [...events, ...newEvents] });\n    } else {\n      // Battle continues - advance to next turn\n      const rngEndTurn = makePRNG(createRNGStream(rngSeed, turnNumber, RNG_STREAMS.END_TURN));\n      const endResult = endTurn(result.value.state, rngEndTurn);\n      if (!endResult.ok) {\n        console.error('endTurn failed:', endResult.error);\n        return;\n      }\n      set({ battle: endResult.value, events: [...events, ...newEvents], turnNumber: turnNumber + 1 });\n    }\n  },\n\n  endTurn: () => {\n    const { battle, rngSeed, turnNumber } = get();\n    if (!battle) return;\n\n    const rng = makePRNG(createRNGStream(rngSeed, turnNumber, RNG_STREAMS.END_TURN));\n    const result = endTurn(battle, rng);\n    if (!result.ok) {\n      console.error('endTurn failed:', result.error);\n      return;\n    }\n    set({ battle: result.value, turnNumber: turnNumber + 1 });\n  },\n\n  performAIAction: () => {\n    const { battle, rngSeed, turnNumber, events } = get();\n    if (!battle) return;\n\n    const allUnits = [...battle.playerTeam.units, ...battle.enemies];\n    const currentActorId = battle.turnOrder[battle.currentActorIndex];\n    const currentActor = allUnits.find(u => u.id === currentActorId);\n\n    if (!currentActor || !currentActorId) return;\n\n    // Check if it's an enemy turn\n    const isPlayerUnit = battle.playerTeam.units.some(u => u.id === currentActorId);\n    if (isPlayerUnit) return; // Player turn - don't auto-execute\n\n    // Make AI decision\n    const rng = makePRNG(createRNGStream(rngSeed, turnNumber, RNG_STREAMS.ACTIONS));\n    try {\n      const decision = makeAIDecision(battle, currentActorId, rng);\n\n      // Execute the decision\n      const result = performAction(battle, currentActorId, decision.abilityId, decision.targetIds, rng);\n\n      if (!result.ok) {\n        console.error('AI performAction failed:', result.error);\n        return;\n      }\n\n      // Check for battle end\n      const battleEnd = checkBattleEnd(result.value.state);\n      const newEvents: BattleEvent[] = [...result.value.events];\n      if (battleEnd) {\n        newEvents.push({\n          type: 'battle-end',\n          result: battleEnd,\n        });\n\n        // If player victory, process rewards\n        if (battleEnd === 'PLAYER_VICTORY') {\n          const { processVictory } = get();\n          processVictory(result.value.state);\n        }\n\n        // Emit encounter-finished event for story progression\n        const encounterId = getEncounterId(battle);\n        if (encounterId) {\n          newEvents.push({\n            type: 'encounter-finished',\n            outcome: battleEnd,\n            encounterId,\n          });\n        }\n\n        set({ battle: result.value.state, events: [...events, ...newEvents] });\n\n        // Notify story slice of encounter completion\n        if (encounterId) {\n          const { onBattleEvents } = get();\n          if (onBattleEvents) {\n            onBattleEvents(newEvents);\n          }\n        }\n      } else {\n        // Battle continues - advance to next turn\n        const rngEndTurn = makePRNG(rngSeed + turnNumber * 1_000_000);\n        const endResult = endTurn(result.value.state, rngEndTurn);\n        if (!endResult.ok) {\n          console.error('AI endTurn failed:', endResult.error);\n          return;\n        }\n        set({ battle: endResult.value, events: [...events, ...newEvents], turnNumber: turnNumber + 1 });\n      }\n    } catch (error) {\n      console.error('AI decision failed:', error);\n      // Fallback: end turn\n      const rngFallback = makePRNG(createRNGStream(rngSeed, turnNumber, RNG_STREAMS.END_TURN));\n      const fallbackResult = endTurn(battle, rngFallback);\n      if (fallbackResult.ok) {\n        set({ battle: fallbackResult.value, turnNumber: turnNumber + 1 });\n      }\n    }\n  },\n\n  dequeueEvent: () => {\n    // Snapshot-based dequeue to prevent race conditions\n    // If new events arrive during processing, we consume exactly what was there at start\n    set((state) => {\n      if (state.events.length === 0) return state;\n      \n      // Remove exactly the first event (snapshot-based: slice creates new array)\n      const remaining = state.events.slice(1);\n      \n      return { events: remaining };\n    });\n  },\n\n  preview: (casterId, abilityId, targets) => {\n    const { battle, rngSeed, turnNumber } = get();\n    if (!battle) return { avg: 0, min: 0, max: 0 };\n\n    // Use a cloned deterministic stream so hovers never consume the live RNG\n    const previewSeed =\n      rngSeed ^\n      (turnNumber << 8) ^\n      (abilityId.length << 16) ^\n      (casterId.length << 24);\n    const baseRng = makePRNG(previewSeed);\n\n    // Run N deterministic samples\n    const N = 16;\n    let sum = 0;\n    let min = Number.POSITIVE_INFINITY;\n    let max = 0;\n\n    for (let i = 0; i < N; i++) {\n      const r = baseRng.clone();\n      const result = performAction(battle, casterId, abilityId, targets, r);\n      if (!result.ok) {\n        continue; // Skip failed previews\n      }\n      const totalDamage = result.value.events\n        .filter((e): e is Extract<BattleEvent, { type: 'hit' }> => e.type === 'hit')\n        .reduce((acc, ev) => acc + ev.amount, 0);\n\n      sum += totalDamage;\n      min = Math.min(min, totalDamage);\n      max = Math.max(max, totalDamage);\n    }\n\n    return { avg: Math.round(sum / N), min, max };\n  },\n});\n","/**\n * Queue-based battle state slice for Zustand\n * PR-QUEUE-BATTLE: Manages planning and execution phases\n */\n\nimport type { StateCreator } from 'zustand';\nimport type { BattleState } from '../../core/models/BattleState';\nimport type { BattleEvent } from '../../core/services/types';\nimport type { Ability } from '../../data/schemas/AbilitySchema';\nimport type { Unit } from '../../core/models/Unit';\nimport type { GameFlowSlice } from './gameFlowSlice';\nimport type { RewardsSlice } from './rewardsSlice';\nimport type { StorySlice } from './storySlice';\nimport type { TeamSlice } from './teamSlice';\nimport type { SaveSlice } from './saveSlice';\nimport type { DialogueSlice } from './dialogueSlice';\nimport type { TowerSlice } from './towerSlice';\nimport {\n  queueAction,\n  clearQueuedAction,\n  queueDjinn,\n  unqueueDjinn,\n  executeRound,\n} from '../../core/services/QueueBattleService';\nimport { makePRNG } from '../../core/random/prng';\nimport { autoHealUnits } from '../../core/algorithms/healing';\nimport { updateTeam } from '../../core/models/Team';\nimport {\n  getEncounterId,\n  updateBattleState,\n} from '../../core/models/BattleState';\nimport { createRNGStream, RNG_STREAMS } from '../../core/constants';\nimport { isUnitKO } from '../../core/models/Unit';\n\nconst critFlashTimeouts = new Map<string, ReturnType<typeof setTimeout>>();\n\nfunction computePendingMana(battle: BattleState): { pendingThisRound: number; pendingManaNextRound: number } {\n  let pendingThisRound = 0;\n  let pendingManaNextRound = 0;\n\n  battle.queuedActions.forEach((action, index) => {\n    if (!action || action.abilityId !== null) {\n      return;\n    }\n\n    const unit = battle.playerTeam.units[index];\n    if (!unit || isUnitKO(unit)) {\n      return;\n    }\n\n    const timing = unit.autoAttackTiming ?? 'same-turn';\n    if (timing === 'next-turn') {\n      pendingManaNextRound += 1;\n    } else {\n      pendingThisRound += 1;\n    }\n  });\n\n  return { pendingThisRound, pendingManaNextRound };\n}\n\nfunction sumBattleStat(units: readonly Unit[], key: 'damageDealt' | 'damageTaken'): number {\n  return units.reduce((total, unit) => total + (unit.battleStats?.[key] ?? 0), 0);\n}\n\nexport interface QueueBattleSlice {\n  battle: BattleState | null;\n  events: BattleEvent[];\n  rngSeed: number;\n  activePortraitIndex: number | null;\n  isActionMenuOpen: boolean;\n  isSummonScreenOpen: boolean;\n  tutorialMessage: string | null;\n  currentMana: number;\n  maxMana: number;\n  pendingManaThisRound: number;\n  pendingManaNextRound: number;\n  critCounters: Record<string, number>;\n  critThresholds: Record<string, number>;\n  critFlash: Record<string, boolean>;\n  lastError: string | null;\n\n  setBattle: (battle: BattleState | null, seed: number) => void;\n  setActivePortrait: (index: number | null) => void;\n  setActionMenuOpen: (open: boolean) => void;\n  setSummonScreenOpen: (open: boolean) => void;\n  showTutorialMessage: (message: string | null) => void;\n  updateManaState: (current: number, pending: number, pendingNext: number) => void;\n  incrementCritCounter: (unitId: string) => void;\n  resetCritCounter: (unitId: string) => void;\n  triggerCritFlash: (unitId: string) => void;\n  clearError: () => void;\n  queueUnitAction: (\n    unitIndex: number,\n    abilityId: string | null,\n    targetIds: readonly string[],\n    ability?: Ability\n  ) => boolean;\n  clearUnitAction: (unitIndex: number) => void;\n  queueDjinnActivation: (djinnId: string) => void;\n  unqueueDjinnActivation: (djinnId: string) => void;\n  executeQueuedRound: () => void;\n  dequeueEvent: () => void;\n}\n\nexport const createQueueBattleSlice: StateCreator<\n  QueueBattleSlice & GameFlowSlice & RewardsSlice & StorySlice & TeamSlice & SaveSlice & DialogueSlice & TowerSlice,\n  [['zustand/devtools', never]],\n  [],\n  QueueBattleSlice\n> = (set, get) => ({\n  battle: null,\n  events: [],\n  rngSeed: 1337,\n  activePortraitIndex: null,\n  isActionMenuOpen: true,\n  isSummonScreenOpen: false,\n  tutorialMessage: null,\n  currentMana: 0,\n  maxMana: 0,\n  pendingManaThisRound: 0,\n  pendingManaNextRound: 0,\n  critCounters: {},\n  critThresholds: {},\n  critFlash: {},\n  lastError: null,\n\n  setBattle: (battle, seed) => {\n    const critThresholds: Record<string, number> = {};\n    const critCounters: Record<string, number> = {};\n    const battleState = battle ? structuredClone(battle) : null;\n    if (battleState) {\n      battleState.playerTeam.units.forEach((unit) => {\n        critThresholds[unit.id] = critThresholds[unit.id] ?? 10;\n        critCounters[unit.id] = 0;\n      });\n    }\n\n    set({\n      battle: battleState,\n      rngSeed: seed,\n      events: [],\n      activePortraitIndex: null, // allow speed-based auto-selection in view\n      currentMana: battleState?.remainingMana ?? 0,\n      maxMana: battleState?.maxMana ?? 0,\n      pendingManaThisRound: 0,\n      pendingManaNextRound: 0,\n      critCounters,\n      critThresholds,\n      critFlash: {},\n      lastError: null,\n    });\n  },\n\n  setActivePortrait: (index) => {\n    set({ activePortraitIndex: index });\n  },\n\n  setActionMenuOpen: (open) => set({ isActionMenuOpen: open }),\n  setSummonScreenOpen: (open) => set({ isSummonScreenOpen: open }),\n  showTutorialMessage: (message) => set({ tutorialMessage: message }),\n\n  updateManaState: (current, pending, pendingNext) => {\n    set({\n      currentMana: current,\n      pendingManaThisRound: pending,\n      pendingManaNextRound: pendingNext,\n    });\n  },\n\n  incrementCritCounter: (unitId) => {\n    set((state) => ({\n      critCounters: {\n        ...state.critCounters,\n        [unitId]: (state.critCounters[unitId] ?? 0) + 1,\n      },\n    }));\n  },\n\n  resetCritCounter: (unitId) => {\n    set((state) => ({\n      critCounters: {\n        ...state.critCounters,\n        [unitId]: 0,\n      },\n    }));\n  },\n\n  triggerCritFlash: (unitId) => {\n    const existingTimeout = critFlashTimeouts.get(unitId);\n    if (existingTimeout) {\n      clearTimeout(existingTimeout);\n    }\n\n    set((state) => ({\n      critFlash: { ...state.critFlash, [unitId]: true },\n    }));\n    const timeoutId = setTimeout(() => {\n      set((state) => {\n        const { [unitId]: _removed, ...rest } = state.critFlash;\n        void _removed; // Intentionally unused - destructuring to exclude key\n        return { critFlash: rest };\n      });\n      critFlashTimeouts.delete(unitId);\n    }, 200);\n    critFlashTimeouts.set(unitId, timeoutId);\n  },\n\n  clearError: () => set({ lastError: null }),\n\n  queueUnitAction: (unitIndex, abilityId, targetIds, ability) => {\n    const { battle } = get();\n    if (!battle || battle.phase !== 'planning') {\n      set({ lastError: 'Cannot queue action: battle not in planning phase.' });\n      return false;\n    }\n\n    const unit = battle.playerTeam.units[unitIndex];\n    if (!unit) {\n      set({ lastError: `Cannot queue action: invalid unit index ${unitIndex}.` });\n      return false;\n    }\n\n    const result = queueAction(battle, unit.id, abilityId, targetIds, ability);\n    if (!result.ok) {\n      // Log error for UI feedback (could be enhanced with toast notifications)\n      console.warn(`Failed to queue action: ${result.error}`);\n      set({ lastError: `Failed to queue action: ${result.error}` });\n      return false;\n    }\n\n    const { pendingThisRound: sameTurn, pendingManaNextRound } = computePendingMana(result.value);\n\n    set({\n      battle: result.value,\n      currentMana: result.value.remainingMana,\n      maxMana: result.value.maxMana,\n      pendingManaThisRound: sameTurn,\n      pendingManaNextRound,\n      lastError: null,\n    });\n    return true;\n  },\n\n  clearUnitAction: (unitIndex) => {\n    const { battle } = get();\n    if (!battle || battle.phase !== 'planning') {\n      set({ lastError: 'Cannot clear action: battle not in planning phase.' });\n      return;\n    }\n\n    const result = clearQueuedAction(battle, unitIndex);\n    if (!result.ok) {\n      console.warn(`Failed to clear action: ${result.error}`);\n      set({ lastError: `Failed to clear action: ${result.error}` });\n      return;\n    }\n\n    const { pendingThisRound: sameTurn, pendingManaNextRound } = computePendingMana(result.value);\n\n    set({\n      battle: result.value,\n      currentMana: result.value.remainingMana,\n      maxMana: result.value.maxMana,\n      pendingManaThisRound: sameTurn,\n      pendingManaNextRound,\n      lastError: null,\n    });\n  },\n\n  queueDjinnActivation: (djinnId) => {\n    const { battle } = get();\n    if (!battle || battle.phase !== 'planning') {\n      set({ lastError: 'Cannot queue Djinn: battle not in planning phase.' });\n      return;\n    }\n\n    const result = queueDjinn(battle, djinnId);\n    if (!result.ok) {\n      console.warn(`Failed to queue Djinn: ${result.error}`);\n      set({ lastError: `Failed to queue Djinn: ${result.error}` });\n      return;\n    }\n\n    set({ battle: result.value, lastError: null });\n  },\n\n  unqueueDjinnActivation: (djinnId) => {\n    const { battle } = get();\n    if (!battle || battle.phase !== 'planning') {\n      set({ lastError: 'Cannot unqueue Djinn: battle not in planning phase.' });\n      return;\n    }\n\n    const result = unqueueDjinn(battle, djinnId);\n    if (!result.ok) {\n      console.warn(`Failed to unqueue Djinn: ${result.error}`);\n      set({ lastError: `Failed to unqueue Djinn: ${result.error}` });\n      return;\n    }\n\n    set({ battle: result.value, lastError: null });\n  },\n\n  executeQueuedRound: () => {\n    const { battle, rngSeed } = get();\n    if (!battle || battle.phase !== 'planning') {\n      set({ lastError: 'Cannot execute round: battle not in planning phase.' });\n      return;\n    }\n\n    const rng = makePRNG(createRNGStream(rngSeed, battle.roundNumber, RNG_STREAMS.QUEUE_ROUND));\n    const result = executeRound(battle, rng);\n    if (result.state === battle && result.events.length === 0) {\n      set({ lastError: 'Cannot execute round: queued actions are invalid for execution.' });\n      return;\n    }\n\n    const previousEvents = get().events;\n    const battleEvents = [...previousEvents, ...result.events];\n\n    const { pendingThisRound: sameTurn, pendingManaNextRound } = computePendingMana(result.state);\n\n    set({\n      battle: result.state,\n      events: battleEvents,\n      currentMana: result.state.remainingMana,\n      maxMana: result.state.maxMana,\n      pendingManaThisRound: sameTurn,\n      pendingManaNextRound,\n      lastError: null,\n    });\n\n    const encounterId = getEncounterId(result.state);\n    const towerEncounterId = get().activeTowerEncounterId;\n    const isTowerBattle =\n      get().towerStatus === 'in-run' &&\n      towerEncounterId !== null &&\n      encounterId === towerEncounterId;\n\n    if (isTowerBattle && (result.state.phase === 'victory' || result.state.phase === 'defeat')) {\n      get().handleTowerBattleCompleted({ battle: result.state, events: battleEvents });\n      return;\n    }\n\n    // Sync Djinn trackers to team state (after round execution)\n    if (result.state.playerTeam.djinnTrackers) {\n      const { updateTeam: updateTeamState } = get();\n      updateTeamState({\n        djinnTrackers: result.state.playerTeam.djinnTrackers,\n      });\n    }\n\n    if (result.state.phase === 'victory') {\n      const {\n        onBattleEvents,\n        updateTeamUnits,\n      } = get();\n\n      const healedUnits = autoHealUnits(result.state.playerTeam.units);\n      const healedTeam = updateTeam(result.state.playerTeam, { units: healedUnits });\n      const healedState = updateBattleState(result.state, { playerTeam: healedTeam });\n\n      const healEvent: BattleEvent = {\n        type: 'auto-heal',\n        message: 'All units restored to full health!',\n      };\n\n      set({\n        battle: healedState,\n        events: [...battleEvents, healEvent],\n      });\n\n      updateTeamUnits(healedUnits);\n      const totalDamage = sumBattleStat(healedState.playerTeam.units, 'damageDealt');\n      get().incrementBattleStats({ outcome: 'win', damageDealt: totalDamage, healingDone: 0 });\n\n      // Auto-save after battle victory\n      try {\n        void Promise.resolve(get().autoSave()).catch((error) => {\n          console.warn('Auto-save failed after battle victory:', error);\n        });\n      } catch (error) {\n        console.warn('Auto-save failed after battle victory:', error);\n      }\n\n      const encounterId = getEncounterId(healedState);\n      if (encounterId && onBattleEvents) {\n        onBattleEvents([\n          {\n            type: 'battle-end',\n            result: 'PLAYER_VICTORY',\n          },\n          {\n            type: 'encounter-finished',\n            outcome: 'PLAYER_VICTORY',\n            encounterId,\n          },\n        ]);\n      }\n\n      return;\n    }\n\n    if (result.state.phase === 'defeat') {\n      const { onBattleEvents, updateTeamUnits } = get();\n\n      const healedUnits = autoHealUnits(result.state.playerTeam.units);\n      const healedTeam = updateTeam(result.state.playerTeam, { units: healedUnits });\n      const healedState = updateBattleState(result.state, { playerTeam: healedTeam });\n\n      const healEvent: BattleEvent = {\n        type: 'auto-heal',\n        message: 'All units restored to full health!',\n      };\n\n      set({\n        battle: healedState,\n        events: [...battleEvents, healEvent],\n      });\n\n      updateTeamUnits(healedUnits);\n\n      const encounterId = getEncounterId(healedState);\n      if (encounterId && onBattleEvents) {\n        onBattleEvents([\n          {\n            type: 'battle-end',\n            result: 'PLAYER_DEFEAT',\n          },\n          {\n            type: 'encounter-finished',\n            outcome: 'PLAYER_DEFEAT',\n            encounterId,\n          },\n        ]);\n      }\n\n      return;\n    }\n  },\n\n  dequeueEvent: () => {\n    // Use functional update to avoid race conditions with concurrent dequeue calls\n    set((state) => {\n      if (state.events.length === 0) return state;\n\n      // MANA FIX: Sync currentMana with battle.remainingMana after dequeuing event\n      // This ensures UI shows accurate mana during event processing (e.g., mana-generated events)\n      const updates: Partial<QueueBattleSlice> = { events: state.events.slice(1) };\n      if (state.battle) {\n        updates.currentMana = state.battle.remainingMana;\n      }\n\n      return updates;\n    });\n  },\n});\n","/**\n * Team state slice for Zustand\n * Manages player team composition and Djinn\n */\n\nimport type { StateCreator } from 'zustand';\nimport type { Team } from '../../core/models/Team';\nimport type { Unit } from '../../core/models/Unit';\nimport { updateTeam } from '../../core/models/Team';\nimport { UNIT_DEFINITIONS } from '../../data/definitions/units';\nimport { createUnit } from '../../core/models/Unit';\n\nexport interface TeamSlice {\n  team: Team | null;\n  roster: Unit[];  // All recruited units (bench + active party, up to 10)\n  setTeam: (team: Team) => void;\n  setRoster: (units: Unit[]) => void;\n  addUnitToRoster: (unit: Unit) => void;\n  getUnitFromRoster: (unitId: string) => Unit | undefined;\n  updateTeam: (updates: Partial<Team>) => void;\n  updateTeamUnits: (units: readonly Unit[]) => void;\n  swapPartyMember: (partyIndex: number, unitId: string) => void;\n}\n\nexport const createTeamSlice: StateCreator<\n  TeamSlice,\n  [['zustand/devtools', never]],\n  [],\n  TeamSlice\n> = (set, get) => ({\n  team: null,\n  roster: [],  // Empty roster initially\n\n  setTeam: (team) => {\n    set((state) => {\n      // Ensure roster contains all team units (add/update as needed)\n      const updatedRoster = [...state.roster];\n      team.units.forEach(unit => {\n        const existingIndex = updatedRoster.findIndex(u => u.id === unit.id);\n        if (existingIndex >= 0) {\n          // Update existing unit in roster\n          updatedRoster[existingIndex] = unit;\n        } else {\n          // Add new unit to roster (if not at max)\n          if (updatedRoster.length < 10) {\n            updatedRoster.push(unit);\n          }\n        }\n      });\n      \n      return {\n        team,\n        roster: updatedRoster,\n      };\n    });\n  },\n  \n  setRoster: (units) => set({ roster: units }),\n  \n  addUnitToRoster: (unit) =>\n    set((state) => {\n      // Check if unit already exists\n      if (state.roster.some(u => u.id === unit.id)) {\n        // Update existing unit\n        return {\n          roster: state.roster.map(u => u.id === unit.id ? unit : u),\n        };\n      }\n      // Add new unit (max 10)\n      if (state.roster.length >= 10) {\n        console.warn('Roster full (10 units max), cannot add unit');\n        return state;\n      }\n      return {\n        roster: [...state.roster, unit],\n      };\n    }),\n  \n  getUnitFromRoster: (unitId) => {\n    return get().roster.find(u => u.id === unitId);\n  },\n\n  updateTeam: (updates) =>\n    set((state) => {\n      if (!state.team) return state;\n      return {\n        team: {\n          ...state.team,\n          ...updates,\n        },\n      };\n    }),\n  updateTeamUnits: (units) =>\n    set((state) => {\n      if (!state.team) return state;\n      \n      const updatedTeam = updateTeam(state.team, { units });\n      \n      // Sync roster with updated units (prevents stale data)\n      const updatedRoster = [...state.roster];\n      units.forEach(unit => {\n        const existingIndex = updatedRoster.findIndex(u => u.id === unit.id);\n        if (existingIndex >= 0) {\n          // Update existing unit in roster\n          updatedRoster[existingIndex] = unit;\n        } else {\n          // Add new unit to roster (if not at max)\n          // This handles edge cases where a unit is added directly\n          if (updatedRoster.length < 10) {\n            updatedRoster.push(unit);\n          }\n        }\n      });\n      \n      return {\n        team: updatedTeam,\n        roster: updatedRoster,\n      };\n    }),\n\n  swapPartyMember: (partyIndex: number, unitId: string) =>\n    set((state) => {\n      if (!state.team) return state;\n\n      // Get unit from roster (preferred) or create from definition (fallback)\n      let newUnit = state.roster.find(u => u.id === unitId);\n      \n      if (!newUnit) {\n        // Fallback: create from definition (for backward compatibility)\n        const unitDef = UNIT_DEFINITIONS[unitId];\n        if (!unitDef) {\n          console.error(`Unit ${unitId} not found in roster or definitions`);\n          return state;\n        }\n        \n        const oldUnit = state.team.units[partyIndex];\n        newUnit = oldUnit\n          ? createUnit(unitDef, oldUnit.level, oldUnit.xp)\n          : createUnit(unitDef, 1, 0);\n        \n        // Add to roster if not already there (will be handled by setTeam below)\n        // Note: setTeam() will ensure roster contains all team units\n      }\n\n      const newUnits = [...state.team.units];\n\n      // Handle append vs replace for variable team sizes\n      if (partyIndex >= newUnits.length) {\n        // Append if index is beyond current team size\n        newUnits.push(newUnit);\n      } else {\n        // Replace existing unit\n        newUnits[partyIndex] = newUnit;\n      }\n\n      // No padding, no slice - allow 1-4 units naturally\n      const finalUnits = newUnits as typeof state.team.units;\n\n      const updatedTeam = updateTeam(state.team, {\n        units: finalUnits,\n      });\n      \n      // Ensure roster contains all team units (add/update as needed)\n      const updatedRoster = [...state.roster];\n      updatedTeam.units.forEach(unit => {\n        const existingIndex = updatedRoster.findIndex(u => u.id === unit.id);\n        if (existingIndex >= 0) {\n          // Update existing unit in roster\n          updatedRoster[existingIndex] = unit;\n        } else {\n          // Add new unit to roster (if not at max)\n          if (updatedRoster.length < 10) {\n            updatedRoster.push(unit);\n          }\n        }\n      });\n\n      return {\n        team: updatedTeam,\n        roster: updatedRoster,\n      };\n    }),\n});\n","type AvailabilityTarget = 'campaign' | 'tower';\n\ninterface AvailabilityLike {\n  availableIn?: ReadonlyArray<AvailabilityTarget>;\n}\n\nfunction normalizeAvailability(entry: AvailabilityLike): ReadonlyArray<AvailabilityTarget> {\n  return entry.availableIn && entry.availableIn.length > 0 ? entry.availableIn : (['campaign'] as const);\n}\n\nexport function isAvailableInCampaign(entry: AvailabilityLike): boolean {\n  return normalizeAvailability(entry).includes('campaign');\n}\n\nexport function isAvailableInTower(entry: AvailabilityLike): boolean {\n  return normalizeAvailability(entry).includes('tower');\n}\n\nexport function filterByAvailability<T extends AvailabilityLike>(items: readonly T[], target: AvailabilityTarget): T[] {\n  if (target === 'campaign') {\n    return items.filter(isAvailableInCampaign);\n  }\n  return items.filter(isAvailableInTower);\n}\n\n","// [BT-STATE][BT-01] Battle Tower UI state slice\nimport type { StateCreator, SetState } from 'zustand';\nimport type { TowerFloor } from '@/data/schemas/TowerFloorSchema';\nimport type { TowerRewardEntry } from '@/data/schemas/TowerRewardSchema';\nimport type { TowerRunState, TowerBattleOutcome, TowerBattleSummary } from '@/core/services/TowerService';\nimport type { TowerConfig, TowerDifficulty } from '@/core/config/towerConfig';\nimport type { BattleState } from '@/core/models/BattleState';\nimport type { Position } from '@/core/models/overworld';\nimport type { Equipment } from '@/data/schemas/EquipmentSchema';\nimport type { Unit } from '@/core/models/Unit';\nimport type { Team } from '@/core/models/Team';\nimport type { QueueBattleSlice } from './queueBattleSlice';\nimport type { GameFlowSlice } from './gameFlowSlice';\nimport type { TeamSlice } from './teamSlice';\nimport type { InventorySlice } from './inventorySlice';\nimport type { OverworldStore } from './overworldSlice';\nimport { DEFAULT_TOWER_CONFIG } from '@/core/config/towerConfig';\nimport { TOWER_FLOORS } from '@/data/definitions/towerFloors';\nimport { TOWER_REWARDS } from '@/data/definitions/towerRewards';\nimport {\n  createTowerRun,\n  getCurrentFloor as towerGetCurrentFloor,\n  recordBattleResult,\n  completeRestFloor,\n  clearPendingRewards,\n} from '@/core/services/TowerService';\nimport { UNIT_DEFINITIONS } from '@/data/definitions/units';\nimport { DJINN } from '@/data/definitions/djinn';\nimport { EQUIPMENT } from '@/data/definitions/equipment';\nimport { createUnit, updateUnit } from '@/core/models/Unit';\nimport { createTeam, updateTeam } from '@/core/models/Team';\nimport { collectDjinn } from '@/core/services/DjinnService';\nimport { calculateEffectiveStats } from '@/core/algorithms/stats';\nimport type { BattleEvent } from '@/core/services/types';\nimport { isAvailableInCampaign } from '../utils/contentAvailability';\n\nconst TOWER_START_GOLD = 5000;\nconst DEFAULT_DIFFICULTY: TowerDifficulty = 'normal';\n\nexport interface TowerRecord {\n  readonly highestFloorEver: number;\n  readonly totalRuns: number;\n  readonly bestRunTurns: number | null;\n  readonly bestRunDamageDealt: number | null;\n}\n\nexport const DEFAULT_TOWER_RECORD: TowerRecord = Object.freeze({\n  highestFloorEver: 0,\n  totalRuns: 0,\n  bestRunTurns: null,\n  bestRunDamageDealt: null,\n});\n\ntype TowerEntryContext =\n  | { type: 'main-menu' }\n  | { type: 'overworld'; mapId: string; position: Position };\n\ninterface SnapshotState {\n  team: Team | null;\n  roster: Unit[];\n  gold: number;\n  equipment: Equipment[];\n}\n\ninterface TowerRewardLedger {\n  equipmentIds: string[];\n  djinnIds: string[];\n  recruitIds: string[];\n}\n\ninterface TowerBattlePayload {\n  battle: BattleState;\n  events: readonly BattleEvent[];\n}\n\nexport interface TowerSlice {\n  towerRun: TowerRunState | null;\n  towerStatus: 'idle' | 'in-run' | 'completed';\n  towerRecord: TowerRecord;\n  towerEntryContext: TowerEntryContext | null;\n  towerSnapshots: SnapshotState | null;\n  activeTowerEncounterId: string | null;\n  towerRewardsEarned: TowerRewardLedger;\n\n  getCurrentTowerFloor: () => TowerFloor | null;\n  startTowerRun: (opts?: { difficulty?: TowerDifficulty; seed?: number }) => void;\n  beginTowerFloorBattle: () => void;\n  handleTowerBattleCompleted: (payload: TowerBattlePayload) => void;\n  applyTowerRest: () => void;\n  quitTowerRun: () => void;\n  enterTowerFromOverworld: (context: { mapId: string; position: Position }) => void;\n  openTowerFromMainMenu: () => void;\n  exitTowerMode: () => void;\n  setTowerRecord: (record: TowerRecord) => void;\n}\n\ntype TowerSliceDeps = TowerSlice &\n  QueueBattleSlice &\n  GameFlowSlice &\n  TeamSlice &\n  InventorySlice &\n  OverworldStore;\n\nexport const createTowerSlice: StateCreator<\n  TowerSliceDeps,\n  [['zustand/devtools', never]],\n  [],\n  TowerSlice\n> = (set, get) => ({\n  towerRun: null,\n  towerStatus: 'idle',\n  towerRecord: { ...DEFAULT_TOWER_RECORD },\n  towerEntryContext: null,\n  towerSnapshots: null,\n  activeTowerEncounterId: null,\n  towerRewardsEarned: createEmptyRewardLedger(),\n\n  getCurrentTowerFloor: () => {\n    const run = get().towerRun;\n    if (!run) {\n      return null;\n    }\n    return towerGetCurrentFloor(run, TOWER_FLOORS);\n  },\n\n  startTowerRun: (opts) => {\n    if (get().towerStatus === 'in-run') {\n      return;\n    }\n\n    const difficulty = opts?.difficulty ?? DEFAULT_DIFFICULTY;\n    const seed = opts?.seed ?? Date.now();\n\n    const snapshots = captureSnapshot(get());\n    const { towerTeam, towerRoster } = buildTowerRoster();\n\n    get().setTeam(towerTeam);\n    get().setRoster(towerRoster);\n    get().setGold(TOWER_START_GOLD);\n    const campaignEquipment = Object.values(EQUIPMENT)\n      .filter(isAvailableInCampaign)\n      .map((item) => ({ ...item }));\n    get().setEquipment(campaignEquipment);\n\n    const run = createTowerRun(seed, difficulty, TOWER_FLOORS, { config: DEFAULT_TOWER_CONFIG });\n\n    if (!get().towerEntryContext) {\n      set({ towerEntryContext: { type: 'main-menu' } });\n    }\n\n    set({\n      towerRun: run,\n      towerStatus: 'in-run',\n      towerSnapshots: snapshots,\n      activeTowerEncounterId: null,\n      towerRewardsEarned: createEmptyRewardLedger(),\n    });\n\n    get().setMode('tower');\n  },\n\n  beginTowerFloorBattle: () => {\n    const run = get().towerRun;\n    if (!run || get().towerStatus !== 'in-run') {\n      return;\n    }\n\n    const floor = towerGetCurrentFloor(run, TOWER_FLOORS);\n    if (!floor || floor.type === 'rest') {\n      return;\n    }\n\n    set({ activeTowerEncounterId: floor.encounterId });\n    get().setPendingBattle(floor.encounterId);\n  },\n\n  handleTowerBattleCompleted: ({ battle }: TowerBattlePayload) => {\n    const run = get().towerRun;\n    if (!run || !run.floorIds.length) {\n      return;\n    }\n\n    const encounterId = battle.encounterId || battle.meta?.encounterId || null;\n    const wasTowerBattle =\n      get().activeTowerEncounterId && encounterId === get().activeTowerEncounterId;\n\n    if (!wasTowerBattle) {\n      return;\n    }\n\n    const currentFloor = towerGetCurrentFloor(run, TOWER_FLOORS);\n    if (!currentFloor) {\n      return;\n    }\n\n    const outcome: TowerBattleOutcome =\n      battle.status === 'PLAYER_DEFEAT' ? 'defeat' : 'victory';\n\n    const summary: TowerBattleSummary = {\n      turnsTaken: battle.roundNumber,\n      damageDealt: sumUnitStat(battle.playerTeam.units, 'damageDealt'),\n      damageTaken: sumUnitStat(battle.playerTeam.units, 'damageTaken'),\n      manaSpent: 0,\n    };\n\n    const rewardEntries = getRewardsForFloor(currentFloor.floorNumber);\n    const recordedRun = recordBattleResult({\n      run,\n      floors: TOWER_FLOORS,\n      outcome,\n      summary,\n      rewards: rewardEntries,\n    });\n    const clearedRun = clearPendingRewards(recordedRun);\n\n    get().setBattle(null, 0);\n    get().updateTeamUnits(battle.playerTeam.units);\n    set({\n      activeTowerEncounterId: null,\n      towerRun: clearedRun,\n      towerStatus: clearedRun.isCompleted ? 'completed' : 'in-run',\n    });\n\n    processTowerRewards(rewardEntries, get(), set);\n\n    if (clearedRun.isCompleted || outcome === 'defeat') {\n      set((state) => ({\n        towerRun: {\n          ...clearedRun,\n          isCompleted: true,\n          isFailed: outcome === 'defeat',\n        },\n        towerStatus: 'completed',\n        towerRecord: updateTowerRecordFromRun(state.towerRecord, clearedRun),\n      }));\n    }\n\n    get().setMode('tower');\n  },\n\n  applyTowerRest: () => {\n    const run = get().towerRun;\n    if (!run || get().towerStatus !== 'in-run') {\n      return;\n    }\n\n    const floor = towerGetCurrentFloor(run, TOWER_FLOORS);\n    if (!floor || floor.type !== 'rest') {\n      return;\n    }\n\n    const config = run.config ?? DEFAULT_TOWER_CONFIG;\n    const healedTeam = healTeamAtRest(get().team, config);\n    if (healedTeam) {\n      get().updateTeam(healedTeam);\n      get().updateTeamUnits(healedTeam.units);\n    }\n\n    const restedRun = completeRestFloor(run, TOWER_FLOORS, {\n      healedFraction: config.healFractionAtRest,\n      loadoutAdjusted: true,\n    });\n\n    set({ towerRun: restedRun });\n  },\n\n  quitTowerRun: () => {\n    const run = get().towerRun;\n    if (!run) {\n      get().exitTowerMode();\n      return;\n    }\n\n    set((state) => ({\n      towerRun: {\n        ...run,\n        isCompleted: true,\n      },\n      towerStatus: 'completed',\n      towerRecord: updateTowerRecordFromRun(state.towerRecord, run),\n    }));\n  },\n\n  enterTowerFromOverworld: ({ mapId, position }) => {\n    set({\n      towerEntryContext: { type: 'overworld', mapId, position },\n    });\n    get().setMode('tower');\n  },\n\n  openTowerFromMainMenu: () => {\n    set({\n      towerEntryContext: { type: 'main-menu' },\n    });\n    get().setMode('tower');\n  },\n\n  exitTowerMode: () => {\n    const context = get().towerEntryContext;\n    const rewardsLedger = get().towerRewardsEarned;\n    restoreSnapshot(get());\n    commitTowerRewardsToCampaign(get(), rewardsLedger);\n\n    set({\n      towerRun: null,\n      towerStatus: 'idle',\n      towerEntryContext: null,\n      towerSnapshots: null,\n      activeTowerEncounterId: null,\n      towerRewardsEarned: createEmptyRewardLedger(),\n    });\n\n    if (context?.type === 'overworld') {\n      get().teleportPlayer(context.mapId, context.position);\n      get().setMode('overworld');\n    } else {\n      get().setMode('main-menu');\n    }\n  },\n\n  setTowerRecord: (record) => {\n    set({\n      towerRecord: {\n        highestFloorEver: record.highestFloorEver ?? 0,\n        totalRuns: record.totalRuns ?? 0,\n        bestRunTurns: record.bestRunTurns ?? null,\n        bestRunDamageDealt: record.bestRunDamageDealt ?? null,\n      },\n    });\n  },\n});\n\nfunction captureSnapshot(state: TowerSliceDeps): SnapshotState {\n  return {\n    team: state.team ? cloneTeam(state.team) : null,\n    roster: state.roster ? state.roster.map((unit) => cloneUnit(unit)) : [],\n    gold: state.gold,\n    equipment: state.equipment.map((item) => ({ ...item })),\n  };\n}\n\nfunction restoreSnapshot(state: TowerSliceDeps) {\n  const snapshot = state.towerSnapshots;\n  if (!snapshot) return;\n\n  if (snapshot.team) {\n    state.setTeam(snapshot.team);\n  }\n  state.setRoster(snapshot.roster);\n  state.setGold(snapshot.gold);\n  state.setEquipment(snapshot.equipment);\n}\n\nfunction buildTowerRoster(): { towerTeam: Team; towerRoster: Unit[] } {\n  const roster = Object.values(UNIT_DEFINITIONS)\n    .filter(isAvailableInCampaign)\n    .map((def) => updateUnit(createUnit(def, 20, 0), { storeUnlocked: true }));\n  const party = roster.slice(0, 4);\n  let team = createTeam(party);\n\n  const campaignDjinnIds = Object.entries(DJINN)\n    .filter(([, def]) => isAvailableInCampaign(def))\n    .map(([id]) => id);\n\n  for (const djinnId of campaignDjinnIds) {\n    const result = collectDjinn(team, djinnId);\n    if (result.ok) {\n      team = result.value;\n    }\n  }\n\n  const equippedDjinn = campaignDjinnIds.slice(0, 3);\n  team = updateTeam(team, { equippedDjinn });\n\n  return {\n    towerTeam: team,\n    towerRoster: roster,\n  };\n}\n\nfunction createEmptyRewardLedger(): TowerRewardLedger {\n  return {\n    equipmentIds: [],\n    djinnIds: [],\n    recruitIds: [],\n  };\n}\n\nfunction getRewardsForFloor(floorNumber: number): TowerRewardEntry[] {\n  const entry = TOWER_REWARDS.find((reward) => reward.floorNumber === floorNumber);\n  return entry ? entry.rewards : [];\n}\n\nfunction sumUnitStat(units: readonly Unit[], key: 'damageDealt' | 'damageTaken'): number {\n  return units.reduce((sum, unit) => sum + (unit.battleStats?.[key] ?? 0), 0);\n}\n\nfunction processTowerRewards(\n  entries: TowerRewardEntry[],\n  state: TowerSliceDeps,\n  setState: SetState<TowerSliceDeps>\n) {\n  if (entries.length === 0) {\n    return;\n  }\n\n  const baseLedger = state.towerRewardsEarned ?? createEmptyRewardLedger();\n  const updatedLedger: TowerRewardLedger = {\n    equipmentIds: [...baseLedger.equipmentIds],\n    djinnIds: [...baseLedger.djinnIds],\n    recruitIds: [...baseLedger.recruitIds],\n  };\n  let recorded = false;\n\n  for (const reward of entries) {\n    switch (reward.type) {\n      case 'equipment': {\n        const items = reward.ids\n          .map((id) => EQUIPMENT[id])\n          .filter((item): item is Equipment => Boolean(item));\n        if (items.length > 0) {\n          state.addEquipment(items);\n          updatedLedger.equipmentIds.push(...items.map((item) => item.id));\n          recorded = true;\n        }\n        break;\n      }\n      case 'djinn': {\n        for (const djinnId of reward.ids) {\n          if (!state.team) continue;\n          const updatedTeam = grantDjinnReward(state.team, djinnId);\n          state.setTeam(updatedTeam);\n          updatedLedger.djinnIds.push(djinnId);\n          recorded = true;\n        }\n        break;\n      }\n      case 'recruit': {\n        for (const unitId of reward.ids) {\n          const def = UNIT_DEFINITIONS[unitId];\n          if (!def) continue;\n          const existing = state.roster.find((unit) => unit.id === unitId);\n          if (existing) continue;\n          const newUnit = createUnit(def, 20, 0);\n          appendUnitToRoster(state, newUnit);\n          updatedLedger.recruitIds.push(unitId);\n          recorded = true;\n        }\n        break;\n      }\n    }\n  }\n\n  if (recorded) {\n    setState({\n      towerRewardsEarned: updatedLedger,\n    });\n  }\n}\n\nfunction commitTowerRewardsToCampaign(state: TowerSliceDeps, rewards: TowerRewardLedger) {\n  if (!rewards) {\n    return;\n  }\n\n  if (rewards.equipmentIds.length) {\n    const items = rewards.equipmentIds\n      .map((id) => EQUIPMENT[id])\n      .filter((item): item is Equipment => Boolean(item))\n      .map((item) => ({ ...item }));\n    if (items.length > 0) {\n      state.addEquipment(items);\n    }\n  }\n\n  if (state.team && rewards.djinnIds.length) {\n    let team = state.team;\n    for (const djinnId of rewards.djinnIds) {\n      team = grantDjinnReward(team, djinnId);\n    }\n    state.setTeam(team);\n  }\n\n  if (rewards.recruitIds.length) {\n    const existingIds = new Set(state.roster?.map((unit) => unit.id) ?? []);\n    for (const unitId of rewards.recruitIds) {\n      if (existingIds.has(unitId)) {\n        continue;\n      }\n      const def = UNIT_DEFINITIONS[unitId];\n      if (!def) {\n        continue;\n      }\n      const newUnit = createUnit(def, 20, 0);\n      appendUnitToRoster(state, newUnit);\n      existingIds.add(unitId);\n    }\n  }\n}\n\nfunction healTeamAtRest(team: Team | null, config: TowerConfig): Team | null {\n  if (!team) return null;\n  const fraction = config.healFractionAtRest;\n  const healedUnits = team.units.map((unit) => {\n    const stats = calculateEffectiveStats(unit, team);\n    const healAmount = Math.floor(stats.hp * fraction);\n    const nextHp = Math.min(stats.hp, unit.currentHp + healAmount);\n    return updateUnit(unit, { currentHp: nextHp });\n  });\n\n  const resetTrackers = Object.fromEntries(\n    Object.entries(team.djinnTrackers).map(([djinnId, tracker]) => [\n      djinnId,\n      { ...tracker, state: 'Set' as const },\n    ])\n  );\n\n  return updateTeam(team, {\n    units: healedUnits,\n    djinnTrackers: resetTrackers,\n  });\n}\n\nfunction updateTowerRecordFromRun(current: TowerRecord, run: TowerRunState): TowerRecord {\n  const nextHighest = Math.max(current.highestFloorEver, run.stats.highestFloor);\n  const nextTotalRuns = current.totalRuns + 1;\n  const turnsThisRun = run.stats.turnsTaken;\n  const damageThisRun = run.stats.totalDamageDealt;\n\n  const nextBestTurns =\n    turnsThisRun > 0\n      ? current.bestRunTurns === null\n        ? turnsThisRun\n        : Math.min(current.bestRunTurns, turnsThisRun)\n      : current.bestRunTurns;\n\n  const nextBestDamage =\n    current.bestRunDamageDealt === null\n      ? damageThisRun\n      : Math.max(current.bestRunDamageDealt, damageThisRun);\n\n  return {\n    highestFloorEver: nextHighest,\n    totalRuns: nextTotalRuns,\n    bestRunTurns: nextBestTurns,\n    bestRunDamageDealt: nextBestDamage,\n  };\n}\n\nfunction cloneTeam(team: Team): Team {\n  return {\n    ...team,\n    equippedDjinn: [...team.equippedDjinn],\n    djinnTrackers: Object.fromEntries(\n      Object.entries(team.djinnTrackers).map(([id, tracker]) => [id, { ...tracker }])\n    ),\n    units: team.units.map((unit) => cloneUnit(unit)),\n    collectedDjinn: [...team.collectedDjinn],\n    activationsThisTurn: { ...team.activationsThisTurn },\n    djinnStates: { ...team.djinnStates },\n  };\n}\n\nfunction cloneUnit(unit: Unit): Unit {\n  return {\n    ...unit,\n    equipment: {\n      weapon: unit.equipment.weapon ? { ...unit.equipment.weapon } : null,\n      armor: unit.equipment.armor ? { ...unit.equipment.armor } : null,\n      helm: unit.equipment.helm ? { ...unit.equipment.helm } : null,\n      boots: unit.equipment.boots ? { ...unit.equipment.boots } : null,\n      accessory: unit.equipment.accessory ? { ...unit.equipment.accessory } : null,\n    },\n    djinn: [...unit.djinn],\n    djinnStates: { ...unit.djinnStates },\n    abilities: unit.abilities.map((ability) => ({ ...ability })),\n    unlockedAbilityIds: [...unit.unlockedAbilityIds],\n    statusEffects: [...unit.statusEffects],\n    battleStats: { ...unit.battleStats },\n  };\n}\n\nfunction grantDjinnReward(team: Team, djinnId: string): Team {\n  const result = collectDjinn(team, djinnId);\n  if (result.ok) {\n    return result.value;\n  }\n\n  if (result.error.includes('Cannot collect more than 12 Djinn') && !team.collectedDjinn.includes(djinnId)) {\n    return updateTeam(team, {\n      collectedDjinn: [...team.collectedDjinn, djinnId],\n    });\n  }\n\n  return team;\n}\n\nfunction appendUnitToRoster(state: TowerSliceDeps, unit: Unit) {\n  const roster = state.roster ?? [];\n  state.setRoster([...roster, unit]);\n}\n\n","/**\n * Save state slice for Zustand\n * Handles save/load operations\n */\n\nimport type { StateCreator } from 'zustand';\nimport type { Unit } from '../../core/models/Unit';\nimport type { StoryState } from '../../core/models/story';\nimport { \n  saveGame, \n  loadGame, \n  hasSave, \n  deleteSave,\n  saveGameSlot,\n  loadGameSlot,\n  hasSaveSlot,\n  deleteSaveSlot,\n  getSaveSlotMetadata,\n  type SaveSlotMetadata,\n} from '../../core/services/SaveService';\nimport type { SaveV1 } from '../../data/schemas/SaveV1Schema';\nimport type { BattleSlice } from './battleSlice';\nimport type { TeamSlice } from './teamSlice';\nimport type { InventorySlice } from './inventorySlice';\nimport type { StorySlice } from './storySlice';\nimport type { OverworldSlice } from './overworldSlice';\nimport type { TowerSlice, TowerRecord } from './towerSlice';\nimport { DEFAULT_TOWER_RECORD } from './towerSlice';\n\ntype NPCState = {\n  defeated?: boolean;\n  dialogueSeen?: boolean;\n  questProgress?: number;\n  lastInteraction?: number;\n  customData?: Record<string, string | number | boolean>;\n};\n\nexport interface SaveSlice {\n  recruitmentFlags: Record<string, boolean>;\n  npcStates: Record<string, NPCState>;\n  statsTracker: {\n    battlesWon: number;\n    battlesLost: number;\n    totalDamageDealt: number;\n    totalHealingDone: number;\n    playtime: number; // seconds\n  };\n\n  hasSave: () => boolean;\n  loadGame: () => void;\n  saveGame: () => void;\n  deleteSave: () => void;\n  \n  // Slot-based operations\n  saveGameSlot: (slot: number) => void;\n  loadGameSlot: (slot: number) => void;\n  hasSaveSlot: (slot: number) => boolean;\n  deleteSaveSlot: (slot: number) => void;\n  getSaveSlotMetadata: (slot: number) => SaveSlotMetadata;\n  autoSave: () => void;\n\n  setRecruitmentFlag: (id: string, recruited: boolean) => void;\n  setNpcState: (id: string, state: Partial<NPCState>) => void;\n  incrementBattleStats: (delta: { outcome: 'win' | 'loss'; damageDealt?: number; healingDone?: number }) => void;\n  addPlaytime: (seconds: number) => void;\n}\n\n/**\n * Create SaveV1 data from current game state\n */\nfunction createSaveData(\n  team: TeamSlice['team'],\n  roster: Unit[],\n  inventory: Pick<InventorySlice, 'gold' | 'equipment'>,\n  story: StorySlice['story'],\n  overworld: Pick<OverworldSlice, 'playerPosition' | 'currentMapId'> | null,\n  towerRecord: TowerRecord,\n  recruitmentFlags: Record<string, boolean>,\n  npcStates: Record<string, NPCState>,\n  statsTracker: SaveSlice['statsTracker']\n): SaveV1 | null {\n  // Ensure we have units to save\n  if (!team || !team.units || team.units.length === 0) {\n    return null;\n  }\n\n  // Build activeParty with actual team size (1-4 units, no padding)\n  const partyIds = team.units.map(u => u.id);\n  // No slice, no padding - save actual team size (1-4 units)\n  const activeParty = partyIds;\n\n  // Get collected Djinn from team (they're stored team-wide, not per-unit)\n  const djinnCollected = team?.collectedDjinn ? [...team.collectedDjinn] : [];\n  const equippedDjinn = team?.equippedDjinn ? [...team.equippedDjinn] : [];\n  const djinnTrackers = team?.djinnTrackers ? { ...team.djinnTrackers } : {};\n\n  // Convert story flags to boolean-only (SaveV1Schema expects boolean)\n  const storyFlags: Record<string, boolean> = {};\n  Object.entries(story.flags).forEach(([key, value]) => {\n    storyFlags[key] = Boolean(value);\n  });\n\n  // Get overworld position or default\n  const playerPosition = overworld?.playerPosition ?? { x: 0, y: 0 };\n  const currentScene = overworld?.currentMapId ?? 'vale-village';\n\n  return {\n    version: '1.0.0' as const,\n    timestamp: Date.now(),\n    chapter: story.chapter,\n    playerData: {\n      unitsCollected: roster.map(u => {\n        // Clamp HP to base max (Djinn bonuses not persisted)\n        const baseMaxHp = u.baseStats.hp + (u.level - 1) * u.growthRates.hp;\n        return {\n          ...u,\n          currentHp: Math.min(u.currentHp, baseMaxHp),\n          djinn: [...u.djinn],\n          abilities: [...u.abilities],\n          unlockedAbilityIds: [...u.unlockedAbilityIds],\n          statusEffects: [...u.statusEffects],\n        };\n      }),\n      activeParty,\n      inventory: inventory.equipment,\n      gold: inventory.gold,\n      djinnCollected,\n      equippedDjinn,\n      djinnTrackers,\n      recruitmentFlags: { ...recruitmentFlags },\n      storyFlags,\n    },\n    overworldState: {\n      playerPosition,\n      currentScene,\n      npcStates: { ...npcStates },\n    },\n    stats: {\n      battlesWon: statsTracker.battlesWon,\n      battlesLost: statsTracker.battlesLost,\n      totalDamageDealt: statsTracker.totalDamageDealt,\n      totalHealingDone: statsTracker.totalHealingDone,\n      playtime: statsTracker.playtime,\n    },\n    towerStats: towerRecord ?? DEFAULT_TOWER_RECORD,\n  };\n}\n\ntype SaveWithOptionalStory = SaveV1 & {\n  story?: {\n    flags?: Record<string, boolean | number>;\n    chapter?: number;\n  };\n};\n\nfunction getStoryStateFromSave(saveData: SaveV1): StoryState {\n  const storySection = (saveData as SaveWithOptionalStory).story;\n  const flags = storySection?.flags ?? saveData.playerData.storyFlags ?? {};\n  return {\n    chapter: saveData.chapter ?? storySection?.chapter ?? 1,\n    flags: { ...flags },\n  };\n}\n\nexport const createSaveSlice: StateCreator<\n  SaveSlice & BattleSlice & TeamSlice & InventorySlice & StorySlice & OverworldSlice & TowerSlice,\n  [['zustand/devtools', never]],\n  [],\n  SaveSlice\n> = (_set, get) => ({\n  recruitmentFlags: {},\n  npcStates: {},\n  statsTracker: {\n    battlesWon: 0,\n    battlesLost: 0,\n    totalDamageDealt: 0,\n    totalHealingDone: 0,\n    playtime: 0,\n  },\n\n  hasSave: () => hasSave(),\n\n  loadGame: () => {\n    const result = loadGame();\n    if (!result.ok) {\n      console.error('Failed to load game:', result.error);\n      return;\n    }\n\n    const saveData = result.value;\n    const state = get();\n\n    // 1. Restore roster from unitsCollected (bench + active party)\n    state.setRoster(saveData.playerData.unitsCollected);\n\n    // 2. Build active party from activeParty IDs (references roster units)\n    const activeUnits = saveData.playerData.activeParty\n      .map(unitId => saveData.playerData.unitsCollected.find(u => u.id === unitId))\n      .filter((u): u is typeof saveData.playerData.unitsCollected[number] => u !== undefined);\n\n    if (activeUnits.length > 0) {\n      // No padding - use actual team size (1-4 units)\n      // Restore equippedDjinn and djinnTrackers from save data\n      const team = {\n        units: activeUnits,\n        equippedDjinn: saveData.playerData.equippedDjinn || [],\n        djinnTrackers: saveData.playerData.djinnTrackers || {},\n        collectedDjinn: saveData.playerData.djinnCollected,\n        currentTurn: 0,\n        activationsThisTurn: {},\n        djinnStates: {},\n      };\n\n      state.setTeam(team);\n    }\n\n    // Hydrate inventory\n    state.setEquipment(saveData.playerData.inventory ?? []);\n    state.setGold(saveData.playerData.gold ?? 0);\n\n    // Hydrate story state\n    state.setStoryState(getStoryStateFromSave(saveData));\n\n    // Hydrate overworld state\n    state.teleportPlayer(\n      saveData.overworldState.currentScene,\n      saveData.overworldState.playerPosition\n    );\n\n    state.setTowerRecord(saveData.towerStats ?? DEFAULT_TOWER_RECORD);\n    _set({\n      recruitmentFlags: saveData.playerData.recruitmentFlags ?? {},\n      npcStates: saveData.overworldState.npcStates ?? {},\n      statsTracker: {\n        battlesWon: saveData.stats.battlesWon ?? 0,\n        battlesLost: saveData.stats.battlesLost ?? 0,\n        totalDamageDealt: saveData.stats.totalDamageDealt ?? 0,\n        totalHealingDone: saveData.stats.totalHealingDone ?? 0,\n        playtime: saveData.stats.playtime ?? 0,\n      },\n    });\n    _set({\n      recruitmentFlags: saveData.playerData.recruitmentFlags ?? {},\n      npcStates: saveData.overworldState.npcStates ?? {},\n      statsTracker: {\n        battlesWon: saveData.stats.battlesWon ?? 0,\n        battlesLost: saveData.stats.battlesLost ?? 0,\n        totalDamageDealt: saveData.stats.totalDamageDealt ?? 0,\n        totalHealingDone: saveData.stats.totalHealingDone ?? 0,\n        playtime: saveData.stats.playtime ?? 0,\n      },\n    });\n    _set({\n      recruitmentFlags: saveData.playerData.recruitmentFlags ?? {},\n      npcStates: saveData.overworldState.npcStates ?? {},\n      statsTracker: {\n        battlesWon: saveData.stats.battlesWon ?? 0,\n        battlesLost: saveData.stats.battlesLost ?? 0,\n        totalDamageDealt: saveData.stats.totalDamageDealt ?? 0,\n        totalHealingDone: saveData.stats.totalHealingDone ?? 0,\n        playtime: saveData.stats.playtime ?? 0,\n      },\n    });\n    _set({\n      recruitmentFlags: saveData.playerData.recruitmentFlags ?? {},\n      npcStates: saveData.overworldState.npcStates ?? {},\n      statsTracker: {\n        battlesWon: saveData.stats.battlesWon ?? 0,\n        battlesLost: saveData.stats.battlesLost ?? 0,\n        totalDamageDealt: saveData.stats.totalDamageDealt ?? 0,\n        totalHealingDone: saveData.stats.totalHealingDone ?? 0,\n        playtime: saveData.stats.playtime ?? 0,\n      },\n    });\n    _set({\n      recruitmentFlags: saveData.playerData.recruitmentFlags ?? {},\n      npcStates: saveData.overworldState.npcStates ?? {},\n      statsTracker: {\n        battlesWon: saveData.stats.battlesWon ?? 0,\n        battlesLost: saveData.stats.battlesLost ?? 0,\n        totalDamageDealt: saveData.stats.totalDamageDealt ?? 0,\n        totalHealingDone: saveData.stats.totalHealingDone ?? 0,\n        playtime: saveData.stats.playtime ?? 0,\n      },\n    });\n    _set({\n      recruitmentFlags: saveData.playerData.recruitmentFlags ?? {},\n      npcStates: saveData.overworldState.npcStates ?? {},\n      statsTracker: {\n        battlesWon: saveData.stats.battlesWon ?? 0,\n        battlesLost: saveData.stats.battlesLost ?? 0,\n        totalDamageDealt: saveData.stats.totalDamageDealt ?? 0,\n        totalHealingDone: saveData.stats.totalHealingDone ?? 0,\n        playtime: saveData.stats.playtime ?? 0,\n      },\n    });\n\n    // Hydrate battle state from localStorage\n    const battleStateJson = localStorage.getItem('vale-v2/battle-state');\n    if (battleStateJson) {\n      try {\n        const battleState = JSON.parse(battleStateJson);\n        if (battleState?.battle) {\n          const rngSeed =\n            typeof battleState.rngSeed === 'number' ? battleState.rngSeed : 0;\n          state.setBattle(battleState.battle, rngSeed);\n          _set({ turnNumber: battleState.turnNumber ?? 0 });\n        }\n      } catch (error) {\n        console.warn('Failed to parse battle state:', error);\n      }\n    }\n  },\n\n  saveGame: () => {\n    const { team, roster, story, currentMapId, playerPosition, gold, equipment, recruitmentFlags, npcStates, statsTracker } = get();\n    const overworldSnapshot: Pick<OverworldSlice, 'playerPosition' | 'currentMapId'> = {\n      currentMapId,\n      playerPosition,\n    };\n    const saveData = createSaveData(\n      team,\n      roster,\n      { gold, equipment },\n      story,\n      overworldSnapshot,\n      get().towerRecord ?? DEFAULT_TOWER_RECORD,\n      recruitmentFlags,\n      npcStates,\n      statsTracker\n    );\n    \n    if (!saveData) {\n      console.error('Cannot save: no team data');\n      return;\n    }\n\n    // Store battle state separately for now\n    const { battle, rngSeed } = get();\n    const battleState = {\n      battle,\n      rngSeed,\n      turnNumber: get().turnNumber,\n    };\n    localStorage.setItem('vale-v2/battle-state', JSON.stringify(battleState));\n\n    const result = saveGame(saveData);\n    if (!result.ok) {\n      console.error('Failed to save game:', result.error);\n    }\n  },\n\n  deleteSave: () => {\n    const result = deleteSave();\n    if (!result.ok) {\n      console.error('Failed to delete save:', result.error);\n    }\n    localStorage.removeItem('vale-v2/battle-state');\n  },\n\n  // Slot-based operations\n  saveGameSlot: (slot: number) => {\n    const { team, roster, story, currentMapId, playerPosition, gold, equipment, recruitmentFlags, npcStates, statsTracker } = get();\n    const overworldSnapshot: Pick<OverworldSlice, 'playerPosition' | 'currentMapId'> = {\n      currentMapId,\n      playerPosition,\n    };\n    const saveData = createSaveData(\n      team,\n      roster,\n      { gold, equipment },\n      story,\n      overworldSnapshot,\n      get().towerRecord ?? DEFAULT_TOWER_RECORD,\n      recruitmentFlags,\n      npcStates,\n      statsTracker\n    );\n    \n    if (!saveData) {\n      console.error('Cannot save: no team data');\n      return;\n    }\n\n    // Store battle state separately\n    const { battle, rngSeed } = get();\n    const battleState = {\n      battle,\n      rngSeed,\n      turnNumber: get().turnNumber,\n    };\n    localStorage.setItem(`vale-v2/battle-state-slot-${slot}`, JSON.stringify(battleState));\n\n    const result = saveGameSlot(slot, saveData);\n    if (!result.ok) {\n      console.error(`Failed to save game to slot ${slot}:`, result.error);\n    }\n  },\n\n  loadGameSlot: (slot: number) => {\n    const result = loadGameSlot(slot);\n    if (!result.ok) {\n      console.error(`Failed to load game from slot ${slot}:`, result.error);\n      return;\n    }\n\n    const saveData = result.value;\n    const state = get();\n\n    // 1. Restore roster from unitsCollected (bench + active party)\n    state.setRoster(saveData.playerData.unitsCollected);\n\n    // 2. Build active party from activeParty IDs (references roster units)\n    const activeUnits = saveData.playerData.activeParty\n      .map(unitId => saveData.playerData.unitsCollected.find(u => u.id === unitId))\n      .filter((u): u is typeof saveData.playerData.unitsCollected[number] => u !== undefined);\n\n    if (activeUnits.length > 0) {\n      // No padding - use actual team size (1-4 units)\n      // Restore equippedDjinn and djinnTrackers from save data\n      const team = {\n        units: activeUnits,\n        equippedDjinn: saveData.playerData.equippedDjinn || [],\n        djinnTrackers: saveData.playerData.djinnTrackers || {},\n        collectedDjinn: saveData.playerData.djinnCollected,\n        currentTurn: 0,\n        activationsThisTurn: {},\n        djinnStates: {},\n      };\n\n      state.setTeam(team);\n    }\n\n    // Hydrate inventory\n    state.setEquipment(saveData.playerData.inventory ?? []);\n    state.setGold(saveData.playerData.gold ?? 0);\n\n    // Hydrate story state\n    state.setStoryState(getStoryStateFromSave(saveData));\n\n    // Hydrate overworld state\n    state.teleportPlayer(\n      saveData.overworldState.currentScene,\n      saveData.overworldState.playerPosition\n    );\n\n    state.setTowerRecord(saveData.towerStats ?? DEFAULT_TOWER_RECORD);\n\n    // Hydrate battle state from localStorage\n    const battleStateJson = localStorage.getItem(`vale-v2/battle-state-slot-${slot}`);\n    if (battleStateJson) {\n      try {\n        const battleState = JSON.parse(battleStateJson);\n        if (battleState?.battle) {\n          const rngSeed =\n            typeof battleState.rngSeed === 'number' ? battleState.rngSeed : 0;\n          state.setBattle(battleState.battle, rngSeed);\n          _set({ turnNumber: battleState.turnNumber ?? 0 });\n        }\n      } catch (error) {\n        console.warn('Failed to parse battle state:', error);\n      }\n    }\n  },\n\n  hasSaveSlot: (slot: number) => hasSaveSlot(slot),\n\n  deleteSaveSlot: (slot: number) => {\n    const result = deleteSaveSlot(slot);\n    if (!result.ok) {\n      console.error(`Failed to delete save slot ${slot}:`, result.error);\n    }\n    localStorage.removeItem(`vale-v2/battle-state-slot-${slot}`);\n  },\n\n  getSaveSlotMetadata: (slot: number) => getSaveSlotMetadata(slot),\n\n  autoSave: () => {\n    // Auto-save to slot 0 (quick save)\n    get().saveGameSlot(0);\n  },\n\n  setRecruitmentFlag: (id, recruited) => {\n    _set((state) => ({\n      recruitmentFlags: { ...state.recruitmentFlags, [id]: recruited },\n    }));\n  },\n\n  setNpcState: (id, statePatch) => {\n    _set((state) => ({\n      npcStates: {\n        ...state.npcStates,\n        [id]: { ...(state.npcStates[id] ?? {}), ...statePatch },\n      },\n    }));\n  },\n\n  incrementBattleStats: ({ outcome, damageDealt = 0, healingDone = 0 }) => {\n    _set((state) => ({\n      statsTracker: {\n        ...state.statsTracker,\n        battlesWon: state.statsTracker.battlesWon + (outcome === 'win' ? 1 : 0),\n        battlesLost: state.statsTracker.battlesLost + (outcome === 'loss' ? 1 : 0),\n        totalDamageDealt: state.statsTracker.totalDamageDealt + Math.max(0, Math.floor(damageDealt)),\n        totalHealingDone: state.statsTracker.totalHealingDone + Math.max(0, Math.floor(healingDone)),\n      },\n    }));\n  },\n\n  addPlaytime: (seconds) => {\n    _set((state) => ({\n      statsTracker: {\n        ...state.statsTracker,\n        playtime: state.statsTracker.playtime + Math.max(0, Math.floor(seconds)),\n      },\n    }));\n  },\n});\n","/**\n * Story state slice for Zustand\n * Manages story progression and flags\n */\n\nimport type { StateCreator } from 'zustand';\nimport type { BattleEvent } from '../../core/services/types';\nimport type { StoryState } from '../../core/models/story';\nimport { createStoryState, setFlag } from '../../core/models/story';\nimport { processEncounterCompletion, advanceChapter, encounterIdToFlagKey, processStoryFlagForDjinn, processStoryFlagForUnit } from '../../core/services/StoryService';\nimport type { BattleSlice } from './battleSlice';\nimport type { TeamSlice } from './teamSlice';\nimport type { SaveSlice } from './saveSlice';\n\nexport interface StorySlice {\n  story: StoryState;\n  showCredits: boolean;\n  setShowCredits: (show: boolean) => void;\n  setStoryFlag: (key: string, value: boolean | number) => void;\n  getStoryFlag: (key: string) => boolean | number | undefined;\n  setStoryState: (story: StoryState) => void;\n  onBattleEvents: (events: readonly BattleEvent[]) => void;\n}\n\nexport const createStorySlice: StateCreator<\n  StorySlice & BattleSlice & TeamSlice & SaveSlice,\n  [['zustand/devtools', never]],\n  [],\n  StorySlice\n> = (_set, get) => ({\n  story: createStoryState(1),\n  showCredits: false,\n  \n  setShowCredits: (show) => _set({ showCredits: show }),\n\n  setStoryState: (storyState) => {\n    _set({ story: storyState });\n  },\n\n  setStoryFlag: (key, value) => {\n    const story = get().story;\n    const team = get().team;\n    \n    // Process story flag (includes Djinn granting)\n    if (team) {\n      const result = processStoryFlagForDjinn(story, team, key, value);\n      \n      // Update story state\n      _set({ story: result.story });\n      \n      // Update team if Djinn was granted\n      if (result.djinnGranted) {\n        get().updateTeam(result.team);\n        if (import.meta.env.DEV) {\n          console.log(` Djinn ${result.djinnGranted} granted from story flag: ${key}`);\n        }\n      }\n    } else {\n      // No team available, just update story\n    const updatedStory = setFlag(story, key, value);\n    _set({ story: updatedStory });\n    }\n  },\n\n  getStoryFlag: (key) => {\n    return get().story.flags[key];\n  },\n\n  onBattleEvents: (events) => {\n    let st = get().story;\n    const team = get().team;\n\n    for (const e of events) {\n      if (e.type === 'encounter-finished' && e.outcome === 'PLAYER_VICTORY') {\n        st = processEncounterCompletion(st, e.encounterId);\n        // Convert encounter ID to flag key for chapter advancement\n        const flagKey = encounterIdToFlagKey(e.encounterId);\n\n        // Process story flag for Djinn (if team available)\n        if (team) {\n          const djinnResult = processStoryFlagForDjinn(st, team, flagKey, true);\n          st = djinnResult.story;\n\n          // Update team if Djinn was granted\n          if (djinnResult.djinnGranted) {\n            get().updateTeam(djinnResult.team);\n            if (import.meta.env.DEV) {\n              console.log(` Djinn ${djinnResult.djinnGranted} granted from encounter: ${e.encounterId}`);\n            }\n          }\n        }\n\n        // Process story flag for Unit recruitment (story joins)\n        // For house encounters, use the house ID directly (e.g., 'house-02') instead of flagKey\n        // because STORY_FLAG_TO_UNIT uses house-XX keys\n        const storyJoinFlagKey = e.encounterId.startsWith('house-') ? e.encounterId : flagKey;\n        const avgLevel = team ? Math.max(1, Math.floor(team.units.reduce((sum, u) => sum + u.level, 0) / team.units.length)) : 1;\n        const unitResult = processStoryFlagForUnit(st, storyJoinFlagKey, true, avgLevel);\n        st = unitResult.story;\n\n        // Add recruited unit to roster if applicable\n        if (unitResult.recruitedUnit) {\n          get().addUnitToRoster(unitResult.recruitedUnit);\n          if (import.meta.env.DEV) {\n            console.log(` Unit ${unitResult.recruitedUnit.name} recruited from story join: ${e.encounterId}`);\n          }\n        }\n\n        const adv = advanceChapter(st, flagKey);\n        if (adv.ok) {\n          st = adv.value;\n        }\n\n        // Trigger credits screen when Chapter 3 boss is defeated\n        if (flagKey === 'boss:ch3' && st.chapter === 4) {\n          _set({ story: st, showCredits: true });\n          return; // Early return to avoid double set\n        }\n      }\n    }\n\n    _set({ story: st });\n  },\n});\n","/**\n * Inventory state slice for Zustand\n * Manages player's gold and equipment inventory\n */\n\nimport type { StateCreator } from 'zustand';\nimport type { Equipment } from '../../core/models/Equipment';\n\nexport interface InventorySlice {\n  gold: number;\n  equipment: Equipment[];\n  setGold: (amount: number) => void;\n  setEquipment: (items: Equipment[]) => void;\n  \n  addGold: (amount: number) => void;\n  addEquipment: (items: Equipment[]) => void;\n  removeEquipment: (itemId: string) => void;\n}\n\nexport const createInventorySlice: StateCreator<\n  InventorySlice,\n  [['zustand/devtools', never]],\n  [],\n  InventorySlice\n> = (set) => ({\n  gold: 0,\n  equipment: [],\n\n  addGold: (amount) => {\n    set((state) => ({ gold: state.gold + amount }));\n  },\n\n  addEquipment: (items) => {\n    // Deep clone equipment to avoid reference sharing issues with duplicates\n    set((state) => ({ \n      equipment: [...state.equipment, ...items.map(item => ({ ...item }))] \n    }));\n  },\n\n  removeEquipment: (itemId) => {\n    set((state) => {\n      const index = state.equipment.findIndex((item) => item.id === itemId);\n      if (index === -1) return state; // Item not found, no change\n      \n      const newEquipment = [...state.equipment];\n      newEquipment.splice(index, 1); // Remove only the first matching item\n      return { equipment: newEquipment };\n    });\n  },\n \n  setGold: (amount) => {\n    set({ gold: amount });\n  },\n\n  setEquipment: (items) => {\n    set({ equipment: items.map(item => ({ ...item })) });\n  },\n});\n","/**\n * Rewards state slice for Zustand\n * Manages post-battle rewards and reward screen visibility\n */\n\nimport type { StateCreator } from 'zustand';\nimport type { BattleState } from '../../core/models/BattleState';\nimport type { RewardDistribution } from '../../core/models/Rewards';\nimport { processVictory as rewardsServiceProcessVictory } from '../../core/services/RewardsService';\nimport type { InventorySlice } from './inventorySlice';\nimport type { BattleSlice } from './battleSlice';\nimport type { TeamSlice } from './teamSlice';\nimport type { GameFlowSlice } from './gameFlowSlice';\nimport type { Equipment } from '../../data/schemas/EquipmentSchema';\n\nexport interface RewardsSlice {\n  lastBattleRewards: RewardDistribution | null;\n  showRewards: boolean;\n  lastBattleEncounterId: string | null; // Store encounterId for post-battle dialogue\n\n  processVictory: (battle: BattleState) => void;\n  claimRewards: () => void;\n  setShowRewards: (visible: boolean) => void;\n  selectEquipmentChoice: (equipment: Equipment) => void;\n}\n\nexport const createRewardsSlice: StateCreator<\n  RewardsSlice & InventorySlice & BattleSlice & TeamSlice & GameFlowSlice,\n  [['zustand/devtools', never]],\n  [],\n  RewardsSlice\n> = (set, get) => ({\n  lastBattleRewards: null,\n  showRewards: false,\n  lastBattleEncounterId: null,\n\n  processVictory: (battle) => {\n    const result = rewardsServiceProcessVictory(battle);\n    \n    // Capture encounterId before clearing battle state\n    const encounterId = battle.encounterId || battle.meta?.encounterId || null;\n\n    const { setTeam } = get();\n    setTeam(result.updatedTeam);\n\n    // NOTE: Unit recruitment is now handled via post-battle recruitment dialogues\n    // All recruitment is narrative-driven via dialogue effects (recruitUnit)\n\n    set({\n      lastBattleRewards: result.distribution,\n      lastBattleEncounterId: encounterId, // Store for post-battle dialogue\n      mode: 'rewards', // Set mode instead of showRewards\n      showRewards: true,\n    });\n  },\n\n  claimRewards: () => {\n    const { lastBattleRewards } = get();\n    if (!lastBattleRewards) return;\n\n    const { addGold, addEquipment } = get();\n    addGold(lastBattleRewards.goldEarned);\n\n    const equipmentToAdd: Equipment[] = [];\n    if (lastBattleRewards.fixedEquipment) {\n      equipmentToAdd.push(lastBattleRewards.fixedEquipment);\n    }\n    if (lastBattleRewards.choiceSelected) {\n      equipmentToAdd.push(lastBattleRewards.choiceSelected);\n    }\n\n    if (equipmentToAdd.length > 0) {\n      addEquipment(equipmentToAdd);\n    }\n\n    // Clear rewards but keep encounterId until handleRewardsContinue uses it\n    // Don't clear lastBattleEncounterId here - handleRewardsContinue needs it\n    set({ lastBattleRewards: null, showRewards: false });\n    // Don't set mode here - let handleRewardsContinue handle mode transition\n    // (it needs to check for recruitment dialogue first)\n  },\n\n  setShowRewards: (visible) => {\n    set({ showRewards: visible });\n  },\n\n  selectEquipmentChoice: (equipment) => {\n    set((state) => {\n      if (!state.lastBattleRewards?.equipmentChoice) return state;\n      return {\n        lastBattleRewards: {\n          ...state.lastBattleRewards,\n          choiceSelected: equipment,\n          equipmentChoice: undefined,\n        },\n      };\n    });\n  },\n});\n","import type { Team } from '@/core/models/Team';\nimport type { Unit } from '@/core/models/Unit';\nimport { MIN_PARTY_SIZE, MAX_PARTY_SIZE } from '@/core/constants';\nimport type { EquipmentLoadout, Equipment } from '@/core/models/Equipment';\nimport { createEmptyLoadout } from '@/core/models/Equipment';\n\nexport interface BattleSlotConfig {\n  readonly slotIndex: number;\n  readonly unitId: string | null;\n  readonly equipmentLoadout: EquipmentLoadout;\n  readonly metadata?: Record<string, unknown>;\n}\n\nexport interface BattleConfig {\n  readonly slots: readonly BattleSlotConfig[];\n  readonly djinnSlots: readonly (string | null)[];\n  readonly metadata?: Record<string, unknown>;\n}\n\nexport const DEFAULT_BATTLE_SLOT_COUNT = MAX_PARTY_SIZE;\nexport const DEFAULT_DJINN_SLOT_COUNT = 3;\n\nexport function cloneEquipmentLoadout(loadout: EquipmentLoadout): EquipmentLoadout {\n  return {\n    weapon: loadout.weapon ?? null,\n    armor: loadout.armor ?? null,\n    helm: loadout.helm ?? null,\n    boots: loadout.boots ?? null,\n    accessory: loadout.accessory ?? null,\n  };\n}\n\nfunction getDefaultEquipmentLoadoutForUnit(unit?: Unit): EquipmentLoadout {\n  if (!unit) {\n    return createEmptyLoadout();\n  }\n\n  return cloneEquipmentLoadout(unit.equipment);\n}\n\nexport function createDefaultDjinnSlots(selectedDjinn?: readonly string[]): readonly (string | null)[] {\n  const slots: (string | null)[] = [];\n  for (let index = 0; index < DEFAULT_DJINN_SLOT_COUNT; index += 1) {\n    slots.push(selectedDjinn?.[index] ?? null);\n  }\n  return slots;\n}\n\nfunction createBattleConfigFromUnits(\n  units: readonly Unit[],\n  slotCount = DEFAULT_BATTLE_SLOT_COUNT,\n  initialDjinn?: readonly string[]\n): BattleConfig {\n  const slots: BattleSlotConfig[] = [];\n  for (let index = 0; index < slotCount; index += 1) {\n    const unit = units[index];\n    slots.push({\n      slotIndex: index,\n      unitId: unit?.id ?? null,\n      equipmentLoadout: getDefaultEquipmentLoadoutForUnit(unit),\n    });\n  }\n\n  return { slots, djinnSlots: createDefaultDjinnSlots(initialDjinn) };\n}\n\nexport function buildBattleConfigForNextBattle(team: Team | null, roster: readonly Unit[], slotCount = DEFAULT_BATTLE_SLOT_COUNT): BattleConfig {\n  const initialDjinn = team?.equippedDjinn;\n  if (team && team.units.length > 0) {\n    return createBattleConfigFromUnits(team.units, slotCount, initialDjinn);\n  }\n\n  return createBattleConfigFromUnits(roster, slotCount, initialDjinn);\n}\n\nexport function getActiveSlotUnitIds(config: BattleConfig): readonly string[] {\n  return config.slots\n    .map((slot) => slot.unitId)\n    .filter((unitId): unitId is string => Boolean(unitId));\n}\n\nexport function getEquipmentLoadoutForSlot(config: BattleConfig, slotIndex: number): EquipmentLoadout {\n  const slot = config.slots.find((entry) => entry.slotIndex === slotIndex);\n  return slot ? cloneEquipmentLoadout(slot.equipmentLoadout) : createEmptyLoadout();\n}\n\nexport function updateDjinnSlots(slots: readonly (string | null)[], slotIndex: number, djinnId: string | null): readonly (string | null)[] {\n  const next = [...slots];\n  next[slotIndex] = djinnId;\n  return next;\n}\n\nexport interface BattleConfigValidationResult {\n  readonly valid: boolean;\n  readonly message?: string;\n}\n\nexport function validateBattleConfig(\n  config: BattleConfig,\n  inventory: readonly Equipment[],\n  roster: readonly Unit[],\n  team: Team | null\n): BattleConfigValidationResult {\n  if (!team) {\n    return { valid: false, message: 'Team data is missing' };\n  }\n\n  const filledUnitIds = getActiveSlotUnitIds(config);\n  if (filledUnitIds.length < MIN_PARTY_SIZE) {\n    return { valid: false, message: `Select at least ${MIN_PARTY_SIZE} units before starting the battle` };\n  }\n\n  const inventoryCounts = new Map<string, number>();\n  for (const item of inventory) {\n    inventoryCounts.set(item.id, (inventoryCounts.get(item.id) ?? 0) + 1);\n  }\n\n  const equipmentUsage = new Map<string, number>();\n\n  for (const slot of config.slots) {\n    if (!slot.unitId) continue;\n\n    const unit = roster.find((candidate) => candidate.id === slot.unitId) ??\n      team.units.find((candidate) => candidate.id === slot.unitId);\n    if (!unit) {\n      return { valid: false, message: `Unit ${slot.unitId} is unavailable for this slot` };\n    }\n\n    const loadoutEntries = Object.values(slot.equipmentLoadout) as (Equipment | null)[];\n    for (const equipment of loadoutEntries) {\n      if (!equipment) continue;\n\n      if (equipment.allowedElements.length > 0 && !equipment.allowedElements.includes(unit.element)) {\n        return { valid: false, message: `${unit.name} cannot equip ${equipment.name}` };\n      }\n\n      const used = equipmentUsage.get(equipment.id) ?? 0;\n      equipmentUsage.set(equipment.id, used + 1);\n    }\n  }\n\n  for (const [equipmentId, used] of equipmentUsage.entries()) {\n    const available = inventoryCounts.get(equipmentId) ?? 0;\n    if (used > available) {\n      return { valid: false, message: `Not enough copies of ${equipmentId} in your inventory` };\n    }\n  }\n\n  const selectedDjinn = config.djinnSlots.filter((djinnId): djinnId is string => Boolean(djinnId));\n  for (const djinnId of selectedDjinn) {\n    if (!team.collectedDjinn.includes(djinnId)) {\n      return { valid: false, message: `You do not own the ${djinnId} Djinn` };\n    }\n  }\n\n  return { valid: true };\n}\n","import type { StateCreator } from 'zustand';\nimport type { MapTrigger } from '@/core/models/overworld';\nimport type { Encounter } from '@/data/schemas/EncounterSchema';\nimport type { Unit } from '@/core/models/Unit';\nimport { createTeam, updateTeam, type Team } from '@/core/models/Team';\nimport { updateUnit } from '@/core/models/Unit';\nimport type { EquipmentSlot, Equipment } from '@/core/models/Equipment';\nimport { createEmptyLoadout } from '@/core/models/Equipment';\nimport { ENCOUNTERS } from '@/data/definitions/encounters';\nimport { createBattleFromEncounter } from '@/core/services/EncounterService';\nimport { makePRNG } from '@/core/random/prng';\nimport { DIALOGUES } from '@/data/definitions/dialogues';\nimport { getPreBattleDialogue } from '@/data/definitions/preBattleDialogues';\nimport type { QueueBattleSlice } from './queueBattleSlice';\nimport type { TeamSlice } from './teamSlice';\nimport type { DialogueSlice } from './dialogueSlice';\nimport type { OverworldSlice } from './overworldSlice';\nimport type { InventorySlice } from './inventorySlice';\nimport type { TowerSlice } from './towerSlice';\nimport { MIN_PARTY_SIZE } from '@/core/constants';\nimport type { BattleConfig } from './battleConfig';\nimport { buildBattleConfigForNextBattle, cloneEquipmentLoadout, updateDjinnSlots, validateBattleConfig } from './battleConfig';\n\nexport interface GameFlowSlice {\n  mode:\n    | 'title-screen'\n    | 'main-menu'\n    | 'intro'\n    | 'overworld'\n    | 'battle'\n    | 'rewards'\n    | 'dialogue'\n    | 'shop'\n    | 'team-select'\n    | 'compendium'\n    | 'tower';\n  lastTrigger: MapTrigger | null;\n  currentEncounter: Encounter | null;\n  currentShopId: string | null;\n  preBattlePosition: { mapId: string; position: { x: number; y: number } } | null;\n  currentBattleConfig: BattleConfig | null;\n  pendingBattleEncounterId: string | null;\n  setMode: (mode: GameFlowSlice['mode']) => void;\n  setPendingBattle: (encounterId: string | null) => void;\n  handleTrigger: (trigger: MapTrigger | null, skipPreBattleDialogue?: boolean) => void;\n  confirmBattleTeam: () => void;\n  updateBattleConfigSlot: (slotIndex: number, unitId: string | null) => void;\n  updateBattleSlotEquipment: (slotIndex: number, equipmentSlot: EquipmentSlot, equipment: Equipment | null) => void;\n  setBattleConfigDjinnSlot: (slotIndex: number, djinnId: string | null) => void;\n  clearBattleConfig: () => void;\n  resetLastTrigger: () => void;\n  returnToOverworld: () => void;\n}\n\nexport const createGameFlowSlice: StateCreator<\n  GameFlowSlice & QueueBattleSlice & TeamSlice & DialogueSlice & OverworldSlice & InventorySlice & TowerSlice,\n  [['zustand/devtools', never]],\n  [],\n  GameFlowSlice\n> = (set, get) => {\n  const buildTeamFromBattleConfig = (): Team | null => {\n    const store = get();\n    const { currentBattleConfig, team: existingTeam } = store;\n\n    if (!currentBattleConfig) {\n      console.error('No battle configuration available when building team');\n      return null;\n    }\n\n    const units: Unit[] = [];\n    for (const slot of currentBattleConfig.slots) {\n      if (!slot.unitId) {\n        continue;\n      }\n\n      let unit = store.getUnitFromRoster(slot.unitId);\n      if (!unit && existingTeam) {\n        unit = existingTeam.units.find((candidate) => candidate.id === slot.unitId);\n      }\n\n      if (!unit) {\n        console.error(`Unit ${slot.unitId} missing from roster/team when building battle team`);\n        return null;\n      }\n\n      const equipmentLoadout = slot.equipmentLoadout ?? createEmptyLoadout();\n      const unitWithEquipment = updateUnit(unit, { equipment: cloneEquipmentLoadout(equipmentLoadout) });\n      units.push(unitWithEquipment);\n    }\n\n    if (units.length < MIN_PARTY_SIZE) {\n      console.error(`Battle requires at least ${MIN_PARTY_SIZE} units, found ${units.length}`);\n      return null;\n    }\n\n    const baseTeam = existingTeam ? updateTeam(existingTeam, { units }) : createTeam(units);\n\n    const selectedDjinn = currentBattleConfig.djinnSlots.filter((djinnId): djinnId is string => Boolean(djinnId));\n    if (selectedDjinn.length > 0) {\n      try {\n        return updateTeam(baseTeam, { equippedDjinn: selectedDjinn });\n      } catch (error) {\n        console.error('Failed to apply Djinn selection from BattleConfig', error);\n        return null;\n      }\n    }\n\n    return baseTeam;\n  };\n\n  const initializeBattleConfig = () => buildBattleConfigForNextBattle(get().team, get().roster);\n\n  return {\n    mode: 'title-screen',\n    lastTrigger: null,\n    currentEncounter: null,\n    currentShopId: null,\n    preBattlePosition: null,\n    currentBattleConfig: null,\n    pendingBattleEncounterId: null,\n    setMode: (mode) => set({ mode }),\n    setPendingBattle: (encounterId) => {\n    // When setting a pending battle, automatically transition to team-select mode\n    // This matches the behavior of handleTrigger when a battle trigger is encountered\n    const battleConfig = encounterId ? initializeBattleConfig() : null;\n    set({ \n      pendingBattleEncounterId: encounterId,\n      mode: encounterId ? 'team-select' : 'overworld',\n      currentBattleConfig: battleConfig,\n    });\n  },\n  handleTrigger: (trigger, skipPreBattleDialogue = false) => {\n    if (!trigger) {\n      set({ lastTrigger: null });\n      return;\n    }\n\n    // ========================================\n    // BATTLE TRIGGERS\n    // ========================================\n    if (trigger.type === 'battle') {\n      const encounterId = (trigger.data as { encounterId?: string }).encounterId;\n      if (!encounterId) {\n        console.error('Battle trigger missing encounterId');\n        return;\n      }\n\n      const encounter = ENCOUNTERS[encounterId];\n      if (!encounter) {\n        console.error(`Encounter ${encounterId} not found in ENCOUNTERS`);\n        return;\n      }\n\n      // Check for pre-battle dialogue (unless skipped - e.g., when triggered from dialogue)\n      if (!skipPreBattleDialogue) {\n        const preBattleDialogue = getPreBattleDialogue(encounterId);\n        if (preBattleDialogue) {\n          // Show pre-battle dialogue first\n          // The dialogue will trigger the battle via effects.startBattle\n          get().startDialogueTree(preBattleDialogue);\n          set({ lastTrigger: trigger });\n          return;\n        }\n      }\n\n      // No pre-battle dialogue (or skipped): go straight to team-select\n      set({\n        mode: 'team-select',\n        pendingBattleEncounterId: encounterId,\n        lastTrigger: trigger,\n        currentBattleConfig: initializeBattleConfig(),\n      });\n      return;\n    }\n\n    // ========================================\n    // NPC TRIGGERS\n    // ========================================\n    if (trigger.type === 'npc') {\n      const npcId = (trigger.data as { npcId?: string }).npcId;\n      if (npcId && DIALOGUES[npcId]) {\n        get().startDialogueTree(DIALOGUES[npcId]);\n      } else if (npcId) {\n        console.warn(`Dialogue ${npcId} not found`);\n      }\n\n      set({ lastTrigger: trigger });\n      return;\n    }\n\n    // ========================================\n    // STORY TRIGGERS\n    // ========================================\n    if (trigger.type === 'story') {\n      const storyId = (trigger.data as { storyId?: string }).storyId;\n      if (storyId && DIALOGUES[storyId]) {\n        get().startDialogueTree(DIALOGUES[storyId]);\n      } else if (storyId) {\n        console.warn(`Story dialogue ${storyId} not found`);\n      }\n\n      set({ lastTrigger: trigger });\n      return;\n    }\n\n    // ========================================\n    // SHOP TRIGGERS\n    // ========================================\n    if (trigger.type === 'shop') {\n      const shopId = (trigger.data as { shopId?: string }).shopId;\n      if (!shopId) {\n        console.error('Shop trigger missing shopId');\n        return;\n      }\n\n      set({\n        lastTrigger: trigger,\n        currentShopId: shopId,\n        mode: 'shop',\n      });\n      return;\n    }\n\n    // ========================================\n    // TOWER TRIGGERS\n    // ========================================\n    if (trigger.type === 'tower') {\n      const { enterTowerFromOverworld } = get();\n      const mapId = get().currentMapId;\n      if (mapId) {\n        enterTowerFromOverworld({ mapId, position: trigger.position });\n      }\n      return;\n    }\n\n    // ========================================\n    // TRANSITION TRIGGERS\n    // ========================================\n    if (trigger.type === 'transition') {\n      set({ lastTrigger: trigger });\n      return;\n    }\n\n    // Default: just track trigger\n    set({ lastTrigger: trigger });\n  },\n  resetLastTrigger: () => set({ lastTrigger: null }),\n\n  confirmBattleTeam: () => {\n    const store = get();\n    const {\n      pendingBattleEncounterId,\n      currentBattleConfig,\n      equipment,\n      roster,\n      team,\n      currentMapId,\n      playerPosition,\n    } = store;\n\n    if (!pendingBattleEncounterId) {\n      console.error('No pending battle encounter');\n      return;\n    }\n\n    if (!currentBattleConfig) {\n      console.error('Missing battle configuration when confirming battle');\n      return;\n    }\n\n    const validation = validateBattleConfig(currentBattleConfig, equipment, roster, team);\n    if (!validation.valid) {\n      console.error('Battle configuration validation failed', validation.message);\n      return;\n    }\n\n    const encounter = ENCOUNTERS[pendingBattleEncounterId];\n    if (!encounter) {\n      console.error(`Encounter ${pendingBattleEncounterId} not found`);\n      return;\n    }\n\n    const selectedTeam = buildTeamFromBattleConfig();\n    if (!selectedTeam) {\n      console.error('Could not resolve team for battle');\n      return;\n    }\n\n    const preBattlePosition = {\n      mapId: currentMapId,\n      position: { x: playerPosition.x, y: playerPosition.y },\n    };\n\n    // Create battle with selected team\n    const seed = Date.now();\n    const rng = makePRNG(seed);\n\n    try {\n      const result = createBattleFromEncounter(pendingBattleEncounterId, selectedTeam, rng);\n      if (!result || !result.battle) {\n        console.error(`Failed to create battle from encounter ${pendingBattleEncounterId}`);\n        return;\n      }\n\n      get().setBattle(result.battle, seed);\n      get().setTeam(selectedTeam);\n\n      set({\n        currentEncounter: encounter,\n        mode: 'battle',\n        preBattlePosition,\n        pendingBattleEncounterId: null,\n        currentBattleConfig: null,\n      });\n    } catch (error) {\n      console.error('Error creating battle:', error);\n    }\n  },\n\n  updateBattleConfigSlot: (slotIndex, unitId) =>\n    set((state) => {\n      const { currentBattleConfig } = state;\n      if (!currentBattleConfig) return state;\n\n      const slots = currentBattleConfig.slots.map((slot) =>\n        slot.slotIndex === slotIndex ? { ...slot, unitId } : slot\n      );\n\n      return {\n        currentBattleConfig: { ...currentBattleConfig, slots },\n      };\n    }),\n\n  updateBattleSlotEquipment: (slotIndex, equipmentSlot, equipment) =>\n    set((state) => {\n      const { currentBattleConfig } = state;\n      if (!currentBattleConfig) return state;\n\n      const slots = currentBattleConfig.slots.map((slot) =>\n        slot.slotIndex === slotIndex\n          ? {\n              ...slot,\n              equipmentLoadout: {\n                ...slot.equipmentLoadout,\n                [equipmentSlot]: equipment,\n              },\n            }\n          : slot\n      );\n\n      return {\n        currentBattleConfig: { ...currentBattleConfig, slots },\n      };\n    }),\n\n  setBattleConfigDjinnSlot: (slotIndex, djinnId) =>\n    set((state) => {\n      const { currentBattleConfig } = state;\n      if (!currentBattleConfig) return state;\n\n      const normalizedDjinnId = djinnId ?? null;\n      if (\n        normalizedDjinnId &&\n        currentBattleConfig.djinnSlots.some((existingId, index) =>\n          index !== slotIndex && existingId === normalizedDjinnId\n        )\n      ) {\n        console.warn('Cannot equip the same Djinn more than once', normalizedDjinnId);\n        return state;\n      }\n\n      const djinnSlots = updateDjinnSlots(currentBattleConfig.djinnSlots, slotIndex, normalizedDjinnId);\n      return {\n        currentBattleConfig: { ...currentBattleConfig, djinnSlots },\n      };\n    }),\n\n  clearBattleConfig: () => {\n    set({ currentBattleConfig: null });\n  },\n\n  returnToOverworld: () => {\n    const { preBattlePosition, teleportPlayer } = get();\n\n    // Restore to pre-battle position if available\n    if (preBattlePosition) {\n      teleportPlayer(preBattlePosition.mapId, preBattlePosition.position);\n    }\n\n    // Clear battle state and return to overworld\n    set({\n      mode: 'overworld',\n      preBattlePosition: null,\n      currentEncounter: null,\n      lastTrigger: null,\n      currentBattleConfig: null,\n    });\n  },\n};\n};\n","import type { StateCreator } from 'zustand';\nimport type { MapTrigger, Position } from '../../core/models/overworld';\nimport { MAPS } from '../../data/definitions/maps';\nimport { processMovement } from '../../core/services/OverworldService';\nimport { isHouseUnlocked } from '../../core/services/StoryService';\nimport { DIALOGUES } from '@/data/definitions/dialogues';\nimport type { GameFlowSlice } from './gameFlowSlice';\nimport type { DialogueSlice } from './dialogueSlice';\nimport type { StorySlice } from './storySlice';\n\nexport interface OverworldSlice {\n  currentMapId: string;\n  playerPosition: Position;\n  facing: 'up' | 'down' | 'left' | 'right';\n  currentTrigger: MapTrigger | null;\n  setFacing: (direction: OverworldSlice['facing']) => void;\n  movePlayer: (direction: 'up' | 'down' | 'left' | 'right') => void;\n  teleportPlayer: (mapId: string, position: Position) => void;\n  clearTrigger: () => void;\n}\n\nexport type OverworldStore = OverworldSlice;\n\nconst startMap = MAPS['vale-village'];\nif (!startMap) {\n  throw new Error('Starting map \"vale-village\" not found');\n}\nconst STARTING_MAP = startMap;\n\nexport const createOverworldSlice: StateCreator<OverworldSlice> = (set, get) => {\n  const getStore = () => get() as OverworldSlice & GameFlowSlice & DialogueSlice & StorySlice;\n\n  return {\n    currentMapId: 'vale-village',\n    playerPosition: STARTING_MAP.spawnPoint,\n    facing: 'down',\n    currentTrigger: null,\n\n    setFacing: (direction) => set({ facing: direction }),\n\n    movePlayer: (direction) => {\n      const store = getStore();\n      const map = MAPS[store.currentMapId];\n      if (!map) return;\n\n      const result = processMovement(map, store.playerPosition, direction);\n      if (!result.blocked) {\n        const trigger = result.trigger ?? null;\n\n        // Filter out locked/defeated battle triggers\n        let filteredTrigger = trigger;\n        if (trigger?.type === 'battle') {\n          const encounterId = (trigger.data as { encounterId?: string }).encounterId;\n          if (encounterId) {\n            const story = store.story;\n\n            // Skip defeated encounters (liberation encounters are one-time only)\n            if (story.flags[encounterId] === true) {\n              filteredTrigger = null;\n            }\n            // Skip locked encounters (progressive unlock system)\n            else if (!isHouseUnlocked(story, encounterId)) {\n              filteredTrigger = null;\n            }\n          }\n        }\n\n        // First Djinn intro: intercept House 1 door before the first battle\n        if (trigger?.type === 'transition' && trigger.id === 'house-01-door') {\n          const hasSeenDjinnIntro = Boolean(store.story.flags['first_djinn_intro_completed']);\n          if (!hasSeenDjinnIntro) {\n            const djinnIntro = DIALOGUES['tutorial:djinn-intro'];\n            if (djinnIntro) {\n              store.startDialogueTree(djinnIntro);\n              // Prevent immediate transition into the house until the intro is complete\n              filteredTrigger = null;\n            }\n          }\n        }\n\n        set({\n          playerPosition: result.newPos,\n          facing: direction,\n          currentTrigger: filteredTrigger,\n        });\n\n        // Handle NPC dialogue (use original trigger for NPCs)\n        if (trigger?.type === 'npc') {\n          const npcId = (trigger.data as { npcId?: string }).npcId;\n          if (npcId && DIALOGUES[npcId]) {\n            store.startDialogueTree(DIALOGUES[npcId]);\n          }\n        }\n\n        // Process filtered trigger (respects unlock status and defeated state)\n        store.handleTrigger(filteredTrigger);\n      }\n    },\n\n    teleportPlayer: (mapId, position) => {\n      if (!MAPS[mapId]) return;\n      set({ currentMapId: mapId, playerPosition: position, facing: 'down' });\n    },\n\n    clearTrigger: () => set({ currentTrigger: null }),\n  };\n};\n","import type { StateCreator } from 'zustand';\nimport type { DialogueTree, DialogueState, DialogueEffects } from '@/core/models/dialogue';\nimport {\n  startDialogue,\n  selectChoice,\n  advanceDialogue,\n} from '@/core/services/DialogueService';\nimport type { GameFlowSlice } from './gameFlowSlice';\nimport type { StorySlice } from './storySlice';\nimport type { SaveSlice } from './saveSlice';\nimport type { TeamSlice } from './teamSlice';\nimport { UNIT_DEFINITIONS } from '@/data/definitions/units';\nimport { isPreBattleDialogueTree } from '@/data/definitions/preBattleDialogues';\nimport { createUnit } from '@/core/models/Unit';\nimport { collectDjinn, equipDjinn } from '@/core/services/DjinnService';\n\nexport interface DialogueSlice {\n  currentDialogueTree: DialogueTree | null;\n  currentDialogueState: DialogueState | null;\n  startDialogueTree: (tree: DialogueTree) => void;\n  makeChoice: (choiceId: string) => void;\n  advanceCurrentDialogue: () => void;\n  endDialogue: () => void;\n}\n\nexport const createDialogueSlice: StateCreator<DialogueSlice & GameFlowSlice & StorySlice & SaveSlice & TeamSlice> = (set, get) =>\n  ({\n  currentDialogueTree: null,\n  currentDialogueState: null,\n\n  startDialogueTree: (tree) => {\n    const state = startDialogue(tree);\n    set({\n      currentDialogueTree: tree,\n      currentDialogueState: state,\n      mode: 'dialogue',\n    });\n  },\n\n  makeChoice: (choiceId) => {\n    const { currentDialogueTree, currentDialogueState } = get();\n    if (!currentDialogueTree || !currentDialogueState) return;\n\n    const currentNode = currentDialogueTree.nodes.find((n) => n.id === currentDialogueState.currentNodeId);\n    const choice = currentNode?.choices?.find((c) => c.id === choiceId);\n    const choiceEffects = choice?.effects;\n\n    const newState = selectChoice(currentDialogueTree, currentDialogueState, choiceId);\n    set({ currentDialogueState: newState });\n\n    if (choiceEffects && Object.keys(choiceEffects).length > 0) {\n      processDialogueEffects(choiceEffects, get);\n    }\n  },\n\n  advanceCurrentDialogue: () => {\n    const { currentDialogueTree, currentDialogueState } = get();\n    if (!currentDialogueTree || !currentDialogueState) return;\n\n    const startingTreeId = currentDialogueTree.id;\n    const startingStateTreeId = currentDialogueState.treeId;\n\n    // Get current node so we can process its effects when leaving it\n    const currentNode = currentDialogueTree.nodes.find((n) => n.id === currentDialogueState.currentNodeId);\n\n    // If the current node has effects, process them now. This allows\n    // mid-dialogue actions (e.g. starting a battle) instead of only\n    // firing effects on the final node.\n    if (currentNode?.effects && Object.keys(currentNode.effects).length > 0) {\n      processDialogueEffects(currentNode.effects, get);\n\n      // If processing effects changed us out of dialogue mode\n      // (e.g. into team-select or battle), end the dialogue shell\n      // but preserve the new mode.\n      const { mode } = get();\n      if (mode !== 'dialogue') {\n        get().endDialogue();\n        return;\n      }\n    }\n\n    // Re-read dialogue state in case effects started a different dialogue tree.\n    const latestState = get().currentDialogueState;\n    const latestTree = get().currentDialogueTree;\n\n    if (!latestTree || !latestState) {\n      return;\n    }\n\n    // If the dialogue tree/state changed (e.g. chaining into another dialogue),\n    // don't continue advancing the previous tree.\n    if (latestState.treeId !== startingStateTreeId || latestTree.id !== startingTreeId) {\n      return;\n    }\n\n    const newState = advanceDialogue(latestTree, latestState);\n\n    if (newState) {\n      // Advance to the next node\n      set({ currentDialogueState: newState });\n    } else {\n      // No next node - just end the dialogue (effects already processed above)\n      get().endDialogue();\n    }\n  },\n\n  endDialogue: () => {\n    const prevMode = get().mode;\n    set({\n      currentDialogueTree: null,\n      currentDialogueState: null,\n      // Race guard: don't overwrite 'battle' or 'team-select' mode (set by effects)\n      mode: prevMode === 'battle' || prevMode === 'team-select' ? prevMode : 'overworld',\n    });\n  },\n} as DialogueSlice & GameFlowSlice & StorySlice & SaveSlice & TeamSlice);\n\n/**\n * Dialogue effect events derived from typed DialogueEffects.\n * These represent high-level game actions that can span slices.\n */\ntype DialogueEffectEvent =\n  | { kind: 'start-battle'; encounterId: string; skipPreBattleDialogue: boolean }\n  | { kind: 'recruit-unit'; unitId: string }\n  | { kind: 'grant-djinn'; djinnId: string }\n  | { kind: 'quest-accepted' }\n  | { kind: 'open-shop' }\n  | { kind: 'set-story-flag'; key: string; value: boolean }\n  | { kind: 'auto-save' };\n\nfunction mapEffectsToEvents(effects: DialogueEffects, currentDialogueTreeId?: string): DialogueEffectEvent[] {\n  const events: DialogueEffectEvent[] = [];\n\n  if (effects.questAccepted === true) {\n    events.push({ kind: 'quest-accepted' });\n    events.push({ kind: 'set-story-flag', key: 'questAccepted', value: true });\n  }\n\n  if (effects.openShop === true) {\n    events.push({ kind: 'open-shop' });\n  }\n\n  if (typeof effects.startBattle === 'string') {\n    const encounterId = effects.startBattle;\n    const skipPreBattleDialogue = isPreBattleDialogueTree(currentDialogueTreeId);\n    events.push({ kind: 'start-battle', encounterId, skipPreBattleDialogue });\n  }\n\n  if (typeof effects.recruitUnit === 'string') {\n    events.push({ kind: 'recruit-unit', unitId: effects.recruitUnit });\n  }\n\n  if (typeof effects.grantDjinn === 'string') {\n    events.push({ kind: 'grant-djinn', djinnId: effects.grantDjinn });\n  }\n\n  // Additional boolean keys (excluding reserved ones) are treated as story flags\n  let hasStoryFlag = false;\n  for (const [key, value] of Object.entries(effects)) {\n    if (\n      typeof value === 'boolean' &&\n      key !== 'questAccepted' &&\n      key !== 'openShop'\n    ) {\n      events.push({ kind: 'set-story-flag', key, value });\n      hasStoryFlag = true;\n    }\n  }\n\n  // Auto-save after any story flag change or quest acceptance\n  if (hasStoryFlag || effects.questAccepted === true) {\n    events.push({ kind: 'auto-save' });\n  }\n\n  return events;\n}\n\nfunction applyDialogueEvents(\n  events: DialogueEffectEvent[],\n  get: () => DialogueSlice & GameFlowSlice & StorySlice & SaveSlice & TeamSlice\n) {\n  const store = get();\n  const canSetStoryFlag = typeof store.setStoryFlag === 'function';\n\n  for (const event of events) {\n    switch (event.kind) {\n      case 'quest-accepted': {\n        if (canSetStoryFlag) {\n          store.setStoryFlag('questAccepted', true);\n          console.warn('Quest accepted!');\n        } else {\n          console.warn('setStoryFlag not available - quest flag not saved');\n        }\n        break;\n      }\n      case 'open-shop': {\n        const shopId = store.currentShopId || 'vale-armory';\n        store.handleTrigger({\n          id: 'dialogue-shop',\n          type: 'shop',\n          position: { x: 0, y: 0 },\n          data: { shopId },\n        });\n        break;\n      }\n      case 'start-battle': {\n        const { encounterId, skipPreBattleDialogue } = event;\n        console.warn(`Starting battle from dialogue: ${encounterId}`);\n        store.handleTrigger(\n          {\n            id: 'dialogue-battle',\n            type: 'battle',\n            position: { x: 0, y: 0 },\n            data: { encounterId },\n          },\n          skipPreBattleDialogue,\n        );\n        break;\n      }\n      case 'recruit-unit': {\n        const unitId = event.unitId;\n        const unitDef = UNIT_DEFINITIONS[unitId];\n\n        if (unitDef && store.team) {\n          // Calculate average team level for new recruit\n          const avgLevel = Math.max(\n            1,\n            Math.floor(\n              store.team.units.reduce((sum, u) => sum + u.level, 0) / store.team.units.length,\n            ),\n          );\n\n          const newUnit = createUnit(unitDef, avgLevel, 0);\n          store.addUnitToRoster(newUnit);\n          if (store.setRecruitmentFlag) {\n            store.setRecruitmentFlag(unitId, true);\n          }\n          console.warn(` Recruited ${newUnit.name} via dialogue effect!`);\n        } else {\n          console.error(`Failed to recruit unit: ${unitId} (definition not found or no team)`);\n        }\n        break;\n      }\n      case 'grant-djinn': {\n        const djinnId = event.djinnId;\n        const team = store.team;\n\n        if (team) {\n          const collectResult = collectDjinn(team, djinnId);\n\n          if (collectResult.ok) {\n            const collectedTeam = collectResult.value;\n            const equipResult = equipDjinn(collectedTeam, djinnId);\n            const finalTeam = equipResult.ok ? equipResult.value : collectedTeam;\n\n            store.updateTeam(finalTeam);\n            console.warn(` Granted Djinn ${djinnId} via dialogue effect!`);\n\n            if (!equipResult.ok) {\n              console.warn(`Failed to auto-equip Djinn ${djinnId}: ${equipResult.error}`);\n            }\n          } else {\n            console.warn(`Failed to grant Djinn ${djinnId}: ${collectResult.error}`);\n          }\n        } else {\n          console.warn(`Cannot grant Djinn ${djinnId}: no team available`);\n        }\n        break;\n      }\n      case 'set-story-flag': {\n        if (canSetStoryFlag) {\n          store.setStoryFlag(event.key, event.value);\n          console.warn(`Story flag set via dialogue: ${event.key} = ${event.value}`);\n        }\n        break;\n      }\n      case 'auto-save': {\n        try {\n          const saveSlice = get();\n          if (typeof saveSlice.autoSave === 'function') {\n            saveSlice.autoSave();\n          }\n        } catch (error) {\n          console.warn('Auto-save failed after dialogue:', error);\n        }\n        break;\n      }\n    }\n  }\n}\n\n/**\n * Process dialogue effects (quest flags, shop openings, battle triggers)\n * Called after a choice updates dialogue state or when advancing past a node\n */\nfunction processDialogueEffects(\n  effects: DialogueEffects,\n  get: () => DialogueSlice & GameFlowSlice & StorySlice & SaveSlice & TeamSlice,\n) {\n  const currentDialogueTreeId = get().currentDialogueTree?.id;\n  const events = mapEffectsToEvents(effects, currentDialogueTreeId);\n  if (events.length === 0) return;\n  applyDialogueEvents(events, get);\n}\n","/**\n * Dev Mode State Slice\n * Manages development mode overlay for rapid house testing\n *\n * IMPORTANT: Dev mode is OFF by default and only activates via keyboard shortcut (Ctrl+D)\n */\n\nimport type { StateCreator } from 'zustand';\n\nexport interface DevModeSlice {\n  /** Whether dev mode overlay is visible */\n  devModeEnabled: boolean;\n\n  /** Currently selected house for inspection (not used for now, future feature) */\n  selectedHouseId: string | null;\n\n  /** Toggle dev mode overlay on/off */\n  toggleDevMode: () => void;\n\n  /** Set dev mode enabled state */\n  setDevModeEnabled: (enabled: boolean) => void;\n\n  /** Set selected house */\n  setSelectedHouse: (houseId: string | null) => void;\n}\n\nexport const createDevModeSlice: StateCreator<\n  DevModeSlice,\n  [['zustand/devtools', never]],\n  [],\n  DevModeSlice\n> = (set) => ({\n  devModeEnabled: false,\n  selectedHouseId: null,\n\n  toggleDevMode: () => set((state) => ({\n    devModeEnabled: !state.devModeEnabled\n  })),\n\n  setDevModeEnabled: (enabled) => set({ devModeEnabled: enabled }),\n\n  setSelectedHouse: (houseId) => set({ selectedHouseId: houseId }),\n});\n","/**\n * Zustand store combining all slices\n * Provides unified state management for the UI\n */\n\nimport { createWithEqualityFn } from 'zustand/traditional';\nimport type { GetState, SetState, StoreApi } from 'zustand';\nimport { devtools } from 'zustand/middleware';\nimport { createBattleSlice, type BattleSlice } from './battleSlice';\nimport { createQueueBattleSlice, type QueueBattleSlice } from './queueBattleSlice';\nimport { createTeamSlice, type TeamSlice } from './teamSlice';\nimport { createSaveSlice, type SaveSlice } from './saveSlice';\nimport { createStorySlice, type StorySlice } from './storySlice';\nimport { createInventorySlice, type InventorySlice } from './inventorySlice';\nimport { createRewardsSlice, type RewardsSlice } from './rewardsSlice';\nimport { createGameFlowSlice, type GameFlowSlice } from './gameFlowSlice';\nimport { createOverworldSlice, type OverworldStore } from './overworldSlice';\nimport { createDialogueSlice, type DialogueSlice } from './dialogueSlice';\nimport { createDevModeSlice, type DevModeSlice } from './devModeSlice';\nimport { createTowerSlice, type TowerSlice } from './towerSlice';\n\nexport type Store = BattleSlice &\n  QueueBattleSlice &\n  TeamSlice &\n  SaveSlice &\n  StorySlice &\n  InventorySlice &\n  RewardsSlice &\n  GameFlowSlice &\n  OverworldStore &\n  DialogueSlice &\n  DevModeSlice &\n  TowerSlice;\n\n// Store factory function to combine all slices\nconst storeFactory = (set: SetState<Store>, get: GetState<Store>, api: StoreApi<Store>) => ({\n  ...createTeamSlice(set, get, api),\n  ...createBattleSlice(set, get, api),\n  ...createQueueBattleSlice(set, get, api),\n  ...createSaveSlice(set, get, api),\n  ...createStorySlice(set, get, api),\n  ...createInventorySlice(set, get, api),\n  ...createRewardsSlice(set, get, api),\n  ...createGameFlowSlice(set, get, api),\n  ...createOverworldSlice(set, get, api),\n  ...createDialogueSlice(set, get, api),\n  ...createDevModeSlice(set, get, api),\n  ...createTowerSlice(set, get, api),\n});\n\nexport function createStore() {\n  return createWithEqualityFn<Store>()(storeFactory);\n}\n\n// Only enable devtools in development to prevent state manipulation in production\nexport const useStore = import.meta.env.DEV\n  ? createWithEqualityFn<Store>()(devtools(storeFactory, { name: 'vale-v2' }))\n  : createStore();\n\n// Export store instance for direct access (used in App.tsx for handleRewardsContinue)\nexport const store = useStore;\n","// Auto-generated sprite list\n// Run 'node scripts/generate-sprite-manifest.js' to regenerate\n// Generated: 2025-11-25T19:22:03.605Z\n\nexport interface SpriteEntry {\n  name: string;\n  path: string;\n  category: string;\n  subcategory: string | null;\n}\n\nexport const SPRITE_LIST: SpriteEntry[] = [\n  {\n    \"name\": \"Isaac Axe Attack1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe Attack2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe Back\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe CastBack1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe CastBack2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe CastFront1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe CastFront2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe DownedBack\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe DownedFront\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe Front\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe HitBack\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Axe HitFront\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Axe_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade Attack1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade Attack2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade Back\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade CastBack1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade CastBack2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade CastFront1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade CastFront2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade DownedBack\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade DownedFront\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade Front\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade HitBack\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lBlade HitFront\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lBlade_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword Attack1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword Attack2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword Back\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword CastBack1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword CastBack2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword CastFront1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword CastFront2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword DownedBack\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword DownedFront\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword Front\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword HitBack\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac lSword HitFront\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_lSword_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace Attack1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace Attack2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace Back\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace CastBack1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace CastBack2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace CastFront1\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace CastFront2\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace DownedBack\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace DownedFront\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace Front\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace HitBack\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Isaac Mace HitFront\",\n    \"path\": \"/sprites/battle/party/isaac/Isaac_Mace_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"isaac\"\n  },\n  {\n    \"name\": \"Garet Axe Attack1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe Attack2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe Back\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe CastBack1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe CastBack2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe CastFront1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe CastFront2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe DownedBack\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe DownedFront\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe Front\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe HitBack\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Axe HitFront\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Axe_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword Attack1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword Attack2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword Back\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword CastBack1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword CastBack2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword CastFront1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword CastFront2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword DownedBack\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword DownedFront\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword Front\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword HitBack\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet lSword HitFront\",\n    \"path\": \"/sprites/battle/party/garet/Garet_lSword_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace Attack1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace Attack2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace Back\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace CastBack1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace CastBack2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace CastFront1\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace CastFront2\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace DownedBack\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace DownedFront\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace Front\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace HitBack\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Garet Mace HitFront\",\n    \"path\": \"/sprites/battle/party/garet/Garet_Mace_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"garet\"\n  },\n  {\n    \"name\": \"Ivan lBlade Attack1\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade Attack2\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade Back\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade CastBack1\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade CastBack2\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade CastFront1\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade CastFront2\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade DownedBack\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade DownedFront\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade Front\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade HitBack\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan lBlade HitFront\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_lBlade_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff Attack1\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff Attack2\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff Back\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff CastBack1\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff CastBack2\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff CastFront1\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff CastFront2\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff DownedBack\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff DownedFront\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff Front\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff HitBack\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Ivan Staff HitFront\",\n    \"path\": \"/sprites/battle/party/ivan/Ivan_Staff_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"ivan\"\n  },\n  {\n    \"name\": \"Mia Mace Attack1\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace Attack2\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace Back\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace CastBack1\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace CastBack2\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace CastFront1\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace CastFront2\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace DownedBack\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace DownedFront\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace Front\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace HitBack\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Mace HitFront\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Mace_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff Attack1\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_Attack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff Attack2\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_Attack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff Back\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_Back.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff CastBack1\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_CastBack1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff CastBack2\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_CastBack2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff CastFront1\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_CastFront1.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff CastFront2\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_CastFront2.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff DownedBack\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_DownedBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff DownedFront\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_DownedFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff Front\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_Front.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff HitBack\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_HitBack.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Mia Staff HitFront\",\n    \"path\": \"/sprites/battle/party/mia/Mia_Staff_HitFront.gif\",\n    \"category\": \"battle-party\",\n    \"subcategory\": \"mia\"\n  },\n  {\n    \"name\": \"Acid Maggot\",\n    \"path\": \"/sprites/battle/enemies/Acid_Maggot.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Alec Goblin\",\n    \"path\": \"/sprites/battle/enemies/Alec_Goblin.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Amaze\",\n    \"path\": \"/sprites/battle/enemies/Amaze.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Angle Worm\",\n    \"path\": \"/sprites/battle/enemies/Angle_Worm.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ant Lion\",\n    \"path\": \"/sprites/battle/enemies/Ant_Lion.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ape\",\n    \"path\": \"/sprites/battle/enemies/Ape.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Armored Rat\",\n    \"path\": \"/sprites/battle/enemies/Armored_Rat.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Assassin\",\n    \"path\": \"/sprites/battle/enemies/Assassin.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bat\",\n    \"path\": \"/sprites/battle/enemies/Bat.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bombander\",\n    \"path\": \"/sprites/battle/enemies/Bombander.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bone Fighter\",\n    \"path\": \"/sprites/battle/enemies/Bone_Fighter.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Boulder Beast\",\n    \"path\": \"/sprites/battle/enemies/Boulder_Beast.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Brigand\",\n    \"path\": \"/sprites/battle/enemies/Brigand.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Brutal Troll\",\n    \"path\": \"/sprites/battle/enemies/Brutal_Troll.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Calamar\",\n    \"path\": \"/sprites/battle/enemies/Calamar.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cannibal Ghoul\",\n    \"path\": \"/sprites/battle/enemies/Cannibal_Ghoul.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cave Troll\",\n    \"path\": \"/sprites/battle/enemies/Cave_Troll.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cerebus\",\n    \"path\": \"/sprites/battle/enemies/Cerebus.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Chimera\",\n    \"path\": \"/sprites/battle/enemies/Chimera.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Chimera Mage\",\n    \"path\": \"/sprites/battle/enemies/Chimera_Mage.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Chimera Worm\",\n    \"path\": \"/sprites/battle/enemies/Chimera_Worm.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Clay Gargoyle\",\n    \"path\": \"/sprites/battle/enemies/Clay_Gargoyle.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Creeper\",\n    \"path\": \"/sprites/battle/enemies/Creeper.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cruel Dragon\",\n    \"path\": \"/sprites/battle/enemies/Cruel_Dragon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cuttle\",\n    \"path\": \"/sprites/battle/enemies/Cuttle.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Death Cap\",\n    \"path\": \"/sprites/battle/enemies/Death_Cap.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Death Head\",\n    \"path\": \"/sprites/battle/enemies/Death_Head.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Devil Frog\",\n    \"path\": \"/sprites/battle/enemies/Devil_Frog.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Devil Scorpion\",\n    \"path\": \"/sprites/battle/enemies/Devil_Scorpion.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dino\",\n    \"path\": \"/sprites/battle/enemies/Dino.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dinox\",\n    \"path\": \"/sprites/battle/enemies/Dinox.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dire Wolf\",\n    \"path\": \"/sprites/battle/enemies/Dire_Wolf.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dirge\",\n    \"path\": \"/sprites/battle/enemies/Dirge.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dirty Ape\",\n    \"path\": \"/sprites/battle/enemies/Dirty_Ape.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Doodle Bug\",\n    \"path\": \"/sprites/battle/enemies/Doodle_Bug.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Doomsayer\",\n    \"path\": \"/sprites/battle/enemies/Doomsayer.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dread Hound\",\n    \"path\": \"/sprites/battle/enemies/Dread_Hound.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Drone Bee\",\n    \"path\": \"/sprites/battle/enemies/Drone_Bee.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Druj\",\n    \"path\": \"/sprites/battle/enemies/Druj.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Earth Golem\",\n    \"path\": \"/sprites/battle/enemies/Earth_Golem.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Earth Lizard\",\n    \"path\": \"/sprites/battle/enemies/Earth_Lizard.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Emu\",\n    \"path\": \"/sprites/battle/enemies/Emu.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Faery\",\n    \"path\": \"/sprites/battle/enemies/Faery.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fenrir\",\n    \"path\": \"/sprites/battle/enemies/Fenrir.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fiendish Ghoul\",\n    \"path\": \"/sprites/battle/enemies/Fiendish_Ghoul.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fighter Bee\",\n    \"path\": \"/sprites/battle/enemies/Fighter_Bee.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fire Worm\",\n    \"path\": \"/sprites/battle/enemies/Fire_Worm.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Flash Ant\",\n    \"path\": \"/sprites/battle/enemies/Flash_Ant.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Foul Dirge\",\n    \"path\": \"/sprites/battle/enemies/Foul_Dirge.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Foul Mummy\",\n    \"path\": \"/sprites/battle/enemies/Foul_Mummy.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gargoyle\",\n    \"path\": \"/sprites/battle/enemies/Gargoyle.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ghost\",\n    \"path\": \"/sprites/battle/enemies/Ghost.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ghost Army\",\n    \"path\": \"/sprites/battle/enemies/Ghost_Army.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ghost Mage\",\n    \"path\": \"/sprites/battle/enemies/Ghost_Mage.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ghoul\",\n    \"path\": \"/sprites/battle/enemies/Ghoul.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gillman\",\n    \"path\": \"/sprites/battle/enemies/Gillman.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gnome\",\n    \"path\": \"/sprites/battle/enemies/Gnome.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gnome Mage\",\n    \"path\": \"/sprites/battle/enemies/Gnome_Mage.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gnome Wizard\",\n    \"path\": \"/sprites/battle/enemies/Gnome_Wizard.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Goblin\",\n    \"path\": \"/sprites/battle/enemies/Goblin.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Golem\",\n    \"path\": \"/sprites/battle/enemies/Golem.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Grand Chimera\",\n    \"path\": \"/sprites/battle/enemies/Grand_Chimera.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Grand Golem\",\n    \"path\": \"/sprites/battle/enemies/Grand_Golem.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Grave Wight\",\n    \"path\": \"/sprites/battle/enemies/Grave_Wight.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Grizzly\",\n    \"path\": \"/sprites/battle/enemies/Grizzly.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Grub\",\n    \"path\": \"/sprites/battle/enemies/Grub.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gryphon\",\n    \"path\": \"/sprites/battle/enemies/Gryphon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Harpy\",\n    \"path\": \"/sprites/battle/enemies/Harpy.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Harridan\",\n    \"path\": \"/sprites/battle/enemies/Harridan.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Hobgoblin\",\n    \"path\": \"/sprites/battle/enemies/Hobgoblin.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Horned Ghost\",\n    \"path\": \"/sprites/battle/enemies/Horned_Ghost.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Hydra\",\n    \"path\": \"/sprites/battle/enemies/Hydra.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ice Gargoyle\",\n    \"path\": \"/sprites/battle/enemies/Ice_Gargoyle.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kobold\",\n    \"path\": \"/sprites/battle/enemies/Kobold.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kobold 2\",\n    \"path\": \"/sprites/battle/enemies/Kobold_2.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lich\",\n    \"path\": \"/sprites/battle/enemies/Lich.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lich 2\",\n    \"path\": \"/sprites/battle/enemies/Lich_2.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Little Death\",\n    \"path\": \"/sprites/battle/enemies/Little_Death.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Living Armor\",\n    \"path\": \"/sprites/battle/enemies/Living_Armor.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Living Statue\",\n    \"path\": \"/sprites/battle/enemies/Living_Statue.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lizard Fighter\",\n    \"path\": \"/sprites/battle/enemies/Lizard_Fighter.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lizard King\",\n    \"path\": \"/sprites/battle/enemies/Lizard_King.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lizard Man\",\n    \"path\": \"/sprites/battle/enemies/Lizard_Man.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Macetail\",\n    \"path\": \"/sprites/battle/enemies/Macetail.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mad Demon\",\n    \"path\": \"/sprites/battle/enemies/Mad_Demon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mad Mole\",\n    \"path\": \"/sprites/battle/enemies/Mad_Mole.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mad Plant\",\n    \"path\": \"/sprites/battle/enemies/Mad_Plant.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mad Vermin\",\n    \"path\": \"/sprites/battle/enemies/Mad_Vermin.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Magicore\",\n    \"path\": \"/sprites/battle/enemies/Magicore.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Manticore King\",\n    \"path\": \"/sprites/battle/enemies/Manticore_King.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Man o War\",\n    \"path\": \"/sprites/battle/enemies/Man_o_War.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mauler\",\n    \"path\": \"/sprites/battle/enemies/Mauler.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Merman\",\n    \"path\": \"/sprites/battle/enemies/Merman.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mimic\",\n    \"path\": \"/sprites/battle/enemies/Mimic.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mini Goblin\",\n    \"path\": \"/sprites/battle/enemies/Mini-Goblin.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Minos Warrior\",\n    \"path\": \"/sprites/battle/enemies/Minos_Warrior.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Minotaurus\",\n    \"path\": \"/sprites/battle/enemies/Minotaurus.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mole\",\n    \"path\": \"/sprites/battle/enemies/Mole.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mole Mage\",\n    \"path\": \"/sprites/battle/enemies/Mole_Mage.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Momonga\",\n    \"path\": \"/sprites/battle/enemies/Momonga.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mummy\",\n    \"path\": \"/sprites/battle/enemies/Mummy.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Needle Egg\",\n    \"path\": \"/sprites/battle/enemies/Needle_Egg.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Nightmare\",\n    \"path\": \"/sprites/battle/enemies/Nightmare.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Numb Ant\",\n    \"path\": \"/sprites/battle/enemies/Numb_Ant.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ooze\",\n    \"path\": \"/sprites/battle/enemies/Ooze.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Orc\",\n    \"path\": \"/sprites/battle/enemies/Orc.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Orc Captain\",\n    \"path\": \"/sprites/battle/enemies/Orc_Captain.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Orc Lord\",\n    \"path\": \"/sprites/battle/enemies/Orc_Lord.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Phoenix\",\n    \"path\": \"/sprites/battle/enemies/Phoenix.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Pixie\",\n    \"path\": \"/sprites/battle/enemies/Pixie.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Plated Rat\",\n    \"path\": \"/sprites/battle/enemies/Plated_Rat.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Poison Toad\",\n    \"path\": \"/sprites/battle/enemies/Poison_Toad.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Pteranodon\",\n    \"path\": \"/sprites/battle/enemies/Pteranodon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Punch Ant\",\n    \"path\": \"/sprites/battle/enemies/Punch_Ant.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Rabid Bat\",\n    \"path\": \"/sprites/battle/enemies/Rabid_Bat.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Raging Rock\",\n    \"path\": \"/sprites/battle/enemies/Raging_Rock.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Raptor\",\n    \"path\": \"/sprites/battle/enemies/Raptor.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Rat\",\n    \"path\": \"/sprites/battle/enemies/Rat.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Rat Fighter\",\n    \"path\": \"/sprites/battle/enemies/Rat_Fighter.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Rat Soldier\",\n    \"path\": \"/sprites/battle/enemies/Rat_Soldier.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Rat Warrior\",\n    \"path\": \"/sprites/battle/enemies/Rat_Warrior.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ravager\",\n    \"path\": \"/sprites/battle/enemies/Ravager.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Recluse\",\n    \"path\": \"/sprites/battle/enemies/Recluse.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Red Demon\",\n    \"path\": \"/sprites/battle/enemies/Red_Demon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Roach\",\n    \"path\": \"/sprites/battle/enemies/Roach.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Roc\",\n    \"path\": \"/sprites/battle/enemies/Roc.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ruffian\",\n    \"path\": \"/sprites/battle/enemies/Ruffian.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Salamander\",\n    \"path\": \"/sprites/battle/enemies/Salamander.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Seabird\",\n    \"path\": \"/sprites/battle/enemies/Seabird.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Seafowl\",\n    \"path\": \"/sprites/battle/enemies/Seafowl.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Siren\",\n    \"path\": \"/sprites/battle/enemies/Siren.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Skeleton\",\n    \"path\": \"/sprites/battle/enemies/Skeleton.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Skull Warrior\",\n    \"path\": \"/sprites/battle/enemies/Skull_Warrior.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sky Dragon\",\n    \"path\": \"/sprites/battle/enemies/Sky_Dragon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Slayer\",\n    \"path\": \"/sprites/battle/enemies/Slayer.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Slime\",\n    \"path\": \"/sprites/battle/enemies/Slime.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Slime Beast\",\n    \"path\": \"/sprites/battle/enemies/Slime_Beast.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Spider\",\n    \"path\": \"/sprites/battle/enemies/Spider.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Spiral Shell\",\n    \"path\": \"/sprites/battle/enemies/Spiral_Shell.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Spirit\",\n    \"path\": \"/sprites/battle/enemies/Spirit.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Squirrelfang\",\n    \"path\": \"/sprites/battle/enemies/Squirrelfang.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Stone Soldier\",\n    \"path\": \"/sprites/battle/enemies/Stone_Soldier.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Succubus\",\n    \"path\": \"/sprites/battle/enemies/Succubus.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Talon Runner\",\n    \"path\": \"/sprites/battle/enemies/Talon_Runner.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tarantula\",\n    \"path\": \"/sprites/battle/enemies/Tarantula.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thief\",\n    \"path\": \"/sprites/battle/enemies/Thief.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thunder Lizard\",\n    \"path\": \"/sprites/battle/enemies/Thunder_Lizard.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tornado Lizard\",\n    \"path\": \"/sprites/battle/enemies/Tornado_Lizard.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Troll\",\n    \"path\": \"/sprites/battle/enemies/Troll.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Turtle Dragon\",\n    \"path\": \"/sprites/battle/enemies/Turtle_Dragon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Undead\",\n    \"path\": \"/sprites/battle/enemies/Undead.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Urchin Beast\",\n    \"path\": \"/sprites/battle/enemies/Urchin_Beast.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Vermin\",\n    \"path\": \"/sprites/battle/enemies/Vermin.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Vile Dirge\",\n    \"path\": \"/sprites/battle/enemies/Vile_Dirge.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Virago\",\n    \"path\": \"/sprites/battle/enemies/Virago.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wargold\",\n    \"path\": \"/sprites/battle/enemies/Wargold.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Warrior Bee\",\n    \"path\": \"/sprites/battle/enemies/Warrior_Bee.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wight\",\n    \"path\": \"/sprites/battle/enemies/Wight.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wild Ape\",\n    \"path\": \"/sprites/battle/enemies/Wild_Ape.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wild Gryphon\",\n    \"path\": \"/sprites/battle/enemies/Wild_Gryphon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wild Mushroom\",\n    \"path\": \"/sprites/battle/enemies/Wild_Mushroom.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wild Wolf\",\n    \"path\": \"/sprites/battle/enemies/Wild_Wolf.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Willowisp\",\n    \"path\": \"/sprites/battle/enemies/Willowisp.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Will Head\",\n    \"path\": \"/sprites/battle/enemies/Will_Head.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wise Gryphon\",\n    \"path\": \"/sprites/battle/enemies/Wise_Gryphon.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wolfkin\",\n    \"path\": \"/sprites/battle/enemies/Wolfkin.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wolfkin Cub\",\n    \"path\": \"/sprites/battle/enemies/Wolfkin_Cub.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wonder Bird\",\n    \"path\": \"/sprites/battle/enemies/Wonder_Bird.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wood Walker\",\n    \"path\": \"/sprites/battle/enemies/Wood_Walker.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Worm\",\n    \"path\": \"/sprites/battle/enemies/Worm.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wyvern\",\n    \"path\": \"/sprites/battle/enemies/Wyvern.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wyvern Chick\",\n    \"path\": \"/sprites/battle/enemies/Wyvern_Chick.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Zombie\",\n    \"path\": \"/sprites/battle/enemies/Zombie.gif\",\n    \"category\": \"battle-enemies\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jupiter Djinn Front\",\n    \"path\": \"/sprites/battle/djinn/Jupiter_Djinn_Front.gif\",\n    \"category\": \"battle-djinn\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mars Djinn Front\",\n    \"path\": \"/sprites/battle/djinn/Mars_Djinn_Front.gif\",\n    \"category\": \"battle-djinn\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mercury Djinn Front\",\n    \"path\": \"/sprites/battle/djinn/Mercury_Djinn_Front.gif\",\n    \"category\": \"battle-djinn\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Djinn Front\",\n    \"path\": \"/sprites/battle/djinn/Venus_Djinn_Front.gif\",\n    \"category\": \"battle-djinn\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Altin Peak\",\n    \"path\": \"/sprites/backgrounds/gs1/Altin_Peak.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Altmillar Cave\",\n    \"path\": \"/sprites/backgrounds/gs1/Altmillar_Cave.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Babi Lighthouse\",\n    \"path\": \"/sprites/backgrounds/gs1/Babi_Lighthouse.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cave\",\n    \"path\": \"/sprites/backgrounds/gs1/Cave.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Colosso\",\n    \"path\": \"/sprites/backgrounds/gs1/Colosso.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Crossbone Isle Cave\",\n    \"path\": \"/sprites/backgrounds/gs1/Crossbone_Isle_Cave.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dark Sky\",\n    \"path\": \"/sprites/backgrounds/gs1/Dark_Sky.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Deadbeard's Ship\",\n    \"path\": \"/sprites/backgrounds/gs1/Deadbeard's_Ship.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Desert\",\n    \"path\": \"/sprites/backgrounds/gs1/Desert.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dice Game\",\n    \"path\": \"/sprites/backgrounds/gs1/Dice_Game.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Final Battle\",\n    \"path\": \"/sprites/backgrounds/gs1/Final_Battle.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fuchin Cave\",\n    \"path\": \"/sprites/backgrounds/gs1/Fuchin_Cave.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kolima Forest\",\n    \"path\": \"/sprites/backgrounds/gs1/Kolima_Forest.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lamakan Desert\",\n    \"path\": \"/sprites/backgrounds/gs1/Lamakan_Desert.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mercury Lighthouse\",\n    \"path\": \"/sprites/backgrounds/gs1/Mercury_Lighthouse.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Meteor\",\n    \"path\": \"/sprites/backgrounds/gs1/Meteor.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mogall Forest\",\n    \"path\": \"/sprites/backgrounds/gs1/Mogall_Forest.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Overworld\",\n    \"path\": \"/sprites/backgrounds/gs1/Overworld.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sky\",\n    \"path\": \"/sprites/backgrounds/gs1/Sky.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sol Sanctum\",\n    \"path\": \"/sprites/backgrounds/gs1/Sol_Sanctum.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Suhalla Desert\",\n    \"path\": \"/sprites/backgrounds/gs1/Suhalla_Desert.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Suhalla Gate\",\n    \"path\": \"/sprites/backgrounds/gs1/Suhalla_Gate.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tolbi Bound Ship Abovedeck\",\n    \"path\": \"/sprites/backgrounds/gs1/Tolbi_Bound_Ship_Abovedeck.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tolbi Bound Ship Belowdecks\",\n    \"path\": \"/sprites/backgrounds/gs1/Tolbi_Bound_Ship_Belowdecks.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tret Tree\",\n    \"path\": \"/sprites/backgrounds/gs1/Tret_Tree.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tret Tree Branches\",\n    \"path\": \"/sprites/backgrounds/gs1/Tret_Tree_Branches.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tunnel Ruins\",\n    \"path\": \"/sprites/backgrounds/gs1/Tunnel_Ruins.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Vale\",\n    \"path\": \"/sprites/backgrounds/gs1/Vale.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Vault Inn\",\n    \"path\": \"/sprites/backgrounds/gs1/Vault_Inn.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Lighthouse\",\n    \"path\": \"/sprites/backgrounds/gs1/Venus_Lighthouse.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Lighthouse Aerie\",\n    \"path\": \"/sprites/backgrounds/gs1/Venus_Lighthouse_Aerie.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"VL Final Battle\",\n    \"path\": \"/sprites/backgrounds/gs1/VL_Final_Battle.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"World Map\",\n    \"path\": \"/sprites/backgrounds/gs1/World_Map.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"World Map Forest\",\n    \"path\": \"/sprites/backgrounds/gs1/World_Map_Forest.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"World Map Shore\",\n    \"path\": \"/sprites/backgrounds/gs1/World_Map_Shore.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"World Map Snow\",\n    \"path\": \"/sprites/backgrounds/gs1/World_Map_Snow.gif\",\n    \"category\": \"backgrounds-gs1\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Airs Rock Inside\",\n    \"path\": \"/sprites/backgrounds/gs2/Airs_Rock_Inside.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Airs Rock Outside\",\n    \"path\": \"/sprites/backgrounds/gs2/Airs_Rock_Outside.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Anemos Inner Sanctum\",\n    \"path\": \"/sprites/backgrounds/gs2/Anemos_Inner_Sanctum.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ankohl Ruins\",\n    \"path\": \"/sprites/backgrounds/gs2/Ankohl_Ruins.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Aqua Rock Inside\",\n    \"path\": \"/sprites/backgrounds/gs2/Aqua_Rock_Inside.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Aqua Rock Outside\",\n    \"path\": \"/sprites/backgrounds/gs2/Aqua_Rock_Outside.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Camelot\",\n    \"path\": \"/sprites/backgrounds/gs2/Camelot.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Catastrophe\",\n    \"path\": \"/sprites/backgrounds/gs2/Catastrophe.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cave\",\n    \"path\": \"/sprites/backgrounds/gs2/Cave.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cave2\",\n    \"path\": \"/sprites/backgrounds/gs2/Cave2.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cliffs\",\n    \"path\": \"/sprites/backgrounds/gs2/Cliffs.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Eclipse\",\n    \"path\": \"/sprites/backgrounds/gs2/Eclipse.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gaia Rock Inside\",\n    \"path\": \"/sprites/backgrounds/gs2/Gaia_Rock_Inside.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gaia Rock Outside\",\n    \"path\": \"/sprites/backgrounds/gs2/Gaia_Rock_Outside.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Great Gabomba Statue\",\n    \"path\": \"/sprites/backgrounds/gs2/Great_Gabomba_Statue.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Iris\",\n    \"path\": \"/sprites/backgrounds/gs2/Iris.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Iris2\",\n    \"path\": \"/sprites/backgrounds/gs2/Iris2.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Islet Cave\",\n    \"path\": \"/sprites/backgrounds/gs2/Islet_Cave.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jupiter Lighthouse\",\n    \"path\": \"/sprites/backgrounds/gs2/Jupiter_Lighthouse.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jupiter Lighthouse Aerie\",\n    \"path\": \"/sprites/backgrounds/gs2/Jupiter_Lighthouse_Aerie.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kibombo Mountains\",\n    \"path\": \"/sprites/backgrounds/gs2/Kibombo_Mountains.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lemurian Ship\",\n    \"path\": \"/sprites/backgrounds/gs2/Lemurian_Ship.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Magma Rock\",\n    \"path\": \"/sprites/backgrounds/gs2/Magma_Rock.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Map\",\n    \"path\": \"/sprites/backgrounds/gs2/Map.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mars Lighthouse\",\n    \"path\": \"/sprites/backgrounds/gs2/Mars_Lighthouse.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mars Lighthouse Aerie\",\n    \"path\": \"/sprites/backgrounds/gs2/Mars_Lighthouse_Aerie.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Nintendo\",\n    \"path\": \"/sprites/backgrounds/gs2/Nintendo.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Opening\",\n    \"path\": \"/sprites/backgrounds/gs2/Opening.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Prox\",\n    \"path\": \"/sprites/backgrounds/gs2/Prox.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sea of Time\",\n    \"path\": \"/sprites/backgrounds/gs2/Sea_of_Time.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Title Screen\",\n    \"path\": \"/sprites/backgrounds/gs2/Title_Screen.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tundaria Tower\",\n    \"path\": \"/sprites/backgrounds/gs2/Tundaria_Tower.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"World Map\",\n    \"path\": \"/sprites/backgrounds/gs2/World_Map.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"World Map Desert\",\n    \"path\": \"/sprites/backgrounds/gs2/World_Map_Desert.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"World Map Shore\",\n    \"path\": \"/sprites/backgrounds/gs2/World_Map_Shore.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Yampi Desert\",\n    \"path\": \"/sprites/backgrounds/gs2/Yampi_Desert.gif\",\n    \"category\": \"backgrounds-gs2\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Felix\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Felix.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Garet\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Garet.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Isaac\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Isaac.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Isaac 2\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Isaac_2.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Ivan\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Ivan.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Ivan 2\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Ivan_2.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Jenna\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Jenna.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Mia\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Mia.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Piers\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Piers.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Sheba\",\n    \"path\": \"/sprites/overworld/protagonists/fallen_Sheba.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix\",\n    \"path\": \"/sprites/overworld/protagonists/Felix.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix Back\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_Back.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix Checkarm\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_Checkarm.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix Checkleg\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_Checkleg.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix Checkleg2\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_Checkleg2.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix E\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_E.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix NE\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix NW\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_NW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix Run\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_Run.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix SE\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix Situp\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_Situp.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix SW\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_SW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix W\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_W.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix Walk\",\n    \"path\": \"/sprites/overworld/protagonists/Felix_Walk.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet\",\n    \"path\": \"/sprites/overworld/protagonists/Garet.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet Back\",\n    \"path\": \"/sprites/overworld/protagonists/Garet_Back.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet Left\",\n    \"path\": \"/sprites/overworld/protagonists/Garet_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet NE\",\n    \"path\": \"/sprites/overworld/protagonists/Garet_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet NW\",\n    \"path\": \"/sprites/overworld/protagonists/Garet_NW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet Right\",\n    \"path\": \"/sprites/overworld/protagonists/Garet_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet SE\",\n    \"path\": \"/sprites/overworld/protagonists/Garet_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet SW\",\n    \"path\": \"/sprites/overworld/protagonists/Garet_SW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Back\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Back.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Left\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac NE\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac NW\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_NW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Right\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Run\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Run.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Run Left\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Run_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Run NE\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Run_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Run NW\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Run_NW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Run Right\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Run_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Run SE\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Run_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Run SW\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Run_SW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Run Up\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Run_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac SE\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac SW\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_SW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac TossCoin\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_TossCoin.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Walk\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Walk.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Walk Left\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Walk_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Walk NE\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Walk_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Walk NW\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Walk_NW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Walk Right\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Walk_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Walk SE\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Walk_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Walk SW\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Walk_SW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac Walk Up\",\n    \"path\": \"/sprites/overworld/protagonists/Isaac_Walk_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan\",\n    \"path\": \"/sprites/overworld/protagonists/Ivan.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan Back\",\n    \"path\": \"/sprites/overworld/protagonists/Ivan_Back.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan Left\",\n    \"path\": \"/sprites/overworld/protagonists/Ivan_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan NE\",\n    \"path\": \"/sprites/overworld/protagonists/Ivan_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan NW\",\n    \"path\": \"/sprites/overworld/protagonists/Ivan_NW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan Right\",\n    \"path\": \"/sprites/overworld/protagonists/Ivan_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan SE\",\n    \"path\": \"/sprites/overworld/protagonists/Ivan_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan SW\",\n    \"path\": \"/sprites/overworld/protagonists/Ivan_SW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna Back\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_Back.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna Left\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna NE\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna NW\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_NW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna Right\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna Run\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_Run.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna SE\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna SW\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_SW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna Walk\",\n    \"path\": \"/sprites/overworld/protagonists/Jenna_Walk.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kraden\",\n    \"path\": \"/sprites/overworld/protagonists/Kraden.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kraden Right\",\n    \"path\": \"/sprites/overworld/protagonists/Kraden_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kraden Up\",\n    \"path\": \"/sprites/overworld/protagonists/Kraden_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kraden Walk Down\",\n    \"path\": \"/sprites/overworld/protagonists/Kraden_Walk_Down.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kraden Walk Right\",\n    \"path\": \"/sprites/overworld/protagonists/Kraden_Walk_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kraden Walk Up\",\n    \"path\": \"/sprites/overworld/protagonists/Kraden_Walk_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia\",\n    \"path\": \"/sprites/overworld/protagonists/Mia.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia Back\",\n    \"path\": \"/sprites/overworld/protagonists/Mia_Back.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia Kneel\",\n    \"path\": \"/sprites/overworld/protagonists/Mia_Kneel.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia Left\",\n    \"path\": \"/sprites/overworld/protagonists/Mia_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia NE\",\n    \"path\": \"/sprites/overworld/protagonists/Mia_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia NW\",\n    \"path\": \"/sprites/overworld/protagonists/Mia_NW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia Right\",\n    \"path\": \"/sprites/overworld/protagonists/Mia_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia SE\",\n    \"path\": \"/sprites/overworld/protagonists/Mia_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia SW\",\n    \"path\": \"/sprites/overworld/protagonists/Mia_SW.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Piers\",\n    \"path\": \"/sprites/overworld/protagonists/Piers.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sheba\",\n    \"path\": \"/sprites/overworld/protagonists/Sheba.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sheba Situp\",\n    \"path\": \"/sprites/overworld/protagonists/Sheba_Situp.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet NE\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet Right\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet SE\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet Up\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet Walk Down\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_Walk_Down.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet Walk NE\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_Walk_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet Walk Right\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_Walk_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet Walk SE\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_Walk_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Garet Walk Up\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Garet_Walk_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac NE\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac Right\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac SE\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac Up\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac Walk Down\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_Walk_Down.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac Walk NE\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_Walk_NE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac Walk Right\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_Walk_Right.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac Walk SE\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_Walk_SE.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Isaac Walk Up\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Isaac_Walk_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Jenna\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Jenna.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Jenna Down\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Jenna_Down.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Jenna Left\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Jenna_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Jenna Up\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Jenna_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Jenna Walk Down\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Jenna_Walk_Down.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Jenna Walk Left\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Jenna_Walk_Left.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Jenna Walk Up\",\n    \"path\": \"/sprites/overworld/protagonists/Young_Jenna_Walk_Up.gif\",\n    \"category\": \"overworld-protagonists\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Aaron Jerra\",\n    \"path\": \"/sprites/overworld/majornpcs/Aaron_Jerra.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Akafubu\",\n    \"path\": \"/sprites/overworld/majornpcs/Akafubu.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Armorshop Keeper\",\n    \"path\": \"/sprites/overworld/majornpcs/Armorshop_Keeper.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Armorshop Owner\",\n    \"path\": \"/sprites/overworld/majornpcs/Armorshop_Owner.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Briggs\",\n    \"path\": \"/sprites/overworld/majornpcs/Briggs.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dojo Leader\",\n    \"path\": \"/sprites/overworld/majornpcs/Dojo_Leader.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dora\",\n    \"path\": \"/sprites/overworld/majornpcs/Dora.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Elder\",\n    \"path\": \"/sprites/overworld/majornpcs/Elder.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Kraden\",\n    \"path\": \"/sprites/overworld/majornpcs/fallen_Kraden.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Ouranos\",\n    \"path\": \"/sprites/overworld/majornpcs/fallen_Ouranos.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"fallen Sean\",\n    \"path\": \"/sprites/overworld/majornpcs/fallen_Sean.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fiezhi\",\n    \"path\": \"/sprites/overworld/majornpcs/Fiezhi.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fortune Teller\",\n    \"path\": \"/sprites/overworld/majornpcs/Fortune_Teller.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Great Healer\",\n    \"path\": \"/sprites/overworld/majornpcs/Great_Healer.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Innkeeper\",\n    \"path\": \"/sprites/overworld/majornpcs/Innkeeper.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Innkeepers Wife\",\n    \"path\": \"/sprites/overworld/majornpcs/Innkeepers_Wife.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Innkeeper 2\",\n    \"path\": \"/sprites/overworld/majornpcs/Innkeeper_2.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kaja\",\n    \"path\": \"/sprites/overworld/majornpcs/Kaja.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kay Jerra\",\n    \"path\": \"/sprites/overworld/majornpcs/Kay_Jerra.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kyle\",\n    \"path\": \"/sprites/overworld/majornpcs/Kyle.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lady Layana\",\n    \"path\": \"/sprites/overworld/majornpcs/Lady_Layana.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lady McCoy\",\n    \"path\": \"/sprites/overworld/majornpcs/Lady_McCoy.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Laurel Asleep\",\n    \"path\": \"/sprites/overworld/majornpcs/Laurel_Asleep.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Laurel Awake\",\n    \"path\": \"/sprites/overworld/majornpcs/Laurel_Awake.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lord Hammet\",\n    \"path\": \"/sprites/overworld/majornpcs/Lord_Hammet.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lord McCoy\",\n    \"path\": \"/sprites/overworld/majornpcs/Lord_McCoy.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Maha\",\n    \"path\": \"/sprites/overworld/majornpcs/Maha.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Master Poi\",\n    \"path\": \"/sprites/overworld/majornpcs/Master_Poi.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mrs Jerra\",\n    \"path\": \"/sprites/overworld/majornpcs/Mrs_Jerra.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mr Jerra\",\n    \"path\": \"/sprites/overworld/majornpcs/Mr_Jerra.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ouranos\",\n    \"path\": \"/sprites/overworld/majornpcs/Ouranos.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Potionshop Keeper\",\n    \"path\": \"/sprites/overworld/majornpcs/Potionshop_Keeper.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Potionshop Owner\",\n    \"path\": \"/sprites/overworld/majornpcs/Potionshop_Owner.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Prox Elder\",\n    \"path\": \"/sprites/overworld/majornpcs/Prox_Elder.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Puelle\",\n    \"path\": \"/sprites/overworld/majornpcs/Puelle.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sean\",\n    \"path\": \"/sprites/overworld/majornpcs/Sean.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sea Captain\",\n    \"path\": \"/sprites/overworld/majornpcs/Sea_Captain.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sunshine\",\n    \"path\": \"/sprites/overworld/majornpcs/Sunshine.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Susa\",\n    \"path\": \"/sprites/overworld/majornpcs/Susa.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Susa Right\",\n    \"path\": \"/sprites/overworld/majornpcs/Susa_Right.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Susa Up\",\n    \"path\": \"/sprites/overworld/majornpcs/Susa_Up.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Susa Walk\",\n    \"path\": \"/sprites/overworld/majornpcs/Susa_Walk.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Susa Walk Right\",\n    \"path\": \"/sprites/overworld/majornpcs/Susa_Walk_Right.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Susa Walk Up\",\n    \"path\": \"/sprites/overworld/majornpcs/Susa_Walk_Up.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thief1\",\n    \"path\": \"/sprites/overworld/majornpcs/Thief1.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tret Asleep\",\n    \"path\": \"/sprites/overworld/majornpcs/Tret_Asleep.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tret Awake\",\n    \"path\": \"/sprites/overworld/majornpcs/Tret_Awake.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Weaponshop Keeper\",\n    \"path\": \"/sprites/overworld/majornpcs/Weaponshop_Keeper.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Weaponshop Owner\",\n    \"path\": \"/sprites/overworld/majornpcs/Weaponshop_Owner.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wise One\",\n    \"path\": \"/sprites/overworld/majornpcs/Wise_One.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wise One 2\",\n    \"path\": \"/sprites/overworld/majornpcs/Wise_One_2.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wise One Glare\",\n    \"path\": \"/sprites/overworld/majornpcs/Wise_One_Glare.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wise One Lookaround\",\n    \"path\": \"/sprites/overworld/majornpcs/Wise_One_Lookaround.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wise One Spin\",\n    \"path\": \"/sprites/overworld/majornpcs/Wise_One_Spin.gif\",\n    \"category\": \"overworld-majornpcs\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Artifacts\",\n    \"path\": \"/sprites/icons/buttons/Artifacts.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Attack\",\n    \"path\": \"/sprites/icons/buttons/Attack.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Battle\",\n    \"path\": \"/sprites/icons/buttons/Battle.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bronze Password\",\n    \"path\": \"/sprites/icons/buttons/Bronze_Password.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Buy\",\n    \"path\": \"/sprites/icons/buttons/Buy.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Coins\",\n    \"path\": \"/sprites/icons/buttons/Coins.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Continue\",\n    \"path\": \"/sprites/icons/buttons/Continue.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Copy File\",\n    \"path\": \"/sprites/icons/buttons/Copy_File.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cure Poison\",\n    \"path\": \"/sprites/icons/buttons/Cure_Poison.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Defend\",\n    \"path\": \"/sprites/icons/buttons/Defend.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Djinni\",\n    \"path\": \"/sprites/icons/buttons/Djinni.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Erase File\",\n    \"path\": \"/sprites/icons/buttons/Erase_File.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fight\",\n    \"path\": \"/sprites/icons/buttons/Fight.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Flee\",\n    \"path\": \"/sprites/icons/buttons/Flee.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gold Password\",\n    \"path\": \"/sprites/icons/buttons/Gold_Password.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Item\",\n    \"path\": \"/sprites/icons/buttons/Item.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Link Cable\",\n    \"path\": \"/sprites/icons/buttons/Link_Cable.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lucky Medals\",\n    \"path\": \"/sprites/icons/buttons/Lucky_Medals.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"New Quest\",\n    \"path\": \"/sprites/icons/buttons/New_Quest.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"no\",\n    \"path\": \"/sprites/icons/buttons/no.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Options\",\n    \"path\": \"/sprites/icons/buttons/Options.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Options2\",\n    \"path\": \"/sprites/icons/buttons/Options2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Password\",\n    \"path\": \"/sprites/icons/buttons/Password.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Psynergy\",\n    \"path\": \"/sprites/icons/buttons/Psynergy.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Remove Curse\",\n    \"path\": \"/sprites/icons/buttons/Remove_Curse.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Repair\",\n    \"path\": \"/sprites/icons/buttons/Repair.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Repel Evil\",\n    \"path\": \"/sprites/icons/buttons/Repel_Evil.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Revive\",\n    \"path\": \"/sprites/icons/buttons/Revive.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Run\",\n    \"path\": \"/sprites/icons/buttons/Run.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Save Game\",\n    \"path\": \"/sprites/icons/buttons/Save_Game.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Save Game2\",\n    \"path\": \"/sprites/icons/buttons/Save_Game2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sell\",\n    \"path\": \"/sprites/icons/buttons/Sell.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Send\",\n    \"path\": \"/sprites/icons/buttons/Send.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Silver Password\",\n    \"path\": \"/sprites/icons/buttons/Silver_Password.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sleep\",\n    \"path\": \"/sprites/icons/buttons/Sleep.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sleep2\",\n    \"path\": \"/sprites/icons/buttons/Sleep2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sleep Mode Off\",\n    \"path\": \"/sprites/icons/buttons/Sleep_Mode_Off.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sleep Mode Off2\",\n    \"path\": \"/sprites/icons/buttons/Sleep_Mode_Off2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sleep Mode On\",\n    \"path\": \"/sprites/icons/buttons/Sleep_Mode_On.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sleep Mode On2\",\n    \"path\": \"/sprites/icons/buttons/Sleep_Mode_On2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Speech Off\",\n    \"path\": \"/sprites/icons/buttons/Speech_Off.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Speech Off2\",\n    \"path\": \"/sprites/icons/buttons/Speech_Off2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Speech On\",\n    \"path\": \"/sprites/icons/buttons/Speech_On.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Speech On2\",\n    \"path\": \"/sprites/icons/buttons/Speech_On2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Status\",\n    \"path\": \"/sprites/icons/buttons/Status.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Summon\",\n    \"path\": \"/sprites/icons/buttons/Summon.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Switch\",\n    \"path\": \"/sprites/icons/buttons/Switch.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Text Speed Fast\",\n    \"path\": \"/sprites/icons/buttons/Text_Speed_Fast.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Text Speed Fast2\",\n    \"path\": \"/sprites/icons/buttons/Text_Speed_Fast2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Text Speed Medium\",\n    \"path\": \"/sprites/icons/buttons/Text_Speed_Medium.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Text Speed Medium2\",\n    \"path\": \"/sprites/icons/buttons/Text_Speed_Medium2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Text Speed Slow\",\n    \"path\": \"/sprites/icons/buttons/Text_Speed_Slow.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Text Speed Slow2\",\n    \"path\": \"/sprites/icons/buttons/Text_Speed_Slow2.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"transfer file\",\n    \"path\": \"/sprites/icons/buttons/transfer_file.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"yes\",\n    \"path\": \"/sprites/icons/buttons/yes.gif\",\n    \"category\": \"icons-buttons\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Aaron Jerra\",\n    \"path\": \"/sprites/icons/characters/Aaron_Jerra.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Agatio\",\n    \"path\": \"/sprites/icons/characters/Agatio.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Akafubu\",\n    \"path\": \"/sprites/icons/characters/Akafubu.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Alex\",\n    \"path\": \"/sprites/icons/characters/Alex.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Armor Shopkeeper\",\n    \"path\": \"/sprites/icons/characters/Armor_Shopkeeper.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Armor Shopkeeper2\",\n    \"path\": \"/sprites/icons/characters/Armor_Shopkeeper2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Armor Shopkeeper 2\",\n    \"path\": \"/sprites/icons/characters/Armor_Shopkeeper_2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Babi\",\n    \"path\": \"/sprites/icons/characters/Babi.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Briggs\",\n    \"path\": \"/sprites/icons/characters/Briggs.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Champa Shopkeeper\",\n    \"path\": \"/sprites/icons/characters/Champa_Shopkeeper.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Chaucha\",\n    \"path\": \"/sprites/icons/characters/Chaucha.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Conservato\",\n    \"path\": \"/sprites/icons/characters/Conservato.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dodonpa\",\n    \"path\": \"/sprites/icons/characters/Dodonpa.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dojo Leader\",\n    \"path\": \"/sprites/icons/characters/Dojo_Leader.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Donpa\",\n    \"path\": \"/sprites/icons/characters/Donpa.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dora\",\n    \"path\": \"/sprites/icons/characters/Dora.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Elder\",\n    \"path\": \"/sprites/icons/characters/Elder.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Elder of Madra\",\n    \"path\": \"/sprites/icons/characters/Elder_of_Madra.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Eoleo\",\n    \"path\": \"/sprites/icons/characters/Eoleo.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Faran\",\n    \"path\": \"/sprites/icons/characters/Faran.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix1\",\n    \"path\": \"/sprites/icons/characters/Felix1.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Felix2\",\n    \"path\": \"/sprites/icons/characters/Felix2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fiezhi\",\n    \"path\": \"/sprites/icons/characters/Fiezhi.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fortune Teller\",\n    \"path\": \"/sprites/icons/characters/Fortune_Teller.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fortune Teller2\",\n    \"path\": \"/sprites/icons/characters/Fortune_Teller2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"frame\",\n    \"path\": \"/sprites/icons/characters/frame.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet's Grandfather\",\n    \"path\": \"/sprites/icons/characters/Garet's_Grandfather.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet's Grandmother\",\n    \"path\": \"/sprites/icons/characters/Garet's_Grandmother.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet1\",\n    \"path\": \"/sprites/icons/characters/Garet1.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Garet2\",\n    \"path\": \"/sprites/icons/characters/Garet2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"GreatHealer\",\n    \"path\": \"/sprites/icons/characters/GreatHealer.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Hsu\",\n    \"path\": \"/sprites/icons/characters/Hsu.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Innkeeper\",\n    \"path\": \"/sprites/icons/characters/Innkeeper.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Innkeepers Wife\",\n    \"path\": \"/sprites/icons/characters/Innkeepers_Wife.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Innkeeper 2\",\n    \"path\": \"/sprites/icons/characters/Innkeeper_2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Innkeeper Wife\",\n    \"path\": \"/sprites/icons/characters/Innkeeper_Wife.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Iodem\",\n    \"path\": \"/sprites/icons/characters/Iodem.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac1\",\n    \"path\": \"/sprites/icons/characters/Isaac1.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Isaac2\",\n    \"path\": \"/sprites/icons/characters/Isaac2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Item Shopkeeper\",\n    \"path\": \"/sprites/icons/characters/Item_Shopkeeper.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ivan\",\n    \"path\": \"/sprites/icons/characters/Ivan.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Izumo Innkeeper\",\n    \"path\": \"/sprites/icons/characters/Izumo_Innkeeper.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Izumo Innkeepers Wife\",\n    \"path\": \"/sprites/icons/characters/Izumo_Innkeepers_Wife.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Izumo Shopkeeper\",\n    \"path\": \"/sprites/icons/characters/Izumo_Shopkeeper.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna's Father\",\n    \"path\": \"/sprites/icons/characters/Jenna's_Father.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna's Mother\",\n    \"path\": \"/sprites/icons/characters/Jenna's_Mother.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna\",\n    \"path\": \"/sprites/icons/characters/Jenna.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna1\",\n    \"path\": \"/sprites/icons/characters/Jenna1.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jenna2\",\n    \"path\": \"/sprites/icons/characters/Jenna2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jupiter\",\n    \"path\": \"/sprites/icons/characters/Jupiter.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kaja\",\n    \"path\": \"/sprites/icons/characters/Kaja.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Karst\",\n    \"path\": \"/sprites/icons/characters/Karst.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kay Jerra\",\n    \"path\": \"/sprites/icons/characters/Kay_Jerra.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"King Hydros\",\n    \"path\": \"/sprites/icons/characters/King_Hydros.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kraden\",\n    \"path\": \"/sprites/icons/characters/Kraden.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kushinada\",\n    \"path\": \"/sprites/icons/characters/Kushinada.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Kyle\",\n    \"path\": \"/sprites/icons/characters/Kyle.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lady Layana\",\n    \"path\": \"/sprites/icons/characters/Lady_Layana.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Laurel\",\n    \"path\": \"/sprites/icons/characters/Laurel.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"LordMcCoy Wife\",\n    \"path\": \"/sprites/icons/characters/LordMcCoy_Wife.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lord Hammet\",\n    \"path\": \"/sprites/icons/characters/Lord_Hammet.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lord McCoy\",\n    \"path\": \"/sprites/icons/characters/Lord_McCoy.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lunpa\",\n    \"path\": \"/sprites/icons/characters/Lunpa.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Maha\",\n    \"path\": \"/sprites/icons/characters/Maha.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mars\",\n    \"path\": \"/sprites/icons/characters/Mars.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Master Hama\",\n    \"path\": \"/sprites/icons/characters/Master_Hama.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Master Poi\",\n    \"path\": \"/sprites/icons/characters/Master_Poi.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mayor of Alhafra\",\n    \"path\": \"/sprites/icons/characters/Mayor_of_Alhafra.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mayor of Madra\",\n    \"path\": \"/sprites/icons/characters/Mayor_of_Madra.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Menardi\",\n    \"path\": \"/sprites/icons/characters/Menardi.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mercury\",\n    \"path\": \"/sprites/icons/characters/Mercury.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mia\",\n    \"path\": \"/sprites/icons/characters/Mia.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Moapa\",\n    \"path\": \"/sprites/icons/characters/Moapa.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"MrJerra\",\n    \"path\": \"/sprites/icons/characters/MrJerra.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"MrsJerra\",\n    \"path\": \"/sprites/icons/characters/MrsJerra.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Nyunpa\",\n    \"path\": \"/sprites/icons/characters/Nyunpa.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Obaba\",\n    \"path\": \"/sprites/icons/characters/Obaba.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ouranos\",\n    \"path\": \"/sprites/icons/characters/Ouranos.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Picard\",\n    \"path\": \"/sprites/icons/characters/Picard.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Potion Shopkeeper\",\n    \"path\": \"/sprites/icons/characters/Potion_Shopkeeper.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Potion Shopkeeper 2\",\n    \"path\": \"/sprites/icons/characters/Potion_Shopkeeper_2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Prox Elder\",\n    \"path\": \"/sprites/icons/characters/Prox_Elder.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Puelle\",\n    \"path\": \"/sprites/icons/characters/Puelle.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Riki\",\n    \"path\": \"/sprites/icons/characters/Riki.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Saturos\",\n    \"path\": \"/sprites/icons/characters/Saturos.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sean\",\n    \"path\": \"/sprites/icons/characters/Sean.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sea Captain\",\n    \"path\": \"/sprites/icons/characters/Sea_Captain.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shadow Babi\",\n    \"path\": \"/sprites/icons/characters/Shadow_Babi.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sheba\",\n    \"path\": \"/sprites/icons/characters/Sheba.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sunshine\",\n    \"path\": \"/sprites/icons/characters/Sunshine.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Susa\",\n    \"path\": \"/sprites/icons/characters/Susa.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tavi\",\n    \"path\": \"/sprites/icons/characters/Tavi.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tret1\",\n    \"path\": \"/sprites/icons/characters/Tret1.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tret2\",\n    \"path\": \"/sprites/icons/characters/Tret2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Unidentified\",\n    \"path\": \"/sprites/icons/characters/Unidentified.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Uzume\",\n    \"path\": \"/sprites/icons/characters/Uzume.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus\",\n    \"path\": \"/sprites/icons/characters/Venus.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Weapon Shopkeeper\",\n    \"path\": \"/sprites/icons/characters/Weapon_Shopkeeper.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Weapon Shopkeeper 2\",\n    \"path\": \"/sprites/icons/characters/Weapon_Shopkeeper_2.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Young Felix\",\n    \"path\": \"/sprites/icons/characters/Young_Felix.gif\",\n    \"category\": \"icons-characters\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Angel Spear\",\n    \"path\": \"/sprites/icons/psynergy/Angel_Spear.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Annihalation\",\n    \"path\": \"/sprites/icons/psynergy/Annihalation.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Arrow\",\n    \"path\": \"/sprites/icons/psynergy/Arrow.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Astral Blast\",\n    \"path\": \"/sprites/icons/psynergy/Astral_Blast.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Aura\",\n    \"path\": \"/sprites/icons/psynergy/Aura.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Avalanche\",\n    \"path\": \"/sprites/icons/psynergy/Avalanche.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Avoid\",\n    \"path\": \"/sprites/icons/psynergy/Avoid.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Backstab\",\n    \"path\": \"/sprites/icons/psynergy/Backstab.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Baffle Card\",\n    \"path\": \"/sprites/icons/psynergy/Baffle_Card.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Beam\",\n    \"path\": \"/sprites/icons/psynergy/Beam.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bind\",\n    \"path\": \"/sprites/icons/psynergy/Bind.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Blast1\",\n    \"path\": \"/sprites/icons/psynergy/Blast1.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Blast2\",\n    \"path\": \"/sprites/icons/psynergy/Blast2.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Blaze\",\n    \"path\": \"/sprites/icons/psynergy/Blaze.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Blue Bolt\",\n    \"path\": \"/sprites/icons/psynergy/Blue_Bolt.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Blunt\",\n    \"path\": \"/sprites/icons/psynergy/Blunt.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bolt\",\n    \"path\": \"/sprites/icons/psynergy/Bolt.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bramble Card\",\n    \"path\": \"/sprites/icons/psynergy/Bramble_Card.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Break\",\n    \"path\": \"/sprites/icons/psynergy/Break.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Briar\",\n    \"path\": \"/sprites/icons/psynergy/Briar.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Burst\",\n    \"path\": \"/sprites/icons/psynergy/Burst.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Call Demon\",\n    \"path\": \"/sprites/icons/psynergy/Call_Demon.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Call Dullahan\",\n    \"path\": \"/sprites/icons/psynergy/Call_Dullahan.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Call Zombie\",\n    \"path\": \"/sprites/icons/psynergy/Call_Zombie.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Carpet Bomb\",\n    \"path\": \"/sprites/icons/psynergy/Carpet_Bomb.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Carry\",\n    \"path\": \"/sprites/icons/psynergy/Carry.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Catch\",\n    \"path\": \"/sprites/icons/psynergy/Catch.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cerberus\",\n    \"path\": \"/sprites/icons/psynergy/Cerberus.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Chimera\",\n    \"path\": \"/sprites/icons/psynergy/Chimera.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Clay Spire\",\n    \"path\": \"/sprites/icons/psynergy/Clay Spire.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cloak\",\n    \"path\": \"/sprites/icons/psynergy/Cloak.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cluster Bomb\",\n    \"path\": \"/sprites/icons/psynergy/Cluster_Bomb.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Condemn\",\n    \"path\": \"/sprites/icons/psynergy/Condemn.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cool\",\n    \"path\": \"/sprites/icons/psynergy/Cool.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cool Aura\",\n    \"path\": \"/sprites/icons/psynergy/Cool_Aura.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cure\",\n    \"path\": \"/sprites/icons/psynergy/Cure.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cure Poison\",\n    \"path\": \"/sprites/icons/psynergy/Cure_Poison.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cure Well\",\n    \"path\": \"/sprites/icons/psynergy/Cure_Well.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Curse\",\n    \"path\": \"/sprites/icons/psynergy/Curse.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cutting Edge\",\n    \"path\": \"/sprites/icons/psynergy/Cutting_Edge.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cycle Beam\",\n    \"path\": \"/sprites/icons/psynergy/Cycle_Beam.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cyclone\",\n    \"path\": \"/sprites/icons/psynergy/Cyclone.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Death Card\",\n    \"path\": \"/sprites/icons/psynergy/Death_Card.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Death Leap\",\n    \"path\": \"/sprites/icons/psynergy/Death_Leap.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Death Plunge\",\n    \"path\": \"/sprites/icons/psynergy/Death_Plunge.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Debilitate\",\n    \"path\": \"/sprites/icons/psynergy/Debilitate.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Delude\",\n    \"path\": \"/sprites/icons/psynergy/Delude.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Deluge\",\n    \"path\": \"/sprites/icons/psynergy/Deluge.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Demon Night\",\n    \"path\": \"/sprites/icons/psynergy/Demon_Night.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Demon Spear\",\n    \"path\": \"/sprites/icons/psynergy/Demon_Spear.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Destruct Ray\",\n    \"path\": \"/sprites/icons/psynergy/Destruct_Ray.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Diamond Berg\",\n    \"path\": \"/sprites/icons/psynergy/Diamond_Berg.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Diamond Dust\",\n    \"path\": \"/sprites/icons/psynergy/Diamond_Dust.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dinox\",\n    \"path\": \"/sprites/icons/psynergy/Dinox.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dire Inferno\",\n    \"path\": \"/sprites/icons/psynergy/Dire_Inferno.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Douse\",\n    \"path\": \"/sprites/icons/psynergy/Douse.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dragon Fire\",\n    \"path\": \"/sprites/icons/psynergy/Dragon_Fire.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dragon Fume\",\n    \"path\": \"/sprites/icons/psynergy/Dragon_Fume.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Drain\",\n    \"path\": \"/sprites/icons/psynergy/Drain.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Drench\",\n    \"path\": \"/sprites/icons/psynergy/Drench.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dull\",\n    \"path\": \"/sprites/icons/psynergy/Dull.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Earthquake\",\n    \"path\": \"/sprites/icons/psynergy/Earthquake.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Emu\",\n    \"path\": \"/sprites/icons/psynergy/Emu.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Enfeeble\",\n    \"path\": \"/sprites/icons/psynergy/Enfeeble.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Epicenter\",\n    \"path\": \"/sprites/icons/psynergy/Epicenter.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Eruption\",\n    \"path\": \"/sprites/icons/psynergy/Eruption.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fiery Abyss\",\n    \"path\": \"/sprites/icons/psynergy/Fiery_Abyss.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fiery Blast\",\n    \"path\": \"/sprites/icons/psynergy/Fiery_Blast.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fiery Juggle\",\n    \"path\": \"/sprites/icons/psynergy/Fiery_Juggle.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fire\",\n    \"path\": \"/sprites/icons/psynergy/Fire.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fireball\",\n    \"path\": \"/sprites/icons/psynergy/Fireball.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fire Bomb\",\n    \"path\": \"/sprites/icons/psynergy/Fire_Bomb.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fire Breath\",\n    \"path\": \"/sprites/icons/psynergy/Fire_Breath.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fire Puppet\",\n    \"path\": \"/sprites/icons/psynergy/Fire_Puppet.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Flame Card\",\n    \"path\": \"/sprites/icons/psynergy/Flame_Card.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Flare\",\n    \"path\": \"/sprites/icons/psynergy/Flare.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Flare Storm\",\n    \"path\": \"/sprites/icons/psynergy/Flare_Storm.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Flare Wall\",\n    \"path\": \"/sprites/icons/psynergy/Flare_Wall.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Flash Bolt\",\n    \"path\": \"/sprites/icons/psynergy/Flash_Bolt.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Force\",\n    \"path\": \"/sprites/icons/psynergy/Force.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Freeze Prism\",\n    \"path\": \"/sprites/icons/psynergy/Freeze_Prism.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Frost\",\n    \"path\": \"/sprites/icons/psynergy/Frost.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Frost Card\",\n    \"path\": \"/sprites/icons/psynergy/Frost_Card.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Froth\",\n    \"path\": \"/sprites/icons/psynergy/Froth.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Froth Sphere\",\n    \"path\": \"/sprites/icons/psynergy/Froth_Sphere.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Froth Spiral\",\n    \"path\": \"/sprites/icons/psynergy/Froth_Spiral.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fume\",\n    \"path\": \"/sprites/icons/psynergy/Fume.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gaia\",\n    \"path\": \"/sprites/icons/psynergy/Gaia.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gale\",\n    \"path\": \"/sprites/icons/psynergy/Gale.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gaurd\",\n    \"path\": \"/sprites/icons/psynergy/Gaurd.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gaurdian\",\n    \"path\": \"/sprites/icons/psynergy/Gaurdian.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Glacier\",\n    \"path\": \"/sprites/icons/psynergy/Glacier.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Grand Gaia\",\n    \"path\": \"/sprites/icons/psynergy/Grand_Gaia.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Grind\",\n    \"path\": \"/sprites/icons/psynergy/Grind.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Growth\",\n    \"path\": \"/sprites/icons/psynergy/Growth.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Hail\",\n    \"path\": \"/sprites/icons/psynergy/Hail.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Hail Prism\",\n    \"path\": \"/sprites/icons/psynergy/Hail_Prism.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Halt\",\n    \"path\": \"/sprites/icons/psynergy/Halt.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Haunt\",\n    \"path\": \"/sprites/icons/psynergy/Haunt.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Healing Aura\",\n    \"path\": \"/sprites/icons/psynergy/Healing_Aura.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Heat Juggle\",\n    \"path\": \"/sprites/icons/psynergy/Heat_Juggle.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Heat Wave\",\n    \"path\": \"/sprites/icons/psynergy/Heat_Wave.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"high impact\",\n    \"path\": \"/sprites/icons/psynergy/high_impact.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Hover\",\n    \"path\": \"/sprites/icons/psynergy/Hover.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Hurricane\",\n    \"path\": \"/sprites/icons/psynergy/Hurricane.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ice\",\n    \"path\": \"/sprites/icons/psynergy/Ice.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ice Horn\",\n    \"path\": \"/sprites/icons/psynergy/Ice_Horn.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ice Missile\",\n    \"path\": \"/sprites/icons/psynergy/Ice_Missile.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"impact\",\n    \"path\": \"/sprites/icons/psynergy/impact.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Impair\",\n    \"path\": \"/sprites/icons/psynergy/Impair.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Inferno\",\n    \"path\": \"/sprites/icons/psynergy/Inferno.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Juggle\",\n    \"path\": \"/sprites/icons/psynergy/Juggle.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lash\",\n    \"path\": \"/sprites/icons/psynergy/Lash.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lava Shower\",\n    \"path\": \"/sprites/icons/psynergy/Lava_Shower.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Lift\",\n    \"path\": \"/sprites/icons/psynergy/Lift.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Liquifier\",\n    \"path\": \"/sprites/icons/psynergy/Liquifier.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mad Blast\",\n    \"path\": \"/sprites/icons/psynergy/Mad_Blast.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mad Growth\",\n    \"path\": \"/sprites/icons/psynergy/Mad_Growth.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Magic Shell\",\n    \"path\": \"/sprites/icons/psynergy/Magic_Shell.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Magic Shield\",\n    \"path\": \"/sprites/icons/psynergy/Magic_Shield.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Magma Storm\",\n    \"path\": \"/sprites/icons/psynergy/Magma_Storm.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Magnet\",\n    \"path\": \"/sprites/icons/psynergy/Magnet.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Megacool\",\n    \"path\": \"/sprites/icons/psynergy/Megacool.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mind Read\",\n    \"path\": \"/sprites/icons/psynergy/Mind_Read.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mist\",\n    \"path\": \"/sprites/icons/psynergy/Mist.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Molten Bath\",\n    \"path\": \"/sprites/icons/psynergy/Molten_Bath.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mother Gaia\",\n    \"path\": \"/sprites/icons/psynergy/Mother_Gaia.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Move\",\n    \"path\": \"/sprites/icons/psynergy/Move.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Nettle\",\n    \"path\": \"/sprites/icons/psynergy/Nettle.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Nova\",\n    \"path\": \"/sprites/icons/psynergy/Nova.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Odyssey\",\n    \"path\": \"/sprites/icons/psynergy/Odyssey.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Parch\",\n    \"path\": \"/sprites/icons/psynergy/Parch.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Planetary\",\n    \"path\": \"/sprites/icons/psynergy/Planetary.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Planet Diver\",\n    \"path\": \"/sprites/icons/psynergy/Planet_Diver.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Plasma\",\n    \"path\": \"/sprites/icons/psynergy/Plasma.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Plume Edge\",\n    \"path\": \"/sprites/icons/psynergy/Plume_Edge.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ply\",\n    \"path\": \"/sprites/icons/psynergy/Ply.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ply Well\",\n    \"path\": \"/sprites/icons/psynergy/Ply_Well.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Poison Flow\",\n    \"path\": \"/sprites/icons/psynergy/Poison_Flow.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Potent Cure\",\n    \"path\": \"/sprites/icons/psynergy/Potent_Cure.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Pound\",\n    \"path\": \"/sprites/icons/psynergy/Pound.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Protect\",\n    \"path\": \"/sprites/icons/psynergy/Protect.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Protector\",\n    \"path\": \"/sprites/icons/psynergy/Protector.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Psy Drain\",\n    \"path\": \"/sprites/icons/psynergy/Psy_Drain.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Punji\",\n    \"path\": \"/sprites/icons/psynergy/Punji.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Punji Strike\",\n    \"path\": \"/sprites/icons/psynergy/Punji_Strike.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Punji Trap\",\n    \"path\": \"/sprites/icons/psynergy/Punji_Trap.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Pure Ply\",\n    \"path\": \"/sprites/icons/psynergy/Pure_Ply.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Pure Wish\",\n    \"path\": \"/sprites/icons/psynergy/Pure_Wish.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Pyroclasm\",\n    \"path\": \"/sprites/icons/psynergy/Pyroclasm.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Quake\",\n    \"path\": \"/sprites/icons/psynergy/Quake.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Quake Sphere\",\n    \"path\": \"/sprites/icons/psynergy/Quake_Sphere.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Quick Strike\",\n    \"path\": \"/sprites/icons/psynergy/Quick_Strike.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Raging Heat\",\n    \"path\": \"/sprites/icons/psynergy/Raging_Heat.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ragnarok\",\n    \"path\": \"/sprites/icons/psynergy/Ragnarok.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"range 1\",\n    \"path\": \"/sprites/icons/psynergy/range-1.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"range 11\",\n    \"path\": \"/sprites/icons/psynergy/range-11.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"range 3\",\n    \"path\": \"/sprites/icons/psynergy/range-3.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"range 5\",\n    \"path\": \"/sprites/icons/psynergy/range-5.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"range 7\",\n    \"path\": \"/sprites/icons/psynergy/range-7.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"range 9\",\n    \"path\": \"/sprites/icons/psynergy/range-9.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ray\",\n    \"path\": \"/sprites/icons/psynergy/Ray.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Reflect\",\n    \"path\": \"/sprites/icons/psynergy/Reflect.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Resist\",\n    \"path\": \"/sprites/icons/psynergy/Resist.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Restore\",\n    \"path\": \"/sprites/icons/psynergy/Restore.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Retreat\",\n    \"path\": \"/sprites/icons/psynergy/Retreat.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Reveal\",\n    \"path\": \"/sprites/icons/psynergy/Reveal.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Revive\",\n    \"path\": \"/sprites/icons/psynergy/Revive.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Roc\",\n    \"path\": \"/sprites/icons/psynergy/Roc.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Rockfall\",\n    \"path\": \"/sprites/icons/psynergy/Rockfall.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Rockslide\",\n    \"path\": \"/sprites/icons/psynergy/Rockslide.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sabre Dance\",\n    \"path\": \"/sprites/icons/psynergy/Sabre_Dance.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Salamander\",\n    \"path\": \"/sprites/icons/psynergy/Salamander.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sand\",\n    \"path\": \"/sprites/icons/psynergy/Sand.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Scoop\",\n    \"path\": \"/sprites/icons/psynergy/Scoop.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Searing Beam\",\n    \"path\": \"/sprites/icons/psynergy/Searing_Beam.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Serpent Fume\",\n    \"path\": \"/sprites/icons/psynergy/Serpent_Fume.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shine Plasma\",\n    \"path\": \"/sprites/icons/psynergy/Shine_Plasma.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shuriken\",\n    \"path\": \"/sprites/icons/psynergy/Shuriken.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Skull Splitter\",\n    \"path\": \"/sprites/icons/psynergy/Skull_Splitter.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Slash\",\n    \"path\": \"/sprites/icons/psynergy/Slash.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sleep\",\n    \"path\": \"/sprites/icons/psynergy/Sleep.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sleep Card\",\n    \"path\": \"/sprites/icons/psynergy/Sleep_Card.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sonic Slash\",\n    \"path\": \"/sprites/icons/psynergy/Sonic_Slash.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Spark Plasma\",\n    \"path\": \"/sprites/icons/psynergy/Spark_Plasma.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Spire\",\n    \"path\": \"/sprites/icons/psynergy/Spire.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Stone Spire\",\n    \"path\": \"/sprites/icons/psynergy/Stone_Spire.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Storm Ray\",\n    \"path\": \"/sprites/icons/psynergy/Storm_Ray.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Supercool\",\n    \"path\": \"/sprites/icons/psynergy/Supercool.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Supernova\",\n    \"path\": \"/sprites/icons/psynergy/Supernova.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sword Card\",\n    \"path\": \"/sprites/icons/psynergy/Sword_Card.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Teleport\",\n    \"path\": \"/sprites/icons/psynergy/Teleport.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tempest\",\n    \"path\": \"/sprites/icons/psynergy/Tempest.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thorn\",\n    \"path\": \"/sprites/icons/psynergy/Thorn.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thorny Grave\",\n    \"path\": \"/sprites/icons/psynergy/Thorny_Grave.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thunderbolt\",\n    \"path\": \"/sprites/icons/psynergy/Thunderbolt.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thunderclap\",\n    \"path\": \"/sprites/icons/psynergy/Thunderclap.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thunderstorm\",\n    \"path\": \"/sprites/icons/psynergy/Thunderstorm.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thunder Card\",\n    \"path\": \"/sprites/icons/psynergy/Thunder_Card.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Thunder Mine\",\n    \"path\": \"/sprites/icons/psynergy/Thunder_Mine.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tornado\",\n    \"path\": \"/sprites/icons/psynergy/Tornado.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tremor\",\n    \"path\": \"/sprites/icons/psynergy/Tremor.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tundra\",\n    \"path\": \"/sprites/icons/psynergy/Tundra.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Typhoon\",\n    \"path\": \"/sprites/icons/psynergy/Typhoon.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Volcano\",\n    \"path\": \"/sprites/icons/psynergy/Volcano.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ward\",\n    \"path\": \"/sprites/icons/psynergy/Ward.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Weaken\",\n    \"path\": \"/sprites/icons/psynergy/Weaken.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Whiplash\",\n    \"path\": \"/sprites/icons/psynergy/Whiplash.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Whirlwind\",\n    \"path\": \"/sprites/icons/psynergy/Whirlwind.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wild Growth\",\n    \"path\": \"/sprites/icons/psynergy/Wild_Growth.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wild Wolf\",\n    \"path\": \"/sprites/icons/psynergy/Wild_Wolf.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wind Slash\",\n    \"path\": \"/sprites/icons/psynergy/Wind_Slash.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wish\",\n    \"path\": \"/sprites/icons/psynergy/Wish.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Wish Well\",\n    \"path\": \"/sprites/icons/psynergy/Wish_Well.gif\",\n    \"category\": \"icons-psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"agitated\",\n    \"path\": \"/sprites/icons/misc/agitated.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Angry\",\n    \"path\": \"/sprites/icons/misc/Angry.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"attack up\",\n    \"path\": \"/sprites/icons/misc/attack_up.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"curse\",\n    \"path\": \"/sprites/icons/misc/curse.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"cursor\",\n    \"path\": \"/sprites/icons/misc/cursor.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"defense up\",\n    \"path\": \"/sprites/icons/misc/defense_up.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"delusion\",\n    \"path\": \"/sprites/icons/misc/delusion.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Down Arrow\",\n    \"path\": \"/sprites/icons/misc/Down_Arrow.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Exclamatory\",\n    \"path\": \"/sprites/icons/misc/Exclamatory.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"frown\",\n    \"path\": \"/sprites/icons/misc/frown.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Green Arrow\",\n    \"path\": \"/sprites/icons/misc/Green_Arrow.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Happy\",\n    \"path\": \"/sprites/icons/misc/Happy.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Haunted\",\n    \"path\": \"/sprites/icons/misc/Haunted.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"huh\",\n    \"path\": \"/sprites/icons/misc/huh.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"idea\",\n    \"path\": \"/sprites/icons/misc/idea.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"item qty bar\",\n    \"path\": \"/sprites/icons/misc/item_qty-bar.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"joy\",\n    \"path\": \"/sprites/icons/misc/joy.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jupiter Star\",\n    \"path\": \"/sprites/icons/misc/Jupiter_Star.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mars Star\",\n    \"path\": \"/sprites/icons/misc/Mars_Star.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mercury Star\",\n    \"path\": \"/sprites/icons/misc/Mercury_Star.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Poison\",\n    \"path\": \"/sprites/icons/misc/Poison.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Psynergy Seal\",\n    \"path\": \"/sprites/icons/misc/Psynergy_Seal.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Psy Seal\",\n    \"path\": \"/sprites/icons/misc/Psy_Seal.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"resist up\",\n    \"path\": \"/sprites/icons/misc/resist_up.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Silence\",\n    \"path\": \"/sprites/icons/misc/Silence.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Stat Down\",\n    \"path\": \"/sprites/icons/misc/Stat-Down.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Stat Up\",\n    \"path\": \"/sprites/icons/misc/Stat-Up.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sweatdrop\",\n    \"path\": \"/sprites/icons/misc/Sweatdrop.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Update\",\n    \"path\": \"/sprites/icons/misc/Update.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Up Arrow\",\n    \"path\": \"/sprites/icons/misc/Up_Arrow.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Star\",\n    \"path\": \"/sprites/icons/misc/Venus_Star.gif\",\n    \"category\": \"icons-misc\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Blue Bolt\",\n    \"path\": \"/sprites/psynergy/Blue_Bolt.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Deluge\",\n    \"path\": \"/sprites/psynergy/Deluge.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Destruct Ray\",\n    \"path\": \"/sprites/psynergy/Destruct_Ray.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dragon Fire\",\n    \"path\": \"/sprites/psynergy/Dragon_Fire.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fiery Blast\",\n    \"path\": \"/sprites/psynergy/Fiery_Blast.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Freeze Prism\",\n    \"path\": \"/sprites/psynergy/Freeze_Prism.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Froth Spiral\",\n    \"path\": \"/sprites/psynergy/Froth_Spiral.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Fume\",\n    \"path\": \"/sprites/psynergy/Fume.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Glacier\",\n    \"path\": \"/sprites/psynergy/Glacier.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Grand Gaia\",\n    \"path\": \"/sprites/psynergy/Grand_Gaia.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Heat Wave\",\n    \"path\": \"/sprites/psynergy/Heat_Wave.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Ice Missile\",\n    \"path\": \"/sprites/psynergy/Ice_Missile.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Inferno\",\n    \"path\": \"/sprites/psynergy/Inferno.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Nettle\",\n    \"path\": \"/sprites/psynergy/Nettle.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Pyroclasm\",\n    \"path\": \"/sprites/psynergy/Pyroclasm.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sonic Slash\",\n    \"path\": \"/sprites/psynergy/Sonic_Slash.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Spark Plasma\",\n    \"path\": \"/sprites/psynergy/Spark_Plasma.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Supernova\",\n    \"path\": \"/sprites/psynergy/Supernova.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tempest\",\n    \"path\": \"/sprites/psynergy/Tempest.gif\",\n    \"category\": \"psynergy\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bush\",\n    \"path\": \"/sprites/scenery/plants/Bush.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bush2\",\n    \"path\": \"/sprites/scenery/plants/Bush2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bush3\",\n    \"path\": \"/sprites/scenery/plants/Bush3.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cactus1\",\n    \"path\": \"/sprites/scenery/plants/Cactus1.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cactus2\",\n    \"path\": \"/sprites/scenery/plants/Cactus2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Cactus3\",\n    \"path\": \"/sprites/scenery/plants/Cactus3.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Desert Shrub1\",\n    \"path\": \"/sprites/scenery/plants/Desert_Shrub1.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Desert Shrub2\",\n    \"path\": \"/sprites/scenery/plants/Desert_Shrub2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Flowers\",\n    \"path\": \"/sprites/scenery/plants/Flowers.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Leaf\",\n    \"path\": \"/sprites/scenery/plants/Leaf.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Leaf2\",\n    \"path\": \"/sprites/scenery/plants/Leaf2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Leaf3\",\n    \"path\": \"/sprites/scenery/plants/Leaf3.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"lilypad1\",\n    \"path\": \"/sprites/scenery/plants/lilypad1.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"lilypad2\",\n    \"path\": \"/sprites/scenery/plants/lilypad2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"lilypad3\",\n    \"path\": \"/sprites/scenery/plants/lilypad3.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"lilypad4\",\n    \"path\": \"/sprites/scenery/plants/lilypad4.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Palm\",\n    \"path\": \"/sprites/scenery/plants/Palm.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Palm2\",\n    \"path\": \"/sprites/scenery/plants/Palm2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"palmtree\",\n    \"path\": \"/sprites/scenery/plants/palmtree.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shrub\",\n    \"path\": \"/sprites/scenery/plants/Shrub.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shrub1\",\n    \"path\": \"/sprites/scenery/plants/Shrub1.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shrub2\",\n    \"path\": \"/sprites/scenery/plants/Shrub2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shrub3\",\n    \"path\": \"/sprites/scenery/plants/Shrub3.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shrub4\",\n    \"path\": \"/sprites/scenery/plants/Shrub4.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shrub5\",\n    \"path\": \"/sprites/scenery/plants/Shrub5.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Shrub6\",\n    \"path\": \"/sprites/scenery/plants/Shrub6.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sickly Tree\",\n    \"path\": \"/sprites/scenery/plants/Sickly_Tree.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sickly Tree2\",\n    \"path\": \"/sprites/scenery/plants/Sickly_Tree2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Small Tree1\",\n    \"path\": \"/sprites/scenery/plants/Small_Tree1.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Small Tree2\",\n    \"path\": \"/sprites/scenery/plants/Small_Tree2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Small Tree3\",\n    \"path\": \"/sprites/scenery/plants/Small_Tree3.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Small Tree4\",\n    \"path\": \"/sprites/scenery/plants/Small_Tree4.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Small Tree5\",\n    \"path\": \"/sprites/scenery/plants/Small_Tree5.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Stump\",\n    \"path\": \"/sprites/scenery/plants/Stump.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree\",\n    \"path\": \"/sprites/scenery/plants/Tree.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree1\",\n    \"path\": \"/sprites/scenery/plants/Tree1.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree10\",\n    \"path\": \"/sprites/scenery/plants/Tree10.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree11\",\n    \"path\": \"/sprites/scenery/plants/Tree11.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree12\",\n    \"path\": \"/sprites/scenery/plants/Tree12.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree2\",\n    \"path\": \"/sprites/scenery/plants/Tree2.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree3\",\n    \"path\": \"/sprites/scenery/plants/Tree3.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree4\",\n    \"path\": \"/sprites/scenery/plants/Tree4.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree5\",\n    \"path\": \"/sprites/scenery/plants/Tree5.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree6\",\n    \"path\": \"/sprites/scenery/plants/Tree6.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree7\",\n    \"path\": \"/sprites/scenery/plants/Tree7.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree8\",\n    \"path\": \"/sprites/scenery/plants/Tree8.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Tree9\",\n    \"path\": \"/sprites/scenery/plants/Tree9.gif\",\n    \"category\": \"scenery-plants\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Alhafra Statue\",\n    \"path\": \"/sprites/scenery/statues/Alhafra_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Bilibin Statue\",\n    \"path\": \"/sprites/scenery/statues/Bilibin_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"crystal statue\",\n    \"path\": \"/sprites/scenery/statues/crystal_statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"desert statue\",\n    \"path\": \"/sprites/scenery/statues/desert_statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dragon\",\n    \"path\": \"/sprites/scenery/statues/Dragon.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dragonhead\",\n    \"path\": \"/sprites/scenery/statues/Dragonhead.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Dragonhead2\",\n    \"path\": \"/sprites/scenery/statues/Dragonhead2.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Gaia Rock Statue\",\n    \"path\": \"/sprites/scenery/statues/Gaia_Rock_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jupiter Statue\",\n    \"path\": \"/sprites/scenery/statues/Jupiter_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Jupiter Statue2\",\n    \"path\": \"/sprites/scenery/statues/Jupiter_Statue2.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Loho Statue\",\n    \"path\": \"/sprites/scenery/statues/Loho_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mars Statue\",\n    \"path\": \"/sprites/scenery/statues/Mars_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Mercury Statue\",\n    \"path\": \"/sprites/scenery/statues/Mercury_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sol Entry Statue\",\n    \"path\": \"/sprites/scenery/statues/Sol_Entry_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sol Sanctum Statue\",\n    \"path\": \"/sprites/scenery/statues/Sol_Sanctum_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sol Sanctum Statue2\",\n    \"path\": \"/sprites/scenery/statues/Sol_Sanctum_Statue2.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sol Sanctum Statue3\",\n    \"path\": \"/sprites/scenery/statues/Sol_Sanctum_Statue3.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Sol Sanctum Statue4\",\n    \"path\": \"/sprites/scenery/statues/Sol_Sanctum_Statue4.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"statue\",\n    \"path\": \"/sprites/scenery/statues/statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"stone face\",\n    \"path\": \"/sprites/scenery/statues/stone_face.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Aerie Statue\",\n    \"path\": \"/sprites/scenery/statues/Venus_Aerie_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Statue\",\n    \"path\": \"/sprites/scenery/statues/Venus_Statue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Statue Blue\",\n    \"path\": \"/sprites/scenery/statues/Venus_Statue_Blue.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Statue Green\",\n    \"path\": \"/sprites/scenery/statues/Venus_Statue_Green.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Statue Purple\",\n    \"path\": \"/sprites/scenery/statues/Venus_Statue_Purple.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Statue Red\",\n    \"path\": \"/sprites/scenery/statues/Venus_Statue_Red.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  },\n  {\n    \"name\": \"Venus Statue Yellow\",\n    \"path\": \"/sprites/scenery/statues/Venus_Statue_Yellow.gif\",\n    \"category\": \"scenery-statues\",\n    \"subcategory\": null\n  }\n];\n\n// Total sprites: 1048\n","/**\n * Sprite Catalog API\n *\n * The sprite system understands two identifier styles:\n *\n * 1. **Path IDs**  literal `/sprites/...` paths that must exist in `public/sprites/**`\n *    and therefore inside `sprite-list-generated.ts`. These IDs should be supplied by\n *    mapping helpers (e.g., overworld/battle mappings) whenever a call site knows the\n *    exact asset to render.\n *\n * 2. **Semantic IDs**  domain-centric slugs like `isaac-lblade-front` or `venus-djinn-front`.\n *    These are resolved through `getSpriteById`, which performs normalization and fuzzy\n *    matching against catalog entries. Semantic IDs allow older call sites and designer\n *    tooling to stay productive without hardcoding full paths.\n *\n * This module exposes pure lookup helpers that other sprite utilities can consume.\n * It intentionally has zero React or mapping-layer knowledge to avoid circular imports.\n */\n\nimport { SPRITE_LIST, type SpriteEntry } from './sprite-list-generated';\n\nfunction normalizeIdentifier(value: string): string {\n  const withSpaces = value.replace(/([a-z])([A-Z])/g, '$1 $2');\n  return withSpaces\n    .replace(/\\.(gif|png)$/gi, '')\n    .replace(/[_\\-\\s]+/g, ' ')\n    .trim()\n    .toLowerCase();\n}\n\nfunction getFilenameStem(spritePath: string): string {\n  const lastSlash = spritePath.lastIndexOf('/');\n  const filename = lastSlash >= 0 ? spritePath.slice(lastSlash + 1) : spritePath;\n  return filename.replace(/\\.(gif|png)$/gi, '');\n}\n\nfunction tokenize(value: string): string[] {\n  return normalizeIdentifier(value)\n    .split(' ')\n    .filter(Boolean);\n}\n\n/**\n * Look up a sprite by literal `/sprites/...` path.\n * Use this for path IDs coming from mapping helpers.\n */\nexport function getSpriteByPath(path: string): SpriteEntry | null {\n  return SPRITE_LIST.find(s => s.path === path) ?? null;\n}\n\n/**\n * Get all sprites in a category\n */\nexport function getSpritesByCategory(category: string): SpriteEntry[] {\n  return SPRITE_LIST.filter(s => s.category === category);\n}\n\n/**\n * Get sprites by category and subcategory\n */\nexport function getSpritesBySubcategory(category: string, subcategory: string): SpriteEntry[] {\n  return SPRITE_LIST.filter(s => s.category === category && s.subcategory === subcategory);\n}\n\n/**\n * Search sprites by name (case-insensitive)\n */\nexport function searchSprites(query: string): SpriteEntry[] {\n  const lowerQuery = query.toLowerCase();\n  return SPRITE_LIST.filter(s => s.name.toLowerCase().includes(lowerQuery));\n}\n\n/**\n * Get all unique categories\n */\nexport function getCategories(): string[] {\n  return [...new Set(SPRITE_LIST.map(s => s.category))].sort();\n}\n\n/**\n * Get all subcategories for a category\n */\nexport function getSubcategories(category: string): string[] {\n  const subs = SPRITE_LIST\n    .filter(s => s.category === category && s.subcategory !== null)\n    .map(s => s.subcategory as string);\n  return [...new Set(subs)].sort();\n}\n\n/**\n * Resolve a semantic sprite ID to the catalog entry.\n *\n * The lookup performs three passes:\n * 1. Exact normalized `name` match (handles IDs like `isaac lBlade Front`).\n * 2. Exact normalized filename stem match (handles `Isaac_Back.gif` style IDs).\n * 3. Keyword containment across both haystacks (last-resort fuzzy match).\n *\n * @example\n * getSpriteById('isaac-lblade-front')  finds \"Isaac lBlade Front\"\n * getSpriteById('Isaac_Back')  matches via filename stem\n */\nexport function getSpriteById(id: string): SpriteEntry | null {\n  const normalizedId = normalizeIdentifier(id);\n  const keywords = tokenize(id);\n  \n  // Try exact name match first\n  const exactMatch = SPRITE_LIST.find(s => \n    normalizeIdentifier(s.name) === normalizedId\n  );\n  if (exactMatch) return exactMatch;\n\n  // Try filename stem match (handles Isaac_Back, etc.)\n  const stemMatch = SPRITE_LIST.find(s => \n    normalizeIdentifier(getFilenameStem(s.path)) === normalizedId\n  );\n  if (stemMatch) return stemMatch;\n  \n  // Try keyword matching (all keywords must be in name)\n  if (keywords.length > 0) {\n    const keywordMatch = SPRITE_LIST.find(s => {\n      const haystacks = [\n        normalizeIdentifier(s.name),\n        normalizeIdentifier(getFilenameStem(s.path)),\n      ];\n      return keywords.every(kw => haystacks.some(haystack => haystack.includes(kw)));\n    });\n\n    if (keywordMatch) {\n      return keywordMatch;\n    }\n  }\n  \n  return null;\n}\n\n/**\n * Get random sprite from category\n */\nexport function getRandomSprite(category?: string): SpriteEntry {\n  const sprites = category \n    ? getSpritesByCategory(category)\n    : SPRITE_LIST;\n  \n  const randomIndex = Math.floor(Math.random() * sprites.length);\n  return sprites[randomIndex]!;\n}\n\n/**\n * Get statistics about sprite catalog\n */\nexport function getStats() {\n  const categories = getCategories();\n  const categoryCounts = categories.map(cat => ({\n    category: cat,\n    count: getSpritesByCategory(cat).length,\n  }));\n  \n  return {\n    total: SPRITE_LIST.length,\n    categories: categoryCounts,\n    largestCategory: categoryCounts.reduce((max, curr) => \n      curr.count > max.count ? curr : max\n    ),\n  };\n}\n\n/**\n * Validate that a sprite path exists in the catalog\n */\nexport function validateSpritePath(path: string): boolean {\n  return SPRITE_LIST.some(s => s.path === path);\n}\n\n// Re-export for convenience\nexport { SPRITE_LIST, type SpriteEntry };\n","/**\n * SimpleSprite Component\n * \n * A flexible, easy-to-use sprite component optimized for mockups and production screens.\n *\n * Identifier semantics:\n * - If `id` starts with `/`, it is treated as a **path ID** and must correspond to an\n *   entry inside `sprite-list-generated.ts`.\n * - Otherwise it is treated as a **semantic ID** and is resolved via `getSpriteById`.\n * \n * @example\n * // Basic usage\n * <SimpleSprite id=\"isaac-lblade-front\" width={64} height={64} />\n * \n * @example\n * // With custom styling\n * <SimpleSprite \n *   id=\"goblin\" \n *   width={48} \n *   height={48}\n *   style={{ border: '1px solid #ccc' }}\n * />\n * \n * @example\n * // Direct path (bypasses catalog)\n * <SimpleSprite \n *   id=\"/sprites/battle/party/isaac/Isaac_lBlade_Front.gif\"\n *   width={64}\n *   height={64}\n * />\n * \n * @example\n * // Debug mode (shows sprite info on hover)\n * <SimpleSprite \n *   id=\"isaac-battle-idle\"\n *   width={64}\n *   height={64}\n *   debug={true}\n * />\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport { getSpriteById, getSpriteByPath, type SpriteEntry } from './catalog';\n\nexport interface SimpleSpriteProps {\n  /**\n   * Sprite identifier - can be:\n   * - Flexible ID: \"isaac-lblade-front\" (searches catalog by keywords)\n   * - Direct path: \"/sprites/battle/party/isaac/Isaac_lBlade_Front.gif\"\n   * - Exact name: \"Isaac lBlade Front\" (case-insensitive)\n   */\n  id: string;\n  \n  /** Width in pixels */\n  width: number;\n  \n  /** Height in pixels */\n  height: number;\n  \n  /** Optional custom CSS styles */\n  style?: React.CSSProperties;\n  \n  /** Optional CSS class name */\n  className?: string;\n  \n  /** \n   * Debug mode - shows sprite info on hover and logs lookups\n   * Useful for mockup/design work to see what sprite was found\n   */\n  debug?: boolean;\n  \n  /** \n   * Fallback component when sprite not found\n   * Default: colored placeholder with sprite ID\n   */\n  fallback?: React.ReactNode;\n  \n  /** Alt text for accessibility */\n  alt?: string;\n  \n  /** \n   * Image rendering mode\n   * - \"pixelated\": Crisp pixel art (default for sprites)\n   * - \"auto\": Browser default\n   * - \"smooth\": Smooth scaling\n   */\n  imageRendering?: 'pixelated' | 'auto' | 'smooth';\n  \n  /** \n   * Object fit mode\n   * - \"contain\": Fit within bounds, maintain aspect ratio\n   * - \"cover\": Fill bounds, maintain aspect ratio\n   * - \"fill\": Stretch to fill bounds\n   */\n  objectFit?: 'contain' | 'cover' | 'fill';\n  \n  /** Callback when sprite loads successfully */\n  onLoad?: () => void;\n  \n  /** Callback when sprite fails to load */\n  onError?: (error: string) => void;\n}\n\n/**\n * Generate a colored placeholder based on sprite ID\n * Useful for debugging and fallbacks\n */\nfunction generatePlaceholder(id: string, width: number, height: number): React.ReactNode {\n  // Generate a consistent color from the ID\n  let hash = 0;\n  for (let i = 0; i < id.length; i++) {\n    hash = id.charCodeAt(i) + ((hash << 5) - hash);\n  }\n  const hue = Math.abs(hash % 360);\n  const saturation = 40 + (Math.abs(hash) % 30); // 40-70%\n  const lightness = 60 + (Math.abs(hash) % 20); // 60-80%\n  \n  return (\n    <div\n      style={{\n        width,\n        height,\n        backgroundColor: `hsl(${hue}, ${saturation}%, ${lightness}%)`,\n        display: 'flex',\n        alignItems: 'center',\n        justifyContent: 'center',\n        fontSize: Math.min(width, height) / 4,\n        color: '#fff',\n        fontWeight: 'bold',\n        textAlign: 'center',\n        padding: '4px',\n        border: '2px dashed rgba(0,0,0,0.3)',\n        boxSizing: 'border-box',\n      }}\n      title={`Placeholder: ${id}`}\n    >\n      <div style={{ wordBreak: 'break-word', lineHeight: 1 }}>\n        {id.length > 10 ? id.substring(0, 10) + '...' : id}\n      </div>\n    </div>\n  );\n}\n\n/**\n * Find sprite entry using flexible lookup\n */\nfunction findSprite(id: string): { entry: SpriteEntry | null; method: string } {\n  // Method 1: Direct path (starts with /)\n  if (id.startsWith('/')) {\n    const entry = getSpriteByPath(id);\n    return { entry, method: 'path' };\n  }\n  \n  // Method 2: Catalog lookup (flexible ID matching)\n  const entry = getSpriteById(id);\n  if (entry) {\n    return { entry, method: 'catalog' };\n  }\n  \n  return { entry: null, method: 'none' };\n}\n\nexport function SimpleSprite({\n  id,\n  width,\n  height,\n  style,\n  className,\n  debug = false,\n  fallback,\n  alt,\n  imageRendering = 'pixelated',\n  objectFit = 'contain',\n  onLoad,\n  onError,\n}: SimpleSpriteProps) {\n  const [spriteEntry, setSpriteEntry] = useState<{ entry: SpriteEntry | null; method: string } | null>(null);\n  const [loadError, setLoadError] = useState<string | null>(null);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [showDebugInfo, setShowDebugInfo] = useState(false);\n  \n  const catalogSuggestion = `searchSprites('${id.split('-')[0] ?? id}')`;\n\n  // Lookup sprite on mount/id change\n  useEffect(() => {\n    const result = findSprite(id);\n    setSpriteEntry(result);\n    setLoadError(null);\n    setIsLoaded(false);\n    \n    if (debug && result.entry) {\n      // eslint-disable-next-line no-console\n      console.log(`[SimpleSprite] Found sprite`, {\n        id,\n        method: result.method,\n        name: result.entry.name,\n        path: result.entry.path,\n        category: result.entry.category,\n      });\n    } else if (debug && !result.entry) {\n      console.warn(`[SimpleSprite] Sprite not found:`, {\n        id,\n        method: result.method,\n        suggestion: id.includes('-') \n          ? `Try searching catalog for: ${id.split('-').join(' ')}`\n          : `Try using direct path or check catalog`,\n      });\n    }\n  }, [id, debug]);\n  \n  // Handle image load\n  const handleLoad = () => {\n    setIsLoaded(true);\n    setLoadError(null);\n    onLoad?.();\n  };\n  \n  const handleError = () => {\n    const error = spriteEntry?.entry \n      ? `Failed to load sprite at ${spriteEntry.entry.path} (method: ${spriteEntry.method})`\n      : `Sprite not found for id \"${id}\" (method: ${spriteEntry?.method ?? 'none'})`;\n    setLoadError(error);\n    setIsLoaded(false);\n    onError?.(error);\n    \n    if (debug) {\n      console.error(`[SimpleSprite] Load error:`, error);\n    }\n  };\n  \n  // Determine sprite path\n  const spritePath = spriteEntry?.entry?.path || null;\n  \n  // Show fallback if no sprite found or error loading\n  if (!spritePath || loadError) {\n    if (fallback) {\n      return <>{fallback}</>;\n    }\n    \n    return (\n      <div\n        className={className}\n        style={{\n          width,\n          height,\n          ...style,\n        }}\n        onMouseEnter={() => debug && setShowDebugInfo(true)}\n        onMouseLeave={() => debug && setShowDebugInfo(false)}\n      >\n        {generatePlaceholder(id, width, height)}\n        {debug && showDebugInfo && (\n          <div\n            style={{\n              position: 'absolute',\n              backgroundColor: 'rgba(0, 0, 0, 0.9)',\n              color: '#fff',\n              padding: '8px',\n              borderRadius: '4px',\n              fontSize: '12px',\n              zIndex: 1000,\n              marginTop: '4px',\n              maxWidth: '300px',\n            }}\n          >\n            <div><strong>Sprite ID:</strong> {id}</div>\n            {spriteEntry && (\n              <div><strong>Lookup Method:</strong> {spriteEntry.method}</div>\n            )}\n            {loadError && (\n              <div style={{ color: '#ff6b6b' }}><strong>Error:</strong> {loadError}</div>\n            )}\n            {!spritePath && (\n              <div style={{ color: '#ffd93d' }}>\n                <strong>Tip:</strong> Sprite not found in catalog. Try:\n                <ul style={{ margin: '4px 0', paddingLeft: '20px' }}>\n                  <li>Using direct path: <code>/sprites/...</code></li>\n                  <li>Checking catalog: <code>{catalogSuggestion}</code></li>\n                </ul>\n              </div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n  \n  // Render sprite\n  return (\n    <div\n      className={className}\n      style={{\n        width,\n        height,\n        position: 'relative',\n        display: 'inline-block',\n        ...style,\n      }}\n      onMouseEnter={() => debug && setShowDebugInfo(true)}\n      onMouseLeave={() => debug && setShowDebugInfo(false)}\n    >\n      <img\n        src={spritePath}\n        alt={alt || spriteEntry?.entry?.name || id}\n        width={width}\n        height={height}\n        style={{\n          width: '100%',\n          height: '100%',\n          objectFit,\n          imageRendering: imageRendering as React.CSSProperties['imageRendering'],\n          display: 'block',\n        }}\n        onLoad={handleLoad}\n        onError={handleError}\n      />\n      \n      {/* Debug info overlay */}\n      {debug && showDebugInfo && spriteEntry && spriteEntry.entry && (\n        <div\n          style={{\n            position: 'absolute',\n            bottom: '100%',\n            left: 0,\n            backgroundColor: 'rgba(0, 0, 0, 0.9)',\n            color: '#fff',\n            padding: '8px',\n            borderRadius: '4px',\n            fontSize: '12px',\n            zIndex: 1000,\n            marginBottom: '4px',\n            maxWidth: '300px',\n            whiteSpace: 'nowrap',\n          }}\n        >\n          <div><strong>Name:</strong> {spriteEntry.entry.name}</div>\n          <div><strong>Path:</strong> {spriteEntry.entry.path}</div>\n          <div><strong>Category:</strong> {spriteEntry.entry.category}</div>\n          {spriteEntry.entry.subcategory && (\n            <div><strong>Subcategory:</strong> {spriteEntry.entry.subcategory}</div>\n          )}\n          <div><strong>Lookup:</strong> {spriteEntry.method}</div>\n          <div><strong>Status:</strong> {isLoaded ? ' Loaded' : ' Loading...'}</div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n","/**\n * Ability Icon Mapping\n * Maps ability IDs to sprite icon IDs from Psynergy icon collection\n * Complete mappings for all 209 abilities\n */\n\n/**\n * Maps ability IDs to sprite IDs\n * Uses available icons from /sprites/icons/psynergy/ (214 icons available)\n */\nexport const ABILITY_ICON_MAP: Record<string, string> = {\n  // === BASIC ATTACK ABILITIES ===\n  'strike': 'arrow',\n  'heavy-strike': 'blast1',\n  'guard-break': 'break',\n  'precise-jab': 'backstab',\n\n  // === FIRE/MARS ABILITIES ===\n  'fireball': 'fire-ball',\n  'fire-burst': 'burst',\n  'flare': 'flare-wall',\n  'burn-touch': 'fire-bomb',\n  'flame-burst-damage': 'burst',\n  'fire-ward-utility': 'fire-shield',\n  'ignite': 'fire',\n  'flame-wall': 'flare-wall',\n  'inferno-slash': 'inferno',\n  'blazing-fury': 'flare-storm',\n  'pyroclasm': 'volcano',\n  'fire-aura': 'cool-aura',\n  'meteor-strike': 'meteor',\n  'phoenix-flames': 'phoenix',\n  'magma-burst': 'molten',\n  'flame-shield': 'fire-shield',\n  'supernova': 'supernova',\n  'infernal-rage': 'dire-inferno',\n  'dragon-breath': 'dragon-fire',\n  'ragnarok-flames': 'ragnarok',\n  'flame-blade': 'fire',\n  'battle-cry': 'ward',\n  'inferno-strike': 'inferno',\n  'pyroblast': 'volcano',\n  'warrior-flame': 'fire',\n  'molten-slash': 'molten',\n  'fire-nova': 'nova',\n  'blazing-assault': 'flare-storm',\n  'magma-wave': 'molten',\n  'berserker-rage': 'dire-inferno',\n  'crimson-fury': 'fire',\n  'meteor-crash': 'meteor',\n  'phoenix-aura': 'phoenix',\n  'solar-flare': 'flare',\n  'ultimate-warrior': 'ragnarok',\n  'inferno-barrage': 'inferno',\n  'supernova-strike': 'supernova',\n  'flame-jab': 'fire',\n  'inferno-assault': 'inferno',\n  'flame-tornado': 'fire-bomb',\n\n  // === WATER/MERCURY ABILITIES ===\n  'ice-shard': 'frost',\n  'freeze-blast': 'ice-horn',\n  'heal': 'cure',\n  'party-heal': 'cure-well',\n  'cure': 'pure-ply',\n  'ice-lance-damage': 'ice-missile',\n  'aqua-heal-utility': 'ply',\n  'cleanse': 'cure-poison',\n  'frost-wave': 'icicle',\n  'regen': 'healing-aura',\n  'diamond-dust': 'diamond-dust',\n  'mass-regen': 'wish-well',\n  'glacial-shield': 'ice-shield',\n  'deep-freeze': 'freeze-prism',\n  'sanctuary': 'sanctuary',\n  'blizzard': 'ice-horn',\n  'restoration': 'restore',\n  'frozen-tomb': 'ice',\n  'aqua-barrier': 'water-shield',\n  'absolute-zero': 'tundra',\n  'leviathan-grace': 'wish-well',\n  'frost-shield': 'ice-shield',\n  'purify': 'cure-poison',\n  'ice-spear': 'ice-missile',\n  'scholar-wisdom': 'reveal',\n  'glacial-wave': 'tundra',\n  'renewal': 'wish',\n  'frozen-spikes': 'icicle',\n  'crystal-barrier': 'ice-shield',\n  'ice-storm': 'hail-prism',\n  'mass-restoration': 'restore',\n  'frozen-tomb-karis': 'ice',\n  'scholar-sanctuary': 'sanctuary',\n  'blizzard-cascade': 'diamond-berg',\n  'divine-renewal': 'wish-well',\n  'absolute-zero-karis': 'tundra',\n  'aqua-resurrection': 'revive',\n\n  // === EARTH/VENUS ABILITIES ===\n  'quake': 'quake',\n  'earth-spike': 'spire',\n  'earth-spike-damage': 'spire',\n  'stone-skin-utility': 'guard',\n  'fortify': 'guard',\n  'tremor': 'tremor',\n  'guardian-stance': 'ward',\n  'rock-breaker': 'quake-sphere',\n  'earthquake': 'earthquake',\n  'stone-wall': 'stone-spire',\n  'unbreakable': 'guard',\n  'titan-grip': 'titan-blade',\n  'gaia-shield': 'gaia',\n  'petrify-strike': 'petra',\n  'mountain-endurance': 'ward',\n  'landslide': 'avalanche',\n  'earth-blessing': 'gaia',\n  'gaia-rebirth': 'revive',\n  'taunt': 'taunt',\n  'shield-bash': 'impact',\n  'iron-wall': 'guard',\n  'counter-stance': 'ward',\n  'tremor-strike': 'tremor',\n  'fortified-guard': 'gaurdian',\n  'bulwark': 'guard',\n  'crushing-blow': 'impact',\n  'earthen-armor': 'guard',\n  'shockwave': 'earthquake',\n  'guardian-resolve': 'gaurdian',\n  'titan-grip-sentinel': 'titan-blade',\n  'stone-fortress': 'guard',\n  'avalanche': 'avalanche',\n  'immortal-bulwark': 'guard',\n  'earth-splitter': 'quake-sphere',\n  'atlas-stand': 'ward',\n  'earth-strike': 'spire',\n  'warrior-resolve': 'ward',\n  'sunder-armor': 'break',\n  'stone-fist': 'clay',\n  'earth-shaker': 'earthquake',\n  'battle-master': 'ward',\n  'crushing-impact': 'impact',\n  'mountain-strength': 'ward',\n  'ragnarok-strike': 'ragnarok',\n  'terra-shield': 'gaia',\n  'grand-impact': 'impact',\n  'legendary-warrior': 'ragnarok',\n  'titan-fall': 'titan-blade',\n  'earth-judgment': 'judgment',\n  'master-aura': 'cool-aura',\n  'gaia-blade': 'gaia',\n\n  // === WIND/JUPITER ABILITIES ===\n  'gust': 'gust',\n  'chain-lightning': 'spark-plasma',\n  'paralyze-shock': 'thunder-mine',\n  'gale-force-damage': 'whirlwind',\n  'wind-barrier-utility': 'wind-shield',\n  'swift-strike': 'quick-strike',\n  'shock-bolt': 'bolt',\n  'tempest': 'tempest',\n  'hurricane-slash': 'hurricane',\n  'plasma-shot': 'plasma',\n  'cyclone': 'cyclone',\n  'thunder-god-fury': 'judgement-bolt',\n  'storm-blessing': 'wish',\n  'judgment-bolt': 'judgement-bolt',\n  'static-field': 'lightning-bomb',\n  'wind-walker': 'quick-strike',\n  'maelstrom': 'tornado',\n  'zeus-wrath': 'thoron',\n  'storm-sovereign': 'thor',\n  'thunder-clap': 'thunderclap',\n  'storm-call': 'storm-ray',\n  'static-charge': 'spark-plasma',\n  'lightning-arc': 'slash',\n  'shock-pulse': 'shock',\n  'wind-mastery': 'whirlwind',\n  'thunder-storm': 'thunderstorm',\n  'electric-overload': 'plasma',\n  'storm-shield': 'wind-shield',\n  'bolt-barrage': 'thoron',\n  'hurricane-force': 'hurricane',\n  'thor-hammer': 'thor',\n  'lightning-sanctuary': 'sanctuary',\n  'apocalyptic-storm': 'tempest',\n  'god-thunder': 'thor',\n  'world-storm': 'storm-ray',\n  'tempest-tyrant': 'tempest',\n\n  // === STATUS/DEBUFF ABILITIES ===\n  'blind': 'baffle-card',\n  'poison-strike': 'venom-fang',\n  'weaken-def': 'debilitate',\n\n  // === BUFF/UTILITY ABILITIES ===\n  'boost-atk': 'boost',\n  'boost-def': 'resist',\n  'guard': 'ward',\n  'focus-strike-neutral': 'quick-strike',\n\n  // === WEAPON-BASED ABILITIES ===\n  'wooden-strike': 'arrow',\n  'bronze-slash': 'slash',\n  'iron-bulwark': 'guard',\n  'arcane-bolt': 'bolt',\n  'iron-thrust': 'arrow',\n  'steel-focus': 'quick-strike',\n  'steel-ward': 'ward',\n  'axe-cleave': 'slash',\n  'iron-mind': 'ward',\n  'silver-shield': 'guard',\n  'mythril-wisdom': 'reveal',\n  'hyper-speed': 'quick-strike',\n  'mythril-edge': 'slash',\n  'dragon-ward': 'ward',\n  'oracle-vision': 'reveal',\n  'steel-slash': 'slash',\n  'crystal-blast': 'blast1',\n  'silver-strike': 'slash',\n  'great-cleave': 'slash',\n  'zodiac-bolt': 'bolt',\n\n  // === COMBAT ABILITIES ===\n  'rapid-strikes': 'quick-strike',\n  'assassinate': 'backstab',\n  'combat-focus': 'quick-strike',\n  'flurry': 'quick-strike',\n  'precision-strike': 'backstab',\n  'blood-rush': 'quick-strike',\n  'death-strike': 'backstab',\n  'perfect-form': 'ward',\n  'obliterate': 'blast2',\n  'unstoppable-force': 'impact',\n  'supreme-focus': 'quick-strike',\n  'annihilation': 'blast2',\n  'one-thousand-cuts': 'quick-strike',\n};\n\n/**\n * Get sprite ID for an ability\n * Returns fallback icon if ability not recognized\n */\nexport function getAbilityIconSprite(abilityId: string): string {\n  return ABILITY_ICON_MAP[abilityId] || 'psynergy';  // Default to generic Psynergy icon\n}\n\n/**\n * Check if an ability has a mapped icon\n */\nexport function hasAbilityIcon(abilityId: string): boolean {\n  return abilityId in ABILITY_ICON_MAP;\n}\n\n/**\n * Convert an ability icon ID to a psynergy FX sprite path (GIF)\n * Returns null if no icon is mapped.\n */\nexport function getAbilityEffectSprite(abilityId: string): string | null {\n  const iconId = ABILITY_ICON_MAP[abilityId];\n  if (!iconId) return null;\n\n  // Convert kebab/slug to Title_Case used by GIF filenames\n  const parts = iconId.split(/[^a-zA-Z0-9]+/).filter(Boolean);\n  if (parts.length === 0) return null;\n  const fileName = parts.map(p => p.charAt(0).toUpperCase() + p.slice(1)).join('_');\n  return `/sprites/psynergy/${fileName}.gif`;\n}\n\n/**\n * Get all mapped ability IDs\n */\nexport function getMappedAbilities(): string[] {\n  return Object.keys(ABILITY_ICON_MAP);\n}\n","/**\n * Portrait Sprite Mapping\n * Maps character/speaker names to portrait sprite IDs\n */\n\n/**\n * Maps character names to portrait sprite IDs\n * Uses available portraits from /sprites/icons/characters/ (100+ portraits available)\n */\nexport const PORTRAIT_MAP: Record<string, string> = {\n  // Main Party Characters (both name variations)\n  'Isaac': 'isaac1',\n  'isaac': 'isaac1',\n  'Garet': 'garet1',\n  'garet': 'garet1',\n  'Mia': 'mia',\n  'mia': 'mia',\n  'Ivan': 'ivan',\n  'ivan': 'ivan',\n  'Felix': 'felix1',\n  'felix': 'felix1',\n  'Jenna': 'jenna1',\n  'jenna': 'jenna1',\n  'Piers': 'piers',\n  'piers': 'piers',\n  'Sheba': 'sheba',\n  'sheba': 'sheba',\n\n  // Unit IDs to portraits\n  'adept': 'isaac1',\n  'war-mage': 'garet1',\n  'mystic': 'mia',\n  'ranger': 'ivan',\n  'blaze': 'garet1',         // Mars - uses Garet portrait\n  'karis': 'ivan',            // Jupiter - uses Ivan portrait (Karis not available)\n  'sentinel': 'felix1',       // Venus - uses Felix portrait\n  'stormcaller': 'jenna1',    // Jupiter - has portrait\n  'tyrell': 'garet1',         // Mars - uses Garet portrait\n  'tower-champion': 'isaac1', // Venus - uses Isaac portrait\n\n  // Test units\n  'test-warrior-1': 'isaac1',\n  'test-warrior-2': 'garet1',\n  'test-warrior-3': 'mia',\n  'test-warrior-4': 'ivan',\n\n  // Antagonists (available in catalog)\n  'Saturos': 'saturos',\n  'saturos': 'saturos',\n  'Menardi': 'menardi',\n  'menardi': 'menardi',\n  'Alex': 'alex',\n  'alex': 'alex',\n  'Agatio': 'agatio',\n  'agatio': 'agatio',\n  'Karst': 'karst',\n  'karst': 'karst',\n\n  // Common NPCs (generic fallbacks)\n  'Elder': 'elder',\n  'elder': 'elder',\n  'Merchant': 'armor-shopkeeper',\n  'merchant': 'armor-shopkeeper',\n  'Villager': 'villager',\n  'villager': 'villager',\n};\n\n/**\n * Get portrait sprite ID for a character/speaker\n * Returns fallback if character not recognized\n *\n * @param name - Character name or unit ID\n * @returns Sprite ID for the character's portrait\n */\nexport function getPortraitSprite(name: string): string {\n  // Try exact match first\n  const exactMatch = PORTRAIT_MAP[name];\n  if (exactMatch) {\n    return exactMatch;\n  }\n\n  // Try lowercase match\n  const lowerName = name.toLowerCase();\n  const lowerMatch = PORTRAIT_MAP[lowerName];\n  if (lowerMatch) {\n    return lowerMatch;\n  }\n\n  // Default fallback - use Isaac portrait\n  return 'isaac1';\n}\n\n/**\n * Check if a character has a mapped portrait\n */\nexport function hasPortrait(name: string): boolean {\n  return name in PORTRAIT_MAP || name.toLowerCase() in PORTRAIT_MAP;\n}\n\n/**\n * Get all mapped character names\n */\nexport function getMappedCharacters(): string[] {\n  return Object.keys(PORTRAIT_MAP);\n}\n","/**\n * Overworld Sprite Mapping\n * Maps overworld entities (player, NPCs, scenery) to sprite IDs\n */\n\n/**\n * Player character directions\n */\nexport type Direction = 'up' | 'down' | 'left' | 'right';\n\n/**\n * Maps tile types to sprite IDs (or fallback to CSS for now)\n * Note: Basic terrain tiles (grass, path, water) use CSS colors for now\n * Can be upgraded with proper tile sprites in future phase\n */\nexport const TILE_SPRITE_MAP: Record<string, string | null> = {\n  // Basic terrain - using CSS colors for now (null = use CSS)\n  'grass': null,\n  'path': null,\n  'water': null,\n  'wall': null,\n\n  // Special tiles with sprites\n  'door': 'door2',  // From scenery/outdoor\n  'chest': 'chest',  // From scenery\n  'trigger': null,  // Hidden/transparent\n  'npc': null,  // NPCs rendered separately\n};\n\n/**\n * Maps player unit IDs to their base sprite names\n */\nconst PROTAGONIST_BASE_PATH = '/sprites/overworld/protagonists';\nconst MAJOR_NPC_BASE_PATH = '/sprites/overworld/majornpcs';\n\nexport const PLAYER_UNIT_TO_SPRITE: Record<string, string> = {\n  // Main party - matches unit definitions\n  'adept': 'Isaac',        // Isaac (Venus Adept)\n  'war-mage': 'Garet',     // Garet (Mars Warrior)\n  'mystic': 'Mia',         // Mia (Mercury Healer)\n  'ranger': 'Ivan',        // Ivan (Jupiter Mage)\n  'sentinel': 'Felix',     // Felix (Venus Adept)\n  'stormcaller': 'Jenna',  // Jenna (Mars Mage)\n\n  // Test units\n  'test-warrior-1': 'Isaac',\n  'test-warrior-2': 'Garet',\n  'test-warrior-3': 'Mia',\n  'test-warrior-4': 'Ivan',\n};\n\ninterface ProtagonistPoseConfig {\n  front: string;\n  back: string;\n  side: string;\n}\n\nconst ISAAC_POSE: ProtagonistPoseConfig = { front: 'Isaac.gif', back: 'Isaac_Back.gif', side: 'Isaac_Right.gif' };\n\nconst PROTAGONIST_POSES: Record<string, ProtagonistPoseConfig> = {\n  Isaac: ISAAC_POSE,\n  Garet: { front: 'Garet.gif', back: 'Garet_Back.gif', side: 'Garet_Right.gif' },\n  Mia: { front: 'Mia.gif', back: 'Mia_Back.gif', side: 'Mia_Right.gif' },\n  Ivan: { front: 'Ivan.gif', back: 'Ivan_Back.gif', side: 'Ivan_Right.gif' },\n  Felix: { front: 'Felix.gif', back: 'Felix_Back.gif', side: 'Felix_E.gif' },\n  Jenna: { front: 'Jenna.gif', back: 'Jenna_Back.gif', side: 'Jenna_Right.gif' },\n};\n\nconst DEFAULT_POSE = ISAAC_POSE;\n\nfunction protagonistPath(file: string): string {\n  return `${PROTAGONIST_BASE_PATH}/${file}`;\n}\n\nfunction getPoseConfig(baseName: string): ProtagonistPoseConfig {\n  return PROTAGONIST_POSES[baseName] ?? DEFAULT_POSE;\n}\n\nexport function getPlayerSprite(unitId: string, direction: Direction): string {\n  const baseName = PLAYER_UNIT_TO_SPRITE[unitId] || 'Isaac';\n  const poseConfig = getPoseConfig(baseName);\n\n  const poseFile = (() => {\n    switch (direction) {\n      case 'up':\n        return poseConfig.back;\n      case 'down':\n        return poseConfig.front;\n      case 'right':\n      case 'left':\n        return poseConfig.side;\n      default:\n        return poseConfig.front;\n    }\n  })();\n\n  return protagonistPath(poseFile);\n}\n\n/**\n * Maps NPC types/roles to sprite IDs\n *\n * Available NPC categories:\n * - majornpcs/: Story NPCs (Saturos, Menardi, Kraden, etc.)\n * - minornpcs/: Villagers, guards, merchants (50+ variants)\n * - minornpcs_2/: Additional villager variety\n */\nconst NPC_ROLE_TO_FILE = {\n  elder: 'Elder.gif',\n  merchant: 'Weaponshop_Owner.gif',\n  shopkeeper: 'Weaponshop_Keeper.gif',\n  villagerMale: 'Mr_Jerra.gif',\n  villagerFemale: 'Mrs_Jerra.gif',\n  guard: 'Thief1.gif',\n  enemy: 'Thief1.gif',\n  default: 'Innkeeper.gif',\n} as const;\n\nconst SPECIFIC_NPC_TO_FILE: Record<string, string> = {\n  'elder-vale': NPC_ROLE_TO_FILE.elder,\n  'shopkeeper-weapons': NPC_ROLE_TO_FILE.shopkeeper,\n  'tower-attendant': NPC_ROLE_TO_FILE.elder,\n  'djinn-guide': NPC_ROLE_TO_FILE.elder,\n};\n\nfunction npcPath(file: string): string {\n  return `${MAJOR_NPC_BASE_PATH}/${file}`;\n}\n\n/**\n * Get NPC sprite ID with fallback\n * Handles actual NPC IDs from map data (elder-vale, shopkeeper-weapons, villager-1, etc.)\n */\nexport function getNPCSprite(npcId: string): string {\n  const specificFile = SPECIFIC_NPC_TO_FILE[npcId];\n  if (specificFile) {\n    return npcPath(specificFile);\n  }\n\n  if (/house-\\d+-enemy/.test(npcId)) {\n    return npcPath(NPC_ROLE_TO_FILE.enemy);\n  }\n\n  if (npcId.includes('elder')) {\n    return npcPath(NPC_ROLE_TO_FILE.elder);\n  }\n\n  if (npcId.includes('shopkeeper') || npcId.includes('merchant')) {\n    return npcPath(NPC_ROLE_TO_FILE.merchant);\n  }\n\n  if (npcId.includes('blacksmith')) {\n    return npcPath(NPC_ROLE_TO_FILE.shopkeeper);\n  }\n\n  if (npcId.includes('guard')) {\n    return npcPath(NPC_ROLE_TO_FILE.guard);\n  }\n\n  // Handle villagers with variety (villager-1, villager-2, etc.)\n  if (npcId.includes('villager')) {\n    const match = npcId.match(/villager-(\\d+)/);\n    if (match && match[1]) {\n      const num = parseInt(match[1], 10);\n      const villagerFile = num % 2 === 0\n        ? NPC_ROLE_TO_FILE.villagerFemale\n        : NPC_ROLE_TO_FILE.villagerMale;\n      return npcPath(villagerFile);\n    }\n    return npcPath(NPC_ROLE_TO_FILE.villagerMale);\n  }\n\n  return npcPath(NPC_ROLE_TO_FILE.default);\n}\n\n/**\n * Maps scenery object types to sprite IDs\n */\nexport const SCENERY_SPRITE_MAP: Record<string, string> = {\n  'chest': 'chest',\n  'chest-open': 'chest_open',\n  'door': 'door2',\n  'sign': 'sign',\n  'sign-weapon-shop': 'WepShop_Sign',\n  'sign-potion-shop': 'PotionShop_Sign',\n  'barrel': 'barrel1',\n  'crate': 'box4',\n  'stump': 'stump1',\n  'stone': 'stone3',\n  'fence': 'Fence_HorizSeg',\n};\n\n/**\n * Get scenery sprite ID with fallback\n */\nexport function getScenerySprite(sceneryType: string): string | null {\n  return SCENERY_SPRITE_MAP[sceneryType] || null;\n}\n\n/**\n * Helper: Check if a direction requires sprite mirroring\n */\nexport function shouldMirrorSprite(direction: Direction): boolean {\n  return direction === 'left';\n}\n\n/**\n * Tile type definitions (matches mapSchema.ts)\n */\nexport type TileType = 'grass' | 'path' | 'water' | 'wall' | 'door' | 'npc' | 'trigger';\n\n/**\n * Get tile sprite ID (null means use CSS color fallback)\n */\nexport function getTileSprite(tileType: TileType): string | null {\n  return TILE_SPRITE_MAP[tileType] || null;\n}\n","import { ENCOUNTERS } from '@/data/definitions/encounters';\n\n/**\n * Battle sprite mappings\n * Provides deterministic path IDs for battle unit rendering.\n *\n * The mapping only references actual GIFs that ship with the repo. Missing units\n * or enemies return `null`, allowing `BattleUnitSprite` to show a placeholder.\n */\n\nexport type BattleSpriteState = 'idle' | 'attack' | 'hit';\n\ntype SpriteStateMap = Record<BattleSpriteState, string>;\n\nconst EARLY_HOUSE_MAX = 5;\nconst EARLY_SPECIAL_ENCOUNTERS = new Set(['vs1-garet']);\n\nfunction isEarlyEncounterId(encounterId: string): boolean {\n  const match = encounterId.match(/^house-(\\d+)/);\n  if (match) {\n    return Number(match[1]) <= EARLY_HOUSE_MAX;\n  }\n  return EARLY_SPECIAL_ENCOUNTERS.has(encounterId);\n}\n\nfunction collectEarlyEnemyIds(): string[] {\n  const ids = new Set<string>();\n  for (const [encounterId, encounter] of Object.entries(ENCOUNTERS)) {\n    if (!isEarlyEncounterId(encounterId)) {\n      continue;\n    }\n    encounter.enemies.forEach(enemyId => ids.add(enemyId));\n  }\n  return Array.from(ids).sort();\n}\n\nfunction makePlayerSpritePaths(character: 'Isaac' | 'Garet' | 'Ivan' | 'Mia', weapon: 'lBlade' | 'Axe' | 'Staff' | 'Mace'): SpriteStateMap {\n  const base = `/sprites/battle/party/${character.toLowerCase()}/${character}_${weapon}`;\n  return {\n    idle: `${base}_Back.gif`,\n    attack: `${base}_Attack1.gif`,\n    hit: `${base}_HitBack.gif`,\n  };\n}\n\nfunction makeSinglePose(path: string): SpriteStateMap {\n  return {\n    idle: path,\n    attack: path,\n    hit: path,\n  };\n}\n\nconst PLAYER_SPRITES: Record<string, SpriteStateMap> = {\n  // Canonical roster\n  'adept': makePlayerSpritePaths('Isaac', 'lBlade'),\n  'war-mage': makePlayerSpritePaths('Garet', 'Axe'),\n  'mystic': makePlayerSpritePaths('Mia', 'Staff'),\n  'ranger': makePlayerSpritePaths('Ivan', 'Staff'),\n  'sentinel': makePlayerSpritePaths('Isaac', 'lBlade'),\n  'blaze': makePlayerSpritePaths('Garet', 'Axe'),\n  'karis': makePlayerSpritePaths('Mia', 'Staff'),\n  'tyrell': makePlayerSpritePaths('Garet', 'Axe'),\n  'stormcaller': makePlayerSpritePaths('Ivan', 'Staff'),\n  'felix': makePlayerSpritePaths('Isaac', 'lBlade'),\n  'tower-champion': makePlayerSpritePaths('Isaac', 'lBlade'),\n\n  // Development/test units map onto the starter party for visuals\n  'test-warrior-1': makePlayerSpritePaths('Isaac', 'lBlade'),\n  'test-warrior-2': makePlayerSpritePaths('Garet', 'Axe'),\n  'test-warrior-3': makePlayerSpritePaths('Mia', 'Staff'),\n  'test-warrior-4': makePlayerSpritePaths('Ivan', 'Staff'),\n};\n\nconst ENEMY_SPRITES: Record<string, SpriteStateMap> = {\n  // Test goblins + tutorial encounters\n  'enemy-1': makeSinglePose('/sprites/battle/enemies/Goblin.gif'),\n  'enemy-2': makeSinglePose('/sprites/battle/enemies/Alec_Goblin.gif'),\n  'garet-enemy': makeSinglePose('/sprites/battle/enemies/Brigand.gif'),\n  'war-mage': makeSinglePose('/sprites/battle/enemies/Brigand.gif'),\n\n  // Houses 2-5 (Act 1 focus)\n  'earth-scout': makeSinglePose('/sprites/battle/enemies/Goblin.gif'),\n  'venus-wolf': makeSinglePose('/sprites/battle/enemies/Wild_Wolf.gif'),\n  'venus-beetle': makeSinglePose('/sprites/battle/enemies/Punch_Ant.gif'),\n  'flame-scout': makeSinglePose('/sprites/battle/enemies/Hobgoblin.gif'),\n  'mars-wolf': makeSinglePose('/sprites/battle/enemies/Dire_Wolf.gif'),\n  'frost-scout': makeSinglePose('/sprites/battle/enemies/Mini-Goblin.gif'),\n  'mercury-wolf': makeSinglePose('/sprites/battle/enemies/Wolfkin.gif'),\n  'gale-scout': makeSinglePose('/sprites/battle/enemies/Alec_Goblin.gif'),\n  'jupiter-wolf': makeSinglePose('/sprites/battle/enemies/Wolfkin_Cub.gif'),\n  'terra-soldier': makeSinglePose('/sprites/battle/enemies/Stone_Soldier.gif'),\n  'venus-bear': makeSinglePose('/sprites/battle/enemies/Grizzly.gif'),\n  'wind-soldier': makeSinglePose('/sprites/battle/enemies/Tornado_Lizard.gif'),\n  'jupiter-bear': makeSinglePose('/sprites/battle/enemies/Grizzly.gif'),\n  'tide-soldier': makeSinglePose('/sprites/battle/enemies/Merman.gif'),\n  'mercury-bear': makeSinglePose('/sprites/battle/enemies/Grizzly.gif'),\n  'ice-elemental': makeSinglePose('/sprites/battle/enemies/Ice_Gargoyle.gif'),\n  'blaze-soldier': makeSinglePose('/sprites/battle/enemies/Salamander.gif'),\n  'mars-bear': makeSinglePose('/sprites/battle/enemies/Grizzly.gif'),\n  'flame-elemental': makeSinglePose('/sprites/battle/enemies/Fire_Worm.gif'),\n  'stone-captain': makeSinglePose('/sprites/battle/enemies/Living_Statue.gif'),\n  'rock-elemental': makeSinglePose('/sprites/battle/enemies/Earth_Golem.gif'),\n  'inferno-captain': makeSinglePose('/sprites/battle/enemies/Grand_Chimera.gif'),\n  'phoenix': makeSinglePose('/sprites/battle/enemies/Phoenix.gif'),\n  'glacier-captain': makeSinglePose('/sprites/battle/enemies/Ice_Gargoyle.gif'),\n  'blizzard-warlord': makeSinglePose('/sprites/battle/enemies/Ice_Gargoyle.gif'),\n  'leviathan': makeSinglePose('/sprites/battle/enemies/Man_o_War.gif'),\n  'thunder-captain': makeSinglePose('/sprites/battle/enemies/Thunder_Lizard.gif'),\n  'thunderbird': makeSinglePose('/sprites/battle/enemies/Roc.gif'),\n  'lightning-commander': makeSinglePose('/sprites/battle/enemies/Thunder_Lizard.gif'),\n  'storm-elemental': makeSinglePose('/sprites/battle/enemies/Tornado_Lizard.gif'),\n  'mountain-commander': makeSinglePose('/sprites/battle/enemies/Grand_Golem.gif'),\n  'granite-warlord': makeSinglePose('/sprites/battle/enemies/Grand_Golem.gif'),\n  'basilisk': makeSinglePose('/sprites/battle/enemies/Lizard_King.gif'),\n  'fire-commander': makeSinglePose('/sprites/battle/enemies/Red_Demon.gif'),\n  'volcano-warlord': makeSinglePose('/sprites/battle/enemies/Grand_Chimera.gif'),\n  'storm-commander': makeSinglePose('/sprites/battle/enemies/Tornado_Lizard.gif'),\n  'hydra': makeSinglePose('/sprites/battle/enemies/Hydra.gif'),\n  'overseer': makeSinglePose('/sprites/battle/enemies/Chimera.gif'),\n  'chimera': makeSinglePose('/sprites/battle/enemies/Chimera.gif'),\n  'tempest-warlord': makeSinglePose('/sprites/battle/enemies/Thunder_Lizard.gif'),\n\n  // Existing misc mappings\n  'bandit-minion': makeSinglePose('/sprites/battle/enemies/Thief.gif'),\n  'bandit-captain': makeSinglePose('/sprites/battle/enemies/Brigand.gif'),\n  'sentinel-enemy': makeSinglePose('/sprites/battle/enemies/Living_Armor.gif'),\n  'stormcaller-enemy': makeSinglePose('/sprites/battle/enemies/Ghost_Mage.gif'),\n  'mercury-slime': makeSinglePose('/sprites/battle/enemies/Slime.gif'),\n  'mars-bandit': makeSinglePose('/sprites/battle/enemies/Brigand.gif'),\n  'mars-sprite': makeSinglePose('/sprites/battle/enemies/Spirit.gif'),\n  'mercury-sprite': makeSinglePose('/sprites/battle/enemies/Will_Head.gif'),\n  'venus-sprite': makeSinglePose('/sprites/battle/enemies/Faery.gif'),\n  'jupiter-sprite': makeSinglePose('/sprites/battle/enemies/Pixie.gif'),\n};\n\nexport const EARLY_GAME_ENEMY_IDS = collectEarlyEnemyIds();\nexport const EARLY_HOUSE_THRESHOLD = EARLY_HOUSE_MAX;\n\n/**\n * Resolve a player unit battle sprite.\n */\nexport function getPlayerBattleSprite(unitId: string, state: BattleSpriteState): string | null {\n  const spriteMap = PLAYER_SPRITES[unitId];\n  if (!spriteMap) {\n    return null;\n  }\n  return spriteMap[state] ?? null;\n}\n\n/**\n * Resolve an enemy battle sprite.\n */\nexport function getEnemyBattleSprite(enemyId: string, state: BattleSpriteState): string | null {\n  const spriteMap = ENEMY_SPRITES[enemyId];\n  if (!spriteMap) {\n    return null;\n  }\n  return spriteMap[state] ?? null;\n}\n\n/**\n * Inspectable ids for tests / tooling.\n */\nexport const KNOWN_PLAYER_BATTLE_UNITS = Object.keys(PLAYER_SPRITES);\nexport const KNOWN_ENEMY_BATTLE_UNITS = Object.keys(ENEMY_SPRITES);\n","import { useEffect } from 'preact/hooks';\nimport { MAPS } from '@/data/definitions/maps';\nimport { useStore } from '../state/store';\nimport { useGameStore } from '../../store/gameStore';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport { getPlayerSprite, shouldMirrorSprite, getNPCSprite } from '../sprites/mappings';\nimport { warnIfPlaceholderSprite } from '../sprites/utils/warnIfPlaceholderSprite';\nimport { getTriggerAt } from '@/core/services/OverworldService';\nimport { isHouseUnlocked } from '@/core/services/StoryService';\nimport type { Tile, Position } from '@/core/models/overworld';\nimport './OverworldMap.css';\n\nexport function OverworldMap() {\n  // Use gameStore for screen navigation state\n  const screen = useGameStore((s) => s.flow.screen);\n  const modal = useGameStore((s) => s.flow.modal);\n\n  const startTransition = useGameStore((s) => s.startTransition);\n  const openModal = useGameStore((s) => s.openModal);\n  const closeModal = useGameStore((s) => s.closeModal);\n\n  // Use V1 store for domain state (overworld data)\n  const { currentMapId, playerPosition, facing, movePlayer, currentTrigger, clearTrigger, teleportPlayer, resetLastTrigger, team, mode, handleTrigger, story } = useStore(state => ({\n    currentMapId: state.currentMapId,\n    playerPosition: state.playerPosition,\n    facing: state.facing,\n    movePlayer: state.movePlayer,\n    currentTrigger: state.currentTrigger,\n    clearTrigger: state.clearTrigger,\n    teleportPlayer: state.teleportPlayer,\n    resetLastTrigger: state.resetLastTrigger,\n    team: state.team,\n    mode: state.mode,\n    handleTrigger: state.handleTrigger,\n    story: state.story,\n  }));\n\n  // Sync V1 store's mode to V2 gameStore screen/modal when mode changes\n  useEffect(() => {\n    if (mode === 'team-select') {\n      startTransition('team-select');\n    } else if (mode === 'battle') {\n      startTransition('battle');\n    } else if (mode === 'shop') {\n      startTransition('shop');\n    } else if (mode === 'rewards') {\n      startTransition('rewards');\n    } else if (mode === 'dialogue') {\n      openModal('dialogue');\n    } else if (mode === 'overworld') {\n      // Close any open modal when returning to overworld (e.g., after dialogue ends)\n      closeModal();\n    }\n  }, [mode, startTransition, openModal, closeModal]);\n\n  const map = MAPS[currentMapId];\n\n  // Helper function to get adjacent positions based on facing direction\n  const getInteractionPosition = (): Position => {\n    const delta: Record<'up' | 'down' | 'left' | 'right', Position> = {\n      up: { x: 0, y: -1 },\n      down: { x: 0, y: 1 },\n      left: { x: -1, y: 0 },\n      right: { x: 1, y: 0 },\n    };\n    return {\n      x: playerPosition.x + delta[facing].x,\n      y: playerPosition.y + delta[facing].y,\n    };\n  };\n\n  // Handle space/enter interaction with NPCs\n  const handleInteraction = () => {\n    if (!map) return;\n\n    // Check for trigger at current position (player is on the same tile as NPC)\n    let trigger = getTriggerAt(map, playerPosition);\n\n    // If no trigger at current position, check adjacent position (facing the NPC)\n    if (!trigger) {\n      const facingPos = getInteractionPosition();\n      trigger = getTriggerAt(map, facingPos);\n    }\n\n    if (!trigger) return;\n\n    // Apply the same filtering logic as movePlayer for battle triggers\n    let shouldTrigger = true;\n    if (trigger.type === 'battle') {\n      const encounterId = (trigger.data as { encounterId?: string }).encounterId;\n      if (encounterId) {\n        // Skip defeated encounters (liberation encounters are one-time only)\n        if (story.flags[encounterId] === true) {\n          shouldTrigger = false;\n        }\n        // Skip locked encounters (progressive unlock system)\n        else if (!isHouseUnlocked(story, encounterId)) {\n          shouldTrigger = false;\n        }\n      }\n    }\n\n    // Only trigger if it passed the filters\n    if (shouldTrigger) {\n      handleTrigger(trigger);\n    }\n  };\n\n  useEffect(() => {\n    // Only listen when on overworld screen with no modal open\n    if (screen !== 'overworld' || modal !== null) return;\n\n    const handleKeyDown = (event: KeyboardEvent) => {\n      // Only handle movement when in overworld mode (not during dialogue, shops, etc.)\n      if (screen !== 'overworld' || modal !== null) return;\n\n      if (event.key === 'ArrowUp') {\n        event.preventDefault();\n        movePlayer('up');\n      } else if (event.key === 'ArrowDown') {\n        event.preventDefault();\n        movePlayer('down');\n      } else if (event.key === 'ArrowLeft') {\n        event.preventDefault();\n        movePlayer('left');\n      } else if (event.key === 'ArrowRight') {\n        event.preventDefault();\n        movePlayer('right');\n      } else if (event.key === ' ' || event.key === 'Enter') {\n        event.preventDefault();\n        handleInteraction();\n      } else if (event.key === 'Escape') {\n        event.preventDefault();\n        openModal('pause');\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [movePlayer, openModal, screen, modal, playerPosition, facing, map, handleTrigger, story]);\n\n\n  useEffect(() => {\n    if (!currentTrigger) return;\n\n    if (currentTrigger.type === 'transition') {\n      const data = currentTrigger.data as { targetMap?: string; targetPos?: Position };\n      if (data.targetMap && data.targetPos) {\n        teleportPlayer(data.targetMap, data.targetPos);\n      }\n    }\n\n    clearTrigger();\n    resetLastTrigger();\n  }, [currentTrigger, clearTrigger, teleportPlayer, resetLastTrigger]);\n\n  if (!map) {\n    return <div>No overworld map loaded.</div>;\n  }\n\n  // Calculate encounter rate display\n  const encounterRatePercent = map.encounterRate ? Math.round(map.encounterRate * 100) : 0;\n  const hasRandomEncounters = map.encounterRate && map.encounterPool && map.encounterPool.length > 0;\n\n  return (\n    <div class=\"overworld-shell\">\n      <div class=\"location-banner\">\n        <div class=\"location-title\">{map.name}</div>\n        <div class=\"location-meta\">\n          {hasRandomEncounters && (\n            <span class=\"location-chip\">Encounters {encounterRatePercent}%</span>\n          )}\n          <span class=\"location-chip location-chip--ghost\">ESC for pause menu</span>\n        </div>\n      </div>\n\n      <div class=\"overworld-stage\">\n        <div class=\"overworld-container\">\n          {map.tiles.map((row, y) => (\n            <div key={y} class=\"tile-row\">\n              {row.map((tile: Tile, x) => {\n                const isPlayer = playerPosition.x === x && playerPosition.y === y;\n\n                // Find NPC at this position\n                const npcAtPosition = map.npcs.find(npc =>\n                  npc.position.x === x && npc.position.y === y\n                );\n\n                return (\n                  <div\n                    key={`${x}-${y}`}\n                    class={`tile tile-${tile.type}`}\n                    style={{\n                      backgroundImage:\n                        tile.spriteId && (tile.spriteId.startsWith('/') || tile.spriteId.startsWith('http'))\n                          ? `url(${tile.spriteId})`\n                          : undefined,\n                      position: 'relative',\n                    }}\n                    data-sprite={tile.spriteId ?? undefined}\n                  >\n                    {/* NPC Sprite */}\n                    {npcAtPosition && !isPlayer && (\n                      <SimpleSprite\n                        id={(() => {\n                          const directSpriteId = npcAtPosition.spriteId;\n                          const resolvedSpriteId = directSpriteId && (directSpriteId.startsWith('/') || directSpriteId.startsWith('http'))\n                            ? directSpriteId\n                            : getNPCSprite(npcAtPosition.id);\n                          warnIfPlaceholderSprite('OverworldMap', resolvedSpriteId);\n                          return resolvedSpriteId;\n                        })()}\n                        width={32}\n                        height={32}\n                        style={{\n                          position: 'absolute',\n                          top: 0,\n                          left: 0,\n                          zIndex: 2, // Above tiles, below player\n                        }}\n                      />\n                    )}\n\n                    {/* Player Sprite */}\n                    {isPlayer && team && team.units[0] && (\n                      <SimpleSprite\n                        id={(() => {\n                          const playerSpriteId = getPlayerSprite(team.units[0].id, facing);\n                          warnIfPlaceholderSprite('OverworldMap', playerSpriteId);\n                          return playerSpriteId;\n                        })()}\n                        width={32}\n                        height={32}\n                        style={{\n                          position: 'absolute',\n                          top: 0,\n                          left: 0,\n                          zIndex: 3, // Above NPCs\n                          transform: shouldMirrorSprite(facing) ? 'scaleX(-1)' : 'none',\n                        }}\n                      />\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * Event text renderer\n * Converts BattleEvent discriminated union to display strings\n */\n\nimport { DJINN } from '../../data/definitions/djinn';\nimport type { BattleEvent } from '../../core/services/types';\n\nexport function renderEventText(e: BattleEvent): string {\n  switch (e.type) {\n    case 'turn-start':\n      return `Turn ${e.turn}  ${e.actorId}`;\n    case 'ability':\n      return `${e.casterId} used ${e.abilityId}`;\n    case 'hit':\n      return `${e.targetId} took ${e.amount}${e.element ? ` [${e.element}]` : ''}`;\n    case 'heal':\n      return `${e.targetId} recovered ${e.amount} HP`;\n    case 'auto-heal':\n      return ` ${e.message}`;\n    case 'mana-generated':\n      return ` ${e.source} generated +${e.amount} mana! (${e.newTotal} total)`;\n    case 'status-applied': {\n      const statusNames: Record<string, string> = {\n        poison: 'Poisoned',\n        burn: 'Burned',\n        freeze: 'Frozen',\n        paralyze: 'Paralyzed',\n      };\n      const statusName = statusNames[e.status.type] || e.status.type;\n      return `${e.targetId} is ${statusName}!`;\n    }\n    case 'status-expired': {\n      const recoveryNames: Record<string, string> = {\n        poison: 'Poison',\n        burn: 'Burn',\n        freeze: 'Freeze',\n        paralyze: 'Paralysis',\n      };\n      const recoveryName = recoveryNames[e.status.type] || e.status.type;\n      return `${e.targetId} recovered from ${recoveryName}`;\n    }\n    case 'ko':\n      return `${e.unitId} is down!`;\n    case 'xp':\n      return `${e.unitId} gained ${e.xp} XP${e.levelUp ? ` (Lv ${e.levelUp.to})` : ''}`;\n    case 'battle-end':\n      return `Battle ended: ${e.result}`;\n    case 'encounter-finished':\n      return `Encounter completed: ${e.outcome}`;\n    case 'djinn-standby':\n    case 'djinn-recovered': {\n      const djinnNames = e.djinnIds\n        .map((id) => DJINN[id]?.name ?? id)\n        .filter(Boolean)\n        .join(', ') || 'Djinn';\n      const stateText = e.type === 'djinn-standby' ? 'Standby' : 'Recovered';\n      const formatDelta = (value: number) => (value >= 0 ? `+${value}` : `${value}`);\n      return `${djinnNames} ${stateText}  ${e.unitId} ATK ${formatDelta(e.atkDelta)}, DEF ${formatDelta(e.defDelta)}`;\n    }\n    default: {\n      // Exhaustive check - ensures all event types are handled\n      const _exhaustive: never = e;\n      console.warn(`Unhandled event type:`, _exhaustive);\n      return '';\n    }\n  }\n}\n","/**\n * Battle log component\n * Displays battle events as they occur\n */\n\nimport type { BattleEvent } from '../../core/services/types';\n\ninterface BattleLogProps {\n  events: readonly BattleEvent[];\n  renderText: (event: BattleEvent) => string;\n}\n\nexport function BattleLog({ events, renderText }: BattleLogProps) {\n  // Throttle announcements for accessibility (batch adjacent events)\n  const announcementText = events.length > 0\n    ? events.slice(0, 3).map(renderText).join('. ') // Announce first 3 events\n    : '';\n\n  return (\n    <div\n      className=\"battle-log\"\n      role=\"log\"\n      aria-live=\"polite\"\n      aria-label=\"Battle log\"\n      style={{\n        marginTop: '1rem',\n        padding: '1rem',\n        backgroundColor: '#1e1e1e',\n        color: '#fff',\n        borderRadius: '4px',\n        maxHeight: '200px',\n        overflowY: 'auto',\n      }}\n    >\n      <h4 style={{ marginTop: 0 }}>Battle Log</h4>\n      <div style={{ display: 'flex', flexDirection: 'column', gap: '0.25rem' }}>\n        {events.length === 0 ? (\n          <div style={{ color: '#888', fontStyle: 'italic' }}>No events yet...</div>\n        ) : (\n          events.map((event, index) => (\n            <div\n              key={index}\n              style={{\n                fontSize: '0.875rem',\n                padding: '0.25rem',\n                backgroundColor: index === 0 ? '#333' : 'transparent',\n                borderRadius: '2px',\n              }}\n            >\n              {renderText(event)}\n            </div>\n          ))\n        )}\n      </div>\n      {/* Hidden announcement for screen readers */}\n      {announcementText && (\n        <div aria-hidden=\"true\" style={{ position: 'absolute', left: '-9999px' }}>\n          {announcementText}\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * PostBattleCutscene Component\n * Simplified version - shows generic victory/defeat message\n * Future: Add NPC-specific dialogue when NPC system exists\n */\n\nimport { useEffect, useState } from 'preact/hooks';\nimport './PostBattleCutscene.css';\n\ninterface PostBattleCutsceneProps {\n  victory: boolean;\n  onComplete: () => void;\n}\n\nexport function PostBattleCutscene({ victory, onComplete }: PostBattleCutsceneProps) {\n  const [currentMessageIndex, setCurrentMessageIndex] = useState(0);\n\n  // Generic messages (no NPC system yet)\n  const messages = victory\n    ? [\n        'You are victorious!',\n        'The enemies have been defeated!',\n        'Your skills have improved from this battle.',\n      ]\n    : [\n        'Your party has been defeated...',\n        'You must retreat and recover.',\n      ];\n\n  const currentMessage = messages[currentMessageIndex];\n  const isLastMessage = currentMessageIndex === messages.length - 1;\n\n  // Auto-advance after delay or wait for player input\n  const handleAdvance = () => {\n    if (isLastMessage) {\n      onComplete();\n    } else {\n      setCurrentMessageIndex(prev => prev + 1);\n    }\n  };\n\n  // Keyboard controls\n  useEffect(() => {\n    const handleKeyPress = (e: KeyboardEvent) => {\n      if (e.key === 'Enter' || e.key === ' ') {\n        e.preventDefault();\n        e.stopPropagation();\n        handleAdvance();\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyPress);\n    return () => window.removeEventListener('keydown', handleKeyPress);\n  }, [currentMessageIndex, isLastMessage, onComplete]);\n\n  return (\n    <div className={`post-battle-cutscene ${victory ? 'victory' : 'defeat'}`}>\n      <div className=\"cutscene-container\">\n        {/* Background effect */}\n        <div className=\"cutscene-background\">\n          {victory && (\n            <div className=\"victory-particles\"></div>\n          )}\n        </div>\n\n        {/* Message Box */}\n        <div className=\"cutscene-message-box\">\n          <div className=\"cutscene-header\">\n            <h2>{victory ? 'VICTORY' : 'DEFEAT'}</h2>\n          </div>\n\n          <div className=\"cutscene-content\">\n            <p className=\"cutscene-text\">{currentMessage}</p>\n          </div>\n\n          <div className=\"cutscene-footer\">\n            <div className=\"progress-indicator\">\n              {messages.map((_, index) => (\n                <span\n                  key={index}\n                  className={`progress-dot ${index === currentMessageIndex ? 'active' : ''} ${index < currentMessageIndex ? 'completed' : ''}`}\n                />\n              ))}\n            </div>\n\n            <button\n              onClick={handleAdvance}\n              className=\"cutscene-button\"\n              aria-label={isLastMessage ? 'Continue to rewards' : 'Next message'}\n            >\n              {isLastMessage ? (victory ? 'CLAIM REWARDS' : 'RETURN') : 'CONTINUE'}\n            </button>\n          </div>\n\n          <div className=\"cutscene-hint\">\n            Press [ENTER] or [SPACE] to continue\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * VictoryOverlay Component\n * Displays victory fanfare animation after battle win\n */\n\nimport { useEffect, useState } from 'preact/hooks';\nimport './VictoryOverlay.css';\n\ninterface VictoryOverlayProps {\n  onComplete: () => void;\n  duration?: number; // Default 2000ms\n}\n\nexport function VictoryOverlay({ onComplete, duration = 2000 }: VictoryOverlayProps) {\n  const [stage, setStage] = useState<'fanfare' | 'sparkles' | 'complete'>('fanfare');\n\n  useEffect(() => {\n    const fanfareTimer = setTimeout(() => {\n      setStage('sparkles');\n    }, 800);\n\n    const completeTimer = setTimeout(() => {\n      setStage('complete');\n      onComplete();\n    }, duration);\n\n    return () => {\n      clearTimeout(fanfareTimer);\n      clearTimeout(completeTimer);\n    };\n  }, [duration, onComplete]);\n\n  if (stage === 'complete') return null;\n\n  return (\n    <div className=\"victory-overlay\">\n      <div className=\"victory-flash\" />\n      <div className=\"victory-text\">\n        <h1 className=\"victory-title\">VICTORY!</h1>\n        <div className=\"victory-stars\">\n          <span className=\"star star-1\">*</span>\n          <span className=\"star star-2\">*</span>\n          <span className=\"star star-3\">*</span>\n        </div>\n      </div>\n      {stage === 'sparkles' && (\n        <div className=\"victory-particles\">\n          {[...Array(20)].map((_, i) => (\n            <div\n              key={i}\n              className=\"particle\"\n              style={{\n                left: `${Math.random() * 100}%`,\n                animationDelay: `${Math.random() * 0.5}s`,\n                animationDuration: `${1 + Math.random()}s`\n              }}\n            />\n          ))}\n        </div>\n      )}\n    </div>\n  );\n}\n","/**\n * DefeatOverlay Component\n * Displays defeat animation after battle loss\n */\n\nimport { useEffect, useState } from 'preact/hooks';\nimport './DefeatOverlay.css';\n\ninterface DefeatOverlayProps {\n  onComplete: () => void;\n  duration?: number;\n}\n\nexport function DefeatOverlay({ onComplete, duration = 2500 }: DefeatOverlayProps) {\n  const [stage, setStage] = useState<'fadeIn' | 'text' | 'complete'>('fadeIn');\n\n  useEffect(() => {\n    const textTimer = setTimeout(() => {\n      setStage('text');\n    }, 500);\n\n    const completeTimer = setTimeout(() => {\n      setStage('complete');\n      onComplete();\n    }, duration);\n\n    return () => {\n      clearTimeout(textTimer);\n      clearTimeout(completeTimer);\n    };\n  }, [duration, onComplete]);\n\n  if (stage === 'complete') return null;\n\n  return (\n    <div class=\"defeat-overlay\">\n      <div class=\"defeat-vignette\" />\n      <div class=\"defeat-text\">\n        <h1 class=\"defeat-title\">DEFEAT...</h1>\n        <p class=\"defeat-subtitle\">Your party has fallen.</p>\n      </div>\n      <button class=\"defeat-continue\" onClick={onComplete}>\n        Continue\n      </button>\n    </div>\n  );\n}\n","interface BattleManaBarProps {\n  currentMana: number;\n  maxMana: number;\n  pendingThisRound: number;\n  pendingNextRound: number;\n}\n\nexport function BattleManaBar({\n  currentMana,\n  maxMana,\n  pendingThisRound,\n  pendingNextRound,\n}: BattleManaBarProps) {\n  const circles = Array.from({ length: maxMana }, (_, idx) => {\n    if (idx < currentMana) return 'solid' as const;\n    if (idx < currentMana + pendingThisRound) return 'pending' as const;\n    return 'empty' as const;\n  });\n\n  return (\n    <div\n      style={{\n        display: 'flex',\n        alignItems: 'center',\n        gap: 8,\n        background: 'rgba(0,0,0,0.7)',\n        padding: '6px 12px',\n        borderRadius: 6,\n        border: '2px solid rgba(255,215,0,0.5)',\n        boxShadow: '0 2px 8px rgba(0,0,0,0.5)',\n      }}\n      aria-label={`Mana ${currentMana}/${maxMana}`}\n    >\n      <span style={{\n        color: '#ffd87f',\n        fontSize: '0.75rem',\n        fontWeight: 700,\n        textShadow: '1px 1px 2px #000',\n        letterSpacing: '0.5px',\n      }}>\n        MANA\n      </span>\n      <div\n        style={{\n          display: 'flex',\n          gap: 4,\n          alignItems: 'center',\n        }}\n      >\n        {circles.map((state, idx) => (\n          <div\n            key={idx}\n            style={{\n              width: 14,\n              height: 14,\n              borderRadius: '50%',\n              border: '2px solid rgba(255, 215, 0, 0.7)',\n              backgroundColor:\n                state === 'solid'\n                  ? '#FFD54A'\n                  : state === 'pending'\n                    ? 'rgba(255, 213, 74, 0.4)'\n                    : 'rgba(0,0,0,0.5)',\n              boxShadow: state === 'solid'\n                ? '0 0 6px rgba(255,215,0,0.8), inset 0 -2px 4px rgba(0,0,0,0.3)'\n                : state === 'pending'\n                  ? '0 0 4px rgba(255,215,0,0.4)'\n                  : 'inset 0 2px 4px rgba(0,0,0,0.5)',\n              transition: 'all 0.2s ease',\n            }}\n            title={\n              state === 'solid'\n                ? 'Available mana'\n                : state === 'pending'\n                  ? 'Pending this round'\n                  : 'Empty'\n            }\n          />\n        ))}\n      </div>\n      {pendingNextRound > 0 && (\n        <span style={{\n          fontSize: '0.75rem',\n          color: '#90EE90',\n          fontWeight: 600,\n          textShadow: '1px 1px 2px #000',\n        }}>\n          +{pendingNextRound}\n        </span>\n      )}\n    </div>\n  );\n}\n","import type { Unit } from '../../core/models/Unit';\nimport type { QueuedAction } from '../../core/models/BattleState';\nimport { calculateMaxHp } from '../../core/models/Unit';\n\ninterface BattlePortraitRowProps {\n  units: readonly Unit[];\n  activeIndex: number | null;\n  queuedActions: readonly (QueuedAction | null)[];\n  critCounters: Record<string, number>;\n  critThresholds: Record<string, number>;\n  critFlashes?: Record<string, boolean>;\n  onSelect?: (index: number) => void;\n}\n\nconst statusIconMap: Record<string, string> = {\n  burn: '/sprites/icons/misc/Poison.gif',\n  poison: '/sprites/icons/misc/Poison.gif',\n  paralyze: '/sprites/icons/misc/Psynergy_Seal.gif',\n  freeze: '/sprites/icons/misc/Haunted.gif',\n  stun: '/sprites/icons/misc/Exclamatory.gif',\n  buff: '/sprites/icons/misc/Stat-Up.gif',\n  debuff: '/sprites/icons/misc/Stat-Down.gif',\n  elementalResistance: '/sprites/icons/misc/Venus_Star.gif',\n  damageReduction: '/sprites/icons/misc/Stat-Up.gif',\n  shield: '/sprites/icons/misc/Stat-Up.gif',\n  invulnerable: '/sprites/icons/misc/Stat-Up.gif',\n  immunity: '/sprites/icons/misc/Stat-Up.gif',\n  autoRevive: '/sprites/icons/misc/Up_Arrow.gif',\n};\n\nfunction getPortraitSprite(unit: Unit): string {\n  // Prefer portrait headshots to keep the action UI focused and readable\n  const portraitDir = '/sprites/icons/characters';\n  const portraitByElement: Record<string, string> = {\n    Venus: 'Isaac1.gif',\n    Mars: 'Garet1.gif',\n    Mercury: 'Mia.gif',\n    Jupiter: 'Ivan.gif',\n  };\n  const portrait = portraitByElement[unit.element];\n  if (portrait) {\n    return `${portraitDir}/${portrait}`;\n  }\n\n  // Fallback to the battle sprite front pose if we don't have a portrait mapping\n  const baseDir = '/sprites/battle/party';\n  const fallback = { folder: 'isaac', prefix: 'Isaac', weapon: 'lSword' };\n  const sprite = fallback;\n  return `${baseDir}/${sprite.folder}/${sprite.prefix}_${sprite.weapon}_Front.gif`;\n}\n\nfunction StatusChips({ unit }: { unit: Unit }) {\n  const maxVisible = 3;\n  const effects = unit.statusEffects.slice(0, maxVisible);\n\n  return (\n    <div style={{ display: 'flex', gap: 4 }}>\n      {effects.map((status, idx) => (\n        <div\n          key={`${status.type}-${idx}`}\n          title={status.type}\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 2,\n            background: 'rgba(0,0,0,0.45)',\n            padding: '2px 4px',\n            borderRadius: 3,\n            border: '1px solid rgba(255,216,127,0.25)',\n            minWidth: 18,\n          }}\n        >\n          <img\n            src={statusIconMap[status.type] ?? '/sprites/icons/misc/Stat-Up.gif'}\n            alt={status.type}\n            width={14}\n            height={14}\n            style={{ imageRendering: 'pixelated' }}\n          />\n          <span style={{ fontSize: '0.7rem', color: '#f6e8b1' }}>\n            {'duration' in status && typeof status.duration === 'number'\n              ? status.duration\n              : 'remainingCharges' in status\n                ? status.remainingCharges\n                : ''}\n          </span>\n        </div>\n      ))}\n    </div>\n  );\n}\n\nexport function BattlePortraitRow({\n  units,\n  activeIndex,\n  queuedActions,\n  critCounters,\n  critThresholds,\n  critFlashes,\n  onSelect,\n}: BattlePortraitRowProps) {\n  return (\n    <div\n      style={{\n        display: 'flex',\n        gap: 6,\n        background: 'rgba(0,0,0,0.7)',\n        padding: '6px 8px',\n        border: '2px solid rgba(255,215,0,0.5)',\n        borderRadius: 8,\n        boxShadow: '0 4px 12px rgba(0,0,0,0.6)',\n      }}\n    >\n      {units.map((unit, idx) => {\n        const maxHp = calculateMaxHp(unit);\n        const hpPct = Math.max(0, Math.min(1, unit.currentHp / maxHp));\n        const critCount = critCounters[unit.id] ?? 0;\n        const critThreshold = critThresholds[unit.id] ?? 10;\n        const queued = queuedActions[idx] !== null;\n        const isActive = idx === activeIndex;\n        const flash = critFlashes?.[unit.id];\n\n        return (\n          <button\n            key={unit.id}\n            onClick={() => onSelect?.(idx)}\n            style={{\n              width: 56,\n              height: 56,\n              position: 'relative',\n              border: isActive ? '3px solid #FFD54A' : '2px solid rgba(255,215,0,0.3)',\n              borderRadius: 8,\n              padding: 0,\n              background: 'linear-gradient(180deg, #1a1a2e 0%, #0f0f18 100%)',\n              boxShadow: flash\n                ? '0 0 15px 4px rgba(255, 216, 74, 0.95), inset 0 0 10px rgba(255,215,0,0.3)'\n                : isActive\n                  ? '0 0 10px rgba(255, 216, 74, 0.7), inset 0 0 5px rgba(255,215,0,0.2)'\n                  : 'inset 0 2px 4px rgba(0,0,0,0.5)',\n              overflow: 'hidden',\n              cursor: onSelect ? 'pointer' : 'default',\n              transition: 'all 0.15s ease',\n            }}\n          >\n            <div\n              style={{\n                position: 'absolute',\n                top: 2,\n                right: 2,\n                fontSize: '0.65rem',\n                color: '#FFD54A',\n                background: 'rgba(0,0,0,0.85)',\n                padding: '1px 4px',\n                borderRadius: 3,\n                border: '1px solid #FFD54A',\n                fontWeight: 700,\n                textShadow: '0 0 4px rgba(255,215,0,0.8)',\n                letterSpacing: '-0.5px',\n              }}\n              title=\"Crit counter\"\n            >\n              {critCount}/{critThreshold}\n            </div>\n\n            {queued && (\n              <div\n                title=\"Queued (click to cancel)\"\n                style={{\n                  position: 'absolute',\n                  bottom: 4,\n                  right: 4,\n                  background: '#4CAF50',\n                  color: '#fff',\n                  width: 18,\n                  height: 18,\n                  display: 'flex',\n                  alignItems: 'center',\n                  justifyContent: 'center',\n                  fontSize: '0.75rem',\n                  borderRadius: 4,\n                  cursor: 'pointer',\n                  boxShadow: '0 0 4px rgba(76, 175, 80, 0.8)',\n                }}\n              >\n                OK\n              </div>\n            )}\n\n            <div\n              style={{\n                position: 'absolute',\n                bottom: 0,\n                left: 0,\n                width: '100%',\n                height: 6,\n                background: 'rgba(0,0,0,0.7)',\n                borderTop: '1px solid rgba(255,255,255,0.1)',\n              }}\n            >\n              <div\n                style={{\n                  width: `${hpPct * 100}%`,\n                  height: '100%',\n                  background: hpPct > 0.5\n                    ? 'linear-gradient(90deg, #4CAF50, #8BC34A)'\n                    : hpPct > 0.25\n                      ? 'linear-gradient(90deg, #FF9800, #FFC107)'\n                      : 'linear-gradient(90deg, #f44336, #FF5722)',\n                  transition: 'width 0.3s ease',\n                  boxShadow: '0 0 4px rgba(255,255,255,0.3)',\n                }}\n              />\n            </div>\n\n            <StatusChips unit={unit} />\n\n            <img\n              src={getPortraitSprite(unit)}\n              alt={`${unit.name} portrait`}\n              width={64}\n              height={64}\n              style={{\n                imageRendering: 'pixelated',\n                width: '100%',\n                height: '100%',\n                objectFit: 'contain',\n                background:\n                  'radial-gradient(circle at 50% 40%, rgba(255,255,255,0.08), transparent 60%)',\n              }}\n            />\n          </button>\n        );\n      })}\n    </div>\n  );\n}\n","import { useMemo, useState } from 'preact/hooks';\nimport type { BattleState } from '../../core/models/BattleState';\nimport type { Ability } from '../../data/schemas/AbilitySchema';\nimport type { Unit } from '../../core/models/Unit';\nimport { canAffordAction, getAbilityManaCost } from '../../core/algorithms/mana';\nimport { DJINN_ABILITIES } from '../../data/definitions/djinnAbilities';\nimport { getLockedDjinnAbilityMetadataForUnit } from '../../core/algorithms/djinnAbilities';\nimport { getSetDjinnIds } from '../../core/algorithms/djinn';\nimport { useStore } from '../state/store';\nimport { DJINN } from '../../data/definitions/djinn';\n\nconst ACTION_ICONS: Record<string, string> = {\n  attack: '/sprites/icons/buttons/Attack.gif',\n  abilities: '/sprites/icons/buttons/Psynergy.gif',\n  djinn: '/sprites/icons/buttons/Djinni.gif',\n  summon: '/sprites/icons/buttons/Summon.gif',\n  defend: '/sprites/icons/buttons/Defend.gif',\n};\n\n// Element star icons (fallback by element)\nconst ELEMENT_ICONS: Record<string, string> = {\n  Venus: '/sprites/icons/misc/Venus_Star.gif',\n  Mars: '/sprites/icons/misc/Mars_Star.gif',\n  Mercury: '/sprites/icons/misc/Mercury_Star.gif',\n  Jupiter: '/sprites/icons/misc/Jupiter_Star.gif',\n  Neutral: '/sprites/icons/buttons/Attack.gif',\n  neutral: '/sprites/icons/buttons/Psynergy.gif',\n};\n\n// Ability type icons (fallback by type)\nconst TYPE_ICONS: Record<string, string> = {\n  physical: '/sprites/icons/buttons/Attack.gif',\n  healing: '/sprites/icons/misc/Mercury_Star.gif',\n  buff: '/sprites/icons/misc/Stat-Up.gif',\n  debuff: '/sprites/icons/misc/Stat-Down.gif',\n  summon: '/sprites/icons/buttons/Summon.gif',\n  psynergy: '/sprites/icons/buttons/Psynergy.gif',\n};\n\n// Element theme colors for ability cards\nconst ELEMENT_COLORS: Record<string, { border: string; glow: string; bg: string }> = {\n  Venus: {\n    border: '#D4A855',\n    glow: 'rgba(212, 168, 85, 0.6)',\n    bg: 'rgba(139, 119, 42, 0.25)',\n  },\n  Mars: {\n    border: '#E85D3B',\n    glow: 'rgba(232, 93, 59, 0.6)',\n    bg: 'rgba(139, 54, 38, 0.25)',\n  },\n  Mercury: {\n    border: '#5BA3D4',\n    glow: 'rgba(91, 163, 212, 0.6)',\n    bg: 'rgba(42, 95, 139, 0.25)',\n  },\n  Jupiter: {\n    border: '#A855D4',\n    glow: 'rgba(168, 85, 212, 0.6)',\n    bg: 'rgba(95, 42, 139, 0.25)',\n  },\n  Neutral: {\n    border: '#888888',\n    glow: 'rgba(136, 136, 136, 0.4)',\n    bg: 'rgba(60, 60, 60, 0.25)',\n  },\n};\n\n// Target type icons/labels\nconst TARGET_LABELS: Record<string, { icon: string; label: string }> = {\n  'single-enemy': { icon: 'T', label: '1' },\n  'all-enemies': { icon: 'A', label: 'ALL' },\n  'single-ally': { icon: '+', label: '1' },\n  'all-allies': { icon: '++', label: 'ALL' },\n  self: { icon: '*', label: 'SELF' },\n};\n\n// Specific ability icons using psynergy animation GIFs\nconst ABILITY_ICONS: Record<string, string> = {\n  // Physical attacks\n  strike: '/sprites/icons/buttons/Attack.gif',\n  'heavy-strike': '/sprites/icons/buttons/Attack.gif',\n  'focus-strike': '/sprites/icons/buttons/Attack.gif',\n  'guard-break': '/sprites/icons/buttons/Attack.gif',\n  'precise-jab': '/sprites/icons/buttons/Attack.gif',\n\n  // Defensive\n  fortify: '/sprites/icons/buttons/Defend.gif',\n  'guardian-stance': '/sprites/icons/buttons/Defend.gif',\n  guard: '/sprites/icons/buttons/Defend.gif',\n  'stone-wall': '/sprites/icons/buttons/Defend.gif',\n  'iron-wall': '/sprites/icons/buttons/Defend.gif',\n\n  // Venus (Earth) psynergy\n  quake: '/sprites/psynergy/Grand_Gaia.gif',\n  tremor: '/sprites/psynergy/Grand_Gaia.gif',\n  'rock-breaker': '/sprites/psynergy/Grand_Gaia.gif',\n  earthquake: '/sprites/psynergy/Grand_Gaia.gif',\n  'earth-spike': '/sprites/psynergy/Grand_Gaia.gif',\n  'stone-fist': '/sprites/psynergy/Grand_Gaia.gif',\n  'granite-guard': '/sprites/psynergy/Grand_Gaia.gif',\n  'terra-break': '/sprites/psynergy/Grand_Gaia.gif',\n  nettle: '/sprites/psynergy/Nettle.gif',\n  'froth-spiral': '/sprites/psynergy/Froth_Spiral.gif',\n\n  // Mars (Fire) psynergy\n  fireball: '/sprites/psynergy/Heat_Wave.gif',\n  'flame-burst': '/sprites/psynergy/Dragon_Fire.gif',\n  'fire-burst': '/sprites/psynergy/Dragon_Fire.gif',\n  'dragon-fire': '/sprites/psynergy/Dragon_Fire.gif',\n  inferno: '/sprites/psynergy/Inferno.gif',\n  'inferno-blaze': '/sprites/psynergy/Inferno.gif',\n  'heat-wave': '/sprites/psynergy/Heat_Wave.gif',\n  supernova: '/sprites/psynergy/Supernova.gif',\n  pyroclasm: '/sprites/psynergy/Pyroclasm.gif',\n  fume: '/sprites/psynergy/Fume.gif',\n  'fiery-blast': '/sprites/psynergy/Fiery_Blast.gif',\n  'flame-strike': '/sprites/psynergy/Heat_Wave.gif',\n  scorch: '/sprites/psynergy/Heat_Wave.gif',\n  'ember-wave': '/sprites/psynergy/Heat_Wave.gif',\n\n  // Mercury (Ice/Water) psynergy\n  'ice-shard': '/sprites/psynergy/Ice_Missile.gif',\n  'ice-missile': '/sprites/psynergy/Ice_Missile.gif',\n  freeze: '/sprites/psynergy/Freeze_Prism.gif',\n  'freeze-blast': '/sprites/psynergy/Freeze_Prism.gif',\n  'freeze-prism': '/sprites/psynergy/Freeze_Prism.gif',\n  glacier: '/sprites/psynergy/Glacier.gif',\n  'glacial-wave': '/sprites/psynergy/Glacier.gif',\n  deluge: '/sprites/psynergy/Deluge.gif',\n  'aqua-pulse': '/sprites/psynergy/Deluge.gif',\n  'frost-storm': '/sprites/psynergy/Glacier.gif',\n  heal: '/sprites/icons/misc/Mercury_Star.gif',\n  'party-heal': '/sprites/icons/misc/Mercury_Star.gif',\n  cure: '/sprites/icons/misc/Mercury_Star.gif',\n\n  // Jupiter (Wind/Lightning) psynergy\n  gust: '/sprites/psynergy/Sonic_Slash.gif',\n  plasma: '/sprites/psynergy/Spark_Plasma.gif',\n  'spark-plasma': '/sprites/psynergy/Spark_Plasma.gif',\n  'chain-lightning': '/sprites/psynergy/Blue_Bolt.gif',\n  'blue-bolt': '/sprites/psynergy/Blue_Bolt.gif',\n  'destruct-ray': '/sprites/psynergy/Destruct_Ray.gif',\n  'sonic-slash': '/sprites/psynergy/Sonic_Slash.gif',\n  tempest: '/sprites/psynergy/Tempest.gif',\n  'gale-force': '/sprites/psynergy/Sonic_Slash.gif',\n  'storm-burst': '/sprites/psynergy/Spark_Plasma.gif',\n  'chain-gale': '/sprites/psynergy/Tempest.gif',\n\n  // Buffs\n  'boost-atk': '/sprites/icons/misc/Stat-Up.gif',\n  'boost-def': '/sprites/icons/misc/Stat-Up.gif',\n  'boost-attack': '/sprites/icons/misc/Stat-Up.gif',\n  'boost-defense': '/sprites/icons/misc/Stat-Up.gif',\n  'stone-skin': '/sprites/icons/misc/Stat-Up.gif',\n\n  // Debuffs\n  weaken: '/sprites/icons/misc/Stat-Down.gif',\n  slow: '/sprites/icons/misc/Stat-Down.gif',\n};\n\nexport type ActionMenuMode = 'root' | 'abilities' | 'summon';\n\ninterface BattleActionMenuProps {\n  battle: BattleState;\n  currentUnit: Unit | null;\n  selectedAbilityId: string | null;\n  mode: ActionMenuMode;\n  onModeChange: (mode: ActionMenuMode) => void;\n  onSelectAttack: () => void;\n  onSelectAbility: (id: string | null, ability?: Ability) => void;\n}\n\nfunction SectionHeader({ title }: { title: string }) {\n  return (\n    <div\n      style={{\n        color: '#f6e8b1',\n        fontSize: '0.75rem',\n        marginBottom: 4,\n        letterSpacing: 0.5,\n      }}\n    >\n      {title}\n    </div>\n  );\n}\n\nfunction AbilityGrid({\n  abilities,\n  selectedAbilityId,\n  battle,\n  lockedAbilityIds,\n  currentUnit,\n  onSelect,\n}: {\n  abilities: readonly Ability[];\n  selectedAbilityId: string | null;\n  battle: BattleState;\n  lockedAbilityIds: readonly string[];\n  currentUnit: Unit;\n  onSelect: (id: string, ability: Ability) => void;\n}) {\n  // Find current unit's queued action to account for refund when swapping\n  const currentQueuedAction = battle.queuedActions[battle.currentQueueIndex];\n  const refundAmount = currentQueuedAction?.unitId === currentUnit.id\n    ? currentQueuedAction.manaCost\n    : 0;\n  const effectiveRemainingMana = battle.remainingMana + refundAmount;\n\n  return (\n    <div\n      style={{\n        display: 'grid',\n        gridTemplateColumns: 'repeat(2, 1fr)',\n        gap: 6,\n        maxHeight: 240,\n        overflowY: 'auto',\n        padding: '2px',\n      }}\n    >\n      {abilities.map((ability) => {\n        const manaCost = getAbilityManaCost(ability.id, ability);\n        const canAfford = canAffordAction(effectiveRemainingMana, manaCost);\n        const isDjinnAbility = Boolean(DJINN_ABILITIES[ability.id]);\n        const isLocked = lockedAbilityIds.includes(ability.id);\n        const isSelected = selectedAbilityId === ability.id;\n        const element = (ability as Record<string, unknown>).element as string || 'Neutral';\n        const elementTheme: { border: string; glow: string; bg: string } = (\n          ELEMENT_COLORS[element as keyof typeof ELEMENT_COLORS] ?? ELEMENT_COLORS.Neutral\n        ) as { border: string; glow: string; bg: string };\n        const targets = (ability as Record<string, unknown>).targets as string || 'single-enemy';\n        const targetInfo: { icon: string; label: string } = (\n          TARGET_LABELS[targets as keyof typeof TARGET_LABELS] || TARGET_LABELS['single-enemy']\n        ) as { icon: string; label: string };\n        const basePower = (ability as Record<string, unknown>).basePower as number || 0;\n        const abilityType = (ability as Record<string, unknown>).type as string || 'psynergy';\n\n        return (\n          <button\n            key={ability.id}\n            onClick={() => canAfford && !isLocked && onSelect(ability.id, ability)}\n            disabled={!canAfford || isLocked}\n            style={{\n              textAlign: 'left',\n              background: isSelected\n                ? `linear-gradient(135deg, ${elementTheme.bg}, rgba(255,213,74,0.15))`\n                : 'rgba(0,0,0,0.6)',\n              border: `2px solid ${\n                isSelected\n                  ? elementTheme.border\n                  : isDjinnAbility\n                    ? 'rgba(186,104,200,0.5)'\n                    : 'rgba(255,255,255,0.15)'\n              }`,\n              borderLeft: `4px solid ${elementTheme.border}`,\n              padding: '6px 8px',\n              color: !canAfford || isLocked ? '#555' : '#f6e8b1',\n              borderRadius: 6,\n              fontSize: '0.85rem',\n              cursor: canAfford && !isLocked ? 'pointer' : 'not-allowed',\n              opacity: canAfford && !isLocked ? 1 : 0.5,\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4,\n              transition: 'all 0.15s',\n              boxShadow: isSelected ? `0 0 12px ${elementTheme.glow}` : 'none',\n              minHeight: 70,\n            }}\n          >\n            <div style={{ display: 'flex', alignItems: 'center', gap: 6 }}>\n              <img\n                src={\n                  ABILITY_ICONS[ability.id] ||\n                  ELEMENT_ICONS[element] ||\n                  TYPE_ICONS[abilityType] ||\n                  ELEMENT_ICONS.neutral\n                }\n                alt=\"\"\n                width={18}\n                height={18}\n                style={{\n                  imageRendering: 'pixelated',\n                  flexShrink: 0,\n                  filter: canAfford ? 'none' : 'grayscale(100%)',\n                }}\n              />\n              <span\n                style={{\n                  color: isDjinnAbility ? '#ce93d8' : elementTheme.border,\n                  fontWeight: 700,\n                  fontSize: '0.8rem',\n                  textShadow: '1px 1px 2px #000',\n                  flex: 1,\n                  overflow: 'hidden',\n                  textOverflow: 'ellipsis',\n                  whiteSpace: 'nowrap',\n                }}\n              >\n                {ability.name}\n              </span>\n              <div\n                style={{\n                  color: canAfford ? '#ffd700' : '#555',\n                  fontWeight: 700,\n                  fontSize: '0.7rem',\n                  background: 'rgba(0,0,0,0.5)',\n                  padding: '2px 5px',\n                  borderRadius: 3,\n                  border: '1px solid rgba(255,215,0,0.4)',\n                }}\n              >\n                {manaCost}\n              </div>\n            </div>\n\n            <div style={{ display: 'flex', alignItems: 'center', gap: 4, fontSize: '0.65rem' }}>\n              <div\n                style={{\n                  color: '#aaa',\n                  background: 'rgba(0,0,0,0.4)',\n                  padding: '1px 4px',\n                  borderRadius: 2,\n                  display: 'flex',\n                  alignItems: 'center',\n                  gap: 2,\n                }}\n                title={targets}\n              >\n                <span>{targetInfo.icon}</span>\n                <span>{targetInfo.label}</span>\n              </div>\n\n              {basePower > 0 && (\n                <div\n                  style={{\n                    color: abilityType === 'healing' ? '#7FFFD4' : '#ff9999',\n                    background: 'rgba(0,0,0,0.4)',\n                    padding: '1px 4px',\n                    borderRadius: 2,\n                  }}\n                  title={`Base power: ${basePower}`}\n                >\n                  {abilityType === 'healing' ? '+' : 'x'}\n                  {basePower}\n                </div>\n              )}\n\n              {(abilityType === 'buff' || abilityType === 'debuff') && (\n                <div\n                  style={{\n                    color: abilityType === 'buff' ? '#90EE90' : '#FFB6C1',\n                    background: 'rgba(0,0,0,0.4)',\n                    padding: '1px 4px',\n                    borderRadius: 2,\n                  }}\n                >\n                  {abilityType === 'buff' ? '^BUFF' : 'vDEBUFF'}\n                </div>\n              )}\n            </div>\n          </button>\n        );\n      })}\n    </div>\n  );\n}\n\nexport function BattleActionMenu({\n  battle,\n  currentUnit,\n  selectedAbilityId,\n  mode,\n  onModeChange,\n  onSelectAttack,\n  onSelectAbility,\n}: BattleActionMenuProps) {\n  const queueDjinnActivation = useStore((s) => s.queueDjinnActivation);\n  const setSummonScreenOpen = useStore((s) => s.setSummonScreenOpen);\n  const [selectedDjinnIds, setSelectedDjinnIds] = useState<string[]>([]);\n\n  // All hooks must be called before any conditional returns\n  const lockedAbilityIds = useMemo(\n    () => currentUnit ? getLockedDjinnAbilityMetadataForUnit(currentUnit, battle.playerTeam).map((m) => m.abilityId) : [],\n    [currentUnit, battle.playerTeam]\n  );\n  const setDjinnIds = useMemo(() => getSetDjinnIds(battle.playerTeam), [battle.playerTeam]);\n\n  if (!currentUnit) {\n    return (\n      <div\n        style={{\n          background: 'rgba(0,0,0,0.85)',\n          border: '2px solid rgba(255,215,0,0.4)',\n          padding: 12,\n          borderRadius: 8,\n          color: '#888',\n          minHeight: 80,\n          textAlign: 'center',\n          fontStyle: 'italic',\n        }}\n      >\n        Select a unit to begin.\n      </div>\n    );\n  }\n\n  const unlocked = currentUnit.abilities.filter((a) =>\n    currentUnit.unlockedAbilityIds.includes(a.id)\n  );\n  const djinnAbilities = unlocked.filter((a) => DJINN_ABILITIES[a.id]);\n  const regularAbilities = unlocked.filter((a) => !DJINN_ABILITIES[a.id]);\n\n  const toggleDjinnSelection = (id: string) => {\n    setSelectedDjinnIds((prev) => {\n      if (prev.includes(id)) {\n        return prev.filter((dj) => dj !== id);\n      }\n      if (prev.length >= 3) return prev; // Max 3\n      return [...prev, id];\n    });\n  };\n\n  const handleSummonConfirm = () => {\n    selectedDjinnIds.forEach((id) => queueDjinnActivation(id));\n    setSummonScreenOpen(false);\n    setSelectedDjinnIds([]);\n    onModeChange('root');\n  };\n\n  if (mode === 'abilities') {\n    return (\n      <div\n        style={{\n          background: 'rgba(0,0,0,0.9)',\n          border: '2px solid #ffd700',\n          padding: 10,\n          borderRadius: 8,\n          width: 360,\n          maxHeight: 320,\n          overflowY: 'auto',\n          boxShadow: '0 4px 20px rgba(0,0,0,0.8)',\n        }}\n      >\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 8 }}>\n          <SectionHeader title=\"PSYNERGY\" />\n          <button\n            onClick={() => onModeChange('root')}\n            style={{\n              background: 'rgba(0,0,0,0.6)',\n              border: '2px solid #ffd700',\n              color: '#ffd87f',\n              borderRadius: 4,\n              padding: '4px 12px',\n              cursor: 'pointer',\n              fontSize: '0.8rem',\n              fontWeight: 600,\n              textShadow: '1px 1px 2px #000',\n            }}\n          >\n            {'<'} BACK\n          </button>\n        </div>\n\n        {/* Unit abilities section */}\n        {regularAbilities.length > 0 && (\n          <>\n            <div style={{ color: '#aaa', fontSize: '0.7rem', marginBottom: 4, letterSpacing: 0.5 }}>\n              UNIT ABILITIES\n            </div>\n            <AbilityGrid\n              abilities={regularAbilities}\n              selectedAbilityId={selectedAbilityId}\n              battle={battle}\n              lockedAbilityIds={lockedAbilityIds}\n              currentUnit={currentUnit}\n              onSelect={onSelectAbility}\n            />\n          </>\n        )}\n\n        {/* Djinn abilities section - visually distinct */}\n        {djinnAbilities.length > 0 && (\n          <div\n            style={{\n              marginTop: 12,\n              paddingTop: 10,\n              borderTop: '2px solid rgba(186, 104, 200, 0.5)',\n              background: 'linear-gradient(180deg, rgba(186, 104, 200, 0.15) 0%, transparent 100%)',\n              borderRadius: '0 0 6px 6px',\n              padding: '10px 6px 6px 6px',\n              marginLeft: -6,\n              marginRight: -6,\n              marginBottom: -4,\n            }}\n          >\n            <div style={{\n              display: 'flex',\n              alignItems: 'center',\n              gap: 6,\n              color: '#ce93d8',\n              fontSize: '0.75rem',\n              marginBottom: 6,\n              letterSpacing: 0.5,\n              fontWeight: 600,\n            }}>\n              <img\n                src=\"/sprites/icons/buttons/Djinni.gif\"\n                alt=\"\"\n                width={16}\n                height={16}\n                style={{ imageRendering: 'pixelated' }}\n              />\n              DJINN ABILITIES\n            </div>\n            <AbilityGrid\n              abilities={djinnAbilities}\n              selectedAbilityId={selectedAbilityId}\n              battle={battle}\n              lockedAbilityIds={lockedAbilityIds}\n              currentUnit={currentUnit}\n              onSelect={onSelectAbility}\n            />\n          </div>\n        )}\n\n        {regularAbilities.length === 0 && djinnAbilities.length === 0 && (\n          <div style={{ color: '#888', fontStyle: 'italic', textAlign: 'center', padding: 16 }}>\n            No abilities available\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  if (mode === 'summon') {\n    return (\n      <div\n        style={{\n          background: 'rgba(0,0,0,0.9)',\n          border: '2px solid #ffd700',\n          padding: 10,\n          borderRadius: 8,\n          width: 360,\n          maxHeight: 320,\n          overflowY: 'auto',\n          boxShadow: '0 4px 20px rgba(0,0,0,0.8)',\n        }}\n      >\n        <div style={{ display: 'flex', justifyContent: 'space-between', marginBottom: 8 }}>\n          <SectionHeader title=\"SUMMON\" />\n          <button\n            onClick={() => {\n              setSelectedDjinnIds([]);\n              onModeChange('root');\n            }}\n            style={{\n              background: 'rgba(0,0,0,0.6)',\n              border: '2px solid #ffd700',\n              color: '#ffd87f',\n              borderRadius: 4,\n              padding: '4px 12px',\n              cursor: 'pointer',\n              fontSize: '0.8rem',\n              fontWeight: 600,\n              textShadow: '1px 1px 2px #000',\n            }}\n          >\n            {'<'} BACK\n          </button>\n        </div>\n\n        {setDjinnIds.length === 0 ? (\n          <div style={{ color: '#888', fontStyle: 'italic', textAlign: 'center', padding: 16 }}>\n            No Djinn are set. Equip Djinn to summon.\n          </div>\n        ) : (\n          <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>\n            {setDjinnIds.map((djinnId) => {\n              const djinn = DJINN[djinnId];\n              if (!djinn) return null;\n              const isSelected = selectedDjinnIds.includes(djinnId);\n              return (\n                <label\n                  key={djinnId}\n                  style={{\n                    display: 'flex',\n                    gap: 10,\n                    alignItems: 'center',\n                    padding: '8px 10px',\n                    border: `2px solid ${isSelected ? '#ffd700' : 'rgba(255,255,255,0.2)'}`,\n                    borderRadius: 6,\n                    background: isSelected ? 'rgba(255,213,74,0.1)' : 'rgba(0,0,0,0.5)',\n                    cursor: 'pointer',\n                    color: '#f6e8b1',\n                    textShadow: '1px 1px 2px #000',\n                  }}\n                >\n                  <input\n                    type=\"checkbox\"\n                    checked={isSelected}\n                    onChange={() => toggleDjinnSelection(djinnId)}\n                    style={{ width: 16, height: 16 }}\n                  />\n                  <div style={{ display: 'flex', flexDirection: 'column', gap: 2 }}>\n                    <span style={{ fontWeight: 700 }}>{djinn.name}</span>\n                    <span style={{ fontSize: '0.8rem', color: '#ccc' }}>{djinn.summonEffect.description}</span>\n                  </div>\n                  <span style={{ marginLeft: 'auto', fontSize: '0.8rem', color: '#ffd87f' }}>\n                    {djinn.element} Djinn\n                  </span>\n                </label>\n              );\n            })}\n\n            <button\n              onClick={handleSummonConfirm}\n              disabled={selectedDjinnIds.length === 0}\n              style={{\n                padding: '8px 12px',\n                background: selectedDjinnIds.length > 0 ? '#FFD54A' : 'rgba(255,255,255,0.08)',\n                color: selectedDjinnIds.length > 0 ? '#000' : '#888',\n                border: '1px solid rgba(255,255,255,0.18)',\n                borderRadius: 6,\n                cursor: selectedDjinnIds.length > 0 ? 'pointer' : 'not-allowed',\n                fontWeight: 700,\n                letterSpacing: 0.5,\n              }}\n            >\n              Summon ({selectedDjinnIds.length}/3)\n            </button>\n          </div>\n        )}\n      </div>\n    );\n  }\n\n  return (\n    <div\n      style={{\n        background: 'rgba(0,0,0,0.85)',\n        border: '2px solid #ffd700',\n        padding: 10,\n        borderRadius: 8,\n        width: 200,\n        boxShadow: '0 4px 20px rgba(0,0,0,0.7)',\n      }}\n    >\n      <SectionHeader title=\"ACTIONS\" />\n      <div style={{ display: 'flex', flexDirection: 'column', gap: 8 }}>\n        <button\n          onClick={onSelectAttack}\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 10,\n            width: '100%',\n            background: 'rgba(0,0,0,0.5)',\n            border: '2px solid rgba(255, 213, 74, 0.7)',\n            borderRadius: 6,\n            padding: '8px 10px',\n            cursor: 'pointer',\n            transition: 'all 0.15s',\n          }}\n        >\n          <img\n            src={ACTION_ICONS.attack}\n            alt=\"\"\n            width={24}\n            height={24}\n            style={{ imageRendering: 'pixelated', transform: 'scale(1.5)', transformOrigin: 'center' }}\n          />\n          <div style={{ textAlign: 'left' }}>\n            <div style={{ color: '#ffd87f', fontWeight: 600, fontSize: '0.95rem', textShadow: '1px 1px 2px #000' }}>\n              ATTACK\n            </div>\n            <div style={{ color: '#aaa', fontSize: '0.75rem' }}>+1 mana</div>\n          </div>\n        </button>\n\n        <button\n          onClick={() => onModeChange('abilities')}\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 10,\n            width: '100%',\n            background: 'rgba(0,0,0,0.5)',\n            border: '2px solid rgba(255,255,255,0.3)',\n            borderRadius: 6,\n            padding: '8px 10px',\n            cursor: 'pointer',\n          }}\n        >\n          <img\n            src={ACTION_ICONS.abilities}\n            alt=\"\"\n            width={24}\n            height={24}\n            style={{ imageRendering: 'pixelated', transform: 'scale(1.5)', transformOrigin: 'center' }}\n          />\n          <div style={{ textAlign: 'left' }}>\n            <div style={{ color: '#f6e8b1', fontWeight: 600, fontSize: '0.95rem', textShadow: '1px 1px 2px #000' }}>\n              PSYNERGY\n            </div>\n            <div style={{ color: '#888', fontSize: '0.75rem' }}>Abilities</div>\n          </div>\n        </button>\n\n        <button\n          onClick={() => {\n            setSummonScreenOpen(true);\n            onModeChange('summon');\n          }}\n          disabled={setDjinnIds.length === 0}\n          style={{\n            display: 'flex',\n            alignItems: 'center',\n            gap: 10,\n            width: '100%',\n            background: 'rgba(0,0,0,0.5)',\n            border: '2px solid rgba(255,215,0,0.3)',\n            borderRadius: 6,\n            padding: '8px 10px',\n            cursor: setDjinnIds.length > 0 ? 'pointer' : 'not-allowed',\n            opacity: setDjinnIds.length > 0 ? 1 : 0.6,\n          }}\n        >\n          <img\n            src={ACTION_ICONS.summon}\n            alt=\"\"\n            width={24}\n            height={24}\n            style={{ imageRendering: 'pixelated', transform: 'scale(1.5)', transformOrigin: 'center' }}\n          />\n          <div style={{ textAlign: 'left' }}>\n            <div style={{ color: '#f6e8b1', fontWeight: 600, fontSize: '0.95rem', textShadow: '1px 1px 2px #000' }}>\n              SUMMON\n            </div>\n            <div style={{ color: '#888', fontSize: '0.75rem' }}>{setDjinnIds.length} Djinn ready</div>\n          </div>\n        </button>\n\n      </div>\n    </div>\n  );\n}\n","interface ModeLabelProps {\n  /** 'story' | 'tower' | 'demo' */\n  battleType: string;\n  /** e.g. \"Vale Village - House 01\" or \"Battle Tower\" */\n  locationName: string;\n  /** Only for tower mode */\n  floorNumber?: number;\n}\n\nexport function ModeLabel({ battleType, locationName, floorNumber }: ModeLabelProps) {\n  const isTower = battleType === 'tower';\n  const label = isTower && floorNumber ? `Battle Tower - Floor ${floorNumber}` : locationName;\n\n  return (\n    <div\n      style={{\n        background: 'rgba(0,0,0,0.75)',\n        border: '2px solid rgba(255,215,0,0.65)',\n        borderRadius: 8,\n        padding: '6px 12px',\n        color: '#ffd87f',\n        fontWeight: 700,\n        letterSpacing: 0.5,\n        textShadow: '1px 1px 2px #000',\n        boxShadow: '0 4px 12px rgba(0,0,0,0.5)',\n        display: 'flex',\n        alignItems: 'center',\n        gap: 8,\n      }}\n    >\n      <span\n        style={{\n          padding: '2px 6px',\n          borderRadius: 4,\n          background: 'rgba(0,0,0,0.5)',\n          border: '1px solid rgba(255,215,0,0.5)',\n          color: '#ffe9a1',\n          fontSize: '0.8rem',\n        }}\n      >\n        {battleType === 'tower' ? 'Battle Tower' : battleType === 'demo' ? 'Demo' : 'Story Battle'}\n      </span>\n      <span style={{ fontSize: '0.9rem' }}>{label}</span>\n    </div>\n  );\n}\n","/**\n * BattleUnitSprite Component\n * Wrapper around SimpleSprite component for unit display with real sprite assets\n */\n\nimport type { JSX } from 'preact';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport {\n  getEnemyBattleSprite,\n  getPlayerBattleSprite,\n  type BattleSpriteState,\n} from '../sprites/mappings';\nimport { warnIfPlaceholderSprite } from '../sprites/utils/warnIfPlaceholderSprite';\n\ninterface BattleUnitSpriteProps {\n  /** Unit ID (e.g., 'adept', 'test-warrior-1') */\n  unitId: string;\n\n  /** Animation state */\n  state?: 'idle' | 'attack' | 'hit' | 'damage';\n\n  /** Whether this unit is on the player team (defaults to true) */\n  isPlayer?: boolean;\n\n  /** Size variant */\n  size?: 'small' | 'medium' | 'large';\n\n  /** Custom className */\n  className?: string;\n\n  /** Custom style */\n  style?: JSX.CSSProperties;\n}\n\nconst SIZE_MAP = {\n  small: { width: 32, height: 32 },\n  medium: { width: 48, height: 48 },\n  large: { width: 64, height: 64 },\n};\n\nconst STATE_PROP_TO_BATTLE_STATE: Record<NonNullable<BattleUnitSpriteProps['state']>, BattleSpriteState> = {\n  idle: 'idle',\n  attack: 'attack',\n  hit: 'hit',\n  damage: 'hit',\n};\n\n/**\n * BattleUnitSprite component\n * Delegates sprite selection to the battle sprite mapping layer so that\n * production screens do not need to know concrete asset IDs.\n */\nexport function BattleUnitSprite({\n  unitId,\n  state = 'idle',\n  isPlayer = true,\n  size = 'medium',\n  className,\n  style,\n}: BattleUnitSpriteProps) {\n  const sizeStyles = SIZE_MAP[size];\n\n  const mappedState = STATE_PROP_TO_BATTLE_STATE[state] ?? 'idle';\n  const spriteId =\n    getPlayerBattleSprite(unitId, mappedState) ??\n    getEnemyBattleSprite(unitId, mappedState) ??\n    null;\n  const resolvedSpriteId = spriteId ?? `missing-battle-sprite-${unitId}-${mappedState}`;\n  warnIfPlaceholderSprite('BattleUnitSprite', resolvedSpriteId);\n\n  const animationClasses: string[] = [];\n  if (!isPlayer) {\n    if (state === 'attack') {\n      animationClasses.push('enemy-lunge');\n    } else if (state === 'hit') {\n      animationClasses.push('enemy-shake');\n    }\n  }\n\n  const finalClassName = [className, ...animationClasses].filter(Boolean).join(' ') || undefined;\n\n  // Render sprite using SimpleSprite with catalog lookup\n  return (\n    <SimpleSprite\n      id={resolvedSpriteId}\n      width={sizeStyles.width}\n      height={sizeStyles.height}\n      className={finalClassName}\n      style={style}\n      alt={spriteId ? `${unitId} sprite` : `Missing battle sprite for ${unitId}`}\n    />\n  );\n}\n","/**\n * Explicit UI phase states for battle view\n * Mirrors BattleState.phase but with UI-specific granularity\n */\nexport type BattleUIPhase =\n  | 'idle'           // No battle loaded\n  | 'planning'       // Selecting actions\n  | 'executing'      // Animating events\n  | 'victory'        // Battle won\n  | 'defeat';        // Battle lost\n\n/**\n * Valid phase transitions - enforces state machine rules\n */\nexport const VALID_TRANSITIONS: Record<BattleUIPhase, readonly BattleUIPhase[]> = {\n  idle: ['planning'],\n  planning: ['executing'],\n  executing: ['planning', 'victory', 'defeat'],\n  victory: ['idle'],\n  defeat: ['idle'],\n} as const;\n\n/**\n * Check if a phase transition is valid\n */\nexport function isValidTransition(from: BattleUIPhase, to: BattleUIPhase): boolean {\n  return VALID_TRANSITIONS[from].includes(to);\n}\n\n/**\n * Assert a transition is valid (throws if not)\n */\nexport function assertValidTransition(from: BattleUIPhase, to: BattleUIPhase): void {\n  if (!isValidTransition(from, to)) {\n    throw new Error(`Invalid phase transition: ${from} -> ${to}`);\n  }\n}\n\n/**\n * Derive UI phase from battle state\n */\nexport function deriveUIPhase(battlePhase: string | null | undefined): BattleUIPhase {\n  if (!battlePhase) return 'idle';\n  switch (battlePhase) {\n    case 'planning': return 'planning';\n    case 'executing': return 'executing';\n    case 'victory': return 'victory';\n    case 'defeat': return 'defeat';\n    default: return 'idle';\n  }\n}\n","/**\n * Animation timing constants for battle system\n * Based on Golden Sun's deliberate pacing\n */\n\n/** Base delays in milliseconds */\nexport const ANIMATION_TIMING = {\n  /** Brief pause before action starts - builds anticipation */\n  WINDUP: 200,\n\n  /** GIF animation display time */\n  EXECUTE: {\n    ABILITY: 1800,      // Psynergy/special moves\n    BASIC_ATTACK: 1200, // Strike, etc.\n    HEAL: 1400,         // Healing spells\n    STATUS: 1000,       // Buff/debuff application\n  },\n\n  /** Pause after action to show impact */\n  IMPACT: {\n    DAMAGE: 400,   // After hit lands\n    HEAL: 350,     // After heal applies\n    KO: 800,       // Dramatic pause for knockout\n    STATUS: 300,   // After status applies\n  },\n\n  /** Inter-event pause prevents rushed feeling */\n  INTER_EVENT: 350,\n\n  /** Minimum delay even if GIF is cached */\n  MIN_DISPLAY: 800,\n} as const;\n\n/**\n * Calculate total delay for an event based on type\n */\nexport function getEventTiming(eventType: string, _isGifCached: boolean): number {\n  const base = ANIMATION_TIMING;\n\n  switch (eventType) {\n    case 'ability':\n      return base.WINDUP + base.EXECUTE.ABILITY + base.IMPACT.DAMAGE + base.INTER_EVENT;\n\n    case 'hit':\n      // Hit events follow ability - shorter since GIF already shown\n      return base.IMPACT.DAMAGE + base.INTER_EVENT;\n\n    case 'heal':\n      return base.WINDUP + base.EXECUTE.HEAL + base.IMPACT.HEAL + base.INTER_EVENT;\n\n    case 'status-applied':\n    case 'status-expired':\n      return base.EXECUTE.STATUS + base.IMPACT.STATUS + base.INTER_EVENT;\n\n    case 'ko':\n      return base.IMPACT.KO + base.INTER_EVENT;\n\n    case 'auto-heal':\n      return base.EXECUTE.HEAL + base.INTER_EVENT;\n\n    default:\n      return base.MIN_DISPLAY + base.INTER_EVENT;\n  }\n}\n\n/**\n * Speed multipliers for user preference\n */\nexport const SPEED_PRESETS = {\n  slow: 1.5,\n  normal: 1.0,\n  fast: 0.6,\n  instant: 0.1,\n} as const;\n\nexport type SpeedPreset = keyof typeof SPEED_PRESETS;\n","import { useState, useCallback, useMemo } from 'preact/hooks';\nimport { SPEED_PRESETS, type SpeedPreset } from '../constants/animationTiming';\n\n/**\n * Hook for managing battle animation speed\n * Persists preference to localStorage\n */\nexport function useBattleSpeed() {\n  const [speedPreset, setSpeedPreset] = useState<SpeedPreset>(() => {\n    if (typeof window === 'undefined') return 'normal';\n    const saved = localStorage.getItem('battleSpeed');\n    return (saved as SpeedPreset) || 'normal';\n  });\n\n  const setSpeed = useCallback((preset: SpeedPreset) => {\n    setSpeedPreset(preset);\n    if (typeof window !== 'undefined') {\n      localStorage.setItem('battleSpeed', preset);\n    }\n  }, []);\n\n  const multiplier = useMemo(() => SPEED_PRESETS[speedPreset], [speedPreset]);\n\n  /** Apply multiplier to a timing value */\n  const applySpeed = useCallback((ms: number) => Math.round(ms * multiplier), [multiplier]);\n\n  /** Cycle through presets (for quick toggle) */\n  const cycleSpeed = useCallback(() => {\n    const presets: SpeedPreset[] = ['slow', 'normal', 'fast', 'instant'];\n    const currentIndex = presets.indexOf(speedPreset);\n    const nextIndex = (currentIndex + 1) % presets.length;\n    setSpeed(presets[nextIndex] as SpeedPreset);\n  }, [speedPreset, setSpeed]);\n\n  return {\n    speedPreset,\n    multiplier,\n    setSpeed,\n    applySpeed,\n    cycleSpeed,\n  };\n}\n","/**\n * Queue-Based Battle View Component\n * Bottom layout implementation aligning with battle UI spec.\n */\n\nimport { useEffect, useState, useMemo, useRef, useCallback } from 'preact/hooks';\nimport { useStore } from '../state/store';\nimport { useGameStore } from '../../store/gameStore';\nimport { renderEventText } from '../utils/text';\nimport { BattleLog } from './BattleLog';\nimport { PostBattleCutscene } from './PostBattleCutscene';\nimport { VictoryOverlay } from './VictoryOverlay';\nimport { DefeatOverlay } from './DefeatOverlay';\nimport { getValidTargets } from '../../core/algorithms/targeting';\nimport { getPlanningTurnOrder } from '../../core/services/QueueBattleService';\nimport { isUnitKO } from '../../core/models/Unit';\nimport { getEncounterId } from '../../core/models/BattleState';\nimport { BattleManaBar } from './BattleManaBar';\nimport { BattlePortraitRow } from './BattlePortraitRow';\nimport { BattleActionMenu, type ActionMenuMode } from './BattleActionMenu';\nimport { ModeLabel } from './ModeLabel';\nimport type { Ability } from '../../data/schemas/AbilitySchema';\nimport type { Unit } from '../../core/models/Unit';\nimport type { BattleEvent } from '../../core/services/types';\nimport { BattleUnitSprite } from './BattleUnitSprite';\nimport { ABILITIES } from '../../data/definitions/abilities';\n// Direct abilityGIF mapping in ABILITY_FX_MAP below (only for existing GIFs)\nimport { DIALOGUES } from '../../data/definitions/dialogues';\nimport { VS1_ENCOUNTER_ID, VS1_SCENE_PRE } from '../../story/vs1Constants';\nimport { type BattleUIPhase, deriveUIPhase } from '../types/BattleUIPhase';\nimport { getEventTiming } from '../constants/animationTiming';\nimport { useBattleSpeed } from '../hooks/useBattleSpeed';\n\n// Z-Index layering constants to prevent overlay conflicts\nconst Z_INDEX = {\n  BACKGROUND: 0,\n  SPRITES: 10,\n  HUD: 40,\n  BATTLE_LOG: 45,\n  BOTTOM_BAR: 50,\n  MODE_LABEL: 55,\n  TARGET_MODAL: 60,\n  RESOLVING_CARD: 80,\n  FX_CARD: 90,\n} as const;\n\nconst FX_LIBRARY = {\n  grandGaia: '/sprites/psynergy/Grand_Gaia.gif',\n  pyroclasm: '/sprites/psynergy/Pyroclasm.gif',\n  sparkPlasma: '/sprites/psynergy/Spark_Plasma.gif',\n  deluge: '/sprites/psynergy/Deluge.gif',\n  blueBolt: '/sprites/psynergy/Blue_Bolt.gif',\n  heatWave: '/sprites/psynergy/Heat_Wave.gif',\n  tempest: '/sprites/psynergy/Tempest.gif',\n  glacier: '/sprites/psynergy/Glacier.gif',\n  freezePrism: '/sprites/psynergy/Freeze_Prism.gif',\n  inferno: '/sprites/psynergy/Inferno.gif',\n  supernova: '/sprites/psynergy/Supernova.gif',\n  dragonFire: '/sprites/psynergy/Dragon_Fire.gif',\n  fieryBlast: '/sprites/psynergy/Fiery_Blast.gif',\n  iceMissile: '/sprites/psynergy/Ice_Missile.gif',\n  nettle: '/sprites/psynergy/Nettle.gif',\n  destructRay: '/sprites/psynergy/Destruct_Ray.gif',\n  frothSpiral: '/sprites/psynergy/Froth_Spiral.gif',\n  fume: '/sprites/psynergy/Fume.gif',\n  sonicSlash: '/sprites/psynergy/Sonic_Slash.gif',\n} as const;\nconst FX_FALLBACK = FX_LIBRARY.sonicSlash;\n\n// Direct ability ID  GIF mapping (only for GIFs we actually have)\nconst ABILITY_FX_MAP: Record<string, string> = {\n  // === BASIC/PHYSICAL ATTACKS ===\n  'strike': FX_LIBRARY.sonicSlash,\n  'heavy-strike': FX_LIBRARY.sonicSlash,\n  'guard-break': FX_LIBRARY.sonicSlash,\n  'precise-jab': FX_LIBRARY.sonicSlash,\n  'wooden-strike': FX_LIBRARY.sonicSlash,\n  'bronze-slash': FX_LIBRARY.sonicSlash,\n  'iron-thrust': FX_LIBRARY.sonicSlash,\n  'iron-bulwark': FX_LIBRARY.sonicSlash,\n  'arcane-bolt': FX_LIBRARY.blueBolt,\n  'steel-focus': FX_LIBRARY.sonicSlash,\n\n  // === FIRE/MARS ===\n  'fireball': FX_LIBRARY.heatWave,\n  'fire-burst': FX_LIBRARY.heatWave,\n  'flare': FX_LIBRARY.heatWave,\n  'burn-touch': FX_LIBRARY.heatWave,\n  'inferno-slash': FX_LIBRARY.inferno,\n  'supernova': FX_LIBRARY.supernova,\n  'pyroclasm': FX_LIBRARY.pyroclasm,\n  'dragon-breath': FX_LIBRARY.dragonFire,\n  'flame-burst-damage': FX_LIBRARY.fieryBlast,\n  'blazing-fury': FX_LIBRARY.fieryBlast,\n  'meteor-strike': FX_LIBRARY.pyroclasm,\n\n  // === ICE/MERCURY ===\n  'ice-shard': FX_LIBRARY.glacier,\n  'freeze-blast': FX_LIBRARY.freezePrism,\n  'blizzard': FX_LIBRARY.freezePrism,\n  'ice-lance-damage': FX_LIBRARY.iceMissile,\n  'heal': FX_LIBRARY.deluge,\n  'party-heal': FX_LIBRARY.deluge,\n  'cure': FX_LIBRARY.deluge,\n\n  // === LIGHTNING/JUPITER ===\n  'chain-lightning': FX_LIBRARY.sparkPlasma,\n  'paralyze-shock': FX_LIBRARY.sparkPlasma,\n  'tempest': FX_LIBRARY.tempest,\n  'gust': FX_LIBRARY.tempest,\n  'plasma-shot': FX_LIBRARY.blueBolt,\n\n  // === EARTH/VENUS ===\n  'quake': FX_LIBRARY.grandGaia,\n  'earthquake': FX_LIBRARY.grandGaia,\n  'earth-spike': FX_LIBRARY.grandGaia,\n  'poison-strike': FX_LIBRARY.fume,\n\n  // === STATUS/BUFF ===\n  'boost-atk': FX_LIBRARY.heatWave,\n  'boost-def': FX_LIBRARY.grandGaia,\n  'weaken-def': FX_LIBRARY.fume,\n  'blind': FX_LIBRARY.fume,\n  'guard': FX_LIBRARY.grandGaia,\n};\n\n/**\n * SIMPLIFIED FX SYSTEM\n * Single source of truth for event -> GIF mapping\n * No complex fallback chains - just simple, predictable logic\n */\nfunction getEventGif(event: BattleEvent | undefined): string | null {\n  if (!event || event.type !== 'ability') return null;  // Only abilities show GIFs\n\n  const abilityId = event.abilityId;\n\n  // Basic attacks always use sonic slash\n  if (['strike', 'heavy-strike', 'guard-break', 'precise-jab'].includes(abilityId)) {\n    return FX_LIBRARY.sonicSlash;\n  }\n\n  // Direct mapping (most abilities)\n  if (ABILITY_FX_MAP[abilityId]) {\n    return ABILITY_FX_MAP[abilityId];\n  }\n\n  // Element fallback for unmapped psynergy\n  const ability = ABILITIES[abilityId];\n  if (ability?.element) {\n    switch (ability.element) {\n      case 'Mars':\n        return FX_LIBRARY.heatWave;\n      case 'Mercury':\n        return FX_LIBRARY.deluge;\n      case 'Jupiter':\n        return FX_LIBRARY.sparkPlasma;\n      case 'Venus':\n        return FX_LIBRARY.grandGaia;\n    }\n  }\n\n  // Final fallback\n  return FX_LIBRARY.sonicSlash;\n}\n\n\nconst djinnSprites = [\n  { id: 'venus', name: 'Flint', path: '/sprites/battle/djinn/Venus_Djinn_Front.gif' },\n  { id: 'mars', name: 'Granite', path: '/sprites/battle/djinn/Mars_Djinn_Front.gif' },\n  { id: 'mercury', name: 'Echo', path: '/sprites/battle/djinn/Mercury_Djinn_Front.gif' },\n];\n\n// --- CSS CONSTANTS ---\n// Unused - commented out to fix TypeScript warnings\n/*\nconst STYLES = {\n  root: {\n    height: '100vh',\n    display: 'grid',\n    gridTemplateRows: 'auto 1fr auto',\n    backgroundColor: '#0a0b10',\n    color: '#fff',\n    fontFamily: '\"Segoe UI\", Tahoma, sans-serif',\n    overflow: 'hidden',\n  },\n  topHud: {\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    padding: '0.75rem 1.5rem',\n    background: 'linear-gradient(180deg, rgba(10,15,25,0.95) 0%, rgba(10,15,25,0.8) 100%)',\n    borderBottom: '1px solid rgba(255, 255, 255, 0.1)',\n    boxShadow: '0 4px 12px rgba(0,0,0,0.3)',\n    zIndex: 100,\n  },\n  battlefield: {\n    position: 'relative' as const,\n    display: 'flex',\n    flexDirection: 'column' as const,\n    justifyContent: 'center',\n    alignItems: 'center',\n    background: 'radial-gradient(circle at 50% 30%, #1a253a 0%, #050810 80%)',\n    perspective: '1000px',\n  },\n  enemyRow: {\n    display: 'flex',\n    gap: '2rem',\n    marginBottom: '4rem',\n    transform: 'scale(1.1)',\n  },\n  playerRow: {\n    display: 'flex',\n    gap: '3rem',\n    alignItems: 'flex-end',\n    zIndex: 10,\n  },\n  commandDeck: {\n    height: '280px',\n    background: 'linear-gradient(180deg, #1a202c 0%, #0f1218 100%)',\n    borderTop: '4px double #4a5568', // Double border for RPG feel\n    display: 'grid',\n    gridTemplateColumns: '260px 1fr',\n    zIndex: 20,\n    boxShadow: '0 -4px 20px rgba(0,0,0,0.6)',\n  },\n  deckLeft: {\n    borderRight: '2px solid #2d3748',\n    display: 'flex',\n    flexDirection: 'column' as const,\n    background: 'rgba(0,0,0,0.2)',\n  },\n  deckRight: {\n    position: 'relative' as const,\n    display: 'flex',\n    flexDirection: 'column' as const,\n    background: 'rgba(0,0,0,0.4)',\n    overflow: 'hidden',\n  },\n  abilityList: {\n    overflowY: 'auto' as const,\n    flex: 1,\n  },\n  abilityBtn: {\n    display: 'flex',\n    alignItems: 'center',\n    justifyContent: 'space-between',\n    width: '100%',\n    padding: '0.75rem 1rem',\n    background: 'transparent',\n    border: 'none',\n    borderBottom: '1px solid rgba(255,255,255,0.05)',\n    color: '#a0aec0',\n    cursor: 'pointer',\n    textAlign: 'left' as const,\n    transition: 'all 0.1s',\n    fontFamily: 'inherit', // Inherit font for consistent feel\n  },\n  abilityBtnSelected: {\n    background: 'linear-gradient(90deg, rgba(255, 215, 0, 0.15) 0%, rgba(255, 215, 0, 0) 100%)',\n    color: '#ffd700',\n    borderLeft: '4px solid #ffd700',\n    textShadow: '0 0 8px rgba(255, 215, 0, 0.3)',\n  },\n  abilityBtnHover: {\n    background: 'rgba(255,255,255,0.05)',\n    color: '#e2e8f0',\n  },\n  activeUnitIndicator: {\n    padding: '0.75rem 1rem',\n    background: 'linear-gradient(90deg, #2d3748 0%, #1a202c 100%)',\n    borderBottom: '1px solid #4a5568',\n    fontWeight: 'bold' as const,\n    color: '#ffd700',\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'center',\n    boxShadow: 'inset 0 -1px 0 rgba(0,0,0,0.2)',\n  },\n  detailsPanel: {\n    position: 'absolute' as const,\n    top: 0, left: 0, right: 0, bottom: 0,\n    padding: '1.5rem',\n    background: 'linear-gradient(135deg, rgba(26, 32, 44, 0.98) 0%, rgba(15, 20, 30, 0.98) 100%)',\n    zIndex: 5,\n    display: 'flex',\n    flexDirection: 'column' as const,\n    gap: '1rem',\n  },\n  detailsHeader: {\n    borderBottom: '1px solid #4a5568',\n    paddingBottom: '0.5rem',\n    marginBottom: '0.5rem',\n    display: 'flex',\n    justifyContent: 'space-between',\n    alignItems: 'baseline',\n  },\n  detailsTitle: {\n    fontSize: '1.3rem',\n    fontWeight: 'bold' as const,\n    color: '#ffd700',\n    display: 'flex',\n    alignItems: 'center',\n    gap: '0.5rem',\n    textShadow: '0 2px 4px rgba(0,0,0,0.5)',\n  },\n  detailsMeta: {\n    fontSize: '0.9rem',\n    color: '#63b3ed',\n    fontWeight: 500,\n  },\n  detailsBody: {\n    display: 'grid',\n    gridTemplateColumns: '1fr 1fr',\n    gap: '2rem',\n  },\n  statBlock: {\n    display: 'flex',\n    flexDirection: 'column' as const,\n    gap: '0.25rem',\n    background: 'rgba(0,0,0,0.2)',\n    padding: '0.5rem',\n    borderRadius: '4px',\n    border: '1px solid rgba(255,255,255,0.05)',\n  },\n  statLabel: {\n    fontSize: '0.75rem',\n    color: '#718096',\n    textTransform: 'uppercase' as const,\n    letterSpacing: '1px',\n    fontWeight: 600,\n  },\n  statValue: {\n    fontSize: '1.1rem',\n    color: '#e2e8f0',\n    fontWeight: 500,\n  },\n  targetOverlay: {\n    position: 'absolute' as const,\n    bottom: '30px',\n    left: '50%',\n    transform: 'translateX(-50%)',\n    padding: '1rem 2rem',\n    background: 'rgba(15, 20, 30, 0.9)',\n    borderRadius: '8px',\n    border: '1px solid #ffd700',\n    zIndex: 50,\n    textAlign: 'center' as const,\n    boxShadow: '0 4px 20px rgba(0,0,0,0.5)',\n    backdropFilter: 'blur(4px)',\n  },\n  executeBtn: {\n    padding: '1rem',\n    background: 'linear-gradient(180deg, #48bb78 0%, #2f855a 100%)',\n    color: '#fff',\n    border: 'none',\n    borderTop: '1px solid #68d391',\n    fontWeight: 'bold' as const,\n    cursor: 'pointer',\n    marginTop: 'auto',\n    textShadow: '0 1px 2px rgba(0,0,0,0.3)',\n    transition: 'all 0.2s',\n  }\n};\n*/\n\nexport function QueueBattleView() {\n  // V2 gameStore for screen navigation\n  const setScreen = useGameStore((s) => s.setScreen);\n\n  // V1 store for battle domain state\n  const battle = useStore((s) => s.battle);\n  const events = useStore((s) => s.events);\n  const dequeue = useStore((s) => s.dequeueEvent);\n  const queueUnitAction = useStore((s) => s.queueUnitAction);\n  const clearUnitAction = useStore((s) => s.clearUnitAction);\n  const executeQueuedRound = useStore((s) => s.executeQueuedRound);\n  const setMode = useStore((s) => s.setMode);\n  const mode = useStore((s) => s.mode);\n  const startDialogueTree = useStore((s) => s.startDialogueTree);\n  const returnToOverworldV1 = useStore((s) => s.returnToOverworld);\n  const activePortraitIndex = useStore((s) => s.activePortraitIndex);\n  const setActivePortrait = useStore((s) => s.setActivePortrait);\n  const currentManaDisplay = useStore((s) => s.currentMana);\n  const maxManaDisplay = useStore((s) => s.maxMana);\n  const pendingManaThisRound = useStore((s) => s.pendingManaThisRound);\n  const pendingManaNextRound = useStore((s) => s.pendingManaNextRound);\n  const towerStatus = useStore((s) => s.towerStatus);\n  const activeTowerEncounterId = useStore((s) => s.activeTowerEncounterId);\n  const getCurrentTowerFloor = useStore((s) => s.getCurrentTowerFloor);\n  const critCounters = useStore((s) => s.critCounters);\n  const critThresholds = useStore((s) => s.critThresholds);\n  const critFlash = useStore((s) => s.critFlash);\n  const incrementCritCounter = useStore((s) => s.incrementCritCounter);\n  const resetCritCounter = useStore((s) => s.resetCritCounter);\n  const triggerCritFlash = useStore((s) => s.triggerCritFlash);\n  const lastBattleRewards = useStore((s) => s.lastBattleRewards);\n  const processVictory = useStore((s) => s.processVictory);\n  const lastError = useStore((s) => s.lastError);\n  const clearError = useStore((s) => s.clearError);\n  // Wrapper to sync both V1 and V2 store when returning to overworld\n  const returnToOverworld = () => {\n    returnToOverworldV1();\n    setScreen('overworld');\n  };\n\n  // Derive UI phase - if events exist, we're 'executing' regardless of battle.phase\n  // This is the KEY FIX: executeRound() returns planning phase, but we need executing while events drain\n  const uiPhase: BattleUIPhase = events.length > 0 ? 'executing' : deriveUIPhase(battle?.phase);\n\n  // Battle speed control\n  const { speedPreset, applySpeed, cycleSpeed } = useBattleSpeed();\n\n  // Selection State\n  const [selectedAbilityId, setSelectedAbilityId] = useState<string | null | undefined>(undefined);\n  const [menuMode, setMenuMode] = useState<ActionMenuMode>('root');\n\n  // Post-battle State\n  const [showCutscene, setShowCutscene] = useState(false);\n  const [showVictoryOverlay, setShowVictoryOverlay] = useState(false);\n  const [showDefeatOverlay, setShowDefeatOverlay] = useState(false);\n  const [battleOutcome, setBattleOutcome] = useState<'victory' | 'defeat' | null>(null);\n  const loadedFxRef = useRef<Set<string>>(new Set());\n  const [floatingNumbers, setFloatingNumbers] = useState<\n    { id: number; unitId: string; amount: number; kind: 'damage' | 'heal' }[]\n  >([]);\n  const floatingIdRef = useRef(0);\n  const floatingTimeoutsRef = useRef<Map<number, ReturnType<typeof setTimeout>>>(new Map());\n  const lastProcessedEventRef = useRef<BattleEvent | undefined>(undefined);\n  const lastCritProcessedEventRef = useRef<BattleEvent | undefined>(undefined);\n  const pendingDequeueEventRef = useRef<string | undefined>(undefined);\n\n  // Reset per-battle transient state\n  useEffect(() => {\n    if (!battle) return;\n    loadedFxRef.current.clear();\n  }, [battle]);\n\n  // Redirect to tower hub if battle is null during tower run\n  useEffect(() => {\n    if (!battle && (towerStatus === 'in-run' || towerStatus === 'completed')) {\n      setMode('tower');\n      setScreen('tower');\n    }\n  }, [battle, towerStatus, setMode, setScreen]);\n\n  // --- EFFECTS ---\n\n  // 1. Auto-select first unit based on SPEED\n  useEffect(() => {\n    if (uiPhase === 'planning' && activePortraitIndex === null && battle) {\n      const order = getPlanningTurnOrder(battle);\n      if (order.length > 0 && order[0] !== undefined) {\n        setActivePortrait(order[0]);\n      }\n    }\n  }, [uiPhase, activePortraitIndex, battle, setActivePortrait]);\n\n  // 2. Detect battle end and kick off result flow\n  useEffect(() => {\n    if (!battle) {\n      setBattleOutcome(null);\n      setShowCutscene(false);\n      setShowVictoryOverlay(false);\n      setShowDefeatOverlay(false);\n      return;\n    }\n\n    if (uiPhase === 'victory') {\n      setBattleOutcome('victory');\n      setShowCutscene(true);\n      return;\n    }\n\n    if (uiPhase === 'defeat') {\n      setBattleOutcome('defeat');\n      setShowCutscene(true);\n      return;\n    }\n\n    setBattleOutcome(null);\n    setShowCutscene(false);\n    setShowVictoryOverlay(false);\n  }, [uiPhase, battle]);\n\n  // 3. Safety net: if victory state exists but mode never transitioned, force rewards\n  useEffect(() => {\n    if (!battle || battleOutcome !== 'victory') return;\n    const isTowerBattle = towerStatus === 'in-run' && !!activeTowerEncounterId;\n    if (isTowerBattle) return; // tower flow handles its own rewards\n\n    if (!showCutscene && !showVictoryOverlay && mode !== 'rewards' && !lastBattleRewards) {\n      processVictory(battle);\n    }\n  }, [\n    battle,\n    battleOutcome,\n    mode,\n    lastBattleRewards,\n    processVictory,\n    towerStatus,\n    activeTowerEncounterId,\n    showCutscene,\n    showVictoryOverlay,\n  ]);\n\n  const currentFx = useMemo(() => getEventGif(events[0]), [events]);\n\n  // Reset floating numbers when battle changes and clear timers on unmount\n  useEffect(() => {\n    floatingTimeoutsRef.current.forEach((timeout) => clearTimeout(timeout));\n    floatingTimeoutsRef.current.clear();\n    setFloatingNumbers([]);\n    lastProcessedEventRef.current = undefined;\n    lastCritProcessedEventRef.current = undefined;\n\n    return () => {\n      floatingTimeoutsRef.current.forEach((timeout) => clearTimeout(timeout));\n      floatingTimeoutsRef.current.clear();\n    };\n  }, [battle]);\n\n  // Add separate effect for unmount cleanup\n  useEffect(() => {\n    return () => {\n      // Cleanup floating numbers on unmount\n      setFloatingNumbers([]);\n    };\n  }, []);\n\n  // Spawn floating damage/heal numbers when events resolve\n  useEffect(() => {\n    if (!battle || uiPhase !== 'executing') return;\n    const evt = events[0];\n    if (!evt) return;\n    if (evt === lastProcessedEventRef.current) return;\n    lastProcessedEventRef.current = evt;\n\n    if (evt.type === 'hit' || evt.type === 'heal') {\n      const id = floatingIdRef.current + 1;\n      floatingIdRef.current = id;\n      const kind = evt.type === 'heal' ? 'heal' : 'damage';\n      setFloatingNumbers((prev) => [...prev, { id, unitId: evt.targetId, amount: evt.amount, kind }]);\n      const timeoutId = setTimeout(() => {\n        setFloatingNumbers((prev) => prev.filter((n) => n.id !== id));\n        floatingTimeoutsRef.current.delete(id);\n      }, 1150);\n      floatingTimeoutsRef.current.set(id, timeoutId);\n    }\n  }, [uiPhase, events, battle]);\n\n  // Crit counter progression for basic attacks (during execution phase)\n  // This ensures the counter only increments when the attack actually happens,\n  // not during planning (prevents counter increment if unit is KO'd before their turn)\n  const BASIC_ATTACK_IDS = ['strike', 'heavy-strike', 'guard-break', 'precise-jab'];\n  useEffect(() => {\n    if (!battle || uiPhase !== 'executing') return;\n    const evt = events[0];\n    if (!evt) return;\n    if (evt === lastCritProcessedEventRef.current) return;\n    lastCritProcessedEventRef.current = evt;\n\n    // Only process 'ability' events for basic attacks from player units\n    if (evt.type === 'ability' && BASIC_ATTACK_IDS.includes(evt.abilityId)) {\n      const casterId = evt.casterId;\n      // Only track crit counters for player units\n      const isPlayerUnit = battle.playerTeam.units.some(u => u.id === casterId);\n      if (isPlayerUnit) {\n        const nextCount = (critCounters[casterId] ?? 0) + 1;\n        const threshold = critThresholds[casterId] ?? 10;\n        if (nextCount >= threshold) {\n          resetCritCounter(casterId);\n          triggerCritFlash(casterId);\n        } else {\n          incrementCritCounter(casterId);\n        }\n      }\n    }\n  }, [uiPhase, events, battle, critCounters, critThresholds, incrementCritCounter, resetCritCounter, triggerCritFlash]);\n\n  // 4. Event Queue Processing - with stale closure protection\n  useEffect(() => {\n    if (!battle || uiPhase !== 'executing' || events.length === 0) {\n      return;\n    }\n\n    const currentEvent = events[0]!; // Safe: we check events.length > 0 above\n    const eventId = `${currentEvent.type}-${currentEvent.type === 'ability' ? currentEvent.casterId : currentEvent.type === 'turn-start' ? currentEvent.actorId : 'event'}-${Date.now()}`;\n    pendingDequeueEventRef.current = eventId;\n\n    const baseDelay = getEventTiming(currentEvent?.type ?? 'unknown', loadedFxRef.current.has(currentFx ?? ''));\n    const delay = applySpeed(baseDelay);\n    const timer = setTimeout(() => {\n      // Only dequeue if this timer is still the active one (prevents stale closure race)\n      if (pendingDequeueEventRef.current === eventId) {\n        dequeue();\n        pendingDequeueEventRef.current = undefined;\n      }\n    }, delay);\n\n    return () => {\n      clearTimeout(timer);\n      if (pendingDequeueEventRef.current === eventId) {\n        pendingDequeueEventRef.current = undefined;\n      }\n    };\n  }, [uiPhase, events, dequeue, currentFx, battle, applySpeed]);\n\n  // --- COMPUTED VALUES ---\n\n  const currentUnit = useMemo<Unit | null>(() => {\n    if (!battle) return null;\n    if (activePortraitIndex === null || activePortraitIndex === undefined) return null;\n    return battle.playerTeam.units[activePortraitIndex] ?? null;\n  }, [battle, activePortraitIndex]);\n\n  const totalQueuedMana = useMemo(() =>\n    battle?.queuedActions.reduce((sum, a) => sum + (a?.manaCost || 0), 0) || 0\n  , [battle?.queuedActions]);\n\n  const isQueueComplete = useMemo(() => {\n    if (!battle) return false;\n    const aliveUnits = battle.playerTeam.units.filter(u => !isUnitKO(u));\n\n    // Count queued actions by index, matching alive units\n    let queuedCount = 0;\n    for (let i = 0; i < battle.playerTeam.units.length; i++) {\n      const unit = battle.playerTeam.units[i];\n      const action = battle.queuedActions[i];\n      if (unit && !isUnitKO(unit) && action !== null) {\n        queuedCount++;\n      }\n    }\n\n    return aliveUnits.length === queuedCount && totalQueuedMana <= battle.maxMana;\n  }, [battle, totalQueuedMana]);\n\n  const currentFloor = useMemo(() => (towerStatus === 'in-run' ? getCurrentTowerFloor() : null), [towerStatus, getCurrentTowerFloor]);\n  const battleType = towerStatus === 'in-run' ? 'tower' : 'story';\n  const locationName = battle?.meta?.encounterId || battle?.encounterId || 'Story Battle';\n  const currentEvent = events[0];\n  const currentActorId =\n    currentEvent?.type === 'ability' ? currentEvent.casterId :\n    currentEvent?.type === 'hit' || currentEvent?.type === 'heal' || currentEvent?.type === 'status-applied' || currentEvent?.type === 'status-expired' ? undefined :\n    currentEvent?.type === 'ko' ? currentEvent.unitId :\n    undefined;\n  const highlightedTargets = new Set<string>();\n  if (currentEvent) {\n    if (currentEvent.type === 'ability') {\n      currentEvent.targets.forEach((t) => highlightedTargets.add(t));\n    } else if (currentEvent.type === 'hit' || currentEvent.type === 'heal' || currentEvent.type === 'status-applied' || currentEvent.type === 'status-expired') {\n      highlightedTargets.add(currentEvent.targetId);\n    } else if (currentEvent.type === 'ko') {\n      highlightedTargets.add(currentEvent.unitId);\n    }\n  }\n\n  // --- HANDLERS ---\n\n  const handleDefeatResolution = () => {\n    const encounterId = battle ? getEncounterId(battle) : null;\n\n    if (encounterId === VS1_ENCOUNTER_ID) {\n      const preScene = DIALOGUES[VS1_SCENE_PRE];\n      if (preScene) {\n        startDialogueTree(preScene);\n        setMode('dialogue');\n        return;\n      }\n    }\n\n    returnToOverworld();\n  };\n\n  const handleVictoryOverlayComplete = () => {\n    setShowVictoryOverlay(false);\n\n    const isTowerBattle = towerStatus === 'in-run' && !!activeTowerEncounterId;\n    if (isTowerBattle) return;\n    if (battleOutcome !== 'victory') return;\n\n    if (battle && !lastBattleRewards) {\n      processVictory(battle);\n    } else if (lastBattleRewards) {\n      setMode('rewards');\n    }\n  };\n\n  // const handleAbilityHover = (id: string | null) => {\n  //   setHoveredAbilityId(id);\n  // };\n\n  const handleSelectAttack = () => {\n    setSelectedAbilityId(null);\n    setMenuMode('root');\n  };\n\n  const handleAbilitySelect = (id: string | null, ability?: Ability) => {\n    if (selectedAbilityId === id) {\n      setSelectedAbilityId(undefined);\n      return;\n    }\n    setSelectedAbilityId(id);\n    void ability; // reserved for future metadata uses\n    setMenuMode('root');\n  };\n\n  const handleTargetSelect = (targetId: string, abilityIdOverride?: string | null) => {\n    if (!currentUnit || activePortraitIndex === null || !battle) return;\n\n    const abilityIdToUse = abilityIdOverride ?? selectedAbilityId;\n    const ability = abilityIdToUse ? currentUnit.abilities.find(a => a.id === abilityIdToUse) : undefined;\n\n    // Resolve target list based on ability target type\n    let targetIds: string[] = [targetId];\n    const aliveEnemies = battle.enemies.filter((e) => !isUnitKO(e)).map((e) => e.id);\n    const aliveAllies = battle.playerTeam.units.filter((u) => !isUnitKO(u)).map((u) => u.id);\n\n    switch (ability?.targets) {\n      case 'all-enemies':\n        targetIds = aliveEnemies;\n        break;\n      case 'all-allies':\n        targetIds = aliveAllies;\n        break;\n      case 'self':\n        targetIds = [currentUnit.id];\n        break;\n      default:\n        targetIds = [targetId];\n    }\n\n    // Check if this unit already has an action queued\n    const existingAction = battle.queuedActions[activePortraitIndex];\n    if (existingAction !== null) {\n      // Already has an action, skip to next unit\n      const order = getPlanningTurnOrder(battle);\n      const currentOrderIdx = order.indexOf(activePortraitIndex);\n      for (let i = currentOrderIdx + 1; i < order.length; i++) {\n        const nextIndex = order[i];\n        if (nextIndex !== undefined && battle.queuedActions[nextIndex] === null) {\n          setActivePortrait(nextIndex);\n          break;\n        }\n      }\n      setSelectedAbilityId(undefined);\n      return;\n    }\n\n    // Queue the action\n    const queued = queueUnitAction(activePortraitIndex, abilityIdToUse ?? null, targetIds, ability);\n    if (!queued) {\n      return;\n    }\n\n    // NOTE: Crit counter progression moved to execution phase (see effect below)\n    // This prevents incrementing the counter if the unit is KO'd before their turn\n\n    // Reset selection for next\n    setSelectedAbilityId(undefined);\n\n    // Auto-advance to next unit by SPEED\n    const order = getPlanningTurnOrder(battle);\n    const currentOrderIdx = order.indexOf(activePortraitIndex);\n    if (currentOrderIdx !== -1 && currentOrderIdx < order.length - 1) {\n      const nextIndex = order[currentOrderIdx + 1];\n      if (nextIndex !== undefined) {\n        setActivePortrait(nextIndex);\n      }\n    }\n  };\n\n  const handleAutoAttack = useCallback(() => {\n    if (!battle || uiPhase !== 'planning') return;\n    if (!currentUnit || activePortraitIndex === null) return;\n    if (isUnitKO(currentUnit)) return;\n\n    const targets = getValidTargets(null, currentUnit, battle.playerTeam, battle.enemies);\n    const firstTarget = targets[0];\n    if (!firstTarget) return;\n\n    handleSelectAttack();\n    handleTargetSelect(firstTarget.id, null);\n  }, [battle, uiPhase, currentUnit, activePortraitIndex]);\n\n  useEffect(() => {\n    const onKeyDown = (event: KeyboardEvent) => {\n      if (event.key !== 'q' && event.key !== 'Q') return;\n      if (event.repeat) return;\n      handleAutoAttack();\n    };\n\n    window.addEventListener('keydown', onKeyDown);\n    return () => {\n      window.removeEventListener('keydown', onKeyDown);\n    };\n  }, [handleAutoAttack]);\n\n  // 'S' key for speed cycling\n  useEffect(() => {\n    const onKeyDown = (event: KeyboardEvent) => {\n      if (event.key === 's' || event.key === 'S') {\n        if (!event.repeat) cycleSpeed();\n      }\n    };\n    window.addEventListener('keydown', onKeyDown);\n    return () => window.removeEventListener('keydown', onKeyDown);\n  }, [cycleSpeed]);\n\n  const handleExecute = () => {\n    if (isQueueComplete && uiPhase === 'planning') executeQueuedRound();\n  };\n\n  // Button should only be enabled in planning phase with complete queue\n  const canExecute = isQueueComplete && uiPhase === 'planning';\n\n  // --- RENDER ---\n\n  if (!battle) return <div>Loading Battle...</div>;\n\n  // Post-battle handling\n  if (showCutscene && battleOutcome) {\n    return (\n      <PostBattleCutscene\n        victory={battleOutcome === 'victory'}\n        onComplete={() => {\n          setShowCutscene(false);\n          if (battleOutcome === 'victory') {\n            setShowVictoryOverlay(true);\n          } else {\n            setShowDefeatOverlay(true);\n          }\n        }}\n      />\n    );\n  }\n\n  if (battleOutcome === 'victory' && showVictoryOverlay) {\n    return <VictoryOverlay onComplete={handleVictoryOverlayComplete} />;\n  }\n\n  if (battleOutcome === 'defeat' && showDefeatOverlay) {\n    return <DefeatOverlay onComplete={() => {\n      setShowDefeatOverlay(false);\n      handleDefeatResolution();\n    }} />;\n  }\n\n  // Determine valid targets if in selection mode (only during planning phase)\n  let validTargets: readonly { id: string; name: string }[] = [];\n  if (uiPhase === 'planning' && selectedAbilityId !== undefined && currentUnit) {\n    // selectedAbilityId is null -> Basic Attack\n    // selectedAbilityId is string -> Ability\n    const ability = selectedAbilityId\n      ? currentUnit.abilities.find(a => a.id === selectedAbilityId)\n      : undefined; // undefined corresponds to 'Basic Attack' in getValidTargets if logic allows?\n                   // Actually getValidTargets expects ability object or undefined for Basic Attack\n\n    // Note: getValidTargets signature might need checking.\n    // Assuming getValidTargets(ability | null/undefined, unit, team, enemies)\n    // Checking import... getValidTargets(ability: Ability | null | undefined, ...)\n    validTargets = getValidTargets(ability || null, currentUnit, battle.playerTeam, battle.enemies);\n  }\n  const validTargetIds = new Set(validTargets.map((t) => t.id));\n  const isTargeting = selectedAbilityId !== undefined && validTargets.length > 0;\n\n  // --- HELPERS FOR RENDERING ABILITY LIST ---\n  // Helpers not required; rendering handled via BattleActionMenu.\n\n  const isExecuting = uiPhase === 'executing';\n\n  return (\n    <div\n      data-testid=\"battle-view\"\n      style={{\n        width: '100vw',\n        height: '100vh',\n        background: '#000',\n        display: 'flex',\n        justifyContent: 'center',\n        alignItems: 'center',\n        overflow: 'hidden',\n        position: 'fixed',\n        inset: 0,\n        zIndex: 999,\n      }}\n    >\n      <div\n        style={{\n          width: 900,\n          height: 600,\n          position: 'relative',\n          background: '#000',\n          overflow: 'hidden',\n          imageRendering: 'pixelated',\n          color: '#fff',\n        }}\n      >\n        <style>\n          {`\n            @keyframes floatNumber {\n              0% { opacity: 1; transform: translate(-50%, 0) scale(1); }\n              60% { opacity: 1; transform: translate(-50%, -6px) scale(1.02); }\n              100% { opacity: 0; transform: translate(-50%, -24px) scale(1.05); }\n            }\n          `}\n        </style>\n        {/* Battlefield Area */}\n        <div\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            right: 0,\n            bottom: 0,\n            overflow: 'hidden',\n          }}\n        >\n        <div\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: '100%',\n            height: '100%',\n            backgroundImage: 'url(/sprites/backgrounds/gs1/Kolima_Forest.gif)',\n            backgroundSize: 'cover',\n            backgroundPosition: 'center 70%',\n            imageRendering: 'pixelated',\n            zIndex: 0,\n          }}\n        />\n\n        <div style={{ position: 'absolute', top: 8, left: 8, zIndex: Z_INDEX.MODE_LABEL }}>\n          <ModeLabel\n            battleType={battleType}\n            locationName={locationName}\n            floorNumber={currentFloor?.floorNumber}\n          />\n        </div>\n\n        {isExecuting && (\n          <div\n            style={{\n              position: 'absolute',\n              top: 16,\n              left: '50%',\n              transform: 'translateX(-50%)',\n              background: 'rgba(0,0,0,0.7)',\n              border: '1px solid rgba(255,216,127,0.4)',\n              borderRadius: 8,\n              padding: '8px 12px',\n              color: '#FFD87F',\n              fontWeight: 700,\n              letterSpacing: 0.5,\n              zIndex: 5,\n            }}\n          >\n             Executing round...\n          </div>\n        )}\n\n        <div\n          style={{\n            display: 'flex',\n            flexDirection: 'column',\n            justifyContent: 'center',\n            alignItems: 'center',\n              gap: 48,\n              height: '100%',\n              position: 'relative',\n              zIndex: 1,\n            }}\n        >\n          <div\n            style={{\n              position: 'absolute',\n              bottom: '42%',\n              left: '8%',\n              display: 'flex',\n              gap: '3rem',\n              zIndex: 10,\n            }}\n          >\n            {battle.enemies.map((enemy) => {\n              const isTargetCandidate = validTargetIds.has(enemy.id);\n              const isResolvingTarget = highlightedTargets.has(enemy.id);\n              const isActor = currentActorId === enemy.id;\n              // Don't filter out KO'd units if they have ANY pending events related to them\n              // This includes ability casts, hits, heals, status changes, and KO animations\n              const hasPendingEvent = events.some(evt => {\n                if (evt.type === 'ability' && evt.casterId === enemy.id) return true;\n                if (evt.type === 'ability' && evt.targets.includes(enemy.id)) return true;\n                if (evt.type === 'hit' && evt.targetId === enemy.id) return true;\n                if (evt.type === 'heal' && evt.targetId === enemy.id) return true;\n                if (evt.type === 'ko' && evt.unitId === enemy.id) return true;\n                if (evt.type === 'status-applied' && evt.targetId === enemy.id) return true;\n                if (evt.type === 'status-expired' && evt.targetId === enemy.id) return true;\n                return false;\n              });\n              if (isUnitKO(enemy) && !hasPendingEvent) return null;\n              const animationState: 'idle' | 'attack' | 'hit' =\n                isActor ? 'attack' : isResolvingTarget ? 'hit' : 'idle';\n              return (\n                <div\n                  key={enemy.id}\n                  onClick={() => isTargetCandidate && handleTargetSelect(enemy.id)}\n                  style={{\n                    position: 'relative',\n                    cursor: isTargetCandidate ? 'pointer' : 'default',\n                    textAlign: 'center',\n                  }}\n                >\n                  <div\n                    style={{\n                      position: 'absolute',\n                      bottom: 0,\n                      left: '50%',\n                      transform: 'translateX(-50%)',\n                      width: 70,\n                      height: 24,\n                      background: 'rgba(0,0,0,0.6)',\n                      borderRadius: '50%',\n                      filter: 'blur(4px)',\n                      pointerEvents: 'none',\n                      zIndex: 0,\n                    }}\n                  />\n                  <div\n                    style={{\n                      position: 'relative',\n                      transform: isActor ? 'scale(3.2)' : 'scale(3)',\n                      zIndex: 1,\n                      filter: isResolvingTarget\n                      ? 'drop-shadow(0 0 14px rgba(255,216,127,0.9))'\n                      : isTargetCandidate\n                        ? 'drop-shadow(0 0 8px rgba(255,216,127,0.7))'\n                        : 'none',\n                    }}\n                  >\n                    <BattleUnitSprite\n                      unitId={enemy.id}\n                      state={animationState}\n                      size=\"large\"\n                      isPlayer={false}\n                    />\n                  </div>\n                  {floatingNumbers\n                    .filter((n) => n.unitId === enemy.id)\n                    .map((num, idx) => {\n                      const displayValue = Math.abs(num.amount);\n                      return (\n                        <div\n                          key={num.id}\n                          style={{\n                            position: 'absolute',\n                            bottom: `calc(100% + ${idx * 16 + 6}px)`,\n                            left: '50%',\n                            color: num.kind === 'heal' ? '#6df0a2' : '#ff6b6b',\n                            fontWeight: 800,\n                            textShadow: '0 0 6px rgba(0,0,0,0.8)',\n                            animation: 'floatNumber 1.05s ease-out forwards',\n                            pointerEvents: 'none',\n                            zIndex: 12,\n                          }}\n                        >\n                          {num.kind === 'heal' ? `+${displayValue}` : `-${displayValue}`}\n                        </div>\n                      );\n                    })}\n                  <div\n                    style={{\n                      marginTop: 4,\n                      fontSize: '0.8rem',\n                      color: isTargetCandidate ? '#FFD87F' : '#aaa',\n                    }}\n                  >\n                    {enemy.name}\n                  </div>\n                  {isTargetCandidate && (\n                    <div style={{ color: '#FFD87F', fontSize: '0.75rem' }}>Click to target</div>\n                  )}\n                  {isResolvingTarget && (\n                    <div\n                      style={{\n                        position: 'absolute',\n                        top: -12,\n                        left: '50%',\n                        transform: 'translateX(-50%)',\n                        color: '#FFD87F',\n                        fontSize: '1.2rem',\n                        fontWeight: 900,\n                        textShadow: '0 0 8px rgba(255,216,127,0.9)',\n                        pointerEvents: 'none',\n                        zIndex: 15,\n                      }}\n                    >\n                      \n                    </div>\n                  )}\n                </div>\n              );\n            })}\n          </div>\n\n          <div\n            style={{\n              position: 'absolute',\n              bottom: '28%',\n              right: '15%',\n              width: 260,\n              height: 160,\n              zIndex: 10,\n            }}\n          >\n            {battle.playerTeam.units.map((unit, index) => {\n              // Don't filter out KO'd units if they have ANY pending events related to them\n              // This includes ability casts, hits, heals, status changes, and KO animations\n              const hasPendingEvent = events.some(evt => {\n                if (evt.type === 'ability' && evt.casterId === unit.id) return true;\n                if (evt.type === 'ability' && evt.targets.includes(unit.id)) return true;\n                if (evt.type === 'hit' && evt.targetId === unit.id) return true;\n                if (evt.type === 'heal' && evt.targetId === unit.id) return true;\n                if (evt.type === 'ko' && evt.unitId === unit.id) return true;\n                if (evt.type === 'status-applied' && evt.targetId === unit.id) return true;\n                if (evt.type === 'status-expired' && evt.targetId === unit.id) return true;\n                return false;\n              });\n              if (isUnitKO(unit) && !hasPendingEvent) return null;\n              const isActor = currentActorId === unit.id;\n              const isTarget = highlightedTargets.has(unit.id);\n              const animationState: 'idle' | 'attack' | 'hit' =\n                isActor ? 'attack' : isTarget ? 'hit' : 'idle';\n              return (\n                <div\n                  key={unit.id}\n                  style={{\n                    position: 'absolute',\n                    left: index * 55,\n                    bottom: index * 12,\n                    textAlign: 'center',\n                  }}\n                >\n                  <div\n                    style={{\n                      position: 'absolute',\n                      bottom: 4,\n                      left: '50%',\n                      transform: 'translateX(-50%)',\n                      width: 48,\n                      height: 16,\n                      background: isActor || isTarget ? 'rgba(255,216,127,0.3)' : 'rgba(0,0,0,0.6)',\n                      borderRadius: '50%',\n                      filter: 'blur(4px)',\n                      pointerEvents: 'none',\n                      zIndex: 0,\n                    }}\n                  />\n                  <div\n                    style={{\n                      position: 'relative',\n                      transform: isActor ? 'scale(2.7)' : 'scale(2.5)',\n                      zIndex: 1,\n                      filter: isTarget ? 'drop-shadow(0 0 12px rgba(255,216,127,0.8))' : 'none',\n                    }}\n                  >\n                    <BattleUnitSprite unitId={unit.id} state={animationState} size=\"large\" />\n                  </div>\n                  {isTarget && (\n                    <div\n                      style={{\n                        position: 'absolute',\n                        top: -12,\n                        left: '50%',\n                        transform: 'translateX(-50%)',\n                        color: '#FFD87F',\n                        fontSize: '1.2rem',\n                        fontWeight: 900,\n                        textShadow: '0 0 8px rgba(255,216,127,0.9)',\n                        pointerEvents: 'none',\n                        zIndex: 15,\n                      }}\n                    >\n                      \n                    </div>\n                  )}\n                  {floatingNumbers\n                    .filter((n) => n.unitId === unit.id)\n                    .map((num, idx) => {\n                      const displayValue = Math.abs(num.amount);\n                      return (\n                        <div\n                          key={num.id}\n                          style={{\n                            position: 'absolute',\n                            bottom: `calc(100% + ${idx * 16 + 6}px)`,\n                            left: '50%',\n                            color: num.kind === 'heal' ? '#6df0a2' : '#ff6b6b',\n                            fontWeight: 800,\n                            textShadow: '0 0 6px rgba(0,0,0,0.8)',\n                            animation: 'floatNumber 1.05s ease-out forwards',\n                            pointerEvents: 'none',\n                            zIndex: 12,\n                          }}\n                        >\n                          {num.kind === 'heal' ? `+${displayValue}` : `-${displayValue}`}\n                        </div>\n                      );\n                    })}\n                </div>\n              );\n            })}\n          </div>\n\n          {/* Djinn companions behind party */}\n          <div\n            style={{\n              position: 'absolute',\n              right: '6%',\n              bottom: '34%',\n              display: 'flex',\n              flexDirection: 'column',\n              gap: 4,\n              zIndex: 8,\n            }}\n          >\n            {djinnSprites.map((djinn, idx) => (\n              <div\n                key={djinn.id}\n                style={{\n                  position: 'relative',\n                left: idx % 2 === 0 ? 0 : 6,\n              }}\n            >\n              <img\n                src={djinn.path}\n                alt={djinn.name}\n                width={32}\n                height={32}\n                style={{ imageRendering: 'pixelated', transform: 'scale(2.5)' }}\n              />\n            </div>\n          ))}\n        </div>\n        </div>\n\n        {validTargets.length > 0 && (\n          <div\n            style={{\n              position: 'absolute',\n              bottom: 24,\n              left: '50%',\n              transform: 'translateX(-50%)',\n              background: 'rgba(0,0,0,0.8)',\n              padding: '12px 16px',\n              borderRadius: 8,\n              border: '1px solid rgba(255,216,127,0.4)',\n              textAlign: 'center',\n              zIndex: Z_INDEX.TARGET_MODAL,\n            }}\n          >\n            <div style={{ color: '#FFD87F', fontWeight: 700, marginBottom: 4 }}>Select target</div>\n            <div style={{ color: '#ccc', fontSize: '0.9rem' }}>Click a highlighted target to confirm</div>\n            <button\n              onClick={() => {\n                setSelectedAbilityId(undefined);\n              }}\n              style={{\n                marginTop: 8,\n                background: 'transparent',\n                border: '1px solid rgba(255,255,255,0.25)',\n                color: '#eaeaea',\n                padding: '6px 10px',\n                borderRadius: 6,\n                cursor: 'pointer',\n              }}\n            >\n              Cancel\n            </button>\n          </div>\n        )}\n\n        {isExecuting && (\n          <div\n            style={{\n              position: 'absolute',\n              right: 16,\n              bottom: 16,\n              width: 340,\n              maxHeight: '45vh',\n              overflow: 'auto',\n              background: 'rgba(0,0,0,0.35)',\n              border: '1px solid rgba(255,255,255,0.08)',\n              borderRadius: 8,\n              padding: 8,\n              zIndex: Z_INDEX.BATTLE_LOG,\n            }}\n          >\n            <BattleLog events={events} renderText={renderEventText} />\n          </div>\n        )}\n      </div>\n\n      {/* Bottom UI simplified strip */}\n      <div\n        style={{\n          position: 'absolute',\n          bottom: 0,\n          left: 0,\n          right: 0,\n          height: 100,\n          background: 'linear-gradient(to top, rgba(8,8,10,0.95), transparent)',\n          display: 'flex',\n          justifyContent: 'center',\n          alignItems: 'center',\n          gap: 16,\n          padding: '10px 20px',\n          zIndex: Z_INDEX.BOTTOM_BAR,\n        }}\n      >\n        <BattleManaBar\n          currentMana={currentManaDisplay}\n          maxMana={maxManaDisplay}\n          pendingThisRound={pendingManaThisRound}\n          pendingNextRound={pendingManaNextRound}\n        />\n        <BattlePortraitRow\n          units={battle.playerTeam.units}\n          activeIndex={activePortraitIndex}\n          queuedActions={battle.queuedActions}\n          critCounters={critCounters}\n          critThresholds={critThresholds}\n          critFlashes={critFlash}\n          onSelect={(idx) => {\n            const unit = battle.playerTeam.units[idx];\n            if (isTargeting && unit && validTargetIds.has(unit.id)) {\n              handleTargetSelect(unit.id);\n              return;\n            }\n            if (uiPhase === 'planning') {\n              // If clicking on a unit with a queued action, cancel it\n              const hasQueuedAction = battle.queuedActions[idx] !== null;\n              if (hasQueuedAction) {\n                clearUnitAction(idx);\n                setActivePortrait(idx); // Select the unit so they can queue a new action\n                setSelectedAbilityId(undefined);\n              } else {\n                setActivePortrait(idx);\n                setSelectedAbilityId(undefined);\n              }\n            }\n          }}\n        />\n        <div\n          style={{\n            alignSelf: 'flex-end',\n            position: 'relative',\n            zIndex: 60,\n            opacity: isExecuting ? 0.5 : 1,\n            pointerEvents: isExecuting ? 'none' : 'auto',\n            transition: 'opacity 0.2s ease',\n          }}\n        >\n          <BattleActionMenu\n            battle={battle}\n            currentUnit={currentUnit}\n            selectedAbilityId={selectedAbilityId ?? null}\n            mode={menuMode}\n            onModeChange={setMenuMode}\n            onSelectAttack={handleSelectAttack}\n            onSelectAbility={handleAbilitySelect}\n          />\n          {isExecuting && (\n            <div\n              style={{\n                position: 'absolute',\n                inset: 0,\n                background: 'rgba(0,0,0,0.4)',\n                display: 'flex',\n                alignItems: 'center',\n                justifyContent: 'center',\n                borderRadius: 8,\n                color: '#FFD87F',\n                fontWeight: 700,\n                fontSize: '0.9rem',\n              }}\n            >\n              Resolving...\n            </div>\n          )}\n        </div>\n        <div style={{ display: 'flex', flexDirection: 'column', gap: 6, minWidth: 200 }}>\n          <button\n            onClick={cycleSpeed}\n            style={{\n              padding: '6px 10px',\n              background: 'rgba(255,255,255,0.1)',\n              color: '#ccc',\n              border: '1px solid rgba(255,255,255,0.2)',\n              borderRadius: 6,\n              cursor: 'pointer',\n              fontSize: '0.8rem',\n              marginBottom: 4,\n            }}\n            title=\"Click to change battle speed (S key)\"\n          >\n            Speed: {speedPreset.charAt(0).toUpperCase() + speedPreset.slice(1)}\n          </button>\n          <button\n            onClick={handleExecute}\n            disabled={!canExecute}\n            style={{\n              padding: '10px 14px',\n              background: canExecute ? '#FFD54A' : 'rgba(255,255,255,0.08)',\n              color: canExecute ? '#000' : '#888',\n              border: '1px solid rgba(255,255,255,0.18)',\n              borderRadius: 8,\n              cursor: canExecute ? 'pointer' : 'not-allowed',\n              fontWeight: 700,\n              letterSpacing: 0.5,\n            }}\n          >\n            {isExecuting ? 'Executing...' : isQueueComplete ? 'Execute Round' : 'Queue all actions first'}\n          </button>\n          {lastError && (\n            <div\n              style={{\n                color: '#ffb3b3',\n                fontSize: '0.85rem',\n                background: 'rgba(0,0,0,0.6)',\n                border: '1px solid rgba(255,99,71,0.4)',\n                borderRadius: 6,\n                padding: '6px 8px',\n                maxWidth: 240,\n              }}\n            >\n              <div style={{ display: 'flex', alignItems: 'center', gap: 8 }}>\n                <span style={{ flex: 1 }}>{lastError}</span>\n                <button\n                  onClick={clearError}\n                  style={{\n                    background: 'transparent',\n                    border: 'none',\n                    color: '#ffb3b3',\n                    cursor: 'pointer',\n                    fontWeight: 700,\n                  }}\n                  aria-label=\"Dismiss error\"\n                >\n                  x\n                </button>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n\n      {/* Execution overlay to show current resolving event */}\n      {isExecuting && events.length > 0 && (\n        <div\n          style={{\n            position: 'absolute',\n            top: 16,\n            left: '50%',\n            transform: 'translateX(-50%)',\n            background: 'rgba(0, 0, 0, 0.65)',\n            padding: '8px 14px',\n            borderRadius: 8,\n            border: '1px solid rgba(255, 215, 127, 0.4)',\n            color: '#f9e0a8',\n            fontWeight: 700,\n            boxShadow: '0 4px 12px rgba(0,0,0,0.45)',\n            zIndex: Z_INDEX.RESOLVING_CARD,\n            minWidth: 260,\n            textAlign: 'center',\n            transition: 'transform 0.2s ease, opacity 0.2s ease',\n          }}\n        >\n          Resolving: {events[0] ? renderEventText(events[0]) : 'Loading...'}\n        </div>\n      )}\n\n      {/* FX overlay for ability events only (hit/heal/status just show damage numbers) */}\n      {isExecuting && events.length > 0 && events[0]?.type === 'ability' && (\n        <div\n          style={{\n            position: 'absolute',\n            top: '12%',\n            left: '50%',\n            transform: 'translateX(-50%)',\n            background: 'rgba(0,0,0,0.25)',\n            padding: '14px 18px',\n            borderRadius: 12,\n            border: '1px solid rgba(255, 215, 127, 0.45)',\n            boxShadow: '0 12px 28px rgba(0,0,0,0.55)',\n            display: 'flex',\n            alignItems: 'center',\n            gap: 14,\n            zIndex: Z_INDEX.FX_CARD,\n            minWidth: 420,\n            justifyContent: 'center',\n          }}\n        >\n          {(() => {\n            const evt = events[0];\n            if (!evt || evt.type !== 'ability') return null;\n            const fx = getEventGif(evt);\n            const abilityName = ABILITIES[evt.abilityId]?.name ?? evt.abilityId;\n\n            // Find target names for display\n            const targetNames = evt.targets.map(targetId => {\n              const enemy = battle.enemies.find(e => e.id === targetId);\n              const ally = battle.playerTeam.units.find(u => u.id === targetId);\n              return enemy?.name || ally?.name || 'Unknown';\n            }).join(', ');\n\n            return (\n              <>\n                {fx && (\n                  <img\n                    src={fx}\n                    width={180}\n                    height={180}\n                    style={{\n                      borderRadius: 10,\n                      imageRendering: 'pixelated',\n                      objectFit: 'cover',\n                      boxShadow: '0 0 24px rgba(255,255,255,0.65)',\n                      mixBlendMode: 'screen',\n                    }}\n                    onLoad={() => loadedFxRef.current.add(fx)}\n                    onError={() => {\n                      loadedFxRef.current.add(FX_FALLBACK);\n                    }}\n                    alt=\"Ability effect\"\n                  />\n                )}\n                <div style={{ display: 'flex', flexDirection: 'column', gap: 4 }}>\n                  <div style={{ fontWeight: 800, color: '#ffd87f', fontSize: '1.05rem' }}>{abilityName}</div>\n                  {targetNames && (\n                    <div style={{ color: '#FFD87F', fontSize: '0.85rem', fontWeight: 600 }}>\n                      Target: {targetNames}\n                    </div>\n                  )}\n                  <div style={{ color: '#e0e0e0', fontSize: '0.95rem', maxWidth: 320 }}>\n                    {renderEventText(evt)}\n                  </div>\n                </div>\n              </>\n            );\n          })()}\n        </div>\n      )}\n      </div>\n    </div>\n  );\n}\n","/**\n * Main Menu Component\n * Menu screen with New Game, Continue, Compendium options\n */\n\nimport { useEffect, useState } from 'preact/hooks';\nimport { useGameStore } from '../../store/gameStore';\nimport { useStore } from '../../ui/state/store';\nimport { ADEPT } from '../../data/definitions/units';\nimport { createUnit } from '../../core/models/Unit';\nimport { createTeam } from '../../core/models/Team';\nimport './MainMenu.css';\n\n// Character sprites flanking the menu\nconst MENU_CHARACTERS = {\n  left: [\n    { name: 'Isaac', sprite: '/sprites/overworld/protagonists/Isaac.gif' },\n    { name: 'Garet', sprite: '/sprites/overworld/protagonists/Garet.gif' },\n  ],\n  right: [\n    { name: 'Ivan', sprite: '/sprites/overworld/protagonists/Ivan.gif' },\n    { name: 'Mia', sprite: '/sprites/overworld/protagonists/Mia.gif' },\n  ],\n};\n\nexport function MainMenu() {\n  const startTransition = useGameStore((s) => s.startTransition);\n  const openModal = useGameStore((s) => s.openModal);\n  const setTeam = useStore((s) => s.setTeam);\n  const addUnitToRoster = useStore((s) => s.addUnitToRoster);\n  const openTowerFromMainMenu = useStore((s) => s.openTowerFromMainMenu);\n  const hasSaveSlot = useStore((s) => s.hasSaveSlot);\n  const [selectedIndex, setSelectedIndex] = useState(0);\n  const [hasSaveFile, setHasSaveFile] = useState(false);\n\n  // Check for existing save files on mount\n  useEffect(() => {\n    // Check if any of the 3 save slots have data\n    const hasAnySave = hasSaveSlot(0) || hasSaveSlot(1) || hasSaveSlot(2);\n    setHasSaveFile(hasAnySave);\n  }, [hasSaveSlot]);\n\n  const menuOptions = [\n    { id: 'new-game', label: 'New Game', enabled: true },\n    { id: 'continue', label: 'Continue', enabled: hasSaveFile },\n    { id: 'compendium', label: 'Compendium', enabled: true },\n    { id: 'battle-tower', label: 'Battle Tower (Beta)', enabled: true },\n  ];\n\n  const enabledOptions = menuOptions.filter(opt => opt.enabled);\n\n  // Ensure selectedIndex is within bounds\n  const safeSelectedIndex = Math.min(selectedIndex, enabledOptions.length - 1);\n  const currentOption = enabledOptions[safeSelectedIndex] || enabledOptions[0];\n\n  useEffect(() => {\n    // Reset selected index when enabled options change\n    if (selectedIndex >= enabledOptions.length) {\n      setSelectedIndex(0);\n    }\n  }, [enabledOptions.length, selectedIndex]);\n\n  useEffect(() => {\n    const handleKeyPress = (event: KeyboardEvent) => {\n      if (event.key === 'ArrowUp' || event.key === 'ArrowDown') {\n        event.preventDefault();\n        event.stopPropagation();\n\n        if (event.key === 'ArrowUp') {\n          setSelectedIndex((prev) => {\n            const newIndex = prev > 0 ? prev - 1 : enabledOptions.length - 1;\n            return newIndex;\n          });\n        } else {\n          setSelectedIndex((prev) => {\n            const newIndex = prev < enabledOptions.length - 1 ? prev + 1 : 0;\n            return newIndex;\n          });\n        }\n        return;\n      }\n\n      if (event.key === 'Enter' || event.key === ' ') {\n        event.preventDefault();\n        event.stopPropagation();\n        if (currentOption) {\n          handleSelectOption(currentOption.id);\n        }\n        return;\n      }\n\n      if (event.key === 'Escape') {\n        event.preventDefault();\n        event.stopPropagation();\n        startTransition('title');\n        return;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyPress);\n    return () => window.removeEventListener('keydown', handleKeyPress);\n  }, [currentOption, enabledOptions.length, startTransition]);\n\n  const handleSelectOption = (optionId: string) => {\n    if (optionId === 'new-game') {\n      // Initialize starting team with Isaac (the adept unit)\n      const isaac = createUnit(ADEPT, 1, 0);\n      addUnitToRoster(isaac);\n      const starterTeam = createTeam([isaac]);\n      setTeam(starterTeam);\n      startTransition('overworld'); // Start new game -> go to overworld\n    } else if (optionId === 'continue') {\n      if (hasSaveFile) {\n        // Open save menu modal to let user choose which slot to load\n        openModal('save');\n      }\n    } else if (optionId === 'compendium') {\n      startTransition('compendium');\n    } else if (optionId === 'battle-tower') {\n      // Initialize team if none exists (for Battle Tower quick access)\n      const store = useStore.getState();\n      if (!store.team || store.team.units.length === 0) {\n        const isaac = createUnit(ADEPT, 1, 0);\n        addUnitToRoster(isaac);\n        const starterTeam = createTeam([isaac]);\n        setTeam(starterTeam);\n      }\n      // Enter the actual tower system with proper progression\n      openTowerFromMainMenu();\n      startTransition('tower');\n    }\n  };\n\n  return (\n    <div class=\"main-menu\">\n      {/* Left character sprites */}\n      <div class=\"main-menu-characters main-menu-characters--left\">\n        {MENU_CHARACTERS.left.map((char, i) => (\n          <img\n            key={char.name}\n            src={char.sprite}\n            alt={char.name}\n            class=\"main-menu-sprite\"\n            style={{ animationDelay: `${i * 0.3}s` }}\n          />\n        ))}\n      </div>\n\n      <div class=\"main-menu-content\">\n        <h1 class=\"main-menu-title\">Vale Chronicles</h1>\n        <div class=\"main-menu-options\">\n          {menuOptions.map((option) => {\n            const isEnabled = option.enabled;\n            const enabledIndex = enabledOptions.findIndex(opt => opt.id === option.id);\n            const isSelected = enabledIndex === safeSelectedIndex && isEnabled;\n\n            return (\n              <button\n                key={option.id}\n                class={`main-menu-option ${isSelected ? 'selected' : ''} ${!isEnabled ? 'disabled' : ''}`}\n                onClick={() => isEnabled && handleSelectOption(option.id)}\n                disabled={!isEnabled}\n              >\n                {option.label}\n              </button>\n            );\n          })}\n        </div>\n      </div>\n\n      {/* Right character sprites */}\n      <div class=\"main-menu-characters main-menu-characters--right\">\n        {MENU_CHARACTERS.right.map((char, i) => (\n          <img\n            key={char.name}\n            src={char.sprite}\n            alt={char.name}\n            class=\"main-menu-sprite\"\n            style={{ animationDelay: `${i * 0.3}s` }}\n          />\n        ))}\n      </div>\n    </div>\n  );\n}\n","/**\n * EquipmentIcon Component\n * Displays equipment sprites with fallback icons\n */\n\nimport { JSX } from 'preact';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport type { Equipment } from '../../core/models/Equipment';\n\ninterface EquipmentIconProps {\n  /** Equipment item */\n  equipment: Equipment;\n\n  /** Size variant */\n  size?: 'small' | 'medium' | 'large';\n\n  /** Custom className */\n  className?: string;\n\n  /** Custom style */\n  style?: Record<string, string | number>;\n}\n\nconst SIZE_MAP = {\n  small: { width: 24, height: 24 },\n  medium: { width: 32, height: 32 },\n  large: { width: 48, height: 48 },\n};\n\n/**\n * Get emoji icon for equipment slot\n */\nfunction getSlotIcon(slot: Equipment['slot']): string {\n  switch (slot) {\n    case 'weapon':\n      return '';\n    case 'armor':\n      return '';\n    case 'helm':\n      return '';\n    case 'boots':\n      return '';\n    case 'accessory':\n      return '';\n    default:\n      return '';\n  }\n}\n\n/**\n * Get color for equipment tier\n */\nfunction getTierColor(tier: Equipment['tier']): string {\n  switch (tier) {\n    case 'basic':\n      return '#9ca3af';\n    case 'bronze':\n      return '#cd7f32';\n    case 'iron':\n      return '#4a5568';\n    case 'steel':\n      return '#718096';\n    case 'silver':\n      return '#c0c0c0';\n    case 'mythril':\n      return '#a0a0ff';\n    case 'legendary':\n      return '#ffd700';\n    case 'artifact':\n      return '#ff00ff';\n    default:\n      return '#9ca3af';\n  }\n}\n\n/**\n * EquipmentIcon component\n * Displays equipment sprite with automatic fallback to colored emoji icons\n */\nexport function EquipmentIcon({\n  equipment,\n  size = 'medium',\n  className,\n  style,\n}: EquipmentIconProps): JSX.Element {\n  const sizeStyles = SIZE_MAP[size];\n  const icon = getSlotIcon(equipment.slot);\n  const tierColor = getTierColor(equipment.tier);\n\n  // SimpleSprite will automatically show fallback if sprite not found\n  // Try flexible lookup: equipment ID might match item icon sprites\n  return (\n    <SimpleSprite\n      id={equipment.id.toLowerCase()}\n      width={sizeStyles.width}\n      height={sizeStyles.height}\n      className={className}\n      style={style}\n      fallback={\n        <div\n          style={{\n            ...sizeStyles,\n            backgroundColor: tierColor,\n            color: '#fff',\n            display: 'flex',\n            alignItems: 'center',\n            justifyContent: 'center',\n            borderRadius: '4px',\n            fontSize: size === 'small' ? '12px' : size === 'medium' ? '16px' : '24px',\n            border: '2px solid rgba(0,0,0,0.2)',\n          }}\n          title={`${equipment.name} (${equipment.tier})`}\n        >\n          {icon}\n        </div>\n      }\n    />\n  );\n}\n","/**\n * EnemyPortalTile Component\n * Minimal enemy display (illustrative portal tile design)\n */\n\nimport { JSX } from 'preact';\nimport { ENCOUNTERS } from '@/data/definitions/encounters';\nimport { ENEMIES } from '@/data/definitions/enemies';\nimport { getEnemyBattleSprite } from '../sprites/mappings';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\n\ninterface EnemyPortalTileProps {\n  encounterId: string;\n}\n\nexport function EnemyPortalTile({ encounterId }: EnemyPortalTileProps): JSX.Element {\n  const encounter = ENCOUNTERS[encounterId];\n  if (!encounter) {\n    return (\n      <div class=\"enemies-section\">\n        <div class=\"enemy-portal\">\n          <div class=\"portal-title\">ENEMIES</div>\n          <div class=\"portal-enemies\">Unknown</div>\n        </div>\n      </div>\n    );\n  }\n\n  // Get enemy names from encounter\n  const enemyNames = encounter.enemies\n    .map((enemyId) => {\n      const enemy = ENEMIES[enemyId];\n      return enemy?.name || enemyId;\n    })\n    .join('  ');\n\n  const enemyEntries = encounter.enemies.map((enemyId) => {\n    const enemy = ENEMIES[enemyId];\n    return {\n      id: enemyId,\n      name: enemy?.name ?? enemyId,\n      spriteId: getEnemyBattleSprite(enemyId, 'idle'),\n    };\n  });\n\n  return (\n    <div class=\"enemies-section\">\n      <div class=\"enemy-portal\">\n        <div class=\"portal-icon\"></div>\n        <div class=\"portal-title\">ENEMIES</div>\n        <div class=\"portal-enemies\">{enemyNames || 'None'}</div>\n        <div class=\"enemy-portraits\">\n          {enemyEntries.map((entry) => (\n            <div key={entry.id} class=\"enemy-portrait-chip\">\n              {entry.spriteId ? (\n                <SimpleSprite id={entry.spriteId} width={36} height={36} alt={entry.name} />\n              ) : (\n                <div class=\"enemy-portrait-fallback\">?</div>\n              )}\n              <span>{entry.name}</span>\n            </div>\n          ))}\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * PreBattleTeamSelectScreenV2 Component\n *\n * Clean, mockup-inspired team selection screen.\n * Features:\n * - Two-panel layout: Available Units (left) | Selected Team (right)\n * - Auto-sorts selected units by SPD (fastest first)\n * - Shows turn order badges (1st, 2nd, 3rd, 4th)\n * - Golden Sun-inspired earthy color palette\n */\n\nimport { JSX } from 'preact';\nimport { useEffect, useCallback, useMemo } from 'preact/hooks';\nimport { useStore } from '../state/store';\nimport { ENCOUNTERS } from '@/data/definitions/encounters';\nimport { validateBattleConfig } from '../state/battleConfig';\nimport { createEmptyLoadout } from '@/core/models/Equipment';\nimport type { EquipmentLoadout, EquipmentSlot } from '@/core/models/Equipment';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport { getPortraitSprite } from '../sprites/mappings';\nimport { EnemyPortalTile } from './EnemyPortalTile';\nimport type { Unit } from '@/core/models/Unit';\nimport { DJINN } from '@/data/definitions/djinn';\nimport './PreBattleTeamSelectScreenV2.css';\n\ninterface PreBattleTeamSelectScreenV2Props {\n  encounterId: string;\n  onConfirm: () => void;\n  onCancel: () => void;\n}\n\n// Ordinal suffixes for turn order\nconst ORDINALS = ['1st', '2nd', '3rd', '4th'] as const;\nconst EQUIPMENT_SLOT_ORDER: EquipmentSlot[] = ['weapon', 'armor', 'helm', 'boots', 'accessory'];\nconst EQUIPMENT_SLOT_LABELS: Record<EquipmentSlot, string> = {\n  weapon: 'Weapon',\n  armor: 'Armor',\n  helm: 'Helm',\n  boots: 'Boots',\n  accessory: 'Accessory',\n};\n\nexport function PreBattleTeamSelectScreenV2({\n  encounterId,\n  onConfirm,\n  onCancel,\n}: PreBattleTeamSelectScreenV2Props): JSX.Element {\n  const {\n    roster,\n    team,\n    currentBattleConfig,\n    updateBattleConfigSlot,\n    equipment: inventory,\n  } = useStore((s) => ({\n    roster: s.roster,\n    team: s.team,\n    currentBattleConfig: s.currentBattleConfig,\n    updateBattleConfigSlot: s.updateBattleConfigSlot,\n    equipment: s.equipment,\n  }));\n\n  const encounter = ENCOUNTERS[encounterId];\n  const battleConfig = currentBattleConfig;\n  const slots = battleConfig?.slots ?? [];\n  const djinnSlots = battleConfig?.djinnSlots ?? [];\n\n  // Get all available units (roster + team units)\n  const allUnits = useMemo(() => {\n    const unitMap = new Map<string, Unit>();\n    roster.forEach((u) => unitMap.set(u.id, u));\n    team?.units.forEach((u) => unitMap.set(u.id, u));\n    return Array.from(unitMap.values());\n  }, [roster, team]);\n\n  // Get currently selected unit IDs from battle config\n  const selectedUnitIds = useMemo(() =>\n    slots\n      .map((slot) => slot.unitId)\n      .filter((id): id is string => Boolean(id)),\n    [slots]\n  );\n\n  // Get selected units sorted by speed (descending)\n  const selectedUnits = useMemo(() => {\n    return selectedUnitIds\n      .map((id) => allUnits.find((u) => u.id === id))\n      .filter((u): u is Unit => Boolean(u))\n      .sort((a, b) => {\n        // Primary: base speed (descending) - good approximation for turn order preview\n        const speedDiff = b.baseStats.spd - a.baseStats.spd;\n        if (speedDiff !== 0) return speedDiff;\n        // Tiebreaker: level\n        return b.level - a.level;\n      });\n  }, [selectedUnitIds, allUnits]);\n\n  // Available units (not selected)\n  const availableUnits = useMemo(() =>\n    allUnits.filter((u) => !selectedUnitIds.includes(u.id)),\n    [allUnits, selectedUnitIds]\n  );\n\n  const loadoutByUnitId = useMemo(() => {\n    const map = new Map<string, EquipmentLoadout>();\n    slots.forEach((slot) => {\n      if (slot.unitId) {\n        map.set(slot.unitId, slot.equipmentLoadout ?? createEmptyLoadout());\n      }\n    });\n    return map;\n  }, [slots]);\n\n  // Validation\n  const configValidation = useMemo(() => {\n    if (!battleConfig) {\n      return { valid: false, message: 'Battle configuration missing' };\n    }\n    return validateBattleConfig(battleConfig, inventory, roster, team);\n  }, [battleConfig, inventory, roster, team]);\n\n  // Toggle unit selection\n  const handleUnitToggle = useCallback((unit: Unit) => {\n    const isSelected = selectedUnitIds.includes(unit.id);\n\n    if (isSelected) {\n      // Find which slot has this unit and clear it\n      const slotIndex = slots.findIndex((s) => s.unitId === unit.id);\n      if (slotIndex !== -1) {\n        updateBattleConfigSlot(slotIndex, null);\n      }\n    } else if (selectedUnitIds.length < 4) {\n      // Find first empty slot and fill it\n      const emptySlotIndex = slots.findIndex((s) => !s.unitId);\n      if (emptySlotIndex !== -1) {\n        updateBattleConfigSlot(emptySlotIndex, unit.id);\n      }\n    }\n  }, [selectedUnitIds, slots, updateBattleConfigSlot]);\n\n  // Remove unit from team\n  const handleRemoveUnit = useCallback((unitId: string) => {\n    const slotIndex = slots.findIndex((s) => s.unitId === unitId);\n    if (slotIndex !== -1) {\n      updateBattleConfigSlot(slotIndex, null);\n    }\n  }, [slots, updateBattleConfigSlot]);\n\n  // Start battle\n  const handleStartBattle = useCallback(() => {\n    if (!battleConfig || !configValidation.valid) return;\n    onConfirm();\n  }, [battleConfig, configValidation.valid, onConfirm]);\n\n  // Keyboard shortcuts\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === 'Escape') {\n        e.preventDefault();\n        onCancel();\n      } else if (e.key === 'Enter' && configValidation.valid) {\n        e.preventDefault();\n        handleStartBattle();\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown, true);\n    return () => window.removeEventListener('keydown', handleKeyDown, true);\n  }, [configValidation.valid, handleStartBattle, onCancel]);\n\n  // Error states\n  if (!encounter) {\n    return (\n      <div class=\"prebattle-v2-overlay\">\n        <div class=\"prebattle-v2-error\">\n          <div>Error: Encounter not found</div>\n          <button onClick={onCancel}>Close</button>\n        </div>\n      </div>\n    );\n  }\n\n  if (!team || !battleConfig) {\n    return (\n      <div class=\"prebattle-v2-overlay\">\n        <div class=\"prebattle-v2-error\">\n          <div>Error: Team or battle config missing</div>\n          <button onClick={onCancel}>Close</button>\n        </div>\n      </div>\n    );\n  }\n\n  return (\n    <div class=\"prebattle-v2-overlay\">\n      <div class=\"prebattle-v2-container\">\n        {/* Header */}\n        <div class=\"prebattle-v2-header\">\n          <div class=\"prebattle-v2-title\">Select Your Team</div>\n          <div class=\"prebattle-v2-subtitle\">\n            {encounter.name}  {encounter.difficulty}  {encounter.reward.xp} XP\n          </div>\n        </div>\n\n        {/* Main Content */}\n        <div class=\"prebattle-v2-layout\">\n          {/* Left Panel: Available Units */}\n          <div class=\"prebattle-v2-available\">\n            <div class=\"panel-title\">Available Units</div>\n            <div class=\"unit-roster\">\n              {availableUnits.map((unit) => (\n                <div\n                  key={unit.id}\n                  class={`roster-unit ${selectedUnitIds.length >= 4 ? 'disabled' : ''}`}\n                  onClick={() => handleUnitToggle(unit)}\n                >\n                  <div class=\"roster-unit-sprite\">\n                    <SimpleSprite\n                      id={getPortraitSprite(unit.id)}\n                      width={40}\n                      height={40}\n                    />\n                  </div>\n                  <div class=\"roster-unit-info\">\n                    <div class=\"roster-unit-name\">{unit.name}</div>\n                    <div class=\"roster-unit-stats\">\n                      Lv.{unit.level} | SPD: <span class=\"unit-speed\">{unit.baseStats.spd}</span>\n                    </div>\n                  </div>\n                  <div class={`roster-unit-element element-${unit.element.toLowerCase()}`}>\n                    {unit.element}\n                  </div>\n                </div>\n              ))}\n              {availableUnits.length === 0 && (\n                <div class=\"roster-empty\">All units selected!</div>\n              )}\n            </div>\n          </div>\n\n          {/* Right Panel: Selected Team */}\n          <div class=\"prebattle-v2-selected\">\n            <div class=\"panel-title\">Battle Party (Sorted by Speed)</div>\n            <div class=\"team-slots\">\n              {[0, 1, 2, 3].map((slotIndex) => {\n                const unit = selectedUnits[slotIndex];\n                return (\n                  <div\n                    key={slotIndex}\n                    class={`team-slot ${unit ? 'filled' : 'empty'}`}\n                  >\n                    <span class=\"slot-badge\">{ORDINALS[slotIndex]}</span>\n                    <span class=\"slot-order\">{slotIndex + 1}</span>\n\n                    {unit ? (\n                      <>\n                        <div class=\"slot-sprite\">\n                          <SimpleSprite\n                            id={getPortraitSprite(unit.id)}\n                            width={40}\n                            height={40}\n                          />\n                        </div>\n                        <div class=\"slot-unit-info\">\n                          <div class=\"slot-unit-name\">{unit.name}</div>\n                          <div class=\"slot-unit-speed\">SPD: {unit.baseStats.spd}</div>\n                        </div>\n                        <button\n                          class=\"remove-btn\"\n                          onClick={(e) => {\n                            e.stopPropagation();\n                            handleRemoveUnit(unit.id);\n                          }}\n                          aria-label={`Remove ${unit.name}`}\n                        >\n                          \n                        </button>\n                      </>\n                    ) : (\n                      <span class=\"slot-empty-text\">\n                        {slotIndex === 0 ? 'Empty - Fastest' : slotIndex === 3 ? 'Empty - Slowest' : 'Empty'}\n                      </span>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n\n            {/* Enemy Preview */}\n            <div class=\"enemy-preview\">\n              <div class=\"panel-title\">Enemies</div>\n              <div class=\"enemy-portal-wrap\">\n                <EnemyPortalTile encounterId={encounterId} />\n              </div>\n            </div>\n\n            {/* Loadout Preview */}\n            <div class=\"loadout-preview\">\n              <div class=\"panel-title\">Equipment &amp; Djinn</div>\n              <div class=\"loadout-columns\">\n                <div class=\"gear-summary\">\n                  <div class=\"loadout-subtitle\">Selected Gear</div>\n                  {selectedUnits.length === 0 ? (\n                    <div class=\"loadout-empty\">Add units to see their equipped items.</div>\n                  ) : (\n                    selectedUnits.map((unit) => {\n                      const loadout = loadoutByUnitId.get(unit.id) ?? unit.equipment ?? createEmptyLoadout();\n                      return (\n                        <div class=\"gear-row\" key={unit.id}>\n                          <div class=\"gear-row-header\">\n                            <div class=\"gear-row-avatar\">\n                              <SimpleSprite id={getPortraitSprite(unit.id)} width={28} height={28} />\n                            </div>\n                            <div class=\"gear-row-name\">{unit.name}</div>\n                            <span class={`gear-row-element element-${unit.element.toLowerCase()}`}>\n                              {unit.element}\n                            </span>\n                          </div>\n                          <div class=\"gear-tags\">\n                            {EQUIPMENT_SLOT_ORDER.map((slot) => {\n                              const item = loadout[slot];\n                              return (\n                                <span class={`gear-tag ${item ? 'filled' : 'empty'}`} key={`${unit.id}-${slot}`}>\n                                  <span class=\"gear-slot-label\">{EQUIPMENT_SLOT_LABELS[slot]}</span>\n                                  <span class=\"gear-item-name\">{item ? item.name : 'None'}</span>\n                                </span>\n                              );\n                            })}\n                          </div>\n                        </div>\n                      );\n                    })\n                  )}\n                </div>\n                <div class=\"djinn-summary\">\n                  <div class=\"loadout-subtitle\">Team Djinn</div>\n                  <div class=\"djinn-chips\">\n                    {djinnSlots.map((djinnId, index) => {\n                      const djinnData = djinnId ? DJINN[djinnId] : undefined;\n                      const elementLabel = djinnData?.element ?? 'Neutral';\n                      const elementClass = elementLabel.toLowerCase();\n                      return (\n                        <div class={`djinn-chip ${djinnId ? 'filled' : 'empty'}`} key={`${djinnId ?? 'empty'}-${index}`}>\n                          <div class=\"djinn-chip-row\">\n                            <span class=\"djinn-slot-label\">Slot {index + 1}</span>\n                            {djinnId && (\n                              <span class={`djinn-element-badge element-${elementClass}`}>\n                                {elementLabel}\n                              </span>\n                            )}\n                          </div>\n                          <div class=\"djinn-name\">{djinnId ? djinnData?.name ?? djinnId : 'Empty'}</div>\n                        </div>\n                      );\n                    })}\n                  </div>\n                  <div class=\"djinn-note\">Djinn bonuses apply to every unit in this party.</div>\n                </div>\n              </div>\n            </div>\n\n            {/* Start Battle Button */}\n            <button\n              class=\"start-battle-btn\"\n              onClick={handleStartBattle}\n              disabled={!configValidation.valid}\n            >\n              {configValidation.valid\n                ? `Start Battle (${selectedUnits.length} unit${selectedUnits.length !== 1 ? 's' : ''})`\n                : configValidation.message ?? 'Select at least 1 unit'}\n            </button>\n          </div>\n        </div>\n\n        {/* Footer with Cancel */}\n        <div class=\"prebattle-v2-footer\">\n          <button class=\"cancel-btn\" onClick={onCancel}>\n             Cancel\n          </button>\n          <div class=\"keyboard-hints\">\n            <span class=\"key\">Enter</span> Start &nbsp;|&nbsp; <span class=\"key\">Esc</span> Cancel\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { JSX } from 'preact';\nimport type { Equipment } from '../../data/schemas/EquipmentSchema';\nimport { EquipmentIcon } from './EquipmentIcon';\n\ninterface EquipmentChoicePickerProps {\n  options: Equipment[];\n  onSelect: (equipment: Equipment) => void;\n}\n\nexport function EquipmentChoicePicker({ options, onSelect }: EquipmentChoicePickerProps): JSX.Element {\n  return (\n    <div\n      style={{\n        backgroundColor: 'rgba(0, 0, 0, 0.9)',\n        padding: '2rem',\n        borderRadius: '8px',\n        border: '2px solid gold',\n        marginTop: '1.5rem',\n        textAlign: 'center',\n        maxWidth: '800px',\n        marginLeft: 'auto',\n        marginRight: 'auto',\n      }}\n    >\n      <h3 style={{ color: '#FFD700', marginBottom: '1.5rem' }}> Choose Your Reward! </h3>\n      <div style={{ display: 'flex', gap: '1rem', justifyContent: 'center', flexWrap: 'wrap' }}>\n        {options.map((equipment) => (\n          <button\n            key={equipment.id}\n            onClick={() => onSelect(equipment)}\n            style={{\n              padding: '1rem',\n              backgroundColor: '#2c2c2c',\n              border: '2px solid #FFD700',\n              borderRadius: '8px',\n              cursor: 'pointer',\n              transition: 'all 0.2s ease',\n              minWidth: '200px',\n              maxWidth: '260px',\n              color: '#fff',\n              textAlign: 'left',\n            }}\n            onMouseEnter={(event: MouseEvent) => {\n              const target = event.currentTarget as HTMLButtonElement;\n              target.style.transform = 'scale(1.05)';\n              target.style.backgroundColor = '#3c3c3c';\n              target.style.borderColor = '#FFA500';\n            }}\n            onMouseLeave={(event: MouseEvent) => {\n              const target = event.currentTarget as HTMLButtonElement;\n              target.style.transform = 'scale(1)';\n              target.style.backgroundColor = '#2c2c2c';\n              target.style.borderColor = '#FFD700';\n            }}\n          >\n            <EquipmentIcon equipment={equipment} size=\"medium\" />\n            <div style={{ marginTop: '0.5rem' }}>\n              <div\n                style={{\n                  fontWeight: 'bold',\n                  fontSize: '1.1rem',\n                  color: getTierColor(equipment.tier),\n                }}\n              >\n                {equipment.name}\n              </div>\n              <div style={{ fontSize: '0.85rem', color: '#ccc', marginTop: '0.25rem' }}>\n                {equipment.slot.toUpperCase()}\n              </div>\n              <div style={{ marginTop: '0.5rem', fontSize: '0.85rem', color: '#fff' }}>\n                {formatStatBonus(equipment.statBonus)}\n              </div>\n              {equipment.unlocksAbility && (\n                <div\n                  style={{\n                    marginTop: '0.5rem',\n                    fontSize: '0.75rem',\n                    color: '#FFD700',\n                    fontStyle: 'italic',\n                  }}\n                >\n                  Unlocks: {equipment.unlocksAbility}\n                </div>\n              )}\n            </div>\n          </button>\n        ))}\n      </div>\n    </div>\n  );\n}\n\nfunction getTierColor(tier: Equipment['tier']) {\n  const colors: Record<Equipment['tier'], string> = {\n    basic: '#999999',\n    bronze: '#CD7F32',\n    iron: '#C0C0C0',\n    steel: '#B0C4DE',\n    silver: '#E8E8E8',\n    mythril: '#9370DB',\n    legendary: '#FFD700',\n    artifact: '#FF1493',\n  };\n  return colors[tier] ?? '#fff';\n}\n\nfunction formatStatBonus(statBonus: Partial<Record<string, number>>): string {\n  const parts: string[] = [];\n  if (statBonus.atk) parts.push(`+${statBonus.atk} ATK`);\n  if (statBonus.def) parts.push(`+${statBonus.def} DEF`);\n  if (statBonus.hp) parts.push(`+${statBonus.hp} HP`);\n  if (statBonus.mag) parts.push(`+${statBonus.mag} MAG`);\n  if (statBonus.spd) parts.push(`+${statBonus.spd} SPD`);\n  return parts.length > 0 ? parts.join('  ') : 'No stat bonus';\n}\n","/**\n * RewardsScreen Component\n * Displays post-battle rewards: XP, gold, equipment, level-ups\n *\n * Enhanced with Golden Sun-inspired victory presentation:\n * - Animated victory banner with golden glow\n * - Bouncing party member sprites\n * - Falling sparkle effects\n * - Earthy color palette\n */\n\nimport { JSX } from 'preact';\nimport { useEffect, useMemo } from 'preact/hooks';\nimport type { RewardDistribution } from '../../core/models/Rewards';\nimport type { Team } from '../../core/models/Team';\nimport type { Equipment } from '../../data/schemas/EquipmentSchema';\nimport { BattleUnitSprite } from './BattleUnitSprite';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport { getPortraitSprite } from '../sprites/mappings';\nimport { EquipmentIcon } from './EquipmentIcon';\nimport { EquipmentChoicePicker } from './EquipmentChoicePicker';\nimport './RewardsScreen.css';\nimport { DJINN } from '../../data/definitions/djinn';\n\n/** Sparkle effect component for victory celebration */\nfunction VictorySparkles(): JSX.Element {\n  return (\n    <div class=\"victory-sparkles\" aria-hidden=\"true\">\n      {[...Array(12)].map((_, i) => (\n        <div\n          key={i}\n          class=\"sparkle\"\n          style={{ '--delay': `${i * 0.25}s`, '--left': `${5 + i * 8}%` } satisfies JSX.CSSProperties}\n        />\n      ))}\n    </div>\n  );\n}\n\ninterface RewardsScreenProps {\n  rewards: RewardDistribution;\n  team: Team;\n  onContinue: () => void;\n  onSelectEquipment: (equipment: Equipment) => void;\n}\n\nexport function RewardsScreen({ rewards, team, onContinue, onSelectEquipment }: RewardsScreenProps): JSX.Element {\n  // Get surviving party members for the victory display\n  const partyMembers = useMemo(() => {\n    return team.units.filter(u => u.currentHp > 0).slice(0, 4);\n  }, [team.units]);\n\n  // Look up units for level-ups\n  const levelUpUnits = rewards.levelUps\n    .map(levelUp => {\n      const unit = team.units.find(u => u.id === levelUp.unitId);\n      if (!unit) {\n        if (import.meta.env.DEV) {\n          // TODO: Add proper error logging for missing unit\n          // console.warn(`Unit not found for level-up: ${levelUp.unitId}`);\n        }\n        return null;\n      }\n      return {\n        unit,\n        oldLevel: levelUp.oldLevel,\n        newLevel: levelUp.newLevel,\n        statGains: levelUp.statGains,\n        unlockedAbilities: levelUp.newAbilitiesUnlocked,\n      };\n    })\n    .filter((entry): entry is NonNullable<typeof entry> => entry !== null);\n\n  const hasPendingChoice = rewards.equipmentChoice && !rewards.choiceSelected;\n  const obtainedEquipment = rewards.choiceSelected\n    ? [rewards.choiceSelected]\n    : rewards.fixedEquipment\n      ? [rewards.fixedEquipment]\n      : [];\n  const latestDjinnId = team.collectedDjinn[team.collectedDjinn.length - 1];\n  const latestDjinn = latestDjinnId ? DJINN[latestDjinnId] : null;\n\n  // Keyboard handler\n  useEffect(() => {\n    const handleKeyDown = (event: KeyboardEvent) => {\n      // Handle equipment choice selection (1-9)\n      if (hasPendingChoice && rewards.equipmentChoice) {\n        const num = parseInt(event.key, 10);\n        if (!Number.isNaN(num) && num >= 1 && num <= rewards.equipmentChoice.length) {\n          event.preventDefault();\n          event.stopPropagation();\n          const selected = rewards.equipmentChoice[num - 1];\n          if (selected) {\n            onSelectEquipment(selected);\n          }\n          return;\n        }\n      }\n\n      // Handle continue (Enter/Space)\n      if (!hasPendingChoice || rewards.choiceSelected) {\n        if (event.key === 'Enter' || event.key === ' ' || event.code === 'Enter' || event.code === 'Space') {\n          event.preventDefault();\n          event.stopPropagation();\n          onContinue();\n          return;\n        }\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown, true); // Use capture phase\n    return () => window.removeEventListener('keydown', handleKeyDown, true);\n  }, [hasPendingChoice, rewards.equipmentChoice, rewards.choiceSelected, onContinue, onSelectEquipment]);\n\n  return (\n    <div class=\"rewards-screen rewards-screen--golden-sun\">\n      {/* Sparkle effects overlay */}\n      <VictorySparkles />\n\n      <div class=\"rewards-container\">\n        {/* Victory Banner */}\n        <div class=\"victory-banner\" role=\"banner\">\n          <h1>VICTORY!</h1>\n          <div class=\"victory-sub\">All enemies defeated!</div>\n        </div>\n\n        {/* Party Display - Bouncing sprites */}\n        <div class=\"party-display\" aria-label=\"Victorious party members\">\n          {partyMembers.map((unit, index) => (\n            <div\n              key={unit.id}\n              class=\"party-member\"\n              style={{ '--index': index } satisfies JSX.CSSProperties}\n            >\n              <div class=\"party-sprite\">\n                <SimpleSprite\n                  id={getPortraitSprite(unit.id)}\n                  width={64}\n                  height={64}\n                />\n              </div>\n              <div class=\"party-name\">{unit.name}</div>\n            </div>\n          ))}\n        </div>\n\n        {/* Rewards Grid (XP + Money) */}\n        <div class=\"rewards-grid\">\n          {/* XP Gained */}\n          <div class=\"reward-card\" role=\"article\" aria-label={`${rewards.rewards.totalXp} experience points gained`}>\n            <div class=\"reward-icon\" aria-hidden=\"true\">XP</div>\n            <div class=\"reward-details\">\n              <div class=\"reward-label\">Experience</div>\n              <div class=\"reward-value highlight\">+{rewards.rewards.totalXp} XP</div>\n              {rewards.rewards.survivorCount > 0 && (\n                <div class=\"reward-subtext\">Split among {rewards.rewards.survivorCount} survivors</div>\n              )}\n            </div>\n          </div>\n\n          {/* Money Gained */}\n          <div class=\"reward-card\" role=\"article\" aria-label={`${rewards.goldEarned} gold coins gained`}>\n            <div class=\"reward-icon\" aria-hidden=\"true\">G</div>\n            <div class=\"reward-details\">\n              <div class=\"reward-label\">Gold</div>\n              <div class=\"reward-value highlight\">+{rewards.goldEarned} G</div>\n            </div>\n          </div>\n        </div>\n\n        {hasPendingChoice && (\n          <EquipmentChoicePicker\n            options={rewards.equipmentChoice!}\n            onSelect={onSelectEquipment}\n          />\n        )}\n\n        {obtainedEquipment.length > 0 && (\n          <section class=\"items-panel\" aria-label=\"Equipment obtained\">\n            <h2>EQUIPMENT OBTAINED</h2>\n            <div class=\"items-grid\">\n              {obtainedEquipment.map(item => (\n                <div key={item.id} class=\"item-card\">\n                  <EquipmentIcon equipment={item} size=\"small\" className=\"item-icon\" />\n                  <div class=\"item-name\">{item.name}</div>\n                  <div class=\"item-quantity\">x1</div>\n                </div>\n              ))}\n            </div>\n          </section>\n        )}\n\n        {/* Unit Recruitment Notification */}\n        {rewards.recruitedUnit && (\n          <section class=\"recruitment-panel\" role=\"alert\" aria-label={`Recruited ${rewards.recruitedUnit.name}`}>\n            <h2>NEW RECRUIT!</h2>\n            <div class=\"recruitment-unit\">\n              <div class=\"recruitment-sprite\">\n                <BattleUnitSprite unitId={rewards.recruitedUnit.id} state=\"idle\" size=\"medium\" />\n              </div>\n              <div class=\"recruitment-details\">\n                <div class=\"recruitment-name\">{rewards.recruitedUnit.name}</div>\n                <div class=\"recruitment-level\">Level {rewards.recruitedUnit.level}</div>\n                <div class=\"recruitment-element\">{rewards.recruitedUnit.element}</div>\n                <div class=\"recruitment-message\">has joined your roster!</div>\n              </div>\n            </div>\n          </section>\n        )}\n\n        {/* Djinn Acquisition Notification */}\n        {rewards.recruitedUnit && latestDjinn && (\n          <section class=\"djinn-panel\" role=\"alert\" aria-label={`Djinn ${latestDjinn.name} acquired`}>\n            <h2>DJINN ACQUIRED</h2>\n            <div class=\"djinn-acquisition\">\n              <div class=\"djinn-name\">{latestDjinn.name}</div>\n              <div class=\"djinn-element\">{latestDjinn.element}</div>\n              <div class=\"djinn-message\">has been added to your collection!</div>\n            </div>\n          </section>\n        )}\n\n        {/* Level Up Notification */}\n        {levelUpUnits.length > 0 && (\n          <section class=\"level-up-panel\" role=\"alert\" aria-label={`${levelUpUnits.length} units leveled up`}>\n            <h2>LEVEL UP!</h2>\n            <div class=\"level-up-units\">\n              {levelUpUnits.map((levelUp, index) => (\n                <div key={levelUp.unit.id} class=\"level-up-unit\" style={{ animationDelay: `${0.6 + index * 0.1}s` }}>\n                  <div class=\"level-up-sprite\">\n                    <BattleUnitSprite unitId={levelUp.unit.id} state=\"idle\" size=\"medium\" />\n                  </div>\n                  <div class=\"level-up-name\">{levelUp.unit.name}</div>\n                  <div class=\"level-up-arrow\">Lv {levelUp.oldLevel} -&gt; Lv {levelUp.newLevel}</div>\n                  <div class=\"level-up-stats\">\n                    {levelUp.statGains.hp > 0 && <span>+{levelUp.statGains.hp} HP</span>}\n                    {levelUp.statGains.atk > 0 && <span>+{levelUp.statGains.atk} ATK</span>}\n                    {levelUp.statGains.def > 0 && <span>+{levelUp.statGains.def} DEF</span>}\n                    {levelUp.statGains.mag > 0 && <span>+{levelUp.statGains.mag} MAG</span>}\n                    {levelUp.statGains.spd > 0 && <span>+{levelUp.statGains.spd} SPD</span>}\n                  </div>\n                  {levelUp.unlockedAbilities.length > 0 && (\n                    <div class=\"level-up-abilities\">\n                      Unlocked: {levelUp.unlockedAbilities.join(', ')}\n                    </div>\n                  )}\n                </div>\n              ))}\n            </div>\n          </section>\n        )}\n\n        {/* Continue Button */}\n        <div class=\"continue-container\">\n          <button\n            onClick={onContinue}\n            class=\"continue-btn\"\n            aria-label=\"Continue to next screen\"\n            disabled={hasPendingChoice && !rewards.choiceSelected}\n            style={{\n              opacity: hasPendingChoice && !rewards.choiceSelected ? 0.5 : 1,\n              cursor: hasPendingChoice && !rewards.choiceSelected ? 'not-allowed' : 'pointer',\n            }}\n          >\n            {hasPendingChoice && !rewards.choiceSelected ? 'SELECT EQUIPMENT FIRST' : 'CONTINUE'}\n          </button>\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * ShopScreen Component\n * Unlock equipment\n */\n\nimport { JSX } from 'preact';\nimport { useState } from 'preact/hooks';\nimport { useStore } from '../state/store';\nimport { SHOPS } from '../../data/definitions/shops';\nimport { EQUIPMENT } from '../../data/definitions/equipment';\nimport {\n  buyItem,\n  canAffordItem,\n  purchaseStarterKit,\n  purchaseUnitEquipment,\n} from '../../core/services/ShopService';\nimport { getStarterKit } from '../../data/definitions/starterKits';\nimport { EquipmentIcon } from './EquipmentIcon';\nimport './ShopScreen.css';\nimport type { Equipment } from '../../data/schemas/EquipmentSchema';\nimport type { Unit } from '../../core/models/Unit';\nimport { isAvailableInCampaign } from '../utils/contentAvailability';\n\ninterface ShopScreenProps {\n  shopId: string;\n  onClose: () => void;\n}\n\nexport function ShopScreen({ shopId, onClose }: ShopScreenProps): JSX.Element {\n  const { gold, addGold, addEquipment, team, updateTeamUnits } = useStore((s) => ({\n    gold: s.gold,\n    addGold: s.addGold,\n    addEquipment: s.addEquipment,\n    team: s.team,\n    updateTeamUnits: s.updateTeamUnits,\n  }));\n\n  const storyFlags = useStore((s) => s.story.flags);\n\n  const [error, setError] = useState<string | null>(null);\n\n  const shop = SHOPS[shopId];\n  if (!shop) {\n    return (\n      <div class=\"shop-screen-overlay\" onClick={onClose}>\n        <div class=\"shop-screen-container\" onClick={(e) => e.stopPropagation()}>\n          <div class=\"shop-error\">Shop not found: {shopId}</div>\n          <button class=\"close-btn\" onClick={onClose}>Close</button>\n        </div>\n      </div>\n    );\n  }\n\n  // Filter available items based on unlock condition\n  const isUnlocked = !shop.unlockCondition || shop.unlockCondition(storyFlags as Record<string, boolean>);\n  const availableItems = isUnlocked\n    ? (shop.availableItems\n        .map((id) => EQUIPMENT[id])\n        .filter((item): item is Equipment => Boolean(item))\n        .filter(isAvailableInCampaign))\n    : [];\n\n  const handleUnlock = (itemId: string) => {\n    setError(null);\n    const result = buyItem(gold, itemId);\n    if (!result.ok) {\n      setError(result.error);\n      return;\n    }\n\n    addGold(result.value.newGold - gold);\n    addEquipment([result.value.item]);\n  };\n\n  const starterKitEntries = team\n    ? team.units\n        .map((unit) => ({\n          unit,\n          kit: getStarterKit(unit), // CHANGED: Takes unit object (needs element)\n        }))\n        .filter(({ kit, unit }) => Boolean(kit) && !unit.storeUnlocked)\n        .map(({ unit, kit }) => ({ unit, kit: kit! }))\n    : [];\n\n  const unlockedUnits = team ? team.units.filter((unit) => unit.storeUnlocked) : [];\n\n  const handleStarterKitPurchase = (unitId: string) => {\n    if (!team) return;\n    const unit = team.units.find(u => u.id === unitId);\n    if (!unit) return;\n\n    setError(null);\n    const result = purchaseStarterKit(unit, gold); // CHANGED: Takes unit object\n    if (!result.ok) {\n      setError(result.error);\n      return;\n    }\n\n    addGold(result.value.newGold - gold);\n    addEquipment(result.value.equipment);\n\n    const updatedUnits = team.units.map((unit) =>\n      unit.id === unitId ? { ...unit, storeUnlocked: true } : unit\n    );\n    updateTeamUnits(updatedUnits);\n  };\n\n  const handleUnitEquipmentPurchase = (unit: Unit, itemId: string) => {\n    setError(null);\n    const result = purchaseUnitEquipment(unit, gold, itemId);\n    if (!result.ok) {\n      setError(result.error);\n      return;\n    }\n\n    addGold(result.value.newGold - gold);\n    addEquipment([result.value.item]);\n  };\n\n  return (\n    <div class=\"shop-screen-overlay\" onClick={onClose}>\n      <div class=\"shop-screen-container\" onClick={(e) => e.stopPropagation()}>\n        <div class=\"shop-header\">\n          <h1>{shop.name}</h1>\n          <button class=\"close-btn\" onClick={onClose} aria-label=\"Close shop\">\n            \n          </button>\n        </div>\n\n        <div class=\"shop-note\" style={{ fontSize: '0.85rem', color: '#a8b3c0', padding: '0 1rem', marginBottom: '0.5rem' }}>\n          Unlock shared, element-locked equipment for your roster here. Each item lives in the shared inventory and\n          the Pre-Battle screen determines who wields it during the next encounter.\n        </div>\n\n        <div class=\"shop-gold\">\n          <span class=\"gold-label\">Gold:</span>\n          <span class=\"gold-value\">{gold}g</span>\n        </div>\n\n        {error && (\n          <div class=\"shop-error\" role=\"alert\">\n            {error}\n          </div>\n        )}\n\n        <div class=\"shop-content\">\n          <section class=\"starter-kits-section\">\n            <h2>Starter Kits</h2>\n            {starterKitEntries.length === 0 ? (\n              <div class=\"shop-empty\">All Starter Kits unlocked.</div>\n            ) : (\n              <div class=\"shop-items-grid\">\n                {starterKitEntries.map(({ unit, kit }) => {\n                  const affordable = gold >= kit.cost;\n                  return (\n                    <div\n                      key={unit.id}\n                      class={`shop-item-card ${!affordable ? 'unaffordable' : ''}`}\n                    >\n                      <div class=\"item-details\">\n                        <div class=\"item-name\">{kit.name}</div>\n                        <div class=\"item-stats\">\n                          <span class=\"stat-badge\">{unit.name}</span>\n                          <span class=\"stat-badge\">{kit.cost}g</span>\n                        </div>\n                      </div>\n                      <button\n                        class=\"buy-btn\"\n                        onClick={() => handleStarterKitPurchase(unit.id)}\n                        disabled={!affordable}\n                      >\n                        Purchase Starter Kit\n                      </button>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </section>\n\n          {unlockedUnits.map((unit) => {\n            const availableEquipment = Object.values(EQUIPMENT).filter(\n              (item) => isAvailableInCampaign(item) && item.allowedElements.includes(unit.element)\n            );\n            return (\n              <section key={unit.id} class=\"unit-store-section\">\n                <h2>{unit.name}&apos;s Equipment</h2>\n                {availableEquipment.length === 0 ? (\n                  <div class=\"shop-empty\">No equipment available yet.</div>\n                ) : (\n                  <div class=\"shop-items-grid\">\n                    {availableEquipment.map((item) => {\n                      const affordable = canAffordItem(gold, item.id);\n                      return (\n                        <div\n                          key={`${unit.id}-${item.id}`}\n                          class={`shop-item-card ${!affordable ? 'unaffordable' : ''}`}\n                        >\n                          <div class=\"item-icon\">\n                            <EquipmentIcon equipment={item} />\n                          </div>\n                          <div class=\"item-details\">\n                            <div class=\"item-name\">{item.name}</div>\n                            <div class=\"item-stats\">\n                              {Object.entries(item.statBonus).map(([stat, value]) => (\n                                <span key={stat} class=\"stat-badge\">\n                                  +{value} {stat.toUpperCase()}\n                                </span>\n                              ))}\n                            </div>\n                            <div class=\"item-price\">{item.cost}g</div>\n                          </div>\n                          <button\n                            class=\"buy-btn\"\n                            onClick={() => handleUnitEquipmentPurchase(unit, item.id)}\n                            disabled={!affordable}\n                          >\n                            Purchase for {unit.name}\n                          </button>\n                        </div>\n                      );\n                    })}\n                  </div>\n                )}\n              </section>\n            );\n          })}\n\n          <section class=\"shop-general-section\">\n            {!isUnlocked ? (\n              <div class=\"shop-locked\">\n                This shop is not yet available.\n              </div>\n            ) : availableItems.length === 0 ? (\n              <div class=\"shop-empty\">No items available.</div>\n            ) : (\n              <div class=\"shop-items-grid\">\n                {availableItems.map((item) => {\n                  const affordable = canAffordItem(gold, item.id);\n                  return (\n                    <div\n                      key={item.id}\n                      class={`shop-item-card ${!affordable ? 'unaffordable' : ''}`}\n                    >\n                      <div class=\"item-icon\">\n                        <EquipmentIcon equipment={item} />\n                      </div>\n                      <div class=\"item-details\">\n                        <div class=\"item-name\">{item.name}</div>\n                        <div class=\"item-stats\">\n                          {Object.entries(item.statBonus).map(([stat, value]) => (\n                            <span key={stat} class=\"stat-badge\">\n                              +{value} {stat.toUpperCase()}\n                            </span>\n                          ))}\n                        </div>\n                        <div class=\"item-price\">{item.cost}g</div>\n                      </div>\n                      <button\n                        class=\"buy-btn\"\n                        onClick={() => handleUnlock(item.id)}\n                        disabled={!affordable}\n                      >\n                        Unlock Equipment\n                      </button>\n                    </div>\n                  );\n                })}\n              </div>\n            )}\n          </section>\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * PartyManagementScreen Component\n * Now a Unit Compendium - shows all recruited units and their details\n */\n\nimport { JSX } from 'preact';\nimport { useState } from 'preact/hooks';\nimport { useStore } from '../state/store';\nimport { calculateEffectiveStats } from '@/core/algorithms/stats';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport { warnIfPlaceholderSprite } from '../sprites/utils/warnIfPlaceholderSprite';\nimport { getPortraitSprite, getAbilityIconSprite } from '../sprites/mappings';\nimport './PartyManagementScreen.css';\n\ninterface PartyManagementScreenProps {\n  onClose: () => void;\n}\n\nexport function PartyManagementScreen({ onClose }: PartyManagementScreenProps): JSX.Element {\n  const { team, roster } = useStore((s) => ({\n    team: s.team,\n    roster: s.roster,\n  }));\n\n  const [selectedUnitId, setSelectedUnitId] = useState<string | null>(null);\n\n  if (!team) {\n    return (\n      <div class=\"party-management-overlay\" onClick={onClose}>\n        <div class=\"party-management-container\" onClick={(e) => e.stopPropagation()}>\n          <div class=\"party-error\">No team data available</div>\n          <button class=\"close-btn\" onClick={onClose}>Close</button>\n        </div>\n      </div>\n    );\n  }\n\n  const activeUnitIds = new Set(team.units.map((u) => u.id));\n  const selectedUnit = roster.find((u) => u.id === selectedUnitId);\n  const selectedStats = selectedUnit ? calculateEffectiveStats(selectedUnit, team) : null;\n\n  return (\n    <div class=\"party-management-overlay\" onClick={onClose}>\n      <div class=\"party-management-container\" onClick={(e) => e.stopPropagation()}>\n        <div class=\"party-management-header\">\n          <h1>Unit Compendium</h1>\n          <button class=\"close-btn\" onClick={onClose} aria-label=\"Close compendium\">\n            \n          </button>\n        </div>\n\n        <div class=\"party-instructions\">\n          <p>\n            Browse your full roster and review each unit&apos;s stats. The battle formation and loadouts you see here\n            are only a snapshotfinal selections happen on the Pre-Battle screen before each fight.\n          </p>\n        </div>\n\n        <div class=\"party-content\">\n          {/* Unit List */}\n          <div class=\"party-section\">\n            <h2>Roster ({roster.length})</h2>\n            <div class=\"party-grid\">\n              {roster.map((unit) => {\n                const isActive = activeUnitIds.has(unit.id);\n                const isSelected = selectedUnitId === unit.id;\n\n                return (\n                  <div\n                    key={unit.id}\n                    class={`party-member-card ${isSelected ? 'selected' : ''} ${isActive ? 'active' : ''}`}\n                    onClick={() => setSelectedUnitId(unit.id)}\n                  >\n                    <div class=\"member-icon\">\n                      {(() => {\n                        const portraitId = getPortraitSprite(unit.id);\n                        warnIfPlaceholderSprite('PartyManagementScreen', portraitId);\n                        return (\n                          <SimpleSprite\n                            id={portraitId}\n                            width={64}\n                            height={64}\n                            style={{ borderRadius: '8px' }}\n                          />\n                        );\n                      })()}\n                    </div>\n                    <div class=\"member-info\">\n                      <div class=\"member-name\">{unit.name}</div>\n                      <div class=\"member-stats\">Lv: {unit.level}</div>\n                      <div class=\"member-element\">{unit.element}</div>\n                      <div class=\"member-role\">{unit.role}</div>\n                      {isActive && <div class=\"active-badge\">Roster Slot</div>}\n                    </div>\n                    {isSelected && (\n                      <div class=\"selection-indicator\">Selected</div>\n                    )}\n                  </div>\n                );\n              })}\n            </div>\n          </div>\n\n          {/* Unit Details */}\n          {selectedUnit && selectedStats && (\n            <div class=\"party-section unit-details\">\n              <h2>{selectedUnit.name}</h2>\n              <div class=\"detail-grid\">\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">Level:</span>\n                  <span class=\"detail-value\">{selectedUnit.level}</span>\n                </div>\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">Element:</span>\n                  <span class=\"detail-value\">{selectedUnit.element}</span>\n                </div>\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">Role:</span>\n                  <span class=\"detail-value\">{selectedUnit.role}</span>\n                </div>\n                <div class=\"detail-divider\" />\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">HP:</span>\n                  <span class=\"detail-value\">{selectedUnit.currentHp} / {selectedStats.hp}</span>\n                </div>\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">ATK:</span>\n                  <span class=\"detail-value\">{selectedStats.atk}</span>\n                </div>\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">DEF:</span>\n                  <span class=\"detail-value\">{selectedStats.def}</span>\n                </div>\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">MAG:</span>\n                  <span class=\"detail-value\">{selectedStats.mag}</span>\n                </div>\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">SPD:</span>\n                  <span class=\"detail-value\">{selectedStats.spd}</span>\n                </div>\n                <div class=\"detail-divider\" />\n                <div class=\"detail-section\">\n                  <h3>Abilities ({selectedUnit.abilities.length})</h3>\n                  <div class=\"ability-list\">\n                    {selectedUnit.abilities.map((ability) => (\n                      <div key={ability.id} class=\"ability-item\">\n                        {(() => {\n                          const iconId = getAbilityIconSprite(ability.id);\n                          warnIfPlaceholderSprite('PartyManagementScreen', iconId);\n                          return (\n                            <SimpleSprite\n                              id={iconId}\n                              width={24}\n                              height={24}\n                              style={{ marginRight: '8px', borderRadius: '4px' }}\n                            />\n                          );\n                        })()}\n                        <span class=\"ability-name\">{ability.name}</span>\n                        {ability.manaCost > 0 && (\n                          <span class=\"ability-cost\">[{ability.manaCost}]</span>\n                        )}\n                      </div>\n                    ))}\n                  </div>\n                </div>\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * ShopEquipScreen Component\n * Combined shop and equipment management screen\n */\n\nimport { JSX } from 'preact';\nimport { useState } from 'preact/hooks';\nimport { useStore } from '../state/store';\nimport { SHOPS } from '../../data/definitions/shops';\nimport { EQUIPMENT } from '../../data/definitions/equipment';\nimport {\n  buyItem,\n  canAffordItem,\n  purchaseStarterKit,\n  purchaseUnitEquipment,\n} from '../../core/services/ShopService';\nimport { getStarterKit } from '../../data/definitions/starterKits';\nimport { EquipmentIcon } from './EquipmentIcon';\nimport { updateUnit } from '../../core/models/Unit';\nimport { calculateEquipmentBonuses } from '../../core/models/Equipment';\nimport { calculateLevelBonuses } from '../../core/algorithms/stats';\nimport './ShopEquipScreen.css';\nimport type { Stats } from '../../core/models/types';\nimport type { Equipment } from '../../data/schemas/EquipmentSchema';\nimport type { Unit } from '../../core/models/Unit';\nimport type { EquipmentSlot } from '../../core/models/Equipment';\nimport { isAvailableInCampaign } from '../utils/contentAvailability';\n\ntype Tab = 'shop' | 'equip';\n\ninterface ShopEquipScreenProps {\n  shopId?: string;\n  onClose: () => void;\n}\n\nconst EQUIPMENT_SLOTS: EquipmentSlot[] = ['weapon', 'armor', 'helm', 'boots', 'accessory'];\n\ntype StatKey = keyof Stats;\nconst COMPARISON_STATS: StatKey[] = ['hp', 'pp', 'atk', 'def', 'mag', 'spd'];\ntype TierFilter = 'all' | 'basic' | 'bronze' | 'iron' | 'steel' | 'mythril-plus';\n\nconst TIER_FILTERS: Array<{ id: TierFilter; label: string }> = [\n  { id: 'all', label: 'All' },\n  { id: 'basic', label: 'Basic' },\n  { id: 'bronze', label: 'Bronze' },\n  { id: 'iron', label: 'Iron' },\n  { id: 'steel', label: 'Steel' },\n  { id: 'mythril-plus', label: 'Mythril+' },\n];\n\nfunction matchesTier(tier: Equipment['tier'] | undefined, filter: TierFilter) {\n  if (filter === 'all' || !tier) return true;\n  if (filter === 'mythril-plus') {\n    return tier === 'mythril' || tier === 'legendary' || tier === 'artifact';\n  }\n  if (filter === 'steel') {\n    return tier === 'steel' || tier === 'silver';\n  }\n  return tier === filter;\n}\n\nfunction buildStatDeltas(candidate: Equipment, current: Equipment | null | undefined) {\n  return COMPARISON_STATS\n    .map((stat) => {\n      const candidateVal = candidate.statBonus[stat] ?? 0;\n      const currentVal = current?.statBonus[stat] ?? 0;\n      const delta = candidateVal - currentVal;\n      return { stat, delta };\n    })\n    .filter(({ delta }) => delta !== 0);\n}\n\nfunction DeltaBadges({ deltas }: { deltas: ReturnType<typeof buildStatDeltas> }) {\n  if (deltas.length === 0) return null;\n  return (\n    <div class=\"item-deltas\">\n      {deltas.map(({ stat, delta }) => (\n        <span\n          key={stat}\n          class={`delta-badge ${delta > 0 ? 'delta-up' : 'delta-down'}`}\n        >\n          {delta > 0 ? '+' : ''}\n          {delta} {stat.toUpperCase()}\n        </span>\n      ))}\n    </div>\n  );\n}\n\nexport function ShopEquipScreen({ shopId, onClose }: ShopEquipScreenProps): JSX.Element {\n  const { gold, addGold, addEquipment, removeEquipment, team, updateTeamUnits, equipment: inventory } = useStore((s) => ({\n    gold: s.gold,\n    addGold: s.addGold,\n    addEquipment: s.addEquipment,\n    removeEquipment: s.removeEquipment,\n    team: s.team,\n    updateTeamUnits: s.updateTeamUnits,\n    equipment: s.equipment,\n  }));\n\n  const storyFlags = useStore((s) => s.story.flags);\n  const [activeTab, setActiveTab] = useState<Tab>('shop');\n  const [selectedUnitId, setSelectedUnitId] = useState<string | null>(\n    team?.units[0]?.id ?? null\n  );\n  const [selectedSlot, setSelectedSlot] = useState<EquipmentSlot | null>(null);\n  const [error, setError] = useState<string | null>(null);\n  const [tierFilter, setTierFilter] = useState<TierFilter>('all');\n\n  const selectedUnit = team?.units.find((u) => u.id === selectedUnitId) ?? null;\n\n  // Shop tab logic\n  const shop = shopId ? SHOPS[shopId] : null;\n  const isShopUnlocked = !shop || !shop.unlockCondition || shop.unlockCondition(storyFlags as Record<string, boolean>);\n  const availableItems = shop && isShopUnlocked\n    ? (shop.availableItems\n        .map((id) => EQUIPMENT[id])\n        .filter((item): item is Equipment => Boolean(item))\n        .filter(isAvailableInCampaign))\n    : [];\n  const filteredAvailableItems = availableItems.filter((item) => matchesTier(item.tier, tierFilter));\n\n  const starterKitEntries = team\n    ? team.units\n        .map((unit) => ({\n          unit,\n          kit: getStarterKit(unit),\n        }))\n        .filter(({ kit, unit }) => Boolean(kit) && !unit.storeUnlocked)\n        .map(({ unit, kit }) => ({ unit, kit: kit! }))\n    : [];\n\n  const unlockedUnits = team ? team.units.filter((unit) => unit.storeUnlocked) : [];\n\n  const handleUnlock = (itemId: string) => {\n    setError(null);\n    const result = buyItem(gold, itemId);\n    if (!result.ok) {\n      setError(result.error);\n      return;\n    }\n    addGold(result.value.newGold - gold);\n    addEquipment([result.value.item]);\n  };\n\n  const handleStarterKitPurchase = (unitId: string) => {\n    if (!team) return;\n    const unit = team.units.find((u) => u.id === unitId);\n    if (!unit) return;\n\n    setError(null);\n    const result = purchaseStarterKit(unit, gold);\n    if (!result.ok) {\n      setError(result.error);\n      return;\n    }\n\n    addGold(result.value.newGold - gold);\n    addEquipment(result.value.equipment);\n\n    const updatedUnits = team.units.map((unit) =>\n      unit.id === unitId ? { ...unit, storeUnlocked: true } : unit\n    );\n    updateTeamUnits(updatedUnits);\n  };\n\n  const handleUnitEquipmentPurchase = (unit: Unit, itemId: string) => {\n    setError(null);\n    const result = purchaseUnitEquipment(unit, gold, itemId);\n    if (!result.ok) {\n      setError(result.error);\n      return;\n    }\n\n    addGold(result.value.newGold - gold);\n    addEquipment([result.value.item]);\n  };\n\n\n  // Equipment tab logic\n  const handleEquip = (equipment: Equipment) => {\n    if (!selectedUnit || !selectedSlot) return;\n\n    // If there's already an item in this slot, return it to inventory first\n    const currentItem = selectedUnit.equipment[selectedSlot];\n    if (currentItem) {\n      addEquipment([currentItem]);\n    }\n\n    // Remove the new item from inventory\n    removeEquipment(equipment.id);\n\n    // Equip the new item\n    const newEquipment = { ...selectedUnit.equipment, [selectedSlot]: equipment };\n    const updatedUnit = updateUnit(selectedUnit, { equipment: newEquipment });\n\n    const updatedUnits = team!.units.map((u) => (u.id === selectedUnit.id ? updatedUnit : u));\n    updateTeamUnits(updatedUnits);\n    setSelectedSlot(null);\n  };\n\n  const handleUnequip = (slot: EquipmentSlot) => {\n    if (!selectedUnit) return;\n\n    // Get the item being unequipped\n    const itemToUnequip = selectedUnit.equipment[slot];\n\n    // Update unit equipment (set slot to null)\n    const newEquipment = { ...selectedUnit.equipment, [slot]: null };\n    const updatedUnit = updateUnit(selectedUnit, { equipment: newEquipment });\n\n    // Return item to inventory if it exists\n    if (itemToUnequip) {\n      addEquipment([itemToUnequip]);\n    }\n\n    const updatedUnits = team!.units.map((u) => (u.id === selectedUnit.id ? updatedUnit : u));\n    updateTeamUnits(updatedUnits);\n  };\n\n  const availableEquipmentForSlot = selectedUnit && selectedSlot\n    ? inventory.filter(\n        (item) => item.slot === selectedSlot &&\n        (item.allowedElements.length === 0 || item.allowedElements.includes(selectedUnit.element))\n      )\n    : [];\n\n  const equipmentBonuses = selectedUnit ? calculateEquipmentBonuses(selectedUnit.equipment) : {};\n  const levelBonuses = selectedUnit ? calculateLevelBonuses(selectedUnit) : {};\n\n  const previewStats = selectedUnit ? {\n    atk: selectedUnit.baseStats.atk + (levelBonuses.atk || 0) + (equipmentBonuses.atk || 0),\n    def: selectedUnit.baseStats.def + (levelBonuses.def || 0) + (equipmentBonuses.def || 0),\n    mag: selectedUnit.baseStats.mag + (levelBonuses.mag || 0) + (equipmentBonuses.mag || 0),\n    spd: selectedUnit.baseStats.spd + (levelBonuses.spd || 0) + (equipmentBonuses.spd || 0),\n  } : null;\n\n  return (\n    <div class=\"shop-equip-overlay\" onClick={onClose}>\n      <div class=\"shop-equip-container\" onClick={(e) => e.stopPropagation()}>\n        <div class=\"shop-equip-header\">\n          <h1>{shop ? shop.name : 'Shop & Equipment'}</h1>\n          <button class=\"close-btn\" onClick={onClose} aria-label=\"Close\">\n            \n          </button>\n        </div>\n\n        <div class=\"shop-equip-gold\">\n          <span class=\"gold-label\">Gold:</span>\n          <span class=\"gold-value\">{gold}g</span>\n        </div>\n\n        <div class=\"shop-equip-note\" style={{ fontSize: '0.8rem', color: '#a9b1c8', padding: '0 1rem', marginBottom: '0.5rem' }}>\n          Equipment in your inventory is shared across the roster and locked to elements. Use the Pre-Battle screen to finalize\n          which pieces each unit actually carries into combat.\n        </div>\n\n        {error && (\n          <div class=\"shop-equip-error\" role=\"alert\">\n            {error}\n          </div>\n        )}\n\n        <div class=\"shop-equip-tabs\">\n          <button\n            class={`tab-btn ${activeTab === 'shop' ? 'active' : ''}`}\n            onClick={() => setActiveTab('shop')}\n          >\n            Shop\n          </button>\n          <button\n            class={`tab-btn ${activeTab === 'equip' ? 'active' : ''}`}\n            onClick={() => setActiveTab('equip')}\n          >\n            Equipment\n          </button>\n        </div>\n\n        <div class=\"shop-equip-content\">\n          {activeTab === 'shop' && (\n            <div class=\"shop-tab-content\">\n              {!shop ? (\n                <div class=\"shop-empty\">No shop available</div>\n              ) : !isShopUnlocked ? (\n                <div class=\"shop-locked\">This shop is not yet available.</div>\n              ) : (\n                <>\n                  <div class=\"tier-filter-bar\">\n                    <span class=\"tier-filter-label\">Tier:</span>\n                    <div class=\"tier-filter-buttons\">\n                      {TIER_FILTERS.map((filter) => (\n                        <button\n                          key={filter.id}\n                          class={`tier-filter-btn ${tierFilter === filter.id ? 'active' : ''}`}\n                          onClick={() => setTierFilter(filter.id)}\n                        >\n                          {filter.label}\n                        </button>\n                      ))}\n                    </div>\n                  </div>\n\n                  {starterKitEntries.length > 0 && (\n                    <section class=\"starter-kits-section\">\n                      <h2>Starter Kits</h2>\n                      <div class=\"shop-items-grid\">\n                        {starterKitEntries.map(({ unit, kit }) => {\n                          const affordable = gold >= kit.cost;\n                          return (\n                            <div\n                              key={unit.id}\n                              class={`shop-item-card ${!affordable ? 'unaffordable' : ''}`}\n                            >\n                              <div class=\"item-details\">\n                                <div class=\"item-name\">{kit.name}</div>\n                                <div class=\"item-stats\">\n                                  <span class=\"stat-badge\">{unit.name}</span>\n                                  <span class=\"stat-badge\">{kit.cost}g</span>\n                                </div>\n                              </div>\n                              <button\n                                class=\"buy-btn\"\n                                onClick={() => handleStarterKitPurchase(unit.id)}\n                                disabled={!affordable}\n                              >\n                                Purchase Starter Kit\n                              </button>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    </section>\n                  )}\n\n                  {unlockedUnits.map((unit) => {\n                    // Filter equipment by element type (not unit-specific)\n                    const availableEquipment = Object.values(EQUIPMENT).filter(\n                      (item) =>\n                        isAvailableInCampaign(item) &&\n                        item.allowedElements.includes(unit.element) &&\n                        matchesTier(item.tier, tierFilter)\n                    );\n                    return (\n                      <section key={unit.id} class=\"unit-store-section\">\n                        <h2>{unit.name}&apos;s Equipment ({unit.element})</h2>\n                        {availableEquipment.length === 0 ? (\n                          <div class=\"shop-empty\">No equipment available yet.</div>\n                        ) : (\n                          <div class=\"shop-items-grid\">\n                            {availableEquipment.map((item) => {\n                              const affordable = canAffordItem(gold, item.id);\n                              return (\n                                <div\n                                  key={`${unit.id}-${item.id}`}\n                                  class={`shop-item-card ${!affordable ? 'unaffordable' : ''}`}\n                                >\n                                  <div class=\"item-icon\">\n                                    <EquipmentIcon equipment={item} />\n                                  </div>\n                                  <div class=\"item-details\">\n                                    <div class=\"item-name\">{item.name}</div>\n                                    <div class=\"item-stats\">\n                                      {Object.entries(item.statBonus).map(([stat, value]) => (\n                                        <span key={stat} class=\"stat-badge\">\n                                          +{value} {stat.toUpperCase()}\n                                        </span>\n                                      ))}\n                                    </div>\n                                    {selectedUnit && (\n                                      <DeltaBadges\n                                        deltas={buildStatDeltas(item, selectedUnit.equipment[item.slot])}\n                                      />\n                                    )}\n                                    <div class=\"item-price\">{item.cost}g</div>\n                                  </div>\n                                  <button\n                                    class=\"buy-btn\"\n                                    onClick={() => handleUnitEquipmentPurchase(unit, item.id)}\n                                    disabled={!affordable}\n                                  >\n                                    Purchase for {unit.name}\n                                  </button>\n                                </div>\n                              );\n                            })}\n                          </div>\n                        )}\n                      </section>\n                    );\n                  })}\n\n                  {filteredAvailableItems.length > 0 && (\n                    <section class=\"shop-general-section\">\n                      <h2>General Equipment</h2>\n                      <div class=\"shop-items-grid\">\n                        {filteredAvailableItems.map((item) => {\n                          const affordable = canAffordItem(gold, item.id);\n                          return (\n                            <div\n                              key={item.id}\n                              class={`shop-item-card ${!affordable ? 'unaffordable' : ''}`}\n                            >\n                              <div class=\"item-icon\">\n                                <EquipmentIcon equipment={item} />\n                              </div>\n                                <div class=\"item-details\">\n                                  <div class=\"item-name\">{item.name}</div>\n                                  <div class=\"item-stats\">\n                                    {Object.entries(item.statBonus).map(([stat, value]) => (\n                                      <span key={stat} class=\"stat-badge\">\n                                        +{value} {stat.toUpperCase()}\n                                      </span>\n                                    ))}\n                                  </div>\n                                  {selectedUnit && (\n                                    <DeltaBadges\n                                      deltas={buildStatDeltas(item, selectedUnit.equipment[item.slot])}\n                                    />\n                                  )}\n                                  <div class=\"item-price\">{item.cost}g</div>\n                                </div>\n                                <button\n                                  class=\"buy-btn\"\n                                  onClick={() => handleUnlock(item.id)}\n                                disabled={!affordable}\n                              >\n                                Unlock Equipment\n                              </button>\n                            </div>\n                          );\n                        })}\n                      </div>\n                    </section>\n                  )}\n\n                  {starterKitEntries.length === 0 && unlockedUnits.length === 0 && availableItems.length === 0 && (\n                    <div class=\"shop-empty\">No items available.</div>\n                  )}\n                  {starterKitEntries.length === 0 && unlockedUnits.length === 0 && availableItems.length > 0 && filteredAvailableItems.length === 0 && (\n                    <div class=\"shop-empty\">No items match this tier filter.</div>\n                  )}\n                </>\n              )}\n            </div>\n          )}\n\n          {activeTab === 'equip' && (\n            <div class=\"equip-tab-content\">\n              <div class=\"equipment-tab-note\" style={{ fontSize: '0.8rem', color: '#9ea6b7', marginBottom: '0.5rem', textAlign: 'center' }}>\n                This view shows each unit&apos;s preferred loadout. The Pre-Battle screen is still the final say for actual gear per battle.\n              </div>\n              {!team || team.units.length === 0 ? (\n                <div class=\"shop-empty\">No units available.</div>\n              ) : (\n                <div class=\"equip-layout\">\n                  <div class=\"unit-selector-panel\">\n                    <h2>Select Unit</h2>\n                    <div class=\"unit-list\">\n                      {team.units.map((unit) => (\n                        <div\n                          key={unit.id}\n                          class={`unit-card ${selectedUnitId === unit.id ? 'selected' : ''}`}\n                          onClick={() => {\n                            setSelectedUnitId(unit.id);\n                            setSelectedSlot(null);\n                          }}\n                        >\n                          <div class=\"unit-info\">\n                            <div class=\"unit-name\">{unit.name}</div>\n                            <div class=\"unit-level\">Lv. {unit.level}</div>\n                          </div>\n                        </div>\n                      ))}\n                    </div>\n                  </div>\n\n                  {selectedUnit && (\n                    <div class=\"equipment-management-panel\">\n                      <div class=\"equipment-slots-section\">\n                        <h2>{selectedUnit.name}&apos;s Equipment</h2>\n                        <div class=\"equipment-grid\">\n                          {EQUIPMENT_SLOTS.map((slot) => {\n                            const eq = selectedUnit.equipment[slot];\n                            const isSelected = selectedSlot === slot;\n                            return (\n                              <div\n                                key={slot}\n                                class={`equipment-slot ${slot} ${isSelected ? 'selected' : ''}`}\n                                onClick={() => setSelectedSlot(isSelected ? null : slot)}\n                              >\n                                <div class=\"equipment-label\">{slot.toUpperCase()}</div>\n                                {eq ? (\n                                  <>\n                                    <div class=\"equipment-value\">{eq.name}</div>\n                                    <div class=\"equipment-bonuses\">\n                                      {eq.statBonus.atk && (\n                                        <span class=\"bonus-badge\">+{eq.statBonus.atk} ATK</span>\n                                      )}\n                                      {eq.statBonus.def && (\n                                        <span class=\"bonus-badge\">+{eq.statBonus.def} DEF</span>\n                                      )}\n                                      {eq.statBonus.mag && (\n                                        <span class=\"bonus-badge\">+{eq.statBonus.mag} MAG</span>\n                                      )}\n                                      {eq.statBonus.spd && (\n                                        <span class=\"bonus-badge\">+{eq.statBonus.spd} SPD</span>\n                                      )}\n                                    </div>\n                                    {isSelected && (\n                                      <button\n                                        class=\"unequip-btn\"\n                                        onClick={(e) => {\n                                          e.stopPropagation();\n                                          handleUnequip(slot);\n                                          setSelectedSlot(null);\n                                        }}\n                                      >\n                                        Unequip\n                                      </button>\n                                    )}\n                                  </>\n                                ) : (\n                                  <div class=\"equipment-value empty\">[None]</div>\n                                )}\n                              </div>\n                            );\n                          })}\n                        </div>\n\n                        {previewStats && (\n                          <div class=\"stat-preview\">\n                            <div class=\"stat-preview-title\">STAT PREVIEW</div>\n                            <div class=\"stat-preview-values\">\n                              <span>\n                                ATK: {previewStats.atk}\n                                {equipmentBonuses.atk ? ` (+${equipmentBonuses.atk})` : ''}\n                              </span>\n                              <span>\n                                DEF: {previewStats.def}\n                                {equipmentBonuses.def ? ` (+${equipmentBonuses.def})` : ''}\n                              </span>\n                              <span>\n                                MAG: {previewStats.mag}\n                                {equipmentBonuses.mag ? ` (+${equipmentBonuses.mag})` : ''}\n                              </span>\n                              <span>\n                                SPD: {previewStats.spd}\n                                {equipmentBonuses.spd ? ` (+${equipmentBonuses.spd})` : ''}\n                              </span>\n                            </div>\n                          </div>\n                        )}\n                      </div>\n\n                      <div class=\"equipment-inventory-section\">\n                        {selectedSlot ? (\n                          <>\n                            <div class=\"slot-indicator\">\n                              Equipping to: <strong>{selectedSlot.toUpperCase()}</strong>\n                            </div>\n                            {availableEquipmentForSlot.length === 0 ? (\n                              <div class=\"inventory-empty\">\n                                No {selectedSlot} available in inventory\n                              </div>\n                            ) : (\n                              <div class=\"inventory-grid\">\n                                {availableEquipmentForSlot.map((item) => (\n                                  <div\n                                    key={item.id}\n                                    class=\"inventory-item\"\n                                    onClick={() => handleEquip(item)}\n                                  >\n                                    <div class=\"inventory-item-icon\">\n                                      <EquipmentIcon equipment={item} />\n                                    </div>\n                                    <div class=\"inventory-item-name\">{item.name}</div>\n                                    <div class=\"inventory-item-stats\">\n                                      {item.statBonus.atk && `+${item.statBonus.atk} ATK `}\n                                      {item.statBonus.def && `+${item.statBonus.def} DEF `}\n                                      {item.statBonus.mag && `+${item.statBonus.mag} MAG `}\n                                      {item.statBonus.spd && `+${item.statBonus.spd} SPD `}\n                                    </div>\n                                    <DeltaBadges\n                                      deltas={buildStatDeltas(item, selectedUnit.equipment[item.slot])}\n                                    />\n                                  </div>\n                                ))}\n                              </div>\n                            )}\n                          </>\n                        ) : (\n                          <div class=\"slot-prompt\">\n                            Select an equipment slot to view available items\n                          </div>\n                        )}\n                      </div>\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * DjinnDetailModal Component\n * Shows detailed Djinn information and assignment UI\n */\n\nimport { JSX } from 'preact';\nimport { useStore } from '../state/store';\nimport { DJINN } from '@/data/definitions/djinn';\nimport { calculateDjinnSynergy } from '@/core/algorithms/djinn';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport { warnIfPlaceholderSprite } from '../sprites/utils/warnIfPlaceholderSprite';\nimport './DjinnDetailModal.css';\n\ninterface DjinnDetailModalProps {\n  djinnId: string;\n  onClose: () => void;\n}\n\nexport function DjinnDetailModal({ djinnId, onClose }: DjinnDetailModalProps): JSX.Element | null {\n  const { team, updateTeam } = useStore((s) => ({\n    team: s.team,\n    updateTeam: s.updateTeam,\n  }));\n\n  const djinn = DJINN[djinnId];\n  if (!djinn || !team) {\n    return null;\n  }\n\n  const isCollected = team.collectedDjinn.includes(djinnId);\n  const isEquipped = team.equippedDjinn.includes(djinnId);\n  const equippedIndex = team.equippedDjinn.indexOf(djinnId);\n  const tracker = team.djinnTrackers[djinnId];\n  const state = tracker?.state || 'Set';\n\n  const handleEquip = (slotIndex: number) => {\n    if (!team) return;\n\n    // Create new equippedDjinn array (max 3 slots)\n    const newEquippedDjinn: string[] = [];\n\n    // Copy existing equipped Djinn, skipping the one being moved\n    team.equippedDjinn.forEach((id, idx) => {\n      if (id !== djinnId && idx !== slotIndex) {\n        newEquippedDjinn.push(id);\n      }\n    });\n\n    // Add to target slot (will be inserted at correct position)\n    // Ensure we have exactly 3 slots\n    while (newEquippedDjinn.length < slotIndex) {\n      newEquippedDjinn.push('');\n    }\n    newEquippedDjinn[slotIndex] = djinnId;\n\n    // Filter out empty strings and ensure max 3\n    const filteredDjinn = newEquippedDjinn.filter(Boolean).slice(0, 3);\n\n    // Update trackers\n    const newTrackers = { ...team.djinnTrackers };\n    if (!newTrackers[djinnId]) {\n      newTrackers[djinnId] = {\n        djinnId,\n        state: 'Set',\n        lastActivatedTurn: 0,\n      };\n    }\n\n    // Remove tracker for Djinn that was in the target slot (if different)\n    if (isEquipped && equippedIndex !== slotIndex) {\n      const oldDjinnId = team.equippedDjinn[slotIndex];\n      if (oldDjinnId && oldDjinnId !== djinnId) {\n        delete newTrackers[oldDjinnId];\n      }\n    }\n\n    updateTeam({\n      equippedDjinn: filteredDjinn,\n      djinnTrackers: newTrackers,\n    });\n  };\n\n  const handleUnequip = () => {\n    if (!team || !isEquipped) return;\n\n    const newEquippedDjinn = team.equippedDjinn.filter((id) => id !== djinnId);\n\n    const newTrackers = { ...team.djinnTrackers };\n    delete newTrackers[djinnId];\n\n    updateTeam({\n      equippedDjinn: newEquippedDjinn,\n      djinnTrackers: newTrackers,\n    });\n  };\n\n  // Calculate synergy preview\n  const previewEquipped = [...team.equippedDjinn];\n  if (!isEquipped) {\n    // Preview with this Djinn in slot 0\n    previewEquipped[0] = djinnId;\n  }\n  const previewDjinn = previewEquipped\n    .filter(Boolean)\n    .map((id) => DJINN[id])\n    .filter((d): d is NonNullable<typeof d> => d !== null && d !== undefined);\n  const synergy = calculateDjinnSynergy(previewDjinn.map((d) => d.element));\n\n  const getElementColor = (element: string): string => {\n    switch (element) {\n      case 'Venus': return '#8B4513';\n      case 'Mars': return '#DC143C';\n      case 'Mercury': return '#1E90FF';\n      case 'Jupiter': return '#32CD32';\n      default: return '#666';\n    }\n  };\n\n  const getDjinnSprite = (element: string): string => {\n    const elementLower = element.toLowerCase();\n    return `${elementLower}-djinn-front`;\n  };\n\n  return (\n    <div class=\"djinn-detail-overlay\" onClick={onClose}>\n      <div class=\"djinn-detail-container\" onClick={(e) => e.stopPropagation()}>\n        <div class=\"djinn-detail-header\">\n          <h2>{djinn.name}</h2>\n          <button class=\"close-btn\" onClick={onClose} aria-label=\"Close Djinn details\">\n            \n          </button>\n        </div>\n\n        <div class=\"djinn-detail-content\">\n          <div class=\"djinn-main-info\">\n            <div\n              class=\"djinn-icon-large\"\n              style={{ backgroundColor: getElementColor(djinn.element) + '40' }}\n            >\n              {(() => {\n                const djinnSpriteId = getDjinnSprite(djinn.element);\n                warnIfPlaceholderSprite('DjinnDetailModal', djinnSpriteId);\n                return (\n                  <SimpleSprite\n                    id={djinnSpriteId}\n                    width={64}\n                    height={64}\n                    style={{ display: 'block' }}\n                  />\n                );\n              })()}\n            </div>\n            <div class=\"djinn-details\">\n              <div class=\"detail-row\">\n                <span class=\"detail-label\">Element:</span>\n                <span class=\"detail-value\" style={{ color: getElementColor(djinn.element) }}>\n                  {djinn.element}\n                </span>\n              </div>\n              <div class=\"detail-row\">\n                <span class=\"detail-label\">Tier:</span>\n                <span class=\"detail-value\">Tier {djinn.tier}</span>\n              </div>\n              {isEquipped && (\n                <div class=\"detail-row\">\n                  <span class=\"detail-label\">Status:</span>\n                  <span class=\"detail-value\">{state}</span>\n                </div>\n              )}\n            </div>\n          </div>\n\n          <div class=\"djinn-detail-note\" style={{ fontSize: '0.85rem', color: '#ccc', margin: '0.5rem 0', padding: '0 0.25rem' }}>\n            Djinn live in the shared 3-slot team pool. Updates here affect that pool, and the Pre-Battle screen lets you\n            choose which of the equipped Djinn apply to the next encounter.\n          </div>\n\n          <div class=\"djinn-summon-effect\">\n            <h3>Summon Effect</h3>\n            <p>{djinn.summonEffect.description}</p>\n          </div>\n\n          {isCollected && (\n            <div class=\"djinn-assignment\">\n              <h3>Global Team Slots</h3>\n              <div class=\"slot-buttons\">\n                {[0, 1, 2].map((slotIndex) => {\n                  const slotDjinnId = team.equippedDjinn[slotIndex];\n                  const slotDjinn = slotDjinnId ? DJINN[slotDjinnId] : null;\n                  const isSlotEquipped = slotDjinnId === djinnId;\n\n                  return (\n                    <button\n                      key={slotIndex}\n                      class={`slot-btn ${isSlotEquipped ? 'active' : ''} ${slotDjinn && !isSlotEquipped ? 'occupied' : ''}`}\n                      onClick={() => handleEquip(slotIndex)}\n                      disabled={!isCollected}\n                    >\n                      <div class=\"slot-number\">Slot {slotIndex + 1}</div>\n                      {slotDjinn ? (\n                        <div class=\"slot-djinn-name\">{slotDjinn.name}</div>\n                      ) : (\n                        <div class=\"slot-empty\">Empty</div>\n                      )}\n                    </button>\n                  );\n                })}\n              </div>\n              {isEquipped && (\n                <button class=\"unequip-btn\" onClick={handleUnequip}>\n                  Unequip\n                </button>\n              )}\n            </div>\n          )}\n\n          {previewDjinn.length > 0 && (\n            <div class=\"djinn-synergy-preview\">\n              <h3>Synergy Preview</h3>\n              <div class=\"synergy-info\">\n                <div class=\"synergy-row\">\n                  <span>Class:</span>\n                  <span class=\"synergy-value\">{synergy.classChange}</span>\n                </div>\n                <div class=\"synergy-row\">\n                  <span>ATK Bonus:</span>\n                  <span class=\"synergy-value\">+{synergy.atk}</span>\n                </div>\n                <div class=\"synergy-row\">\n                  <span>DEF Bonus:</span>\n                  <span class=\"synergy-value\">+{synergy.def}</span>\n                </div>\n                {synergy.spd !== undefined && (\n                  <div class=\"synergy-row\">\n                    <span>SPD Bonus:</span>\n                    <span class=\"synergy-value\">+{synergy.spd}</span>\n                  </div>\n                )}\n                {synergy.abilitiesUnlocked.length > 0 && (\n                  <div class=\"synergy-row\">\n                    <span>Abilities:</span>\n                    <span class=\"synergy-value\">{synergy.abilitiesUnlocked.join(', ')}</span>\n                  </div>\n                )}\n              </div>\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n}\n","/**\n * DjinnCollectionScreen Component\n * Displays all collected Djinn in a grid layout\n */\n\nimport { JSX } from 'preact';\nimport { useState } from 'preact/hooks';\nimport { useStore } from '../state/store';\nimport { DJINN } from '@/data/definitions/djinn';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport { warnIfPlaceholderSprite } from '../sprites/utils/warnIfPlaceholderSprite';\nimport { DjinnDetailModal } from './DjinnDetailModal';\nimport './DjinnCollectionScreen.css';\n\ninterface DjinnCollectionScreenProps {\n  onClose: () => void;\n}\n\nexport function DjinnCollectionScreen({ onClose }: DjinnCollectionScreenProps): JSX.Element {\n  const { team } = useStore((s) => ({\n    team: s.team,\n  }));\n\n  const [selectedDjinnId, setSelectedDjinnId] = useState<string | null>(null);\n\n  if (!team) {\n    return (\n      <div class=\"djinn-collection-overlay\" onClick={onClose}>\n        <div class=\"djinn-collection-container\" onClick={(e) => e.stopPropagation()}>\n          <div class=\"djinn-error\">No team data available</div>\n          <button class=\"close-btn\" onClick={onClose}>Close</button>\n        </div>\n      </div>\n    );\n  }\n\n  const collectedDjinn = team.collectedDjinn || [];\n  const equippedDjinn = team.equippedDjinn || [];\n\n  // Group Djinn by element\n  const djinnByElement: Record<string, typeof DJINN[string][]> = {\n    Venus: [],\n    Mars: [],\n    Mercury: [],\n    Jupiter: [],\n  };\n\n  collectedDjinn.forEach((djinnId) => {\n    const djinn = DJINN[djinnId];\n    if (djinn) {\n      const elementList = djinnByElement[djinn.element];\n      if (elementList) {\n        elementList.push(djinn);\n      }\n    }\n  });\n\n  // Sort by tier within each element (convert string tier to number for comparison)\n  Object.keys(djinnByElement).forEach((element) => {\n    const elementList = djinnByElement[element];\n    if (elementList) {\n      elementList.sort((a, b) => parseInt(a.tier, 10) - parseInt(b.tier, 10));\n    }\n  });\n\n  const getElementColor = (element: string): string => {\n    switch (element) {\n      case 'Venus': return '#8B4513'; // Brown\n      case 'Mars': return '#DC143C'; // Crimson\n      case 'Mercury': return '#1E90FF'; // Dodger Blue\n      case 'Jupiter': return '#32CD32'; // Lime Green\n      default: return '#666';\n    }\n  };\n\n  const getDjinnSprite = (element: string): string => {\n    // Semantic ID for catalog lookup (e.g., \"venus-djinn-front\")\n    return `${element.toLowerCase()}-djinn-front`;\n  };\n\n  return (\n    <div class=\"djinn-collection-overlay\" onClick={onClose}>\n      <div class=\"djinn-collection-container\" onClick={(e) => e.stopPropagation()}>\n        <div class=\"djinn-collection-header\">\n          <h1>Djinn Collection</h1>\n          <button class=\"close-btn\" onClick={onClose} aria-label=\"Close Djinn collection\">\n            \n          </button>\n        </div>\n\n        <div class=\"djinn-collection-note\" style={{ padding: '0 1rem', fontSize: '0.85rem', color: '#ccc' }}>\n          Your collected Djinn live in a global 3-slot team configuration. Use the Pre-Battle screen to lock in which\n          Djinn you want active for the upcoming fightthe bonuses apply to every unit at once.\n        </div>\n\n        <div class=\"djinn-stats\">\n          <div class=\"stat-item\">\n            <span class=\"stat-label\">Collected:</span>\n            <span class=\"stat-value\">{collectedDjinn.length} / 12</span>\n          </div>\n          <div class=\"stat-item\">\n            <span class=\"stat-label\">Equipped:</span>\n            <span class=\"stat-value\">{equippedDjinn.length} / 3</span>\n          </div>\n        </div>\n\n        <div class=\"djinn-collection-subnote\" style={{ fontSize: '0.8rem', color: '#888', textAlign: 'center', marginBottom: '0.25rem' }}>\n          Equipped Djinn occupy the shared team slots; swapping them is done here, but final confirmation happens pre-battle.\n        </div>\n\n        <div class=\"djinn-collection-content\">\n          {Object.entries(djinnByElement).map(([element, djinnList]) => (\n            <div key={element} class=\"djinn-element-section\">\n              <h2 class=\"element-header\" style={{ color: getElementColor(element) }}>\n                {element} Djinn\n              </h2>\n              {djinnList.length === 0 ? (\n                <div class=\"no-djinn-message\">No {element} Djinn collected yet</div>\n              ) : (\n                <div class=\"djinn-grid\">\n                  {djinnList.map((djinn) => {\n                    const isEquipped = equippedDjinn.includes(djinn.id);\n                    const tracker = team.djinnTrackers[djinn.id];\n                    const state = tracker?.state || 'Set';\n\n                    return (\n                      <div\n                        key={djinn.id}\n                        class={`djinn-card ${isEquipped ? 'equipped' : ''} ${state.toLowerCase()}`}\n                        onClick={() => setSelectedDjinnId(djinn.id)}\n                      >\n                        <div class=\"djinn-icon\" style={{ backgroundColor: getElementColor(element) + '40' }}>\n                          {(() => {\n                            const djinnSpriteId = getDjinnSprite(element);\n                            warnIfPlaceholderSprite('DjinnCollectionScreen', djinnSpriteId);\n                            return (\n                              <SimpleSprite\n                                id={djinnSpriteId}\n                                width={48}\n                                height={48}\n                                style={{ filter: state === 'Standby' ? 'brightness(0.6)' : 'none' }}\n                              />\n                            );\n                          })()}\n                        </div>\n                        <div class=\"djinn-info\">\n                          <div class=\"djinn-name\">{djinn.name}</div>\n                          <div class=\"djinn-tier\">Tier {djinn.tier}</div>\n                          {isEquipped && (\n                            <div class=\"djinn-status\">Equipped  Team Slot ({state})</div>\n                          )}\n                        </div>\n                      </div>\n                    );\n                  })}\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n\n        {selectedDjinnId && (\n          <DjinnDetailModal\n            djinnId={selectedDjinnId}\n            onClose={() => setSelectedDjinnId(null)}\n          />\n        )}\n      </div>\n    </div>\n  );\n}\n","import { JSX } from 'preact';\nimport { useMemo, useState, useEffect } from 'preact/hooks';\nimport { useGameStore } from '../../store/gameStore';\nimport './TowerHubScreen.css';\nimport { useStore } from '../state/store';\nimport type { Store } from '../state/store';\nimport type { TowerFloor } from '@/data/schemas/TowerFloorSchema';\nimport type { TowerRewardEntry } from '@/data/schemas/TowerRewardSchema';\nimport type { TowerRunState } from '@/core/services/TowerService';\nimport { DEFAULT_TOWER_CONFIG } from '@/core/config/towerConfig';\nimport { TOWER_REWARDS } from '@/data/definitions/towerRewards';\nimport { calculateEffectiveStats } from '@/core/algorithms/stats';\nimport { DJINN } from '@/data/definitions/djinn';\nimport { PartyManagementScreen } from './PartyManagementScreen';\nimport { ShopEquipScreen } from './ShopEquipScreen';\nimport { DjinnCollectionScreen } from './DjinnCollectionScreen';\n\ntype ConfirmAction = 'quit' | 'restart' | null;\ntype LoadoutPanel = 'party' | 'equipment' | 'djinn' | null;\n\nexport function TowerHubScreen(): JSX.Element {\n  const startTransition = useGameStore((s) => s.startTransition);\n\n  const {\n    towerRun,\n    towerStatus,\n    towerRecord,\n    getCurrentTowerFloor,\n    startTowerRun,\n    beginTowerFloorBattle,\n    applyTowerRest,\n    quitTowerRun,\n    exitTowerMode,\n    towerEntryContext,\n    team,\n    mode,\n  } = useStore((state) => ({\n    towerRun: state.towerRun,\n    towerStatus: state.towerStatus,\n    towerRecord: state.towerRecord,\n    getCurrentTowerFloor: state.getCurrentTowerFloor,\n    startTowerRun: state.startTowerRun,\n    beginTowerFloorBattle: state.beginTowerFloorBattle,\n    applyTowerRest: state.applyTowerRest,\n    quitTowerRun: state.quitTowerRun,\n    exitTowerMode: state.exitTowerMode,\n    towerEntryContext: state.towerEntryContext,\n    team: state.team,\n    mode: state.mode,\n  }));\n\n  // Sync V1 store mode to V2 gameStore screen (for battle transitions from tower)\n  useEffect(() => {\n    if (mode === 'team-select') {\n      startTransition('team-select');\n    } else if (mode === 'battle') {\n      startTransition('battle');\n    } else if (mode === 'rewards') {\n      startTransition('rewards');\n    }\n  }, [mode, startTransition]);\n\n  const currentFloor = getCurrentTowerFloor();\n  const isRestFloor = currentFloor?.type === 'rest';\n  const isCompleted = towerStatus === 'completed';\n  const upcomingReward = useMemo(() => getNextReward(towerRun), [towerRun]);\n  const partySummary = useMemo(() => buildPartySummary(team), [team]);\n  const djinnStatus = useMemo(() => buildDjinnStatus(team), [team]);\n  const [confirmAction, setConfirmAction] = useState<ConfirmAction>(null);\n  const [loadoutPanel, setLoadoutPanel] = useState<LoadoutPanel>(null);\n\n  const handleStartRun = () => {\n    if (towerStatus === 'idle' || !towerRun) {\n      startTowerRun({ difficulty: 'normal' });\n      return;\n    }\n    setConfirmAction('restart');\n  };\n\n  const handleConfirmAction = () => {\n    if (confirmAction === 'quit') {\n      quitTowerRun();\n    } else if (confirmAction === 'restart') {\n      startTowerRun({ difficulty: towerRun?.difficulty ?? 'normal' });\n    }\n    setConfirmAction(null);\n  };\n\n  const handleQuitRun = () => {\n    setConfirmAction('quit');\n  };\n\n  const closeLoadoutPanel = () => setLoadoutPanel(null);\n\n  if (towerStatus === 'idle' || !towerRun) {\n    return (\n      <div class=\"tower-hub\">\n        <section class=\"tower-card intro\">\n          <h1>Battle Tower</h1>\n          <p>\n            Step into an infinite gauntlet built on the queue battle engine. Assemble any four heroes, keep their HP between fights,\n            and chase your highest floor on this save-independent sandbox.\n          </p>\n          <div class=\"tower-actions\">\n            <button class=\"primary\" onClick={handleStartRun}>\n              Start Tower Run\n            </button>\n            <button onClick={exitTowerMode}>\n              {towerEntryContext?.type === 'overworld' ? 'Return to Vale' : 'Back to Menu'}\n            </button>\n          </div>\n        </section>\n        <TowerRecords towerRecord={towerRecord} />\n      </div>\n    );\n  }\n\n  const stats = towerRun.stats;\n\n  return (\n    <div class=\"tower-hub\">\n      <section class=\"tower-card status\">\n        <header>\n          <div>\n            <p class=\"label\">Difficulty</p>\n            <p class=\"value\">{towerRun.difficulty}</p>\n          </div>\n          <div>\n            <p class=\"label\">Highest Floor</p>\n            <p class=\"value\">{stats.highestFloor}</p>\n          </div>\n          <div>\n            <p class=\"label\">Battles Won</p>\n            <p class=\"value\">{stats.victories}</p>\n          </div>\n        </header>\n        <div class=\"timeline\">\n          <p class=\"label\">Current Floor</p>\n          {renderFloor(currentFloor)}\n        </div>\n        <div class=\"next-reward\" data-testid=\"tower-next-reward\">\n          <p class=\"label\">Next Reward Floor</p>\n          {upcomingReward ? (\n            <div class=\"reward-row\">\n              <span class={`floor-pill reward`}>{`Floor ${upcomingReward.floorNumber}`}</span>\n              <span>{describeRewardBundle(upcomingReward.rewards)}</span>\n            </div>\n          ) : (\n            <span class=\"value\">All milestone rewards claimed</span>\n          )}\n        </div>\n      </section>\n\n      <section class=\"tower-card actions\">\n        {isCompleted ? (\n          <>\n            <h2>Run Complete</h2>\n            <p>\n              {towerRun.isFailed\n                ? 'The party fell, but their record stands in the archive.'\n                : 'You cleared every defined floor for this phase.'}\n            </p>\n            <div class=\"tower-actions\">\n              <button class=\"primary\" onClick={handleStartRun}>\n                Start New Run\n              </button>\n              <button onClick={exitTowerMode}>\n                {towerEntryContext?.type === 'overworld' ? 'Return to Vale' : 'Back to Menu'}\n              </button>\n            </div>\n          </>\n        ) : isRestFloor ? (\n          <>\n            <h2>Rest Floor</h2>\n            <p>Restore {Math.round(REST_HEAL * 100)}% HP and reset Djinn before the next stretch.</p>\n            <div class=\"tower-actions\">\n              <button class=\"primary\" onClick={applyTowerRest}>\n                Take Rest\n              </button>\n              <button onClick={beginTowerFloorBattle}>Skip Rest</button>\n              <button class=\"ghost\" onClick={handleQuitRun}>\n                Quit Run\n              </button>\n            </div>\n            <div class=\"tower-loadout-actions\">\n              <span>Adjust loadouts:</span>\n              <div class=\"tower-rest-buttons\">\n                <button onClick={() => setLoadoutPanel('party')}>Party</button>\n                <button onClick={() => setLoadoutPanel('equipment')}>Equipment</button>\n                <button onClick={() => setLoadoutPanel('djinn')}>Djinn</button>\n              </div>\n            </div>\n          </>\n        ) : (\n          <>\n            <h2>{currentFloor ? `Floor ${currentFloor.floorNumber}` : 'All Floors Cleared'}</h2>\n            <p>\n              {currentFloor\n                ? `Encounter: ${currentFloor.encounterId}`\n                : 'There are no more encounters defined for this build.'}\n            </p>\n            <div class=\"tower-actions\">\n              <button\n                class=\"primary\"\n                disabled={!currentFloor || isRestFloor}\n                onClick={beginTowerFloorBattle}\n              >\n                Begin Battle\n              </button>\n              <button class=\"ghost\" onClick={handleQuitRun}>\n                Quit Run\n              </button>\n              <button onClick={exitTowerMode}>\n                {towerEntryContext?.type === 'overworld' ? 'Return to Vale' : 'Back to Menu'}\n              </button>\n            </div>\n          </>\n        )}\n      </section>\n\n      <section class=\"tower-card stats\">\n        <h3>Run Stats</h3>\n        <ul>\n          <li>\n            <span>Turns Taken</span>\n            <span>{stats.turnsTaken}</span>\n          </li>\n          <li>\n            <span>Total Damage Dealt</span>\n            <span>{stats.totalDamageDealt}</span>\n          </li>\n          <li>\n            <span>Total Damage Taken</span>\n            <span>{stats.totalDamageTaken}</span>\n          </li>\n          <li>\n            <span>Retreats</span>\n            <span>{stats.retreats}</span>\n          </li>\n        </ul>\n      </section>\n\n      <section class=\"tower-card party\" data-testid=\"tower-party-summary\">\n        <h3>Party Status</h3>\n        {partySummary.length === 0 ? (\n          <p class=\"value\">No party data available.</p>\n        ) : (\n          <div class=\"party-grid\">\n            {partySummary.map((unit) => (\n              <div key={unit.id} class=\"party-unit\">\n                <div class=\"unit-header\">\n                  <span>{unit.name}</span>\n                  <span>\n                    {unit.currentHp} / {unit.maxHp}\n                  </span>\n                </div>\n                <div class=\"hp-bar\">\n                  <div style={{ width: `${unit.hpPercent}%` }} />\n                </div>\n                {unit.djinn.length > 0 && (\n                  <div class=\"djinn-badges\">\n                    {unit.djinn.map((djinnId) => {\n                      const tracker = djinnStatus[djinnId];\n                      return (\n                        <span key={djinnId} class={`djinn-pill state-${tracker?.state ?? 'Set'}`}>\n                          {tracker?.name ?? djinnId}  {tracker?.state ?? 'Set'}\n                        </span>\n                      );\n                    })}\n                  </div>\n                )}\n              </div>\n            ))}\n          </div>\n        )}\n      </section>\n\n      <TowerRecords towerRecord={towerRecord} />\n\n      {confirmAction && (\n        <div class=\"tower-modal\" role=\"dialog\" aria-modal=\"true\">\n          <div class=\"tower-modal-content\">\n            <p>\n              {confirmAction === 'quit'\n                ? 'Are you sure? This will end the current Tower run.'\n                : 'Start a new run? Your existing Tower progress will be lost.'}\n            </p>\n            <div class=\"tower-modal-actions\">\n              <button class=\"primary\" onClick={handleConfirmAction}>\n                {confirmAction === 'quit' ? 'Confirm Quit' : 'Start New Run'}\n              </button>\n              <button onClick={() => setConfirmAction(null)}>Cancel</button>\n            </div>\n          </div>\n        </div>\n      )}\n\n      {loadoutPanel === 'party' && <PartyManagementScreen onClose={closeLoadoutPanel} />}\n      {loadoutPanel === 'equipment' && <ShopEquipScreen shopId=\"vale-armory\" onClose={closeLoadoutPanel} />}\n      {loadoutPanel === 'djinn' && <DjinnCollectionScreen onClose={closeLoadoutPanel} />}\n    </div>\n  );\n}\n\nconst REST_HEAL = DEFAULT_TOWER_CONFIG.healFractionAtRest;\n\nfunction renderFloor(floor: TowerFloor | null): JSX.Element {\n  if (!floor) {\n    return <p class=\"value\">No remaining floors</p>;\n  }\n\n  const badgeClass = floor.type === 'boss' ? 'boss' : floor.type === 'rest' ? 'rest' : 'normal';\n  const badgeLabel = floor.type === 'boss' ? 'Boss' : floor.type === 'rest' ? 'Rest' : 'Battle';\n\n  return (\n    <div class=\"floor-display\" data-testid=\"tower-current-floor\">\n      <span class={`floor-pill ${badgeClass}`}>{badgeLabel}</span>\n      {floor.type === 'rest' ? (\n        <p class=\"value rest\">Floor {floor.floorNumber}  Heal & Regroup</p>\n      ) : (\n        <p class={`value ${badgeClass}`}>\n          Floor {floor.floorNumber}  {floor.encounterId}\n        </p>\n      )}\n    </div>\n  );\n}\n\nfunction describeRewardBundle(rewards: readonly TowerRewardEntry[]): string {\n  return rewards\n    .map((reward) => {\n      const ids = reward.ids.join(', ');\n      switch (reward.type) {\n        case 'equipment':\n          return `Equipment: ${ids}`;\n        case 'djinn':\n          return `Djinn: ${ids}`;\n        case 'recruit':\n          return `Recruit: ${ids}`;\n        default:\n          return ids;\n      }\n    })\n    .join('  ');\n}\n\nfunction getNextReward(\n  run: TowerRunState | null\n): { floorNumber: number; rewards: TowerRewardEntry[] } | null {\n  if (!run) {\n    return TOWER_REWARDS[0] ?? null;\n  }\n\n  const rewardedFloors = new Set(\n    run.history\n      .filter((entry) => entry.rewardsGranted.length > 0)\n      .map((entry) => entry.floorNumber)\n  );\n\n  const currentEntry = run.history[run.floorIndex];\n  const pivotFloor =\n    currentEntry?.floorNumber ??\n    ((run.history[run.history.length - 1]?.floorNumber ?? 0) + (run.isCompleted ? 0 : 1));\n\n  return (\n    TOWER_REWARDS.find(\n      (reward) => !rewardedFloors.has(reward.floorNumber) && reward.floorNumber >= pivotFloor\n    ) ?? null\n  );\n}\n\nfunction buildPartySummary(team: Store['team']) {\n  if (!team) {\n    return [];\n  }\n\n  return team.units.map((unit) => {\n    const { hp: maxHp } = calculateEffectiveStats(unit, team);\n    const percent = maxHp > 0 ? Math.round((Math.max(unit.currentHp, 0) / maxHp) * 100) : 0;\n    return {\n      id: unit.id,\n      name: unit.name,\n      currentHp: unit.currentHp,\n      maxHp,\n      hpPercent: Math.max(0, Math.min(100, percent)),\n      djinn: unit.djinn,\n    };\n  });\n}\n\nfunction buildDjinnStatus(team: Store['team']) {\n  if (!team) {\n    return {};\n  }\n\n  const entries: Record<\n    string,\n    {\n      name: string;\n      state: 'Set' | 'Standby' | 'Recovery';\n    }\n  > = {};\n\n  for (const [djinnId, tracker] of Object.entries(team.djinnTrackers)) {\n    entries[djinnId] = {\n      name: DJINN[djinnId]?.name ?? djinnId,\n      state: tracker.state,\n    };\n  }\n\n  return entries;\n}\n\nfunction TowerRecords({ towerRecord }: { towerRecord: Store['towerRecord'] }): JSX.Element {\n  return (\n    <section class=\"tower-card record\" data-testid=\"tower-record-panel\">\n      <h3>Tower Record</h3>\n      <div class=\"record-grid\">\n        <div>\n          <span class=\"label\">Highest Floor Ever</span>\n          <span class=\"value\">{towerRecord.highestFloorEver}</span>\n        </div>\n        <div>\n          <span class=\"label\">Total Runs</span>\n          <span class=\"value\">{towerRecord.totalRuns}</span>\n        </div>\n        <div>\n          <span class=\"label\">Best Run (Turns)</span>\n          <span class=\"value\">{towerRecord.bestRunTurns ?? ''}</span>\n        </div>\n        <div>\n          <span class=\"label\">Best Run (Damage)</span>\n          <span class=\"value\">{towerRecord.bestRunDamageDealt ?? ''}</span>\n        </div>\n      </div>\n    </section>\n  );\n}\n","/**\n * Credits Screen Component\n * Data-driven credits display with scroll animation\n */\n\nimport { JSX } from 'preact';\nimport { useEffect, useState, useRef } from 'preact/hooks';\nimport { z } from 'zod';\nimport creditsDataRaw from '../../data/credits.json';\n\ninterface CreditsScreenProps {\n  onExit: () => void;\n}\n\n// Zod schema for credits data validation\nconst CreditsSectionSchema = z.object({\n  title: z.string(),\n  entries: z.array(z.string()),\n});\n\nconst CreditsDataSchema = z.object({\n  sections: z.array(CreditsSectionSchema),\n  options: z.object({\n    scrollSpeed: z.number().positive(),\n    music: z.string().nullable(),\n  }),\n});\n\n\n// Validate credits data at module load\nconst creditsDataResult = CreditsDataSchema.safeParse(creditsDataRaw);\nif (!creditsDataResult.success) {\n  throw new Error(`Invalid credits data: ${creditsDataResult.error.message}`);\n}\nconst creditsData = creditsDataResult.data;\n\nexport function CreditsScreen({ onExit }: CreditsScreenProps): JSX.Element {\n  const [scrollPosition, setScrollPosition] = useState(0);\n  const [isPaused, setIsPaused] = useState(false);\n  const containerRef = useRef<HTMLDivElement>(null);\n  const animationRef = useRef<number | null>(null);\n\n  const scrollSpeed = creditsData.options.scrollSpeed || 40;\n\n  // Auto-scroll animation\n  useEffect(() => {\n    if (isPaused) return;\n\n    const animate = () => {\n      setScrollPosition((prev) => {\n        const container = containerRef.current;\n        if (!container) return prev;\n\n        const maxScroll = container.scrollHeight - container.clientHeight;\n        if (prev >= maxScroll) {\n          // Reached end - stop or loop\n          return prev;\n        }\n\n        return prev + scrollSpeed / 60; // 60fps\n      });\n\n      animationRef.current = requestAnimationFrame(animate);\n    };\n\n    animationRef.current = requestAnimationFrame(animate);\n\n    return () => {\n      if (animationRef.current !== null) {\n        cancelAnimationFrame(animationRef.current);\n      }\n    };\n  }, [isPaused, scrollSpeed]);\n\n  // Update scroll position\n  useEffect(() => {\n    const container = containerRef.current;\n    if (container) {\n      container.scrollTop = scrollPosition;\n    }\n  }, [scrollPosition]);\n\n  // Keyboard handlers\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === 'Escape' || e.key === 'Enter') {\n        e.preventDefault();\n        e.stopPropagation();\n        onExit();\n      } else if (e.key === ' ') {\n        e.preventDefault();\n        e.stopPropagation();\n        setIsPaused((prev) => !prev);\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [onExit]);\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: '#000',\n        color: '#fff',\n        overflow: 'hidden',\n        display: 'flex',\n        flexDirection: 'column',\n        zIndex: 1000,\n      }}\n      role=\"dialog\"\n      aria-label=\"Credits\"\n      aria-modal=\"true\"\n    >\n      <div\n        ref={containerRef}\n        style={{\n          flex: 1,\n          overflow: 'auto',\n          padding: '2rem',\n          display: 'flex',\n          flexDirection: 'column',\n          alignItems: 'center',\n          justifyContent: 'flex-start',\n        }}\n      >\n        <div\n          style={{\n            maxWidth: '600px',\n            width: '100%',\n            paddingTop: '100vh', // Start below viewport\n            paddingBottom: '100vh', // End below viewport\n          }}\n        >\n          <h1\n            style={{\n              fontSize: '3rem',\n              textAlign: 'center',\n              marginBottom: '3rem',\n              fontWeight: 'bold',\n            }}\n          >\n            Credits\n          </h1>\n\n          {creditsData.sections.map((section, idx) => (\n            <div\n              key={idx}\n              style={{\n                marginBottom: '4rem',\n                textAlign: 'center',\n              }}\n            >\n              <h2\n                style={{\n                  fontSize: '2rem',\n                  marginBottom: '1.5rem',\n                  fontWeight: 'bold',\n                  color: '#ffd700',\n                }}\n              >\n                {section.title}\n              </h2>\n              {section.entries.map((entry, entryIdx) => (\n                <p\n                  key={entryIdx}\n                  style={{\n                    fontSize: '1.25rem',\n                    marginBottom: '0.75rem',\n                    lineHeight: '1.6',\n                  }}\n                >\n                  {entry}\n                </p>\n              ))}\n            </div>\n          ))}\n\n          <div\n            style={{\n              marginTop: '4rem',\n              textAlign: 'center',\n              fontSize: '1.5rem',\n            }}\n          >\n            <p>Thank you for playing!</p>\n          </div>\n        </div>\n      </div>\n\n      <div\n        style={{\n          position: 'absolute',\n          bottom: '2rem',\n          left: '50%',\n          transform: 'translateX(-50%)',\n          textAlign: 'center',\n          fontSize: '0.9rem',\n          color: '#888',\n        }}\n      >\n        <p>Press ESC or Enter to exit | Space to pause/resume</p>\n      </div>\n    </div>\n  );\n}\n","/**\n * Epilogue Screen - Plays after credits\n * Shows what happens to each character after the Overseer's defeat\n */\n\nimport { JSX } from 'preact';\nimport { useState, useEffect } from 'preact/hooks';\n\ninterface EpilogueEntry {\n  character: string;\n  portrait: string;\n  text: string;\n}\n\nconst EPILOGUE_ENTRIES: EpilogueEntry[] = [\n  {\n    character: 'Isaac',\n    portrait: 'isaac',\n    text: 'Isaac returned to Vale as a hero. Though he missed the thrill of adventure, he found purpose in training the next generation of Adepts. On quiet evenings, he still watches the sunset from the hill overlooking the village, remembering his friends.',\n  },\n  {\n    character: 'Sentinel',\n    portrait: 'sentinel',\n    text: 'Sentinel chose to remain in the liberated village, helping rebuild what the Overseer had destroyed. His earth psynergy proved invaluable for reconstruction. The villagers say the stones themselves seem happier now, placed by gentle hands instead of cruel ones.',\n  },\n  {\n    character: 'Stormcaller',\n    portrait: 'stormcaller',\n    text: 'True to form, Stormcaller couldn\\'t stay in one place for long. She traveled the land, seeking other villages oppressed by tyranny. Wherever storms gather, they say it\\'s Stormcaller - bringing justice like lightning from a clear sky.',\n  },\n  {\n    character: 'The Liberated Creatures',\n    portrait: 'creatures',\n    text: 'The beasts freed from the Overseer\\'s control gradually returned to their natural habitats. Some, like the Phoenix and Leviathan, became legends once more. Others stayed near the village, guardians now instead of prisoners.',\n  },\n  {\n    character: 'The Village',\n    portrait: 'village',\n    text: 'The twenty houses, once cages of suffering, became homes again. Families returned. Children played in streets that had known only silence. And in the center of town, a monument was built - not to the heroes, but to those who endured.',\n  },\n  {\n    character: 'The Future',\n    portrait: 'sunset',\n    text: 'Peace returned to the land. But as old Adepts know, peace is not an ending - it\\'s a beginning. New threats will rise. New heroes will answer. And when they do, they\\'ll remember the tale of Isaac and his friends, who proved that courage and friendship can overcome any darkness.',\n  },\n];\n\ninterface EpilogueScreenProps {\n  onComplete: () => void;\n}\n\nexport function EpilogueScreen({ onComplete }: EpilogueScreenProps): JSX.Element {\n  const [currentIndex, setCurrentIndex] = useState(0);\n  const [fadeState, setFadeState] = useState<'in' | 'visible' | 'out'>('in');\n\n  // Safe access - currentIndex is always within bounds\n  const currentEntry = EPILOGUE_ENTRIES[currentIndex]!;\n  const isLastEntry = currentIndex === EPILOGUE_ENTRIES.length - 1;\n\n  // Handle fade transitions\n  useEffect(() => {\n    if (fadeState === 'in') {\n      const timer = setTimeout(() => setFadeState('visible'), 500);\n      return () => clearTimeout(timer);\n    }\n    return undefined;\n  }, [fadeState]);\n\n  // Keyboard handler\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      if (e.key === 'Enter' || e.key === ' ' || e.key === 'ArrowRight') {\n        e.preventDefault();\n        e.stopPropagation();\n        handleAdvance();\n      } else if (e.key === 'Escape') {\n        e.preventDefault();\n        e.stopPropagation();\n        onComplete();\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown);\n    return () => window.removeEventListener('keydown', handleKeyDown);\n  }, [currentIndex, fadeState, onComplete]);\n\n  const handleAdvance = () => {\n    if (fadeState !== 'visible') return;\n\n    if (isLastEntry) {\n      setFadeState('out');\n      setTimeout(() => onComplete(), 500);\n    } else {\n      setFadeState('out');\n      setTimeout(() => {\n        setCurrentIndex((prev) => prev + 1);\n        setFadeState('in');\n      }, 500);\n    }\n  };\n\n  const getOpacity = (): number => {\n    switch (fadeState) {\n      case 'in':\n        return 0;\n      case 'visible':\n        return 1;\n      case 'out':\n        return 0;\n      default:\n        return 0;\n    }\n  };\n\n  return (\n    <div\n      style={{\n        position: 'fixed',\n        top: 0,\n        left: 0,\n        right: 0,\n        bottom: 0,\n        backgroundColor: '#0a0a1a',\n        color: '#fff',\n        display: 'flex',\n        flexDirection: 'column',\n        alignItems: 'center',\n        justifyContent: 'center',\n        zIndex: 1000,\n        padding: '2rem',\n      }}\n      onClick={handleAdvance}\n      role=\"dialog\"\n      aria-label=\"Epilogue\"\n      aria-modal=\"true\"\n    >\n      {/* Starfield background effect */}\n      <div\n        style={{\n          position: 'absolute',\n          top: 0,\n          left: 0,\n          right: 0,\n          bottom: 0,\n          background: 'radial-gradient(ellipse at center, #1a1a3a 0%, #0a0a1a 100%)',\n          opacity: 0.8,\n        }}\n      />\n\n      {/* Content */}\n      <div\n        style={{\n          position: 'relative',\n          maxWidth: '700px',\n          width: '100%',\n          textAlign: 'center',\n          opacity: getOpacity(),\n          transition: 'opacity 0.5s ease-in-out',\n        }}\n      >\n        {/* Character name */}\n        <h2\n          style={{\n            fontSize: '2.5rem',\n            fontWeight: 'bold',\n            color: '#ffd700',\n            marginBottom: '2rem',\n            textShadow: '0 0 20px rgba(255, 215, 0, 0.5)',\n          }}\n        >\n          {currentEntry.character}\n        </h2>\n\n        {/* Epilogue text */}\n        <p\n          style={{\n            fontSize: '1.4rem',\n            lineHeight: '2',\n            color: '#e0e0e0',\n            fontStyle: 'italic',\n            textShadow: '0 2px 4px rgba(0, 0, 0, 0.5)',\n          }}\n        >\n          {currentEntry.text}\n        </p>\n\n        {/* Progress indicator */}\n        <div\n          style={{\n            marginTop: '3rem',\n            display: 'flex',\n            justifyContent: 'center',\n            gap: '0.5rem',\n          }}\n        >\n          {EPILOGUE_ENTRIES.map((_, idx) => (\n            <div\n              key={idx}\n              style={{\n                width: '12px',\n                height: '12px',\n                borderRadius: '50%',\n                backgroundColor: idx === currentIndex ? '#ffd700' : '#444',\n                transition: 'background-color 0.3s ease',\n              }}\n            />\n          ))}\n        </div>\n      </div>\n\n      {/* Controls hint */}\n      <div\n        style={{\n          position: 'absolute',\n          bottom: '2rem',\n          textAlign: 'center',\n          fontSize: '0.9rem',\n          color: '#666',\n        }}\n      >\n        <p>{isLastEntry ? 'Press Enter to finish' : 'Press Enter or click to continue'}</p>\n        <p style={{ marginTop: '0.5rem' }}>ESC to skip</p>\n      </div>\n    </div>\n  );\n}\n","/**\n * PauseMenu Component\n *\n * Golden Sun-inspired pause menu with full keyboard navigation.\n * Features:\n * - Arrow key navigation ()\n * - Enter/Space to select\n * - Escape to resume\n * - Keyboard shortcuts for quick access (T, I, D, S, O, H, Q)\n * - Status bar showing game progress\n */\n\nimport { useState, useEffect, useCallback, useRef } from 'preact/hooks';\nimport { useStore } from '../state/store';\nimport './PauseMenu.css';\n\ninterface PauseMenuProps {\n  onClose: () => void;\n  onTeamManagement?: () => void;\n  onInventory?: () => void;\n  onDjinnCollection?: () => void;\n  onCompendium?: () => void;\n  onSaveGame?: () => void;\n  onSettings?: () => void;\n  onHowToPlay?: () => void;\n  onReturnToTitle?: () => void;\n}\n\ninterface MenuItem {\n  id: string;\n  icon: string;\n  label: string;\n  shortcut: string;\n  action?: () => void;\n  dividerAfter?: boolean;\n}\n\nexport function PauseMenu({\n  onClose,\n  onTeamManagement,\n  onInventory,\n  onDjinnCollection,\n  onCompendium,\n  onSaveGame,\n  onSettings,\n  onHowToPlay,\n  onReturnToTitle,\n}: PauseMenuProps) {\n  const [selectedIndex, setSelectedIndex] = useState(0);\n  const [flashIndex, setFlashIndex] = useState<number | null>(null);\n  const menuRef = useRef<HTMLDivElement>(null);\n\n  // Get game state for status bar\n  const story = useStore((s) => s.story);\n  const gold = useStore((s) => s.gold);\n  const roster = useStore((s) => s.roster);\n\n  // Define menu items\n  const menuItems: MenuItem[] = [\n    { id: 'resume', icon: '', label: 'Resume Game', shortcut: 'ESC', action: onClose },\n    { id: 'team', icon: '', label: 'Team Management', shortcut: 'T', action: onTeamManagement },\n    { id: 'inventory', icon: '', label: 'Inventory', shortcut: 'I', action: onInventory },\n    { id: 'djinn', icon: '', label: 'Djinn Collection', shortcut: 'D', action: onDjinnCollection },\n    { id: 'compendium', icon: '', label: 'Compendium', shortcut: 'C', action: onCompendium, dividerAfter: true },\n    { id: 'save', icon: '', label: 'Save Game', shortcut: 'S', action: onSaveGame },\n    { id: 'settings', icon: '', label: 'Settings', shortcut: 'O', action: onSettings },\n    { id: 'help', icon: '', label: 'How to Play', shortcut: 'H', action: onHowToPlay, dividerAfter: true },\n    { id: 'title', icon: '', label: 'Return to Title', shortcut: 'Q', action: onReturnToTitle },\n  ];\n\n  // Execute menu action with flash effect\n  const executeAction = useCallback((index: number) => {\n    const item = menuItems[index];\n    if (item?.action) {\n      setFlashIndex(index);\n      setTimeout(() => {\n        setFlashIndex(null);\n        item.action?.();\n      }, 150);\n    }\n  }, [menuItems]);\n\n  // Keyboard navigation\n  useEffect(() => {\n    const handleKeyDown = (e: KeyboardEvent) => {\n      // Prevent default for navigation keys\n      if (['ArrowUp', 'ArrowDown', 'Enter', ' ', 'Escape'].includes(e.key)) {\n        e.preventDefault();\n        e.stopPropagation();\n      }\n\n      switch (e.key) {\n        case 'ArrowDown':\n          setSelectedIndex((prev) => (prev + 1) % menuItems.length);\n          break;\n        case 'ArrowUp':\n          setSelectedIndex((prev) => (prev - 1 + menuItems.length) % menuItems.length);\n          break;\n        case 'Enter':\n        case ' ':\n          executeAction(selectedIndex);\n          break;\n        case 'Escape':\n          onClose();\n          break;\n        // Keyboard shortcuts\n        case 't':\n        case 'T':\n          if (onTeamManagement) {\n            const idx = menuItems.findIndex((m) => m.id === 'team');\n            executeAction(idx);\n          }\n          break;\n        case 'i':\n        case 'I':\n          if (onInventory) {\n            const idx = menuItems.findIndex((m) => m.id === 'inventory');\n            executeAction(idx);\n          }\n          break;\n        case 'd':\n        case 'D':\n          if (onDjinnCollection) {\n            const idx = menuItems.findIndex((m) => m.id === 'djinn');\n            executeAction(idx);\n          }\n          break;\n        case 'c':\n        case 'C':\n          if (onCompendium) {\n            const idx = menuItems.findIndex((m) => m.id === 'compendium');\n            executeAction(idx);\n          }\n          break;\n        case 's':\n        case 'S':\n          if (onSaveGame) {\n            const idx = menuItems.findIndex((m) => m.id === 'save');\n            executeAction(idx);\n          }\n          break;\n        case 'o':\n        case 'O':\n          if (onSettings) {\n            const idx = menuItems.findIndex((m) => m.id === 'settings');\n            executeAction(idx);\n          }\n          break;\n        case 'h':\n        case 'H':\n          if (onHowToPlay) {\n            const idx = menuItems.findIndex((m) => m.id === 'help');\n            executeAction(idx);\n          }\n          break;\n        case 'q':\n        case 'Q':\n          if (onReturnToTitle) {\n            const idx = menuItems.findIndex((m) => m.id === 'title');\n            executeAction(idx);\n          }\n          break;\n      }\n    };\n\n    window.addEventListener('keydown', handleKeyDown, true);\n    return () => window.removeEventListener('keydown', handleKeyDown, true);\n  }, [selectedIndex, menuItems, executeAction, onClose, onTeamManagement, onInventory, onDjinnCollection, onSaveGame, onSettings, onHowToPlay, onReturnToTitle]);\n\n  // Focus management\n  useEffect(() => {\n    menuRef.current?.focus();\n  }, []);\n\n  return (\n    <div class=\"pause-overlay\" role=\"dialog\" aria-modal=\"true\" aria-label=\"Pause Menu\">\n      {/* Status Bar */}\n      <div class=\"pause-status-bar\">\n        <div class=\"status-item\">\n          <span class=\"status-label\">Chapter:</span>\n          <span class=\"status-value\">{story.chapter}</span>\n        </div>\n        <div class=\"status-item\">\n          <span class=\"status-label\">Units:</span>\n          <span class=\"status-value\">{roster.length}/10</span>\n        </div>\n        <div class=\"status-item\">\n          <span class=\"status-label\">Gold:</span>\n          <span class=\"status-value\">{gold.toLocaleString()}</span>\n        </div>\n      </div>\n\n      {/* Pause Menu Container */}\n      <div class=\"pause-menu\" ref={menuRef} tabIndex={-1}>\n        <h1 class=\"pause-title\">PAUSED</h1>\n\n        <div class=\"menu-options\" role=\"menu\">\n          {menuItems.map((item, index) => (\n            <div key={item.id}>\n              <button\n                class={`menu-option ${selectedIndex === index ? 'selected' : ''} ${flashIndex === index ? 'flash' : ''}`}\n                onClick={() => {\n                  setSelectedIndex(index);\n                  executeAction(index);\n                }}\n                onMouseEnter={() => setSelectedIndex(index)}\n                role=\"menuitem\"\n                aria-selected={selectedIndex === index}\n                disabled={!item.action}\n              >\n                <span class=\"menu-icon\" aria-hidden=\"true\">{item.icon}</span>\n                <span class=\"menu-label\">{item.label}</span>\n                <span class=\"menu-hint\">{item.shortcut}</span>\n              </button>\n              {item.dividerAfter && <div class=\"menu-divider\" />}\n            </div>\n          ))}\n        </div>\n\n        <div class=\"pause-footer\">\n          <div class=\"keyboard-hints\">\n            <div class=\"hint\">\n              <span class=\"key\"></span>\n              <span>Navigate</span>\n            </div>\n            <div class=\"hint\">\n              <span class=\"key\">Enter</span>\n              <span>Select</span>\n            </div>\n            <div class=\"hint\">\n              <span class=\"key\">ESC</span>\n              <span>Resume</span>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n","import { useEffect, useState, useRef } from 'preact/hooks';\nimport { createPortal } from 'preact/compat';\nimport { useStore } from '../state/store';\nimport { getCurrentNode, getAvailableChoices } from '@/core/services/DialogueService';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport { getPortraitSprite } from '../sprites/mappings';\nimport { warnIfPlaceholderSprite } from '../sprites/utils/warnIfPlaceholderSprite';\nimport './DialogueBoxV2.css';\n\nexport function DialogueBoxV2() {\n  const {\n    currentDialogueTree,\n    currentDialogueState,\n    makeChoice,\n    advanceCurrentDialogue,\n    endDialogue,\n    story,\n    gold,\n    equipment,\n    team,\n  } = useStore((state) => ({\n    currentDialogueTree: state.currentDialogueTree,\n    currentDialogueState: state.currentDialogueState,\n    makeChoice: state.makeChoice,\n    advanceCurrentDialogue: state.advanceCurrentDialogue,\n    endDialogue: state.endDialogue,\n    story: state.story,\n    gold: state.gold,\n    equipment: state.equipment,\n    team: state.team,\n  }));\n\n  const currentNode =\n    currentDialogueTree && currentDialogueState\n      ? getCurrentNode(currentDialogueTree, currentDialogueState)\n      : null;\n\n  const availableChoices = currentNode\n    ? getAvailableChoices(currentNode, {\n        flags: (story.flags || {}) as Record<string, boolean>,\n        inventory: {\n          items: equipment.map((item) => item.id),\n        },\n        gold,\n        level: team?.units?.[0]?.level || 1,\n      })\n    : [];\n  const hasChoices = availableChoices.length > 0;\n\n  // Typewriter effect state\n  const [displayedText, setDisplayedText] = useState('');\n  const [isTyping, setIsTyping] = useState(false);\n  const typewriterInterval = useRef<NodeJS.Timeout | null>(null);\n  const currentTextRef = useRef('');\n\n  // Typewriter effect\n  useEffect(() => {\n    if (!currentNode?.text) {\n      setDisplayedText('');\n      setIsTyping(false);\n      return;\n    }\n\n    // Check if text has changed\n    if (currentTextRef.current !== currentNode.text) {\n      currentTextRef.current = currentNode.text;\n      setDisplayedText('');\n      setIsTyping(true);\n\n      // Clear any existing interval\n      if (typewriterInterval.current) {\n        clearInterval(typewriterInterval.current);\n      }\n\n      let index = 0;\n      const typewriterSpeed = 30; // milliseconds per character\n\n      typewriterInterval.current = setInterval(() => {\n        if (index < currentNode.text.length) {\n          setDisplayedText(currentNode.text.substring(0, index + 1));\n          index++;\n        } else {\n          setIsTyping(false);\n          if (typewriterInterval.current) {\n            clearInterval(typewriterInterval.current);\n            typewriterInterval.current = null;\n          }\n        }\n      }, typewriterSpeed);\n    }\n\n    return () => {\n      if (typewriterInterval.current) {\n        clearInterval(typewriterInterval.current);\n        typewriterInterval.current = null;\n      }\n    };\n  }, [currentNode?.text]);\n\n  const skipTypewriter = () => {\n    if (isTyping && currentNode?.text) {\n      if (typewriterInterval.current) {\n        clearInterval(typewriterInterval.current);\n        typewriterInterval.current = null;\n      }\n      setDisplayedText(currentNode.text);\n      setIsTyping(false);\n    }\n  };\n\n  const handleAdvance = () => {\n    if (isTyping) {\n      skipTypewriter();\n    } else {\n      advanceCurrentDialogue();\n    }\n  };\n\n  useEffect(() => {\n    const handleKeyPress = (event: KeyboardEvent) => {\n      // Only handle if dialogue is active\n      if (!currentDialogueTree || !currentDialogueState) return;\n\n      if (event.key === 'Escape') {\n        event.preventDefault();\n        event.stopPropagation();\n        endDialogue();\n        return;\n      }\n\n      // Space or Enter: skip typewriter if typing, otherwise advance\n      if (!hasChoices && (event.key === ' ' || event.key === 'Enter' || event.code === 'Space' || event.code === 'Enter')) {\n        event.preventDefault();\n        event.stopPropagation();\n\n        handleAdvance();\n        return;\n      }\n\n      // Number keys for choices\n      const num = parseInt(event.key, 10);\n      if (!Number.isNaN(num) && num >= 1 && num <= availableChoices.length) {\n        event.preventDefault();\n        event.stopPropagation();\n        const selected = availableChoices[num - 1];\n        if (selected) {\n          makeChoice(selected.id);\n        }\n      }\n    };\n\n    // Use capture phase to get events before other handlers\n    window.addEventListener('keydown', handleKeyPress, true);\n    return () => window.removeEventListener('keydown', handleKeyPress, true);\n  }, [currentDialogueTree, currentDialogueState, availableChoices, hasChoices, advanceCurrentDialogue, makeChoice, endDialogue, isTyping, handleAdvance]);\n\n  if (!currentDialogueTree || !currentDialogueState) {\n    return null;\n  }\n\n  if (!currentNode) {\n    return null;\n  }\n\n  const handleClick = (e: MouseEvent) => {\n    // Don't advance if clicking on buttons or choices\n    if (hasChoices || (e.target as HTMLElement).closest('.dialogue-choice-v2')) {\n      return;\n    }\n\n    handleAdvance();\n  };\n\n  const dialogueContent = (\n    <div\n      class=\"dialogue-overlay-v2\"\n      onClick={handleClick}\n      style={{\n        cursor: hasChoices ? 'default' : 'pointer',\n      }}\n    >\n      <div class=\"dialogue-box-v2\">\n        <div class=\"dialogue-panel-v2\">\n          {/* Corner ornaments */}\n          <div class=\"corner-ornament-v2 top-left\"></div>\n          <div class=\"corner-ornament-v2 top-right\"></div>\n          <div class=\"corner-ornament-v2 bottom-left\"></div>\n          <div class=\"corner-ornament-v2 bottom-right\"></div>\n\n          {/* Portrait section */}\n          {currentNode.speaker && (\n            <div class=\"portrait-section-v2\">\n              <div class=\"speaker-name-v2\">{currentNode.speaker}</div>\n              <div class=\"portrait-frame-v2\">\n                <div class=\"portrait-inner-v2\">\n                  {(() => {\n                    const portraitId = getPortraitSprite(currentNode.speaker);\n                    warnIfPlaceholderSprite('DialogueBoxV2', portraitId);\n                    return (\n                      <SimpleSprite\n                        id={portraitId}\n                        width={84}\n                        height={84}\n                        style={{ borderRadius: '50%', imageRendering: 'pixelated' }}\n                      />\n                    );\n                  })()}\n                </div>\n              </div>\n            </div>\n          )}\n\n          {/* Text content area */}\n          <div class=\"dialogue-content-v2\">\n            <div class=\"dialogue-text-v2\">\n              {displayedText}\n              {isTyping && <span class=\"cursor-v2\"></span>}\n            </div>\n\n            {/* Choices */}\n            {hasChoices && (\n              <div class=\"dialogue-choices-v2\">\n                {availableChoices.map((choice, idx) => (\n                  <button\n                    key={choice.id}\n                    class=\"choice-button-v2\"\n                    data-number={idx + 1}\n                    onClick={(e) => {\n                      e.stopPropagation();\n                      makeChoice(choice.id);\n                    }}\n                  >\n                    {choice.text}\n                  </button>\n                ))}\n              </div>\n            )}\n          </div>\n\n          {/* Continue indicator with explicit next button */}\n          {!hasChoices && (\n            <div class={`continue-indicator-v2 ${isTyping ? 'is-typing' : ''}`}>\n              <button\n                type=\"button\"\n                class=\"dialogue-next-button-v2\"\n                onClick={(event) => {\n                  event.stopPropagation();\n                  handleAdvance();\n                }}\n              >\n                <span class=\"next-label-v2\">{isTyping ? 'Skip' : 'Next'}</span>\n                <span class=\"next-icon-v2\" aria-hidden=\"true\"></span>\n              </button>\n              <span class=\"dialogue-hotkey-v2\">Space / Enter</span>\n              {!isTyping && <div class=\"arrow-sprite-v2\"></div>}\n            </div>\n          )}\n        </div>\n      </div>\n    </div>\n  );\n\n  // Use Preact portal to render at document.body level\n  if (typeof document === 'undefined' || !document.body) {\n    return null;\n  }\n\n  return createPortal(dialogueContent, document.body);\n}\n","/**\n * BackgroundSprite Component\n * \n * Specialized component for rendering battle/overworld backgrounds.\n * Supports random selection, category filtering, and full-screen backgrounds.\n * \n * @example\n * // Random background from category\n * <BackgroundSprite id=\"random\" category=\"backgrounds-gs1\" />\n * \n * @example\n * // Specific background\n * <BackgroundSprite id=\"vale-forest\" />\n * \n * @example\n * // Full-screen background\n * <BackgroundSprite \n *   id=\"random\" \n *   category=\"backgrounds-gs1\"\n *   style={{ position: 'absolute', width: '100%', height: '100%' }}\n * />\n */\n\nimport { useState, useEffect, useMemo } from 'preact/hooks';\nimport { \n  getSpritesByCategory, \n  getRandomSprite, \n  getSpriteById,\n  getSpriteByPath,\n  type SpriteEntry \n} from './catalog';\n\nexport interface BackgroundSpriteProps {\n  /**\n   * Background identifier:\n   * - \"random\": Select random background from category\n   * - Flexible ID: \"vale-forest\" (searches catalog)\n   * - Direct path: \"/sprites/backgrounds/gs1/Vale.gif\"\n   */\n  id: string;\n  \n  /**\n   * Category to filter backgrounds (required if id=\"random\")\n   * Examples: \"backgrounds-gs1\", \"backgrounds-gs2\"\n   */\n  category?: string;\n  \n  /** Optional custom CSS styles */\n  style?: React.CSSProperties;\n  \n  /** Optional CSS class name */\n  className?: string;\n  \n  /** \n   * Background size mode\n   * - \"cover\": Fill container, maintain aspect ratio (default)\n   * - \"contain\": Fit within container, maintain aspect ratio\n   * - \"fill\": Stretch to fill container\n   */\n  sizeMode?: 'cover' | 'contain' | 'fill';\n  \n  /** \n   * Background position\n   * Default: \"center center\"\n   */\n  position?: string;\n  \n  /** \n   * Background repeat\n   * Default: \"no-repeat\"\n   */\n  repeat?: 'no-repeat' | 'repeat' | 'repeat-x' | 'repeat-y';\n  \n  /** Debug mode - shows background info */\n  debug?: boolean;\n  \n  /** Callback when background loads */\n  onLoad?: () => void;\n  \n  /** Callback when background fails to load */\n  onError?: (error: string) => void;\n}\n\n/**\n * Find background sprite entry\n */\nfunction findBackgroundSprite(\n  id: string, \n  category?: string\n): { entry: SpriteEntry | null; method: string } {\n  // Random selection\n  if (id.toLowerCase() === 'random') {\n    if (!category) {\n      console.warn('[BackgroundSprite] Random selection requires category prop');\n      return { entry: null, method: 'none' };\n    }\n    \n    const sprites = getSpritesByCategory(category);\n    if (sprites.length === 0) {\n      console.warn(`[BackgroundSprite] No sprites found in category: ${category}`);\n      return { entry: null, method: 'none' };\n    }\n    \n    const randomSprite = getRandomSprite(category);\n    return { entry: randomSprite, method: 'random' };\n  }\n  \n  // Direct path\n  if (id.startsWith('/')) {\n    const entry = getSpriteByPath(id);\n    return { entry, method: 'path' };\n  }\n  \n  // Catalog lookup\n  const entry = getSpriteById(id);\n  if (entry) {\n    return { entry, method: 'catalog' };\n  }\n  \n  return { entry: null, method: 'none' };\n}\n\nexport function BackgroundSprite({\n  id,\n  category,\n  style,\n  className,\n  sizeMode = 'cover',\n  position = 'center center',\n  repeat = 'no-repeat',\n  debug = false,\n  onLoad,\n  onError,\n}: BackgroundSpriteProps) {\n  const [spriteEntry, setSpriteEntry] = useState<{ entry: SpriteEntry | null; method: string } | null>(null);\n  const [loadError, setLoadError] = useState<string | null>(null);\n  const [isLoaded, setIsLoaded] = useState(false);\n  const [showDebugInfo, setShowDebugInfo] = useState(false);\n  \n  // Lookup sprite (memoized for random to prevent re-rolling on every render)\n  const lookupResult = useMemo(() => {\n    return findBackgroundSprite(id, category);\n  }, [id, category]);\n  \n  useEffect(() => {\n    setSpriteEntry(lookupResult);\n    setLoadError(null);\n    setIsLoaded(false);\n    \n    if (debug && lookupResult.entry) {\n      // eslint-disable-next-line no-console\n      console.log(`[BackgroundSprite] Found background:`, {\n        id,\n        method: lookupResult.method,\n        name: lookupResult.entry.name,\n        path: lookupResult.entry.path,\n        category: lookupResult.entry.category,\n      });\n    } else if (debug && !lookupResult.entry) {\n      // eslint-disable-next-line no-console\n      console.warn(`[BackgroundSprite] Background not found:`, {\n        id,\n        category,\n        method: lookupResult.method,\n      });\n    }\n  }, [lookupResult, debug, id, category]);\n  \n  // Handle image load\n  const handleLoad = () => {\n    setIsLoaded(true);\n    setLoadError(null);\n    onLoad?.();\n  };\n  \n  const handleError = () => {\n    const error = spriteEntry?.entry \n      ? `Failed to load: ${spriteEntry.entry.path}`\n      : `Background not found: ${id}`;\n    setLoadError(error);\n    setIsLoaded(false);\n    onError?.(error);\n    \n    if (debug) {\n      console.error(`[BackgroundSprite] Load error:`, error);\n    }\n  };\n  \n  // Determine background path\n  const backgroundPath = spriteEntry?.entry?.path || null;\n  \n  // Fallback if no background found\n  if (!backgroundPath || loadError) {\n    return (\n      <div\n        className={className}\n        style={{\n          backgroundColor: '#1a1a2e',\n          backgroundImage: 'linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)',\n          ...style,\n        }}\n        onMouseEnter={() => debug && setShowDebugInfo(true)}\n        onMouseLeave={() => debug && setShowDebugInfo(false)}\n        title={loadError || `Background not found: ${id}`}\n      >\n        {debug && showDebugInfo && (\n          <div\n            style={{\n              position: 'absolute',\n              top: 0,\n              left: 0,\n              backgroundColor: 'rgba(0, 0, 0, 0.9)',\n              color: '#fff',\n              padding: '8px',\n              borderRadius: '4px',\n              fontSize: '12px',\n              zIndex: 1000,\n            }}\n          >\n            <div><strong>Background ID:</strong> {id}</div>\n            {category && <div><strong>Category:</strong> {category}</div>}\n            {spriteEntry && <div><strong>Lookup Method:</strong> {spriteEntry.method}</div>}\n            {loadError && (\n              <div style={{ color: '#ff6b6b' }}><strong>Error:</strong> {loadError}</div>\n            )}\n          </div>\n        )}\n      </div>\n    );\n  }\n  \n  // Render background\n  return (\n    <div\n      className={className}\n      style={{\n        backgroundImage: `url(${backgroundPath})`,\n        backgroundSize: sizeMode,\n        backgroundPosition: position,\n        backgroundRepeat: repeat,\n        width: '100%',\n        height: '100%',\n        ...style,\n      }}\n      onMouseEnter={() => debug && setShowDebugInfo(true)}\n      onMouseLeave={() => debug && setShowDebugInfo(false)}\n    >\n      {/* Preload image to detect load/error */}\n      <img\n        src={backgroundPath}\n        alt={spriteEntry?.entry?.name || id}\n        style={{ display: 'none' }}\n        onLoad={handleLoad}\n        onError={handleError}\n      />\n      \n      {/* Debug info overlay */}\n      {debug && showDebugInfo && spriteEntry && spriteEntry.entry && (\n        <div\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            backgroundColor: 'rgba(0, 0, 0, 0.9)',\n            color: '#fff',\n            padding: '8px',\n            borderRadius: '4px',\n            fontSize: '12px',\n            zIndex: 1000,\n            maxWidth: '300px',\n          }}\n        >\n          <div><strong>Name:</strong> {spriteEntry.entry.name}</div>\n          <div><strong>Path:</strong> {spriteEntry.entry.path}</div>\n          <div><strong>Category:</strong> {spriteEntry.entry.category}</div>\n          <div><strong>Lookup:</strong> {spriteEntry.method}</div>\n          <div><strong>Status:</strong> {isLoaded ? ' Loaded' : ' Loading...'}</div>\n        </div>\n      )}\n    </div>\n  );\n}\n\n","/**\n * SaveMenu Component\n * Displays 3 save slots with metadata and save/load/delete actions\n */\n\nimport { useState, useEffect } from 'preact/hooks';\nimport { useStore } from '../state/store';\nimport { useGameStore } from '../../store/gameStore';\nimport type { SaveSlotMetadata } from '../../core/services/SaveService';\nimport { SimpleSprite } from '../sprites/SimpleSprite';\nimport { BackgroundSprite } from '../sprites/BackgroundSprite';\nimport './SaveMenu.css';\n\ninterface SaveMenuProps {\n  onClose: () => void;\n}\n\n/**\n * Format timestamp to readable date/time\n */\nfunction formatTimestamp(timestamp?: number): string {\n  if (!timestamp) return 'No save';\n  const date = new Date(timestamp);\n  return date.toLocaleString('en-US', {\n    month: 'short',\n    day: 'numeric',\n    year: 'numeric',\n    hour: '2-digit',\n    minute: '2-digit',\n  });\n}\n\n/**\n * Format playtime in seconds to readable format\n */\nfunction formatPlaytime(seconds?: number): string {\n  if (!seconds) return '0:00';\n  const hours = Math.floor(seconds / 3600);\n  const minutes = Math.floor((seconds % 3600) / 60);\n  if (hours > 0) {\n    return `${hours}:${minutes.toString().padStart(2, '0')}`;\n  }\n  return `${minutes}:${(seconds % 60).toString().padStart(2, '0')}`;\n}\n\nexport function SaveMenu({ onClose }: SaveMenuProps) {\n  const { saveGameSlot, loadGameSlot, deleteSaveSlot, getSaveSlotMetadata: getMetadata } = useStore();\n  const startTransition = useGameStore((s) => s.startTransition);\n  const [slots, setSlots] = useState<SaveSlotMetadata[]>([\n    { exists: false },\n    { exists: false },\n    { exists: false },\n  ]);\n  const [selectedSlot, setSelectedSlot] = useState<number | null>(null);\n  const [action, setAction] = useState<'save' | 'load' | 'delete' | null>(null);\n  const [isLoading, setIsLoading] = useState(false);\n  const [error, setError] = useState<string | null>(null);\n\n  // Refresh slot metadata\n  const refreshSlots = () => {\n    setSlots([\n      getMetadata(0),\n      getMetadata(1),\n      getMetadata(2),\n    ]);\n  };\n\n  useEffect(() => {\n    refreshSlots();\n  }, []);\n\n  const handleSlotClick = (slotIndex: number) => {\n    if (action === 'save') {\n      handleSave(slotIndex);\n    } else if (action === 'load') {\n      handleLoad(slotIndex);\n    } else if (action === 'delete') {\n      setSelectedSlot(slotIndex);\n    }\n  };\n\n  const handleSave = async (slotIndex: number) => {\n    setIsLoading(true);\n    setError(null);\n    try {\n      saveGameSlot(slotIndex);\n      refreshSlots();\n      setAction(null);\n      setSelectedSlot(null);\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to save game');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleLoad = async (slotIndex: number) => {\n    if (!slots[slotIndex]?.exists) {\n      setError('No save file found in this slot');\n      return;\n    }\n    setIsLoading(true);\n    setError(null);\n    try {\n      loadGameSlot(slotIndex);\n      // Navigate to overworld after successful load\n      startTransition('overworld');\n      onClose();\n    } catch (err) {\n      setError(err instanceof Error ? err.message : 'Failed to load game');\n    } finally {\n      setIsLoading(false);\n    }\n  };\n\n  const handleDelete = (slotIndex: number) => {\n    if (!slots[slotIndex]?.exists) {\n      return;\n    }\n    deleteSaveSlot(slotIndex);\n    refreshSlots();\n    setSelectedSlot(null);\n    setAction(null);\n  };\n\n  const handleConfirmDelete = () => {\n    if (selectedSlot !== null) {\n      handleDelete(selectedSlot);\n    }\n  };\n\n  return (\n    <div class=\"save-menu-overlay\" onClick={onClose}>\n      <div class=\"save-menu-container\" onClick={(e) => e.stopPropagation()}>\n        <BackgroundSprite\n          id=\"random\"\n          category=\"backgrounds-gs1\"\n          style={{\n            position: 'absolute',\n            top: 0,\n            left: 0,\n            width: '100%',\n            height: '100%',\n            opacity: 0.3,\n            borderRadius: '12px',\n            zIndex: -1,\n          }}\n        />\n        <div class=\"save-menu-header\">\n          <h1>Save / Load Game</h1>\n          <button class=\"close-btn\" onClick={onClose} aria-label=\"Close save menu\">\n            \n          </button>\n        </div>\n\n        {error && (\n          <div class=\"save-menu-error\" role=\"alert\">\n            {error}\n          </div>\n        )}\n\n        {isLoading && (\n          <div class=\"save-menu-loading\">\n            {action === 'save' ? 'Saving...' : 'Loading...'}\n          </div>\n        )}\n\n        {/* Action Buttons */}\n        <div class=\"save-menu-actions\">\n          <button\n            class={`action-btn ${action === 'save' ? 'active' : ''}`}\n            onClick={() => {\n              setAction(action === 'save' ? null : 'save');\n              setSelectedSlot(null);\n            }}\n            disabled={isLoading}\n          >\n            <SimpleSprite\n              id=\"save-game\"\n              width={24}\n              height={24}\n              style={{ marginRight: '8px' }}\n            />\n            New Save\n          </button>\n          <button\n            class={`action-btn ${action === 'load' ? 'active' : ''}`}\n            onClick={() => {\n              setAction(action === 'load' ? null : 'load');\n              setSelectedSlot(null);\n            }}\n            disabled={isLoading}\n          >\n            <SimpleSprite\n              id=\"continue\"\n              width={24}\n              height={24}\n              style={{ marginRight: '8px' }}\n            />\n            Load Save\n          </button>\n        </div>\n\n        {/* Save Slots */}\n        <div class=\"save-slots\">\n          {slots.map((slot, index) => (\n            <div\n              key={index}\n              class={`save-slot ${selectedSlot === index ? 'selected' : ''} ${!slot.exists ? 'empty' : ''}`}\n              onClick={() => handleSlotClick(index)}\n            >\n              <div class=\"save-slot-header\">\n                <h2>Slot {index + 1}</h2>\n                {action === 'save' && (\n                  <span class=\"action-indicator\">Click to save</span>\n                )}\n                {action === 'load' && slot.exists && (\n                  <span class=\"action-indicator\">Click to load</span>\n                )}\n                {action === 'delete' && slot.exists && (\n                  <span class=\"action-indicator\">Click to delete</span>\n                )}\n              </div>\n\n              {slot.exists ? (\n                <div class=\"save-slot-content\">\n                  <div style={{ display: 'flex', gap: '16px', alignItems: 'flex-start' }}>\n                    <div class=\"save-slot-portrait\">\n                      <SimpleSprite\n                        id=\"isaac1\"\n                        width={64}\n                        height={64}\n                      />\n                    </div>\n                    <div class=\"save-slot-meta\">\n                      <div class=\"meta-row\">\n                        <span class=\"meta-label\">Date:</span>\n                        <span class=\"meta-value\">{formatTimestamp(slot.timestamp)}</span>\n                      </div>\n                      <div class=\"meta-row\">\n                        <span class=\"meta-label\">Playtime:</span>\n                        <span class=\"meta-value\">{formatPlaytime(slot.playtime)}</span>\n                      </div>\n                      <div class=\"meta-row\">\n                        <span class=\"meta-label\">Team Level:</span>\n                        <span class=\"meta-value\">Lv. {slot.teamLevel ?? 1}</span>\n                      </div>\n                      <div class=\"meta-row\">\n                        <span class=\"meta-label\">Gold:</span>\n                        <span class=\"meta-value\">{slot.gold ?? 0}g</span>\n                      </div>\n                      {slot.chapter && (\n                        <div class=\"meta-row\">\n                          <span class=\"meta-label\">Chapter:</span>\n                          <span class=\"meta-value\">{slot.chapter}</span>\n                        </div>\n                      )}\n                    </div>\n                  </div>\n                </div>\n              ) : (\n                <div class=\"save-slot-empty\">\n                  <span>Empty Slot</span>\n                </div>\n              )}\n            </div>\n          ))}\n        </div>\n\n        {/* Delete Confirmation */}\n        {action === 'delete' && selectedSlot !== null && slots[selectedSlot]?.exists && (\n          <div class=\"delete-confirmation\">\n            <p>Are you sure you want to delete this save?</p>\n            <div class=\"confirmation-buttons\">\n              <button\n                class=\"confirm-btn\"\n                onClick={handleConfirmDelete}\n              >\n                Yes, Delete\n              </button>\n              <button\n                class=\"cancel-btn\"\n                onClick={() => {\n                  setSelectedSlot(null);\n                  setAction(null);\n                }}\n              >\n                Cancel\n              </button>\n            </div>\n          </div>\n        )}\n\n        {/* Delete Button */}\n        {action !== 'delete' && (\n          <div class=\"save-menu-footer\">\n            <button\n              class=\"delete-action-btn\"\n              onClick={() => {\n                setAction('delete');\n                setSelectedSlot(null);\n              }}\n              disabled={isLoading}\n            >\n              <SimpleSprite\n                id=\"erase-file\"\n                width={24}\n                height={24}\n                style={{ marginRight: '8px' }}\n              />\n              Delete Save\n            </button>\n          </div>\n        )}\n      </div>\n    </div>\n  );\n}\n","/**\n * Error Boundary Component\n * Catches React errors and displays fallback UI instead of blank screen\n */\n\nimport { Component, ComponentChildren } from 'preact';\n\ninterface Props {\n  children: ComponentChildren;\n  fallback?: ComponentChildren;\n}\n\ninterface State {\n  hasError: boolean;\n  error: Error | null;\n}\n\nexport class GameErrorBoundary extends Component<Props, State> {\n  constructor(props: Props) {\n    super(props);\n    this.state = {\n      hasError: false,\n      error: null,\n    };\n  }\n\n  static getDerivedStateFromError(error: Error): State {\n    return {\n      hasError: true,\n      error,\n    };\n  }\n\n  componentDidCatch(error: Error, errorInfo: { componentStack?: string }) {\n    // Log error for debugging\n    // Error boundary logging is acceptable - this helps with debugging\n    console.error('Game error caught by boundary:', error, errorInfo);\n  }\n\n  handleReset = () => {\n    this.setState({\n      hasError: false,\n      error: null,\n    });\n  };\n\n  handleReload = () => {\n    window.location.reload();\n  };\n\n  render() {\n    if (this.state.hasError) {\n      if (this.props.fallback) {\n        return this.props.fallback;\n      }\n\n      return (\n        <div\n          style={{\n            display: 'flex',\n            flexDirection: 'column',\n            alignItems: 'center',\n            justifyContent: 'center',\n            minHeight: '100vh',\n            padding: '2rem',\n            backgroundColor: '#1a1a2e',\n            color: '#fff',\n          }}\n        >\n          <h1 style={{ fontSize: '2rem', marginBottom: '1rem', color: '#FFD87F' }}>\n            Arena Reset Required\n          </h1>\n          <p style={{ fontSize: '1.2rem', marginBottom: '2rem', textAlign: 'center', maxWidth: '600px' }}>\n            Hang tight, the arena needs a reset. An unexpected error occurred during battle.\n          </p>\n          {this.state.error && (\n            <details\n              style={{\n                marginBottom: '2rem',\n                padding: '1rem',\n                backgroundColor: '#2a2a3e',\n                borderRadius: '4px',\n                maxWidth: '800px',\n                width: '100%',\n              }}\n            >\n              <summary style={{ cursor: 'pointer', marginBottom: '0.5rem' }}>\n                Error Details (for debugging)\n              </summary>\n              <pre\n                style={{\n                  whiteSpace: 'pre-wrap',\n                  wordBreak: 'break-word',\n                  fontSize: '0.9rem',\n                  color: '#ff6b6b',\n                }}\n              >\n                {this.state.error.toString()}\n                {this.state.error.stack && `\\n\\n${this.state.error.stack}`}\n              </pre>\n            </details>\n          )}\n          <div style={{ display: 'flex', gap: '1rem' }}>\n            <button\n              onClick={this.handleReset}\n              style={{\n                padding: '0.75rem 1.5rem',\n                fontSize: '1rem',\n                backgroundColor: '#4CAF50',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: 'pointer',\n                fontWeight: 'bold',\n              }}\n            >\n              Try Again\n            </button>\n            <button\n              onClick={this.handleReload}\n              style={{\n                padding: '0.75rem 1.5rem',\n                fontSize: '1rem',\n                backgroundColor: '#2196F3',\n                color: '#fff',\n                border: 'none',\n                borderRadius: '4px',\n                cursor: 'pointer',\n                fontWeight: 'bold',\n              }}\n            >\n              Reload Game\n            </button>\n          </div>\n        </div>\n      );\n    }\n\n    return this.props.children;\n  }\n}\n"],"names":["DEFAULT_INVENTORY_CAPACITY","initialFlowState","initialPlayerData","createGameSlice","set","_get","screen","state","modal","isTransitioning","createBattleSlice","enemyId","rngSeed","seed","event","phase","createTeamSlice","team","member","memberId","updater","index","createInventorySlice","inventory","item","existing","it","itemId","quantity","items","useGameStore","createWithEqualityFn","immer","get","TITLE_CHARACTERS","TitleScreen","startTransition","s","useEffect","handleKeyPress","handleClick","jsxs","jsx","char","battle","turnNumber","events","rng","makePRNG","createRNGStream","RNG_STREAMS","result","battleServiceStartTurnTick","casterId","abilityId","targetIds","performAction","battleEnd","checkBattleEnd","newEvents","processVictory","encounterId","getEncounterId","rngEndTurn","endResult","endTurn","allUnits","currentActorId","decision","makeAIDecision","onBattleEvents","error","rngFallback","fallbackResult","targets","previewSeed","baseRng","N","sum","min","max","i","r","totalDamage","e","acc","ev","critFlashTimeouts","computePendingMana","pendingThisRound","pendingManaNextRound","action","unit","isUnitKO","sumBattleStat","units","key","total","createQueueBattleSlice","critThresholds","critCounters","battleState","open","message","current","pending","pendingNext","unitId","existingTimeout","timeoutId","_removed","rest","unitIndex","ability","queueAction","sameTurn","clearQueuedAction","djinnId","queueDjinn","unqueueDjinn","executeRound","battleEvents","towerEncounterId","updateTeamState","updateTeamUnits","healedUnits","autoHealUnits","healedTeam","updateTeam","healedState","updateBattleState","healEvent","updates","updatedRoster","existingIndex","u","updatedTeam","partyIndex","newUnit","unitDef","UNIT_DEFINITIONS","oldUnit","createUnit","newUnits","finalUnits","normalizeAvailability","entry","isAvailableInCampaign","TOWER_START_GOLD","DEFAULT_DIFFICULTY","DEFAULT_TOWER_RECORD","createTowerSlice","createEmptyRewardLedger","run","towerGetCurrentFloor","TOWER_FLOORS","opts","difficulty","snapshots","captureSnapshot","towerTeam","towerRoster","buildTowerRoster","campaignEquipment","EQUIPMENT","createTowerRun","DEFAULT_TOWER_CONFIG","floor","currentFloor","outcome","summary","sumUnitStat","rewardEntries","getRewardsForFloor","recordedRun","recordBattleResult","clearedRun","clearPendingRewards","processTowerRewards","updateTowerRecordFromRun","config","healTeamAtRest","restedRun","completeRestFloor","mapId","position","context","rewardsLedger","restoreSnapshot","commitTowerRewardsToCampaign","record","cloneTeam","cloneUnit","snapshot","roster","def","updateUnit","party","createTeam","campaignDjinnIds","DJINN","id","collectDjinn","equippedDjinn","floorNumber","TOWER_REWARDS","reward","entries","setState","baseLedger","updatedLedger","recorded","grantDjinnReward","appendUnitToRoster","rewards","existingIds","fraction","stats","calculateEffectiveStats","healAmount","nextHp","resetTrackers","tracker","nextHighest","nextTotalRuns","turnsThisRun","damageThisRun","nextBestTurns","nextBestDamage","createSaveData","story","overworld","towerRecord","recruitmentFlags","npcStates","statsTracker","activeParty","djinnCollected","djinnTrackers","storyFlags","value","playerPosition","currentScene","baseMaxHp","getStoryStateFromSave","saveData","storySection","flags","createSaveSlice","_set","hasSave","loadGame","activeUnits","battleStateJson","currentMapId","gold","equipment","saveGame","deleteSave","slot","saveGameSlot","loadGameSlot","hasSaveSlot","deleteSaveSlot","getSaveSlotMetadata","recruited","statePatch","damageDealt","healingDone","seconds","createStorySlice","createStoryState","show","storyState","processStoryFlagForDjinn","updatedStory","setFlag","st","processEncounterCompletion","flagKey","encounterIdToFlagKey","djinnResult","storyJoinFlagKey","avgLevel","unitResult","processStoryFlagForUnit","adv","advanceChapter","amount","newEquipment","createRewardsSlice","rewardsServiceProcessVictory","setTeam","lastBattleRewards","addGold","addEquipment","equipmentToAdd","visible","DEFAULT_BATTLE_SLOT_COUNT","MAX_PARTY_SIZE","DEFAULT_DJINN_SLOT_COUNT","cloneEquipmentLoadout","loadout","getDefaultEquipmentLoadoutForUnit","createEmptyLoadout","createDefaultDjinnSlots","selectedDjinn","slots","createBattleConfigFromUnits","slotCount","initialDjinn","buildBattleConfigForNextBattle","getActiveSlotUnitIds","updateDjinnSlots","slotIndex","next","validateBattleConfig","MIN_PARTY_SIZE","inventoryCounts","equipmentUsage","candidate","loadoutEntries","used","equipmentId","available","createGameFlowSlice","buildTeamFromBattleConfig","store","currentBattleConfig","existingTeam","equipmentLoadout","unitWithEquipment","baseTeam","initializeBattleConfig","mode","battleConfig","trigger","skipPreBattleDialogue","ENCOUNTERS","preBattleDialogue","getPreBattleDialogue","npcId","DIALOGUES","storyId","shopId","enterTowerFromOverworld","pendingBattleEncounterId","validation","encounter","selectedTeam","preBattlePosition","createBattleFromEncounter","equipmentSlot","normalizedDjinnId","existingId","djinnSlots","teleportPlayer","startMap","MAPS","STARTING_MAP","createOverworldSlice","getStore","direction","map","processMovement","filteredTrigger","isHouseUnlocked","djinnIntro","createDialogueSlice","tree","startDialogue","choiceId","currentDialogueTree","currentDialogueState","choiceEffects","n","newState","selectChoice","processDialogueEffects","startingTreeId","startingStateTreeId","currentNode","latestState","latestTree","advanceDialogue","prevMode","mapEffectsToEvents","effects","currentDialogueTreeId","isPreBattleDialogueTree","hasStoryFlag","applyDialogueEvents","canSetStoryFlag","collectResult","collectedTeam","equipResult","equipDjinn","finalTeam","saveSlice","createDevModeSlice","enabled","houseId","storeFactory","api","createStore","useStore","SPRITE_LIST","normalizeIdentifier","getFilenameStem","spritePath","lastSlash","tokenize","getSpriteByPath","path","getSpritesByCategory","category","getSpriteById","normalizedId","keywords","exactMatch","stemMatch","keywordMatch","haystacks","kw","haystack","getRandomSprite","sprites","randomIndex","generatePlaceholder","width","height","hash","hue","saturation","lightness","findSprite","SimpleSprite","style","className","debug","fallback","alt","imageRendering","objectFit","onLoad","onError","spriteEntry","setSpriteEntry","useState","loadError","setLoadError","isLoaded","setIsLoaded","showDebugInfo","setShowDebugInfo","catalogSuggestion","handleLoad","handleError","ABILITY_ICON_MAP","getAbilityIconSprite","PORTRAIT_MAP","getPortraitSprite","name","lowerName","lowerMatch","PROTAGONIST_BASE_PATH","MAJOR_NPC_BASE_PATH","PLAYER_UNIT_TO_SPRITE","ISAAC_POSE","PROTAGONIST_POSES","DEFAULT_POSE","protagonistPath","file","getPoseConfig","baseName","getPlayerSprite","poseConfig","poseFile","NPC_ROLE_TO_FILE","SPECIFIC_NPC_TO_FILE","npcPath","getNPCSprite","specificFile","match","villagerFile","shouldMirrorSprite","EARLY_HOUSE_MAX","EARLY_SPECIAL_ENCOUNTERS","isEarlyEncounterId","collectEarlyEnemyIds","ids","makePlayerSpritePaths","character","weapon","base","makeSinglePose","PLAYER_SPRITES","ENEMY_SPRITES","getPlayerBattleSprite","spriteMap","getEnemyBattleSprite","OverworldMap","openModal","closeModal","facing","movePlayer","currentTrigger","clearTrigger","resetLastTrigger","handleTrigger","getInteractionPosition","delta","handleInteraction","getTriggerAt","facingPos","shouldTrigger","handleKeyDown","data","encounterRatePercent","hasRandomEncounters","row","y","tile","x","isPlayer","npcAtPosition","npc","directSpriteId","renderEventText","statusName","recoveryName","djinnNames","stateText","formatDelta","BattleLog","renderText","announcementText","PostBattleCutscene","victory","onComplete","currentMessageIndex","setCurrentMessageIndex","messages","currentMessage","isLastMessage","handleAdvance","prev","_","VictoryOverlay","duration","stage","setStage","fanfareTimer","completeTimer","DefeatOverlay","textTimer","BattleManaBar","currentMana","maxMana","pendingNextRound","circles","idx","statusIconMap","portraitDir","portrait","baseDir","sprite","StatusChips","status","BattlePortraitRow","activeIndex","queuedActions","critFlashes","onSelect","maxHp","calculateMaxHp","hpPct","critCount","critThreshold","queued","isActive","flash","ACTION_ICONS","ELEMENT_ICONS","TYPE_ICONS","ELEMENT_COLORS","TARGET_LABELS","ABILITY_ICONS","SectionHeader","title","AbilityGrid","abilities","selectedAbilityId","lockedAbilityIds","currentUnit","currentQueuedAction","refundAmount","effectiveRemainingMana","manaCost","getAbilityManaCost","canAfford","canAffordAction","isDjinnAbility","DJINN_ABILITIES","isLocked","isSelected","element","elementTheme","targetInfo","basePower","abilityType","BattleActionMenu","onModeChange","onSelectAttack","onSelectAbility","queueDjinnActivation","setSummonScreenOpen","selectedDjinnIds","setSelectedDjinnIds","useMemo","getLockedDjinnAbilityMetadataForUnit","setDjinnIds","getSetDjinnIds","unlocked","a","djinnAbilities","regularAbilities","toggleDjinnSelection","dj","handleSummonConfirm","Fragment","djinn","ModeLabel","battleType","locationName","label","SIZE_MAP","STATE_PROP_TO_BATTLE_STATE","BattleUnitSprite","size","sizeStyles","mappedState","spriteId","resolvedSpriteId","animationClasses","finalClassName","deriveUIPhase","battlePhase","ANIMATION_TIMING","getEventTiming","eventType","_isGifCached","SPEED_PRESETS","useBattleSpeed","speedPreset","setSpeedPreset","setSpeed","useCallback","preset","multiplier","applySpeed","ms","cycleSpeed","presets","nextIndex","Z_INDEX","FX_LIBRARY","FX_FALLBACK","ABILITY_FX_MAP","getEventGif","ABILITIES","djinnSprites","QueueBattleView","setScreen","dequeue","queueUnitAction","clearUnitAction","executeQueuedRound","setMode","startDialogueTree","returnToOverworldV1","activePortraitIndex","setActivePortrait","currentManaDisplay","maxManaDisplay","pendingManaThisRound","towerStatus","activeTowerEncounterId","getCurrentTowerFloor","critFlash","incrementCritCounter","resetCritCounter","triggerCritFlash","lastError","clearError","returnToOverworld","uiPhase","setSelectedAbilityId","menuMode","setMenuMode","showCutscene","setShowCutscene","showVictoryOverlay","setShowVictoryOverlay","showDefeatOverlay","setShowDefeatOverlay","battleOutcome","setBattleOutcome","loadedFxRef","useRef","floatingNumbers","setFloatingNumbers","floatingIdRef","floatingTimeoutsRef","lastProcessedEventRef","lastCritProcessedEventRef","pendingDequeueEventRef","order","getPlanningTurnOrder","currentFx","timeout","evt","kind","BASIC_ATTACK_IDS","nextCount","threshold","currentEvent","eventId","baseDelay","delay","timer","totalQueuedMana","isQueueComplete","aliveUnits","queuedCount","highlightedTargets","t","handleDefeatResolution","VS1_ENCOUNTER_ID","preScene","VS1_SCENE_PRE","handleVictoryOverlayComplete","handleSelectAttack","handleAbilitySelect","handleTargetSelect","targetId","abilityIdOverride","abilityIdToUse","aliveEnemies","aliveAllies","currentOrderIdx","handleAutoAttack","firstTarget","getValidTargets","onKeyDown","handleExecute","canExecute","validTargets","validTargetIds","isTargeting","isExecuting","enemy","isTargetCandidate","isResolvingTarget","isActor","hasPendingEvent","animationState","num","displayValue","isTarget","fx","abilityName","targetNames","ally","MENU_CHARACTERS","MainMenu","addUnitToRoster","openTowerFromMainMenu","selectedIndex","setSelectedIndex","hasSaveFile","setHasSaveFile","hasAnySave","menuOptions","enabledOptions","opt","safeSelectedIndex","currentOption","handleSelectOption","optionId","isaac","ADEPT","starterTeam","option","isEnabled","getSlotIcon","getTierColor","tier","EquipmentIcon","icon","tierColor","EnemyPortalTile","enemyNames","ENEMIES","enemyEntries","ORDINALS","EQUIPMENT_SLOT_ORDER","EQUIPMENT_SLOT_LABELS","PreBattleTeamSelectScreenV2","onConfirm","onCancel","updateBattleConfigSlot","unitMap","selectedUnitIds","selectedUnits","b","speedDiff","availableUnits","loadoutByUnitId","configValidation","handleUnitToggle","emptySlotIndex","handleRemoveUnit","handleStartBattle","djinnData","elementLabel","elementClass","EquipmentChoicePicker","options","target","formatStatBonus","statBonus","parts","VictorySparkles","RewardsScreen","onContinue","onSelectEquipment","partyMembers","levelUpUnits","levelUp","hasPendingChoice","obtainedEquipment","latestDjinnId","latestDjinn","selected","ShopScreen","onClose","setError","shop","SHOPS","isUnlocked","availableItems","handleUnlock","buyItem","starterKitEntries","getStarterKit","kit","unlockedUnits","handleStarterKitPurchase","purchaseStarterKit","updatedUnits","handleUnitEquipmentPurchase","purchaseUnitEquipment","affordable","availableEquipment","canAffordItem","stat","PartyManagementScreen","selectedUnitId","setSelectedUnitId","activeUnitIds","selectedUnit","selectedStats","portraitId","iconId","EQUIPMENT_SLOTS","COMPARISON_STATS","TIER_FILTERS","matchesTier","filter","buildStatDeltas","candidateVal","currentVal","DeltaBadges","deltas","ShopEquipScreen","removeEquipment","activeTab","setActiveTab","selectedSlot","setSelectedSlot","tierFilter","setTierFilter","isShopUnlocked","filteredAvailableItems","handleEquip","currentItem","updatedUnit","handleUnequip","itemToUnequip","availableEquipmentForSlot","equipmentBonuses","calculateEquipmentBonuses","levelBonuses","calculateLevelBonuses","previewStats","eq","DjinnDetailModal","isCollected","isEquipped","equippedIndex","newEquippedDjinn","filteredDjinn","newTrackers","oldDjinnId","previewEquipped","previewDjinn","d","synergy","calculateDjinnSynergy","getElementColor","getDjinnSprite","djinnSpriteId","slotDjinnId","slotDjinn","isSlotEquipped","DjinnCollectionScreen","selectedDjinnId","setSelectedDjinnId","collectedDjinn","djinnByElement","elementList","djinnList","TowerHubScreen","towerRun","startTowerRun","beginTowerFloorBattle","applyTowerRest","quitTowerRun","exitTowerMode","towerEntryContext","isRestFloor","isCompleted","upcomingReward","getNextReward","partySummary","buildPartySummary","djinnStatus","buildDjinnStatus","confirmAction","setConfirmAction","loadoutPanel","setLoadoutPanel","handleStartRun","handleConfirmAction","handleQuitRun","closeLoadoutPanel","TowerRecords","renderFloor","describeRewardBundle","REST_HEAL","badgeClass","badgeLabel","rewardedFloors","pivotFloor","percent","CreditsSectionSchema","z.object","z.string","z.array","CreditsDataSchema","z.number","creditsDataResult","creditsDataRaw","creditsData","CreditsScreen","onExit","scrollPosition","setScrollPosition","isPaused","setIsPaused","containerRef","animationRef","scrollSpeed","animate","container","maxScroll","section","entryIdx","EPILOGUE_ENTRIES","EpilogueScreen","currentIndex","setCurrentIndex","fadeState","setFadeState","currentEntry","isLastEntry","PauseMenu","onTeamManagement","onInventory","onDjinnCollection","onCompendium","onSaveGame","onSettings","onHowToPlay","onReturnToTitle","flashIndex","setFlashIndex","menuRef","menuItems","executeAction","m","DialogueBoxV2","makeChoice","advanceCurrentDialogue","endDialogue","getCurrentNode","availableChoices","getAvailableChoices","hasChoices","displayedText","setDisplayedText","isTyping","setIsTyping","typewriterInterval","currentTextRef","typewriterSpeed","skipTypewriter","dialogueContent","choice","createPortal","findBackgroundSprite","BackgroundSprite","sizeMode","repeat","lookupResult","backgroundPath","formatTimestamp","timestamp","formatPlaytime","hours","minutes","SaveMenu","getMetadata","setSlots","setAction","isLoading","setIsLoading","refreshSlots","handleSlotClick","handleSave","err","handleDelete","handleConfirmDelete","GameErrorBoundary","Component","props","errorInfo"],"mappings":"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"}