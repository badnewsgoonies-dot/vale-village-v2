import{g as y,y as O,f as e,h as X,d as K,o as p,n as g,s as o,l as T,a as k,r as Y,e as H,G as $}from"./vendor-DevG9r99.js";import{u as I,a as w,E as Z,g as ee,S as U,b as ne,T as F,c as te,C as ie,d as se,D as re,P as ae,M as le,Q as ce,O as oe,e as de,f as me,h as he,i as ue,R as pe,j as ve,s as ge,G as fe}from"./ui-components-BQV0FG4t.js";import{a as L,U as j,c as z,d as q,E as V}from"./data-definitions-BS67O2Yi.js";import{ak as be,al as Q,am as W,an as ye,ao as we,ap as Se}from"./core-services-D8JEer3v.js";(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))c(s);new MutationObserver(s=>{for(const r of s)if(r.type==="childList")for(const i of r.addedNodes)i.tagName==="LINK"&&i.rel==="modulepreload"&&c(i)}).observe(document,{childList:!0,subtree:!0});function a(s){const r={};return s.integrity&&(r.integrity=s.integrity),s.referrerPolicy&&(r.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?r.credentials="include":s.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function c(s){if(s.ep)return;s.ep=!0;const r=a(s);fetch(s.href,r)}})();const C=[{id:"djinn",label:"Djinn Collection",icon:"âœ¨"},{id:"units",label:"Unit Roster",icon:"âš”ï¸"},{id:"enemies",label:"Enemies",icon:"ðŸ‘¾"},{id:"equipment",label:"Equipment Catalog",icon:"ðŸ›¡ï¸"}],Ee={Venus:"#9b6b3f",Mars:"#d14545",Mercury:"#4a90d9",Jupiter:"#9b59b6"};function D(n){return Ee[n]||"#888"}const Ce={1:"Tier 1",2:"Tier 2",3:"Tier 3"},Te={basic:"Basic",bronze:"Bronze",iron:"Iron",steel:"Steel",silver:"Silver",mythril:"Mythril",legendary:"Legendary",artifact:"Artifact"};function _({isOwned:n}){return e("div",{class:`ownership-badge ${n?"owned":"not-owned"}`,children:n?"âœ“":"?"})}function ke({djinn:n,isOwned:t}){const a=n.element.toLowerCase();return e("div",{class:`compendium-card ${t?"":"not-owned"}`,style:{borderColor:D(n.element)},children:[e(_,{isOwned:t}),e("div",{class:"compendium-card-header",children:[e("h3",{class:"compendium-card-title",children:n.name}),e("span",{class:"compendium-card-element",style:{backgroundColor:D(n.element)},children:n.element})]}),e("div",{class:"compendium-card-sprite",children:e(U,{id:`${a}-djinn-front`,width:64,height:64})}),e("div",{class:"compendium-card-body",children:[e("div",{class:"compendium-card-tier",children:Ce[n.tier]||n.tier}),n.description&&e("p",{class:"compendium-card-description",children:n.description}),e("div",{class:"compendium-card-section",children:[e("h4",{children:"Summon Effect"}),e("p",{class:"compendium-card-description",children:n.summonEffect.description}),n.summonEffect.type==="damage"&&n.summonEffect.damage&&e("p",{class:"compendium-card-stat",children:["Damage: ",n.summonEffect.damage]}),n.summonEffect.type==="heal"&&n.summonEffect.healAmount&&e("p",{class:"compendium-card-stat",children:["Heal: ",n.summonEffect.healAmount]}),n.summonEffect.type==="buff"&&n.summonEffect.statBonus&&e("p",{class:"compendium-card-stat",children:["Bonus: ",Object.entries(n.summonEffect.statBonus).map(([c,s])=>c.toUpperCase()+" +"+s).join(", ")]})]})]})]})}function Ie({unit:n,isRecruited:t}){const a=ne(n.id);return e("div",{class:`compendium-card ${t?"":"not-owned"}`,style:{borderColor:D(n.element)},children:[e(_,{isOwned:t}),e("div",{class:"compendium-card-header",children:[e("h3",{class:"compendium-card-title",children:n.name}),e("span",{class:"compendium-card-element",style:{backgroundColor:D(n.element)},children:n.element})]}),e("div",{class:"compendium-card-sprite",children:e(U,{id:a,width:64,height:64})}),e("div",{class:"compendium-card-body",children:[e("div",{class:"compendium-card-role",children:n.role}),e("p",{class:"compendium-card-description",children:n.description}),e("div",{class:"compendium-card-section",children:[e("h4",{children:"Base Stats (Level 1)"}),e("div",{class:"compendium-card-stats",children:[e("div",{class:"compendium-stat",children:["HP: ",n.baseStats.hp]}),e("div",{class:"compendium-stat",children:["PP: ",n.baseStats.pp]}),e("div",{class:"compendium-stat",children:["ATK: ",n.baseStats.atk]}),e("div",{class:"compendium-stat",children:["DEF: ",n.baseStats.def]}),e("div",{class:"compendium-stat",children:["MAG: ",n.baseStats.mag]}),e("div",{class:"compendium-stat",children:["SPD: ",n.baseStats.spd]})]})]}),e("div",{class:"compendium-card-section",children:[e("h4",{children:"Abilities"}),e("p",{class:"compendium-card-stat",children:[n.abilities.length," abilities available"]})]})]})]})}function De({equipment:n,isOwned:t}){return e("div",{class:`compendium-card ${t?"":"not-owned"}`,style:{borderColor:"#888"},children:[e(_,{isOwned:t}),e("div",{class:"compendium-card-header",children:[e("h3",{class:"compendium-card-title",children:n.name}),e("span",{class:"compendium-card-tier-badge",children:Te[n.tier]||n.tier})]}),e("div",{class:"compendium-card-sprite",children:e(Z,{equipment:n,size:"large"})}),e("div",{class:"compendium-card-body",children:[e("div",{class:"compendium-card-slot",children:n.slot.toUpperCase()}),e("div",{class:"compendium-card-section",children:[e("h4",{children:"Cost"}),e("p",{class:"compendium-card-stat",children:[n.cost," Gold"]})]}),e("div",{class:"compendium-card-section",children:[e("h4",{children:"Stat Bonuses"}),e("div",{class:"compendium-card-stats",children:Object.entries(n.statBonus).map(([a,c])=>e("div",{class:"compendium-stat",children:[a.toUpperCase(),": ",c>0?"+":"",c]},a))})]}),n.allowedElements&&n.allowedElements.length>0&&e("div",{class:"compendium-card-section",children:[e("h4",{children:"Allowed Elements"}),e("div",{class:"compendium-element-tags",children:n.allowedElements.map(a=>e("span",{class:"compendium-element-tag",style:{backgroundColor:D(a)},children:a},a))})]}),n.unlocksAbility&&e("div",{class:"compendium-card-section",children:[e("h4",{children:"Unlocks Ability"}),e("p",{class:"compendium-card-stat",children:n.unlocksAbility})]}),n.elementalResist&&e("div",{class:"compendium-card-section",children:[e("h4",{children:"Elemental Resist"}),e("p",{class:"compendium-card-stat",children:[(n.elementalResist*100).toFixed(0),"%"]})]})]})]})}function Be({enemy:n}){const t=ee(n.id,"idle");return e("div",{class:"compendium-card",style:{borderColor:D(n.element)},children:[e("div",{class:"compendium-card-header",children:[e("h3",{class:"compendium-card-title",children:n.name}),e("span",{class:"compendium-card-element",style:{backgroundColor:D(n.element)},children:n.element})]}),e("div",{class:"compendium-card-sprite",children:t?e(U,{id:t,width:64,height:64}):e("div",{class:"compendium-card-stat",children:"Sprite missing"})}),e("div",{class:"compendium-card-body",children:[e("div",{class:"compendium-card-role",children:["Level ",n.level]}),e("div",{class:"compendium-card-section",children:[e("h4",{children:"Base Stats"}),e("div",{class:"compendium-card-stats",children:[e("div",{class:"compendium-stat",children:["HP: ",n.stats.hp]}),e("div",{class:"compendium-stat",children:["PP: ",n.stats.pp]}),e("div",{class:"compendium-stat",children:["ATK: ",n.stats.atk]}),e("div",{class:"compendium-stat",children:["DEF: ",n.stats.def]}),e("div",{class:"compendium-stat",children:["MAG: ",n.stats.mag]}),e("div",{class:"compendium-stat",children:["SPD: ",n.stats.spd]})]})]}),e("div",{class:"compendium-card-section",children:[e("h4",{children:"Abilities"}),e("p",{class:"compendium-card-stat",children:[n.abilities.length," abilities available"]})]})]})]})}function Ae(){const n=I(l=>l.startTransition),[t,a]=y("djinn"),[c,s]=y(0),{team:r,roster:i,equipment:m}=w(l=>({team:l.team,roster:l.roster,equipment:l.equipment})),f=new Set(r?.collectedDjinn||[]),E=new Set(i.map(l=>l.id)),h=new Set(m.map(l=>l.id)),v=Object.values(L).filter(l=>!l.availableIn||l.availableIn.length===0),u=Object.values(j).filter(l=>!l.availableIn||l.availableIn.length===0),S=Object.values(q),B=Object.values(z).filter(l=>!l.availableIn||l.availableIn.length===0),N=(()=>{switch(t){case"djinn":return v;case"units":return u;case"enemies":return S;case"equipment":return B;default:return[]}})();O(()=>{s(0)},[t]),O(()=>{const l=d=>{if(d.key==="Escape"){d.preventDefault(),n("menu");return}if(d.key==="q"||d.key==="Q"){d.preventDefault();const b=C.findIndex(R=>R.id===t),P=b>0?b-1:C.length-1,A=C[P];A?.id&&a(A.id);return}if(d.key==="e"||d.key==="E"){d.preventDefault();const b=C.findIndex(R=>R.id===t),P=b<C.length-1?b+1:0,A=C[P];A?.id&&a(A.id);return}if(d.key==="ArrowUp"){d.preventDefault(),s(b=>b>0?b-1:N.length-1);return}if(d.key==="ArrowDown"){d.preventDefault(),s(b=>b<N.length-1?b+1:0);return}};return window.addEventListener("keydown",l),()=>window.removeEventListener("keydown",l)},[t,N.length,n]);const J=()=>{switch(t){case"djinn":return e("div",{class:"compendium-grid",children:v.map((l,d)=>e("div",{class:c===d?"selected":"",children:e(ke,{djinn:l,isOwned:f.has(l.id)})},l.id))});case"units":return e("div",{class:"compendium-grid",children:u.map((l,d)=>e("div",{class:c===d?"selected":"",children:e(Ie,{unit:l,isRecruited:E.has(l.id)})},l.id))});case"enemies":return e("div",{class:"compendium-grid",children:S.map((l,d)=>e("div",{class:c===d?"selected":"",children:e(Be,{enemy:l})},l.id))});case"equipment":return e("div",{class:"compendium-grid",children:B.map((l,d)=>e("div",{class:c===d?"selected":"",children:e(De,{equipment:l,isOwned:h.has(l.id)})},l.id))});default:return null}};return e("div",{class:"compendium-screen",children:[e("div",{class:"compendium-header",children:[e("h1",{class:"compendium-title",children:"Compendium"}),e("div",{class:"compendium-tabs",children:C.map(l=>e("button",{class:`compendium-tab ${t===l.id?"active":""}`,onClick:()=>a(l.id),children:[e("span",{class:"compendium-tab-icon",children:l.icon}),e("span",{class:"compendium-tab-label",children:l.label})]},l.id))})]}),e("div",{class:"compendium-content",children:J()}),e("div",{class:"compendium-footer",children:[e("div",{class:"compendium-help",children:[e("span",{children:"Q/E: Switch Tabs"}),e("span",{children:"â†‘/â†“: Navigate"}),e("span",{children:"ESC: Return to Menu"})]}),e("div",{class:"compendium-count",children:[N.length," ",t==="djinn"?"Djinn":t==="units"?"Units":t==="enemies"?"Enemies":"Items"]})]})]})}const Me=({onClose:n})=>{const{gold:t,equipment:a}=w(i=>({gold:i.gold,equipment:i.equipment})),[c,s]=y(null),r=a.find(i=>i.id===c);return e("div",{class:"modal-overlay",onClick:n,children:e("div",{class:"modal modal--inventory",onClick:i=>i.stopPropagation(),children:[e("div",{class:"modal-header",children:[e("h2",{children:"Inventory"}),e("button",{class:"close-btn",onClick:n,"aria-label":"Close inventory",children:"Ã—"})]}),e("div",{class:"modal-content",children:[e("div",{class:"inventory-stats",children:[e("div",{class:"stat-item",children:[e("span",{class:"stat-label",children:"Gold:"}),e("span",{class:"stat-value",children:t.toLocaleString()})]}),e("div",{class:"stat-item",children:[e("span",{class:"stat-label",children:"Equipment:"}),e("span",{class:"stat-value",children:[a.length," items"]})]})]}),e("div",{class:"inventory-content",children:[e("div",{class:"equipment-list",children:a.length===0?e("div",{class:"empty-message",children:"No equipment in inventory"}):a.map(i=>{const m=c===i.id;return e("div",{class:`equipment-item ${m?"selected":""}`,onClick:()=>s(i.id),children:[e("div",{class:"item-icon",children:i.slot==="weapon"?"âš”ï¸":"ðŸ›¡ï¸"}),e("div",{class:"item-info",children:[e("div",{class:"item-name",children:i.name}),e("div",{class:"item-type",children:i.slot})]}),e("div",{class:"item-stats",children:[(i.statBonus.atk??0)>0&&e("span",{class:"stat-bonus",children:["ATK +",i.statBonus.atk]}),(i.statBonus.def??0)>0&&e("span",{class:"stat-bonus",children:["DEF +",i.statBonus.def]}),(i.statBonus.mag??0)>0&&e("span",{class:"stat-bonus",children:["MAG +",i.statBonus.mag]}),(i.statBonus.spd??0)>0&&e("span",{class:"stat-bonus",children:["SPD +",i.statBonus.spd]})]})]},i.id)})}),r&&e("div",{class:"item-details",children:[e("h3",{children:r.name}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"Type:"}),e("span",{class:"detail-value",children:r.slot})]}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"Bonuses:"}),e("div",{class:"detail-bonuses",children:[(r.statBonus.atk??0)>0&&e("div",{children:["Attack: +",r.statBonus.atk]}),(r.statBonus.def??0)>0&&e("div",{children:["Defense: +",r.statBonus.def]}),(r.statBonus.mag??0)>0&&e("div",{children:["Magic: +",r.statBonus.mag]}),(r.statBonus.spd??0)>0&&e("div",{children:["Speed: +",r.statBonus.spd]}),(r.statBonus.hp??0)>0&&e("div",{children:["HP: +",r.statBonus.hp]})]})]})]})]}),e("div",{class:"inventory-footer",children:e("button",{class:"btn btn-secondary",onClick:n,children:"Close"})})]})]})})},xe=({onClose:n})=>{const[t,a]=y(70),[c,s]=y(80),[r,i]=y("normal"),[m,f]=y(!0),[E,h]=y(!0);return e("div",{class:"modal-overlay",onClick:n,children:e("div",{class:"modal modal--settings",onClick:v=>v.stopPropagation(),children:[e("div",{class:"modal-header",children:[e("h2",{children:"Settings"}),e("button",{class:"close-btn",onClick:n,"aria-label":"Close settings",children:"Ã—"})]}),e("div",{class:"modal-content",children:[e("section",{class:"settings-section",children:[e("h3",{children:"Audio"}),e("div",{class:"setting-item",children:[e("label",{class:"setting-label",for:"music-volume",children:["Music Volume: ",t,"%"]}),e("input",{id:"music-volume",type:"range",min:"0",max:"100",value:t,onInput:v=>a(parseInt(v.target.value)),class:"setting-slider"})]}),e("div",{class:"setting-item",children:[e("label",{class:"setting-label",for:"sfx-volume",children:["Sound Effects: ",c,"%"]}),e("input",{id:"sfx-volume",type:"range",min:"0",max:"100",value:c,onInput:v=>s(parseInt(v.target.value)),class:"setting-slider"})]})]}),e("section",{class:"settings-section",children:[e("h3",{children:"Gameplay"}),e("div",{class:"setting-item",children:[e("label",{class:"setting-label",children:"Battle Speed"}),e("div",{class:"setting-buttons",children:[e("button",{class:`setting-btn ${r==="slow"?"active":""}`,onClick:()=>i("slow"),children:"Slow"}),e("button",{class:`setting-btn ${r==="normal"?"active":""}`,onClick:()=>i("normal"),children:"Normal"}),e("button",{class:`setting-btn ${r==="fast"?"active":""}`,onClick:()=>i("fast"),children:"Fast"})]})]}),e("div",{class:"setting-item",children:e("label",{class:"setting-checkbox",children:[e("input",{type:"checkbox",checked:m,onChange:v=>f(v.target.checked)}),e("span",{children:"Show Damage Numbers"})]})}),e("div",{class:"setting-item",children:e("label",{class:"setting-checkbox",children:[e("input",{type:"checkbox",checked:E,onChange:v=>h(v.target.checked)}),e("span",{children:"Auto-Save After Battles"})]})})]}),e("section",{class:"settings-section",children:[e("h3",{children:"Display"}),e("div",{class:"setting-info",children:["Resolution: ",window.innerWidth," Ã— ",window.innerHeight]})]}),e("div",{class:"settings-footer",children:e("button",{class:"btn btn-primary",onClick:n,children:"Apply & Close"})})]})]})})},Oe=({onClose:n})=>e("div",{class:"modal-overlay",onClick:n,children:e("div",{class:"modal modal--help",onClick:t=>t.stopPropagation(),children:[e("div",{class:"modal-header",children:[e("h2",{children:"How to Play"}),e("button",{class:"close-btn",onClick:n,"aria-label":"Close help",children:"Ã—"})]}),e("div",{class:"modal-content",children:[e("section",{class:"help-section",children:[e("h3",{children:"Game Overview"}),e("p",{children:"Vale Village is a Golden Sun-inspired RPG where you build a team of heroes, collect Djinn, and battle through challenging encounters."})]}),e("section",{class:"help-section",children:[e("h3",{children:"Battle System"}),e("ul",{children:[e("li",{children:[e("strong",{children:"Turn-Based Combat:"})," Select actions for each unit in turn order"]}),e("li",{children:[e("strong",{children:"Abilities:"})," Each unit has unique abilities that cost mana"]}),e("li",{children:[e("strong",{children:"Djinn:"})," Summon Djinn to provide team-wide stat bonuses"]}),e("li",{children:[e("strong",{children:"Elements:"})," Venus, Mars, Mercury, and Jupiter - each with strengths"]})]})]}),e("section",{class:"help-section",children:[e("h3",{children:"Team Management"}),e("ul",{children:[e("li",{children:[e("strong",{children:"Roster:"})," Recruit units and view their stats in the Unit Compendium"]}),e("li",{children:[e("strong",{children:"Formation:"})," Select your battle formation before each encounter"]}),e("li",{children:[e("strong",{children:"Equipment:"})," Equip items to boost unit stats"]})]})]}),e("section",{class:"help-section",children:[e("h3",{children:"Djinn System"}),e("ul",{children:[e("li",{children:[e("strong",{children:"Collecting:"})," Find Djinn throughout your journey"]}),e("li",{children:[e("strong",{children:"States:"})," Set (passive bonuses) or Standby (ready to summon)"]}),e("li",{children:[e("strong",{children:"Summoning:"})," Use Djinn in battle for powerful effects"]}),e("li",{children:[e("strong",{children:"Team Slots:"})," Equip up to 3 Djinn for global team bonuses"]})]})]}),e("section",{class:"help-section",children:[e("h3",{children:"Keyboard Controls"}),e("ul",{children:[e("li",{children:[e("strong",{children:"Arrow Keys:"})," Navigate menus and select targets"]}),e("li",{children:[e("strong",{children:"Enter/Space:"})," Confirm selection"]}),e("li",{children:[e("strong",{children:"Escape:"})," Cancel or open pause menu"]}),e("li",{children:[e("strong",{children:"1-9:"})," Quick select abilities in battle"]})]})]}),e("section",{class:"help-section",children:[e("h3",{children:"Pause Menu Shortcuts"}),e("ul",{children:[e("li",{children:[e("strong",{children:"T:"})," Team Management"]}),e("li",{children:[e("strong",{children:"I:"})," Inventory"]}),e("li",{children:[e("strong",{children:"D:"})," Djinn Collection"]}),e("li",{children:[e("strong",{children:"S:"})," Save Game"]}),e("li",{children:[e("strong",{children:"O:"})," Settings"]}),e("li",{children:[e("strong",{children:"H:"})," How to Play"]}),e("li",{children:[e("strong",{children:"Q:"})," Return to Title"]})]})]}),e("div",{class:"help-footer",children:e("button",{class:"btn btn-primary",onClick:n,children:"Got It!"})})]})]})}),Ne=()=>{const{pendingBattleEncounterId:n,confirmBattleTeam:t,returnToOverworld:a}=w(i=>({pendingBattleEncounterId:i.pendingBattleEncounterId,confirmBattleTeam:i.confirmBattleTeam,returnToOverworld:i.returnToOverworld})),c=I(i=>i.startTransition),s=()=>{t(),c("battle")},r=()=>{a(),c("menu")};return n?e(ve,{encounterId:n,onConfirm:s,onCancel:r}):e("div",{style:{color:"#fff",textAlign:"center",padding:"2rem"},children:"No battle pending..."})},Pe=()=>{const{lastBattleRewards:n,team:t,claimRewards:a,selectEquipmentChoice:c,returnToOverworld:s,setBattle:r,towerStatus:i,setMode:m}=w(h=>({lastBattleRewards:h.lastBattleRewards,team:h.team,claimRewards:h.claimRewards,selectEquipmentChoice:h.selectEquipmentChoice,returnToOverworld:h.returnToOverworld,setBattle:h.setBattle,towerStatus:h.towerStatus,setMode:h.setMode})),f=I(h=>h.startTransition),E=()=>{a(),r(null,0),ge.setState({lastBattleEncounterId:null}),i==="in-run"||i==="completed"?(m("tower"),f("tower")):(s(),f("overworld"))};return!n||!t?e("div",{style:{color:"#fff",textAlign:"center",padding:"2rem"},children:"No rewards available..."}):e(pe,{rewards:n,team:t,onContinue:E,onSelectEquipment:c})},Re=()=>{const{currentShopId:n,returnToOverworld:t}=w(s=>({currentShopId:s.currentShopId,returnToOverworld:s.returnToOverworld})),a=I(s=>s.startTransition),c=()=>{t(),a("overworld")};return n?e(ue,{shopId:n,onClose:c}):e("div",{style:{color:"#fff",textAlign:"center",padding:"2rem"},children:"No shop available..."})};function Le(){const n=w(i=>i.mode),t=w(i=>i.towerStatus),a=w(i=>i.showCredits),c=w(i=>i.setShowCredits),s=I(i=>i.setScreen),r=I(i=>i.startTransition);O(()=>{n==="tower"&&(t==="in-run"||t==="completed"||t==="idle")&&s("tower")},[n,t,s]),O(()=>{a&&(r("credits"),c(!1))},[a,r,c])}const je=({screen:n,modal:t})=>e("div",{className:"dev-overlay",children:e("div",{className:"dev-overlay__panel",children:[e("div",{className:"dev-overlay__header",children:"Dev Mode"}),e("div",{className:"dev-overlay__row",children:[e("span",{children:["Screen: ",n]}),e("span",{children:["Modal: ",t??"none"]})]}),e("div",{className:"dev-overlay__row",children:[e("span",{children:"F1"}),e("span",{children:"Toggle dev overlay"})]}),e("div",{className:"dev-overlay__row",children:[e("span",{children:"1 / 2 / 3 / 4"}),e("span",{children:"title / overworld / battle / menu"})]}),e("div",{className:"dev-overlay__row",children:[e("span",{children:"I / O / P / D"}),e("span",{children:"inventory / settings / pause / dialogue modal"})]}),e("div",{className:"dev-overlay__row",children:[e("span",{children:"Esc"}),e("span",{children:"Close active modal"})]})]})}),qe=()=>{Le();const{screen:n,modal:t,isTransitioning:a,setScreen:c,startTransition:s,openModal:r,closeModal:i}=I(u=>({screen:u.flow.screen,modal:u.flow.modal,isTransitioning:u.flow.isTransitioning,setScreen:u.setScreen,startTransition:u.startTransition,openModal:u.openModal,closeModal:u.closeModal}),X),m=u=>{u===null?i():r(u)},[f,E]=y(!1);O(()=>{const u=S=>{if(S.key==="F1"){S.preventDefault(),E(B=>!B);return}if(S.code==="KeyI"&&!f){["overworld","menu","team-management","djinn-collection"].includes(n)&&(S.preventDefault(),m("inventory"));return}if(f)switch(S.code){case"Digit1":s("title");break;case"Digit2":s("overworld");break;case"Digit3":s("battle");break;case"Digit4":s("menu");break;case"KeyI":m("inventory");break;case"KeyO":m("settings");break;case"KeyP":m("pause");break;case"KeyD":m("dialogue");break;case"Escape":m(null);break}};return window.addEventListener("keydown",u),()=>window.removeEventListener("keydown",u)},[f,n,c,m]);const h=()=>{switch(n){case"title":return e(F,{});case"overworld":return e(oe,{});case"battle":return e(ce,{});case"menu":return e(le,{});case"compendium":return e(Ae,{});case"team-select":return e(Ne,{});case"rewards":return e(Pe,{});case"shop":return e(Re,{});case"team-management":return e(ae,{onClose:()=>s("overworld")});case"djinn-collection":return e(re,{onClose:()=>s("overworld")});case"tower":return e(se,{});case"credits":return e(ie,{onExit:()=>s("epilogue")});case"epilogue":return e(te,{onComplete:()=>s("title")});default:return e(F,{})}},v=()=>{if(!t)return null;switch(t){case"inventory":return e(Me,{onClose:i});case"settings":return e(xe,{onClose:i});case"dialogue":return e(he,{});case"save":return e(me,{onClose:i});case"help":return e(Oe,{onClose:i});case"pause":return e(de,{onClose:i,onTeamManagement:()=>{i(),s("team-management")},onInventory:()=>{i(),r("inventory")},onDjinnCollection:()=>{i(),s("djinn-collection")},onSaveGame:()=>{i(),r("save")},onSettings:()=>{i(),r("settings")},onHowToPlay:()=>{i(),r("help")},onReturnToTitle:()=>{i(),s("title")}});default:return null}};return e("div",{className:`app-root${a?" app-root--transitioning":""}`,children:[h(),v(),f&&e(je,{screen:n,modal:t})]})},Ge=K("type",[p({type:T("damage"),description:o(),damage:g().int().min(0)}),p({type:T("heal"),description:o(),healAmount:g().int().min(0)}),p({type:T("buff"),description:o(),statBonus:p({atk:g().optional(),def:g().optional(),mag:g().optional(),spd:g().optional()})}),p({type:T("special"),description:o()})]),Ue=p({same:k(o()).min(0).max(4),counter:k(o()).min(0).max(4),neutral:k(o()).min(0).max(4)}),_e=p({id:o().min(1),name:o().min(1),element:Q,tier:H(["1","2","3"]),description:o().optional(),summonEffect:Ge,grantedAbilities:Y(o().min(1),Ue),availableIn:be.optional().readonly()}),$e=p({equipment:W,chance:g().min(0).max(1)}),Fe=p({id:o().min(1),name:o().min(1),level:g().int().min(1).max(20),stats:ye,abilities:k(we).min(1),element:Q,baseXp:g().int().min(0),baseGold:g().int().min(0),drops:k($e).optional()}),Ve=p({phaseChange:p({hpPct:g().min(0).max(1),addAbility:o().min(1)}).optional()}),Ke=n=>new Set(n).size===n.length,He=K("type",[p({type:T("none")}),p({type:T("fixed"),itemId:o().min(1)}),p({type:T("choice"),options:k(o().min(1)).length(3).refine(Ke,{message:"Choice options must be unique"})})]),ze=p({xp:g().int().min(0),gold:g().int().min(0),equipment:He,djinn:o().min(1).optional(),unlockUnit:o().min(1).optional(),unlockAbility:o().min(1).optional()}),Qe=p({id:o().min(1),name:o().min(1),enemies:k(o().min(1)).min(1),difficulty:H(["easy","medium","hard","boss"]).optional(),rules:Ve.optional(),reward:ze});function M(n,t,a){const c=[];for(const[s,r]of Object.entries(n)){const i=t.safeParse(r);i.success||c.push({category:a,id:s,errors:i.error.errors.map(m=>`${m.path.join(".")}: ${m.message}`)})}return c}function We(){const n=[],t=[];return n.push(...M(L,_e,"Djinn")),n.push(...M(j,Se,"Units")),n.push(...M(z,W,"Equipment")),n.push(...M(q,Fe,"Enemies")),n.push(...M(V,Qe,"Encounters")),Object.keys(L).length===0&&t.push("No Djinn defined"),Object.keys(j).length===0&&t.push("No Units defined"),Object.keys(q).length===0&&t.push("No Enemies defined"),Object.keys(V).length===0&&t.push("No Encounters defined"),{valid:n.length===0,errors:n,warnings:t}}function Je(n){if(n.valid&&n.warnings.length===0)return"All game data validated successfully.";const t=[];if(!n.valid){t.push("DATA VALIDATION FAILED:"),t.push("");for(const a of n.errors){t.push(`[${a.category}] ${a.id}:`);for(const c of a.errors)t.push(`  - ${c}`)}}if(n.warnings.length>0){t.length>0&&t.push(""),t.push("Warnings:");for(const a of n.warnings)t.push(`  - ${a}`)}return t.join(`
`)}const G=document.getElementById("root");if(!G)throw new Error('Root element not found. Expected element with id="root" in index.html.');const x=We();if(x.valid)x.warnings.length>0&&console.warn("Game data warnings:",x.warnings),$(e(fe,{children:e(qe,{})}),G);else{const n=Je(x);console.error("Game data validation failed:",n),$(e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"2rem",backgroundColor:"#1a1a2e",color:"#fff",fontFamily:"system-ui, sans-serif"},children:[e("h1",{style:{fontSize:"2rem",marginBottom:"1rem",color:"#ff6b6b"},children:"Game Data Error"}),e("p",{style:{fontSize:"1.2rem",marginBottom:"2rem",textAlign:"center",maxWidth:"600px"},children:"Unable to start the game due to corrupted or invalid data. Please try refreshing the page or clearing your browser cache."}),e("details",{style:{marginBottom:"2rem",padding:"1rem",backgroundColor:"#2a2a3e",borderRadius:"4px",maxWidth:"800px",width:"100%"},children:[e("summary",{style:{cursor:"pointer",marginBottom:"0.5rem"},children:["Technical Details (",x.errors.length," errors)"]}),e("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"0.85rem",color:"#ff6b6b",marginTop:"1rem"},children:n})]}),e("button",{onClick:()=>window.location.reload(),style:{padding:"0.75rem 1.5rem",fontSize:"1rem",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Reload Game"})]}),G)}
//# sourceMappingURL=index-jODYUFAj.js.map
