import{c as ga,i as $a,y as P,f as e,g as F,k as ie,T as U,q as fe,A as re,o as St,a as pa,s as kt,n as Ua,$ as Oa,x as za}from"./vendor-DevG9r99.js";import{U as Ne,T as Se,c as Te,e as _t,a as oe,E as Le,f as Ha,h as be,M as Ke,i as Ya,D as It,A as ua,V as Ja,j as Va,k as Gt,d as Lt,l as da,g as ya}from"./data-definitions-BS67O2Yi.js";import{m as ne,p as pt,a as Ka,c as Wt,g as Ae,e as Ye,s as Qa,b as ke,R as _e,d as Xa,f as Nt,h as ge,i as qt,j as Za,q as er,k as tr,l as ar,n as he,o as ve,r as Je,D as Tt,t as rr,v as sr,w as nr,x as ir,y as Dt,z as We,A as Qe,B as Ct,C as or,E as lr,F as cr,G as gr,H as pr,I as ur,J as dr,K as yr,L as mr,M as hr,N as br,O as fr,P as $t,Q as vr,S as wr,T as Sr,U as kr,V as _r,W as Xe,X as Ze,Y as Ir,Z as Tr,_ as ma,$ as xr,a0 as Dr,a1 as Cr,a2 as Er,a3 as Ut,a4 as Mr,a5 as Br,a6 as Ar,a7 as Fr,a8 as Rr,a9 as ut,aa as Ot,ab as et,ac as ha,ad as ba,ae as fa,af as jr,ag as Pr,ah as Gr,ai as Lr,aj as Wr}from"./core-services-D8JEer3v.js";const Nr=32,zt={screen:"title",modal:null,isTransitioning:!1},qr={team:[],inventory:{items:[],capacity:Nr},currency:0,storyFlags:new Set,saves:[]},$r=(t,r)=>({flow:zt,setScreen:a=>t(s=>{s.flow.screen=a}),startTransition:a=>{t(s=>{s.flow.isTransitioning=!0}),setTimeout(()=>{t(s=>{s.flow.screen=a}),setTimeout(()=>{t(s=>{s.flow.isTransitioning=!1})},150)},150)},openModal:a=>t(s=>{s.flow.modal=a}),closeModal:()=>t(a=>{a.flow.modal=null}),setTransitioning:a=>t(s=>{s.flow.isTransitioning=a}),resetFlow:()=>t(a=>{a.flow={...zt}})}),Ur=(t,r)=>({battleSession:null,startBattle:({enemyId:a,rngSeed:s})=>t(n=>{const i=s??Date.now();n.battleSession={battle:{enemyId:a,phase:"playerTurn"},rngSeed:i,turnNumber:1,eventQueue:[],rewards:null},n.flow.screen="battle",n.flow.modal=null}),endBattle:()=>t(a=>{a.battleSession=null,a.flow.screen==="battle"&&(a.flow.screen="overworld")}),queueBattleEvent:a=>t(s=>{s.battleSession&&s.battleSession.eventQueue.push(a)}),advanceTurn:()=>t(a=>{a.battleSession&&(a.battleSession.turnNumber+=1)}),setBattlePhase:a=>t(s=>{s.battleSession&&(s.battleSession.battle.phase=a)}),clearBattleEvents:()=>t(a=>{a.battleSession&&(a.battleSession.eventQueue=[])})}),Or=(t,r)=>({playerData:qr,setTeam:a=>t(s=>{s.playerData.team=a}),addTeamMember:a=>t(s=>{s.playerData.team.push(a)}),updateTeamMember:(a,s)=>t(n=>{const i=n.playerData.team.findIndex(g=>g.id===a);if(i===-1)return;const o=n.playerData.team[i];o&&(n.playerData.team[i]=s(o))}),removeTeamMember:a=>t(s=>{s.playerData.team=s.playerData.team.filter(n=>n.id!==a)})}),zr=(t,r)=>({setInventory:a=>t(s=>{s.playerData.inventory=a}),addItem:a=>t(s=>{const n=s.playerData.inventory.items.find(i=>i.id===a.id);n?n.quantity+=a.quantity:s.playerData.inventory.items.push({...a})}),removeItem:(a,s)=>t(n=>{const i=n.playerData.inventory.items,o=i.findIndex(p=>p.id===a);if(o===-1)return;const g=i[o];g&&(s===void 0||s>=g.quantity?i.splice(o,1):s>0&&(g.quantity-=s))}),clearInventory:()=>t(a=>{a.playerData.inventory.items=[]})}),se=ga()($a((t,r)=>({...$r(t),...Ur(t),...Or(t),...zr(t)}))),Hr=[{name:"Isaac",sprite:"/sprites/overworld/protagonists/Isaac_Walk.gif",delay:0},{name:"Garet",sprite:"/sprites/overworld/protagonists/Garet_Right.gif",delay:.8},{name:"Ivan",sprite:"/sprites/overworld/protagonists/Ivan_Right.gif",delay:1.6},{name:"Mia",sprite:"/sprites/overworld/protagonists/Mia_Right.gif",delay:2.4}];function ri(){const t=se(r=>r.startTransition);return P(()=>{const r=s=>{s.preventDefault(),s.stopPropagation(),t("menu")},a=()=>{t("menu")};return window.addEventListener("keydown",r),window.addEventListener("click",a),()=>{window.removeEventListener("keydown",r),window.removeEventListener("click",a)}},[t]),e("div",{class:"title-screen",onClick:()=>t("menu"),children:[e("div",{class:"title-screen-content",children:[e("h1",{class:"title-screen-logo",children:"Vale Chronicles"}),e("p",{class:"title-screen-subtitle",children:"Press any key to continue"})]}),e("div",{class:"title-screen-parade",children:Hr.map(r=>e("div",{class:"title-screen-character",style:{animationDelay:`${r.delay}s`},children:e("img",{src:r.sprite,alt:r.name,class:"title-screen-sprite"})},r.name))})]})}const Yr=(t,r)=>({battle:null,events:[],rngSeed:1337,turnNumber:0,setBattle:(a,s)=>t({battle:a,rngSeed:s,turnNumber:0,events:[]}),startTurnTick:()=>{const{battle:a,rngSeed:s,turnNumber:n,events:i}=r();if(!a)return;const o=ne(ke(s,n,_e.STATUS_EFFECTS)),g=Qa(a,o);t({battle:g.updatedState,events:[...i,...g.events]})},perform:(a,s,n)=>{const{battle:i,rngSeed:o,turnNumber:g,events:p}=r();if(!i)return;const c=ne(ke(o,g,_e.ACTIONS)),l=pt(i,a,s,n,c);if(!l.ok){console.error("performAction failed:",l.error);return}const u=Wt(l.value.state),f=[...l.value.events];if(u){if(f.push({type:"battle-end",result:u}),u==="PLAYER_VICTORY"){const{processVictory:k}=r();k(l.value.state)}const _=Ae(i);_&&f.push({type:"encounter-finished",outcome:u,encounterId:_}),t({battle:l.value.state,events:[...p,...f]})}else{const _=ne(ke(o,g,_e.END_TURN)),k=Ye(l.value.state,_);if(!k.ok){console.error("endTurn failed:",k.error);return}t({battle:k.value,events:[...p,...f],turnNumber:g+1})}},endTurn:()=>{const{battle:a,rngSeed:s,turnNumber:n}=r();if(!a)return;const i=ne(ke(s,n,_e.END_TURN)),o=Ye(a,i);if(!o.ok){console.error("endTurn failed:",o.error);return}t({battle:o.value,turnNumber:n+1})},performAIAction:()=>{const{battle:a,rngSeed:s,turnNumber:n,events:i}=r();if(!a)return;const o=[...a.playerTeam.units,...a.enemies],g=a.turnOrder[a.currentActorIndex];if(!o.find(u=>u.id===g)||!g||a.playerTeam.units.some(u=>u.id===g))return;const l=ne(ke(s,n,_e.ACTIONS));try{const u=Ka(a,g,l),f=pt(a,g,u.abilityId,u.targetIds,l);if(!f.ok){console.error("AI performAction failed:",f.error);return}const _=Wt(f.value.state),k=[...f.value.events];if(_){if(k.push({type:"battle-end",result:_}),_==="PLAYER_VICTORY"){const{processVictory:I}=r();I(f.value.state)}const w=Ae(a);if(w&&k.push({type:"encounter-finished",outcome:_,encounterId:w}),t({battle:f.value.state,events:[...i,...k]}),w){const{onBattleEvents:I}=r();I&&I(k)}}else{const w=ne(s+n*1e6),I=Ye(f.value.state,w);if(!I.ok){console.error("AI endTurn failed:",I.error);return}t({battle:I.value,events:[...i,...k],turnNumber:n+1})}}catch(u){console.error("AI decision failed:",u);const f=ne(ke(s,n,_e.END_TURN)),_=Ye(a,f);_.ok&&t({battle:_.value,turnNumber:n+1})}},dequeueEvent:()=>{t(a=>a.events.length===0?a:{events:a.events.slice(1)})},preview:(a,s,n)=>{const{battle:i,rngSeed:o,turnNumber:g}=r();if(!i)return{avg:0,min:0,max:0};const p=o^g<<8^s.length<<16^a.length<<24,c=ne(p),l=16;let u=0,f=Number.POSITIVE_INFINITY,_=0;for(let k=0;k<l;k++){const w=c.clone(),I=pt(i,a,s,n,w);if(!I.ok)continue;const h=I.value.events.filter(m=>m.type==="hit").reduce((m,T)=>m+T.amount,0);u+=h,f=Math.min(f,h),_=Math.max(_,h)}return{avg:Math.round(u/l),min:f,max:_}}}),dt=new Map;function yt(t){let r=0,a=0;return t.queuedActions.forEach((s,n)=>{if(!s||s.abilityId!==null)return;const i=t.playerTeam.units[n];if(!i||he(i))return;(i.autoAttackTiming??"same-turn")==="next-turn"?a+=1:r+=1}),{pendingThisRound:r,pendingManaNextRound:a}}function Jr(t,r){return t.reduce((a,s)=>a+(s.battleStats?.[r]??0),0)}const Vr=(t,r)=>({battle:null,events:[],rngSeed:1337,activePortraitIndex:null,isActionMenuOpen:!0,isSummonScreenOpen:!1,tutorialMessage:null,currentMana:0,maxMana:0,pendingManaThisRound:0,pendingManaNextRound:0,critCounters:{},critThresholds:{},critFlash:{},lastError:null,setBattle:(a,s)=>{const n={},i={},o=a?structuredClone(a):null;o&&o.playerTeam.units.forEach(g=>{n[g.id]=n[g.id]??10,i[g.id]=0}),t({battle:o,rngSeed:s,events:[],activePortraitIndex:null,currentMana:o?.remainingMana??0,maxMana:o?.maxMana??0,pendingManaThisRound:0,pendingManaNextRound:0,critCounters:i,critThresholds:n,critFlash:{},lastError:null})},setActivePortrait:a=>{t({activePortraitIndex:a})},setActionMenuOpen:a=>t({isActionMenuOpen:a}),setSummonScreenOpen:a=>t({isSummonScreenOpen:a}),showTutorialMessage:a=>t({tutorialMessage:a}),updateManaState:(a,s,n)=>{t({currentMana:a,pendingManaThisRound:s,pendingManaNextRound:n})},incrementCritCounter:a=>{t(s=>({critCounters:{...s.critCounters,[a]:(s.critCounters[a]??0)+1}}))},resetCritCounter:a=>{t(s=>({critCounters:{...s.critCounters,[a]:0}}))},triggerCritFlash:a=>{const s=dt.get(a);s&&clearTimeout(s),t(i=>({critFlash:{...i.critFlash,[a]:!0}}));const n=setTimeout(()=>{t(i=>{const{[a]:o,...g}=i.critFlash;return{critFlash:g}}),dt.delete(a)},200);dt.set(a,n)},clearError:()=>t({lastError:null}),queueUnitAction:(a,s,n,i)=>{const{battle:o}=r();if(!o||o.phase!=="planning")return t({lastError:"Cannot queue action: battle not in planning phase."}),!1;const g=o.playerTeam.units[a];if(!g)return t({lastError:`Cannot queue action: invalid unit index ${a}.`}),!1;const p=ar(o,g.id,s,n,i);if(!p.ok)return console.warn(`Failed to queue action: ${p.error}`),t({lastError:`Failed to queue action: ${p.error}`}),!1;const{pendingThisRound:c,pendingManaNextRound:l}=yt(p.value);return t({battle:p.value,currentMana:p.value.remainingMana,maxMana:p.value.maxMana,pendingManaThisRound:c,pendingManaNextRound:l,lastError:null}),!0},clearUnitAction:a=>{const{battle:s}=r();if(!s||s.phase!=="planning"){t({lastError:"Cannot clear action: battle not in planning phase."});return}const n=tr(s,a);if(!n.ok){console.warn(`Failed to clear action: ${n.error}`),t({lastError:`Failed to clear action: ${n.error}`});return}const{pendingThisRound:i,pendingManaNextRound:o}=yt(n.value);t({battle:n.value,currentMana:n.value.remainingMana,maxMana:n.value.maxMana,pendingManaThisRound:i,pendingManaNextRound:o,lastError:null})},queueDjinnActivation:a=>{const{battle:s}=r();if(!s||s.phase!=="planning"){t({lastError:"Cannot queue Djinn: battle not in planning phase."});return}const n=er(s,a);if(!n.ok){console.warn(`Failed to queue Djinn: ${n.error}`),t({lastError:`Failed to queue Djinn: ${n.error}`});return}t({battle:n.value,lastError:null})},unqueueDjinnActivation:a=>{const{battle:s}=r();if(!s||s.phase!=="planning"){t({lastError:"Cannot unqueue Djinn: battle not in planning phase."});return}const n=Za(s,a);if(!n.ok){console.warn(`Failed to unqueue Djinn: ${n.error}`),t({lastError:`Failed to unqueue Djinn: ${n.error}`});return}t({battle:n.value,lastError:null})},executeQueuedRound:()=>{const{battle:a,rngSeed:s}=r();if(!a||a.phase!=="planning"){t({lastError:"Cannot execute round: battle not in planning phase."});return}const n=ne(ke(s,a.roundNumber,_e.QUEUE_ROUND)),i=Xa(a,n);if(i.state===a&&i.events.length===0){t({lastError:"Cannot execute round: queued actions are invalid for execution."});return}const g=[...r().events,...i.events],{pendingThisRound:p,pendingManaNextRound:c}=yt(i.state);t({battle:i.state,events:g,currentMana:i.state.remainingMana,maxMana:i.state.maxMana,pendingManaThisRound:p,pendingManaNextRound:c,lastError:null});const l=Ae(i.state),u=r().activeTowerEncounterId;if(r().towerStatus==="in-run"&&u!==null&&l===u&&(i.state.phase==="victory"||i.state.phase==="defeat")){r().handleTowerBattleCompleted({battle:i.state,events:g});return}if(i.state.playerTeam.djinnTrackers){const{updateTeam:_}=r();_({djinnTrackers:i.state.playerTeam.djinnTrackers})}if(i.state.phase==="victory"){const{onBattleEvents:_,updateTeamUnits:k}=r(),w=Nt(i.state.playerTeam.units),I=ge(i.state.playerTeam,{units:w}),h=qt(i.state,{playerTeam:I}),m={type:"auto-heal",message:"All units restored to full health!"};t({battle:h,events:[...g,m]}),k(w);const T=Jr(h.playerTeam.units,"damageDealt");r().incrementBattleStats({outcome:"win",damageDealt:T,healingDone:0});try{Promise.resolve(r().autoSave()).catch(b=>{console.warn("Auto-save failed after battle victory:",b)})}catch(b){console.warn("Auto-save failed after battle victory:",b)}const v=Ae(h);v&&_&&_([{type:"battle-end",result:"PLAYER_VICTORY"},{type:"encounter-finished",outcome:"PLAYER_VICTORY",encounterId:v}]);return}if(i.state.phase==="defeat"){const{onBattleEvents:_,updateTeamUnits:k}=r(),w=Nt(i.state.playerTeam.units),I=ge(i.state.playerTeam,{units:w}),h=qt(i.state,{playerTeam:I}),m={type:"auto-heal",message:"All units restored to full health!"};t({battle:h,events:[...g,m]}),k(w);const T=Ae(h);T&&_&&_([{type:"battle-end",result:"PLAYER_DEFEAT"},{type:"encounter-finished",outcome:"PLAYER_DEFEAT",encounterId:T}]);return}},dequeueEvent:()=>{t(a=>{if(a.events.length===0)return a;const s={events:a.events.slice(1)};return a.battle&&(s.currentMana=a.battle.remainingMana),s})}}),Kr=(t,r)=>({team:null,roster:[],setTeam:a=>{t(s=>{const n=[...s.roster];return a.units.forEach(i=>{const o=n.findIndex(g=>g.id===i.id);o>=0?n[o]=i:n.length<10&&n.push(i)}),{team:a,roster:n}})},setRoster:a=>t({roster:a}),addUnitToRoster:a=>t(s=>s.roster.some(n=>n.id===a.id)?{roster:s.roster.map(n=>n.id===a.id?a:n)}:s.roster.length>=10?(console.warn("Roster full (10 units max), cannot add unit"),s):{roster:[...s.roster,a]}),getUnitFromRoster:a=>r().roster.find(s=>s.id===a),updateTeam:a=>t(s=>s.team?{team:{...s.team,...a}}:s),updateTeamUnits:a=>t(s=>{if(!s.team)return s;const n=ge(s.team,{units:a}),i=[...s.roster];return a.forEach(o=>{const g=i.findIndex(p=>p.id===o.id);g>=0?i[g]=o:i.length<10&&i.push(o)}),{team:n,roster:i}}),swapPartyMember:(a,s)=>t(n=>{if(!n.team)return n;let i=n.roster.find(l=>l.id===s);if(!i){const l=Ne[s];if(!l)return console.error(`Unit ${s} not found in roster or definitions`),n;const u=n.team.units[a];i=u?ve(l,u.level,u.xp):ve(l,1,0)}const o=[...n.team.units];a>=o.length?o.push(i):o[a]=i;const g=o,p=ge(n.team,{units:g}),c=[...n.roster];return p.units.forEach(l=>{const u=c.findIndex(f=>f.id===l.id);u>=0?c[u]=l:c.length<10&&c.push(l)}),{team:p,roster:c}})});function Qr(t){return t.availableIn&&t.availableIn.length>0?t.availableIn:["campaign"]}function xe(t){return Qr(t).includes("campaign")}const Xr=5e3,Zr="normal",Be=Object.freeze({highestFloorEver:0,totalRuns:0,bestRunTurns:null,bestRunDamageDealt:null}),es=(t,r)=>({towerRun:null,towerStatus:"idle",towerRecord:{...Be},towerEntryContext:null,towerSnapshots:null,activeTowerEncounterId:null,towerRewardsEarned:Ve(),getCurrentTowerFloor:()=>{const a=r().towerRun;return a?Je(a,Se):null},startTowerRun:a=>{if(r().towerStatus==="in-run")return;const s=a?.difficulty??Zr,n=a?.seed??Date.now(),i=ts(r()),{towerTeam:o,towerRoster:g}=rs();r().setTeam(o),r().setRoster(g),r().setGold(Xr);const p=Object.values(Te).filter(xe).map(l=>({...l}));r().setEquipment(p);const c=ir(n,s,Se,{config:Tt});r().towerEntryContext||t({towerEntryContext:{type:"main-menu"}}),t({towerRun:c,towerStatus:"in-run",towerSnapshots:i,activeTowerEncounterId:null,towerRewardsEarned:Ve()}),r().setMode("tower")},beginTowerFloorBattle:()=>{const a=r().towerRun;if(!a||r().towerStatus!=="in-run")return;const s=Je(a,Se);!s||s.type==="rest"||(t({activeTowerEncounterId:s.encounterId}),r().setPendingBattle(s.encounterId))},handleTowerBattleCompleted:({battle:a})=>{const s=r().towerRun;if(!s||!s.floorIds.length)return;const n=a.encounterId||a.meta?.encounterId||null;if(!(r().activeTowerEncounterId&&n===r().activeTowerEncounterId))return;const o=Je(s,Se);if(!o)return;const g=a.status==="PLAYER_DEFEAT"?"defeat":"victory",p={turnsTaken:a.roundNumber,damageDealt:Ht(a.playerTeam.units,"damageDealt"),damageTaken:Ht(a.playerTeam.units,"damageTaken")},c=ss(o.floorNumber),l=sr({run:s,floors:Se,outcome:g,summary:p,rewards:c}),u=nr(l);r().setBattle(null,0),r().updateTeamUnits(a.playerTeam.units),t({activeTowerEncounterId:null,towerRun:u,towerStatus:u.isCompleted?"completed":"in-run"}),ns(c,r(),t),(u.isCompleted||g==="defeat")&&t(f=>({towerRun:{...u,isCompleted:!0,isFailed:g==="defeat"},towerStatus:"completed",towerRecord:Yt(f.towerRecord,u)})),r().setMode("tower")},applyTowerRest:()=>{const a=r().towerRun;if(!a||r().towerStatus!=="in-run")return;const s=Je(a,Se);if(!s||s.type!=="rest")return;const n=a.config??Tt,i=os(r().team,n);i&&(r().updateTeam(i),r().updateTeamUnits(i.units));const o=rr(a,Se,{healedFraction:n.healFractionAtRest,loadoutAdjusted:!0});t({towerRun:o})},quitTowerRun:()=>{const a=r().towerRun;if(!a){r().exitTowerMode();return}t(s=>({towerRun:{...a,isCompleted:!0},towerStatus:"completed",towerRecord:Yt(s.towerRecord,a)}))},enterTowerFromOverworld:({mapId:a,position:s})=>{t({towerEntryContext:{type:"overworld",mapId:a,position:s}}),r().setMode("tower")},openTowerFromMainMenu:()=>{t({towerEntryContext:{type:"main-menu"}}),r().setMode("tower")},exitTowerMode:()=>{const a=r().towerEntryContext,s=r().towerRewardsEarned;as(r()),is(r(),s),t({towerRun:null,towerStatus:"idle",towerEntryContext:null,towerSnapshots:null,activeTowerEncounterId:null,towerRewardsEarned:Ve()}),a?.type==="overworld"?(r().teleportPlayer(a.mapId,a.position),r().setMode("overworld")):r().setMode("main-menu")},setTowerRecord:a=>{t({towerRecord:{highestFloorEver:a.highestFloorEver??0,totalRuns:a.totalRuns??0,bestRunTurns:a.bestRunTurns??null,bestRunDamageDealt:a.bestRunDamageDealt??null}})}});function ts(t){return{team:t.team?ls(t.team):null,roster:t.roster?t.roster.map(r=>va(r)):[],gold:t.gold,equipment:t.equipment.map(r=>({...r}))}}function as(t){const r=t.towerSnapshots;r&&(r.team&&t.setTeam(r.team),t.setRoster(r.roster),t.setGold(r.gold),t.setEquipment(r.equipment))}function rs(){const t=Object.values(Ne).filter(xe).map(i=>We(ve(i,20,0),{storeUnlocked:!0})),r=t.slice(0,4);let a=Qe(r);const s=Object.entries(oe).filter(([,i])=>xe(i)).map(([i])=>i);for(const i of s){const o=Ct(a,i);o.ok&&(a=o.value)}const n=s.slice(0,3);return a=ge(a,{equippedDjinn:n}),{towerTeam:a,towerRoster:t}}function Ve(){return{equipmentIds:[],djinnIds:[],recruitIds:[]}}function ss(t){const r=_t.find(a=>a.floorNumber===t);return r?r.rewards:[]}function Ht(t,r){return t.reduce((a,s)=>a+(s.battleStats?.[r]??0),0)}function ns(t,r,a){if(t.length===0)return;const s=r.towerRewardsEarned??Ve(),n={equipmentIds:[...s.equipmentIds],djinnIds:[...s.djinnIds],recruitIds:[...s.recruitIds]};let i=!1;for(const o of t)switch(o.type){case"equipment":{const g=o.ids.map(p=>Te[p]).filter(p=>!!p);g.length>0&&(r.addEquipment(g),n.equipmentIds.push(...g.map(p=>p.id)),i=!0);break}case"djinn":{for(const g of o.ids){if(!r.team)continue;const p=wa(r.team,g);r.setTeam(p),n.djinnIds.push(g),i=!0}break}case"recruit":{for(const g of o.ids){const p=Ne[g];if(!p||r.roster.find(u=>u.id===g))continue;const l=ve(p,20,0);Sa(r,l),n.recruitIds.push(g),i=!0}break}}i&&a({towerRewardsEarned:n})}function is(t,r){if(r){if(r.equipmentIds.length){const a=r.equipmentIds.map(s=>Te[s]).filter(s=>!!s).map(s=>({...s}));a.length>0&&t.addEquipment(a)}if(t.team&&r.djinnIds.length){let a=t.team;for(const s of r.djinnIds)a=wa(a,s);t.setTeam(a)}if(r.recruitIds.length){const a=new Set(t.roster?.map(s=>s.id)??[]);for(const s of r.recruitIds){if(a.has(s))continue;const n=Ne[s];if(!n)continue;const i=ve(n,20,0);Sa(t,i),a.add(s)}}}}function os(t,r){if(!t)return null;const a=r.healFractionAtRest,s=t.units.map(i=>{const o=Dt(i,t),g=Math.floor(o.hp*a),p=Math.min(o.hp,i.currentHp+g);return We(i,{currentHp:p})}),n=Object.fromEntries(Object.entries(t.djinnTrackers).map(([i,o])=>[i,{...o,state:"Set"}]));return ge(t,{units:s,djinnTrackers:n})}function Yt(t,r){const a=Math.max(t.highestFloorEver,r.stats.highestFloor),s=t.totalRuns+1,n=r.stats.turnsTaken,i=r.stats.totalDamageDealt,o=n>0?t.bestRunTurns===null?n:Math.min(t.bestRunTurns,n):t.bestRunTurns,g=t.bestRunDamageDealt===null?i:Math.max(t.bestRunDamageDealt,i);return{highestFloorEver:a,totalRuns:s,bestRunTurns:o,bestRunDamageDealt:g}}function ls(t){return{...t,equippedDjinn:[...t.equippedDjinn],djinnTrackers:Object.fromEntries(Object.entries(t.djinnTrackers).map(([r,a])=>[r,{...a}])),units:t.units.map(r=>va(r)),collectedDjinn:[...t.collectedDjinn],activationsThisTurn:{...t.activationsThisTurn},djinnStates:{...t.djinnStates}}}function va(t){return{...t,equipment:{weapon:t.equipment.weapon?{...t.equipment.weapon}:null,armor:t.equipment.armor?{...t.equipment.armor}:null,helm:t.equipment.helm?{...t.equipment.helm}:null,boots:t.equipment.boots?{...t.equipment.boots}:null,accessory:t.equipment.accessory?{...t.equipment.accessory}:null},djinn:[...t.djinn],djinnStates:{...t.djinnStates},abilities:t.abilities.map(r=>({...r})),unlockedAbilityIds:[...t.unlockedAbilityIds],statusEffects:[...t.statusEffects],battleStats:{...t.battleStats}}}function wa(t,r){const a=Ct(t,r);return a.ok?a.value:a.error.includes("Cannot collect more than 12 Djinn")&&!t.collectedDjinn.includes(r)?ge(t,{collectedDjinn:[...t.collectedDjinn,r]}):t}function Sa(t,r){const a=t.roster??[];t.setRoster([...a,r])}function Jt(t,r,a,s,n,i,o,g,p){if(!t||!t.units||t.units.length===0)return null;const l=t.units.map(h=>h.id),u=t?.collectedDjinn?[...t.collectedDjinn]:[],f=t?.equippedDjinn?[...t.equippedDjinn]:[],_=t?.djinnTrackers?{...t.djinnTrackers}:{},k={};Object.entries(s.flags).forEach(([h,m])=>{k[h]=!!m});const w=n?.playerPosition??{x:0,y:0},I=n?.currentMapId??"vale-village";return{version:"1.0.0",timestamp:Date.now(),chapter:s.chapter,playerData:{unitsCollected:r.map(h=>{const m=h.baseStats.hp+(h.level-1)*h.growthRates.hp;return{...h,currentHp:Math.min(h.currentHp,m),djinn:[...h.djinn],abilities:[...h.abilities],unlockedAbilityIds:[...h.unlockedAbilityIds],statusEffects:[...h.statusEffects]}}),activeParty:l,inventory:a.equipment,gold:a.gold,djinnCollected:u,equippedDjinn:f,djinnTrackers:_,recruitmentFlags:{...o},storyFlags:k},overworldState:{playerPosition:w,currentScene:I,npcStates:{...g}},stats:{battlesWon:p.battlesWon,battlesLost:p.battlesLost,totalDamageDealt:p.totalDamageDealt,totalHealingDone:p.totalHealingDone,playtime:p.playtime},towerStats:i??Be}}function Vt(t){const r=t.story,a=r?.flags??t.playerData.storyFlags??{};return{chapter:t.chapter??r?.chapter??1,flags:{...a}}}const cs=(t,r)=>({recruitmentFlags:{},npcStates:{},statsTracker:{battlesWon:0,battlesLost:0,totalDamageDealt:0,totalHealingDone:0,playtime:0},hasSave:()=>cr(),loadGame:()=>{const a=mr();if(!a.ok){console.error("Failed to load game:",a.error);return}const s=a.value,n=r();n.setRoster(s.playerData.unitsCollected);const i=s.playerData.activeParty.map(g=>s.playerData.unitsCollected.find(p=>p.id===g)).filter(g=>g!==void 0);if(i.length>0){const g={units:i,equippedDjinn:s.playerData.equippedDjinn||[],djinnTrackers:s.playerData.djinnTrackers||{},collectedDjinn:s.playerData.djinnCollected,currentTurn:0,activationsThisTurn:{},djinnStates:{}};n.setTeam(g)}n.setEquipment(s.playerData.inventory??[]),n.setGold(s.playerData.gold??0),n.setStoryState(Vt(s)),n.teleportPlayer(s.overworldState.currentScene,s.overworldState.playerPosition),n.setTowerRecord(s.towerStats??Be),t({recruitmentFlags:s.playerData.recruitmentFlags??{},npcStates:s.overworldState.npcStates??{},statsTracker:{battlesWon:s.stats.battlesWon??0,battlesLost:s.stats.battlesLost??0,totalDamageDealt:s.stats.totalDamageDealt??0,totalHealingDone:s.stats.totalHealingDone??0,playtime:s.stats.playtime??0}}),t({recruitmentFlags:s.playerData.recruitmentFlags??{},npcStates:s.overworldState.npcStates??{},statsTracker:{battlesWon:s.stats.battlesWon??0,battlesLost:s.stats.battlesLost??0,totalDamageDealt:s.stats.totalDamageDealt??0,totalHealingDone:s.stats.totalHealingDone??0,playtime:s.stats.playtime??0}}),t({recruitmentFlags:s.playerData.recruitmentFlags??{},npcStates:s.overworldState.npcStates??{},statsTracker:{battlesWon:s.stats.battlesWon??0,battlesLost:s.stats.battlesLost??0,totalDamageDealt:s.stats.totalDamageDealt??0,totalHealingDone:s.stats.totalHealingDone??0,playtime:s.stats.playtime??0}}),t({recruitmentFlags:s.playerData.recruitmentFlags??{},npcStates:s.overworldState.npcStates??{},statsTracker:{battlesWon:s.stats.battlesWon??0,battlesLost:s.stats.battlesLost??0,totalDamageDealt:s.stats.totalDamageDealt??0,totalHealingDone:s.stats.totalHealingDone??0,playtime:s.stats.playtime??0}}),t({recruitmentFlags:s.playerData.recruitmentFlags??{},npcStates:s.overworldState.npcStates??{},statsTracker:{battlesWon:s.stats.battlesWon??0,battlesLost:s.stats.battlesLost??0,totalDamageDealt:s.stats.totalDamageDealt??0,totalHealingDone:s.stats.totalHealingDone??0,playtime:s.stats.playtime??0}}),t({recruitmentFlags:s.playerData.recruitmentFlags??{},npcStates:s.overworldState.npcStates??{},statsTracker:{battlesWon:s.stats.battlesWon??0,battlesLost:s.stats.battlesLost??0,totalDamageDealt:s.stats.totalDamageDealt??0,totalHealingDone:s.stats.totalHealingDone??0,playtime:s.stats.playtime??0}});const o=localStorage.getItem("vale-v2/battle-state");if(o)try{const g=JSON.parse(o);if(g?.battle){const p=typeof g.rngSeed=="number"?g.rngSeed:0;n.setBattle(g.battle,p),t({turnNumber:g.turnNumber??0})}}catch(g){console.warn("Failed to parse battle state:",g)}},saveGame:()=>{const{team:a,roster:s,story:n,currentMapId:i,playerPosition:o,gold:g,equipment:p,recruitmentFlags:c,npcStates:l,statsTracker:u}=r(),_=Jt(a,s,{gold:g,equipment:p},n,{currentMapId:i,playerPosition:o},r().towerRecord??Be,c,l,u);if(!_){console.error("Cannot save: no team data");return}const{battle:k,rngSeed:w}=r(),I={battle:k,rngSeed:w,turnNumber:r().turnNumber};localStorage.setItem("vale-v2/battle-state",JSON.stringify(I));const h=yr(_);h.ok||console.error("Failed to save game:",h.error)},deleteSave:()=>{const a=dr();a.ok||console.error("Failed to delete save:",a.error),localStorage.removeItem("vale-v2/battle-state")},saveGameSlot:a=>{const{team:s,roster:n,story:i,currentMapId:o,playerPosition:g,gold:p,equipment:c,recruitmentFlags:l,npcStates:u,statsTracker:f}=r(),k=Jt(s,n,{gold:p,equipment:c},i,{currentMapId:o,playerPosition:g},r().towerRecord??Be,l,u,f);if(!k){console.error("Cannot save: no team data");return}const{battle:w,rngSeed:I}=r(),h={battle:w,rngSeed:I,turnNumber:r().turnNumber};localStorage.setItem(`vale-v2/battle-state-slot-${a}`,JSON.stringify(h));const m=ur(a,k);m.ok||console.error(`Failed to save game to slot ${a}:`,m.error)},loadGameSlot:a=>{const s=pr(a);if(!s.ok){console.error(`Failed to load game from slot ${a}:`,s.error);return}const n=s.value,i=r();i.setRoster(n.playerData.unitsCollected);const o=n.playerData.activeParty.map(p=>n.playerData.unitsCollected.find(c=>c.id===p)).filter(p=>p!==void 0);if(o.length>0){const p={units:o,equippedDjinn:n.playerData.equippedDjinn||[],djinnTrackers:n.playerData.djinnTrackers||{},collectedDjinn:n.playerData.djinnCollected,currentTurn:0,activationsThisTurn:{},djinnStates:{}};i.setTeam(p)}i.setEquipment(n.playerData.inventory??[]),i.setGold(n.playerData.gold??0),i.setStoryState(Vt(n)),i.teleportPlayer(n.overworldState.currentScene,n.overworldState.playerPosition),i.setTowerRecord(n.towerStats??Be);const g=localStorage.getItem(`vale-v2/battle-state-slot-${a}`);if(g)try{const p=JSON.parse(g);if(p?.battle){const c=typeof p.rngSeed=="number"?p.rngSeed:0;i.setBattle(p.battle,c),t({turnNumber:p.turnNumber??0})}}catch(p){console.warn("Failed to parse battle state:",p)}},hasSaveSlot:a=>lr(a),deleteSaveSlot:a=>{const s=gr(a);s.ok||console.error(`Failed to delete save slot ${a}:`,s.error),localStorage.removeItem(`vale-v2/battle-state-slot-${a}`)},getSaveSlotMetadata:a=>or(a),autoSave:()=>{r().saveGameSlot(0)},setRecruitmentFlag:(a,s)=>{t(n=>({recruitmentFlags:{...n.recruitmentFlags,[a]:s}}))},setNpcState:(a,s)=>{t(n=>({npcStates:{...n.npcStates,[a]:{...n.npcStates[a]??{},...s}}}))},incrementBattleStats:({outcome:a,damageDealt:s=0,healingDone:n=0})=>{t(i=>({statsTracker:{...i.statsTracker,battlesWon:i.statsTracker.battlesWon+(a==="win"?1:0),battlesLost:i.statsTracker.battlesLost+(a==="loss"?1:0),totalDamageDealt:i.statsTracker.totalDamageDealt+Math.max(0,Math.floor(s)),totalHealingDone:i.statsTracker.totalHealingDone+Math.max(0,Math.floor(n))}}))},addPlaytime:a=>{t(s=>({statsTracker:{...s.statsTracker,playtime:s.statsTracker.playtime+Math.max(0,Math.floor(a))}}))}}),gs=(t,r)=>({story:hr(1),showCredits:!1,setShowCredits:a=>t({showCredits:a}),setStoryState:a=>{t({story:a})},setStoryFlag:(a,s)=>{const n=r().story,i=r().team;if(i){const o=$t(n,i,a,s);t({story:o.story}),o.djinnGranted&&r().updateTeam(o.team)}else{const o=Sr(n,a,s);t({story:o})}},getStoryFlag:a=>r().story.flags[a],onBattleEvents:a=>{let s=r().story;const n=r().team;for(const i of a)if(i.type==="encounter-finished"&&i.outcome==="PLAYER_VICTORY"){s=br(s,i.encounterId);const o=fr(i.encounterId);if(n){const u=$t(s,n,o,!0);s=u.story,u.djinnGranted&&r().updateTeam(u.team)}const g=i.encounterId.startsWith("house-")?i.encounterId:o,p=n?Math.max(1,Math.floor(n.units.reduce((u,f)=>u+f.level,0)/n.units.length)):1,c=vr(s,g,!0,p);s=c.story,c.recruitedUnit&&r().addUnitToRoster(c.recruitedUnit);const l=wr(s,o);if(l.ok&&(s=l.value),o==="boss:ch3"&&s.chapter===4){t({story:s,showCredits:!0});return}}t({story:s})}}),ps=t=>({gold:0,equipment:[],addGold:r=>{t(a=>({gold:a.gold+r}))},addEquipment:r=>{t(a=>({equipment:[...a.equipment,...r.map(s=>({...s}))]}))},removeEquipment:r=>{t(a=>{const s=a.equipment.findIndex(i=>i.id===r);if(s===-1)return a;const n=[...a.equipment];return n.splice(s,1),{equipment:n}})},setGold:r=>{t({gold:r})},setEquipment:r=>{t({equipment:r.map(a=>({...a}))})}}),us=(t,r)=>({lastBattleRewards:null,showRewards:!1,lastBattleEncounterId:null,processVictory:a=>{const s=kr(a),n=a.encounterId||a.meta?.encounterId||null,{setTeam:i}=r();i(s.updatedTeam),t({lastBattleRewards:s.distribution,lastBattleEncounterId:n,mode:"rewards",showRewards:!0})},claimRewards:()=>{const{lastBattleRewards:a}=r();if(!a)return;const{addGold:s,addEquipment:n}=r();s(a.goldEarned);const i=[];a.fixedEquipment&&i.push(a.fixedEquipment),a.choiceSelected&&i.push(a.choiceSelected),i.length>0&&n(i),t({lastBattleRewards:null,showRewards:!1})},setShowRewards:a=>{t({showRewards:a})},selectEquipmentChoice:a=>{t(s=>s.lastBattleRewards?.equipmentChoice?{lastBattleRewards:{...s.lastBattleRewards,choiceSelected:a,equipmentChoice:void 0}}:s)}}),ka=_r,ds=3;function _a(t){return{weapon:t.weapon??null,armor:t.armor??null,helm:t.helm??null,boots:t.boots??null,accessory:t.accessory??null}}function ys(t){return t?_a(t.equipment):Ze()}function ms(t){const r=[];for(let a=0;a<ds;a+=1)r.push(t?.[a]??null);return r}function Kt(t,r=ka,a){const s=[];for(let n=0;n<r;n+=1){const i=t[n];s.push({slotIndex:n,unitId:i?.id??null,equipmentLoadout:ys(i)})}return{slots:s,djinnSlots:ms(a)}}function hs(t,r,a=ka){const s=t?.equippedDjinn;return t&&t.units.length>0?Kt(t.units,a,s):Kt(r,a,s)}function bs(t){return t.slots.map(r=>r.unitId).filter(r=>!!r)}function fs(t,r,a){const s=[...t];return s[r]=a,s}function Ia(t,r,a,s){if(!s)return{valid:!1,message:"Team data is missing"};if(bs(t).length<Xe)return{valid:!1,message:`Select at least ${Xe} units before starting the battle`};const i=new Map;for(const p of r)i.set(p.id,(i.get(p.id)??0)+1);const o=new Map;for(const p of t.slots){if(!p.unitId)continue;const c=a.find(u=>u.id===p.unitId)??s.units.find(u=>u.id===p.unitId);if(!c)return{valid:!1,message:`Unit ${p.unitId} is unavailable for this slot`};const l=Object.values(p.equipmentLoadout);for(const u of l){if(!u)continue;if(u.allowedElements.length>0&&!u.allowedElements.includes(c.element))return{valid:!1,message:`${c.name} cannot equip ${u.name}`};const f=o.get(u.id)??0;o.set(u.id,f+1)}}for(const[p,c]of o.entries()){const l=i.get(p)??0;if(c>l)return{valid:!1,message:`Not enough copies of ${p} in your inventory`}}const g=t.djinnSlots.filter(p=>!!p);for(const p of g)if(!s.collectedDjinn.includes(p))return{valid:!1,message:`You do not own the ${p} Djinn`};return{valid:!0}}const vs=(t,r)=>{const a=()=>{const n=r(),{currentBattleConfig:i,team:o}=n;if(!i)return console.error("No battle configuration available when building team"),null;const g=[];for(const l of i.slots){if(!l.unitId)continue;let u=n.getUnitFromRoster(l.unitId);if(!u&&o&&(u=o.units.find(k=>k.id===l.unitId)),!u)return console.error(`Unit ${l.unitId} missing from roster/team when building battle team`),null;const f=l.equipmentLoadout??Ze(),_=We(u,{equipment:_a(f)});g.push(_)}if(g.length<Xe)return console.error(`Battle requires at least ${Xe} units, found ${g.length}`),null;const p=o?ge(o,{units:g}):Qe(g),c=i.djinnSlots.filter(l=>!!l);if(c.length>0)try{return ge(p,{equippedDjinn:c})}catch(l){return console.error("Failed to apply Djinn selection from BattleConfig",l),null}return p},s=()=>hs(r().team,r().roster);return{mode:"title-screen",lastTrigger:null,currentEncounter:null,currentShopId:null,preBattlePosition:null,currentBattleConfig:null,pendingBattleEncounterId:null,setMode:n=>t({mode:n}),setPendingBattle:n=>{const i=n?s():null;t({pendingBattleEncounterId:n,mode:n?"team-select":"overworld",currentBattleConfig:i})},handleTrigger:(n,i=!1)=>{if(!n){t({lastTrigger:null});return}if(n.type==="battle"){const o=n.data.encounterId;if(!o){console.error("Battle trigger missing encounterId");return}if(!Le[o]){console.error(`Encounter ${o} not found in ENCOUNTERS`);return}if(!i){const p=Ha(o);if(p){r().startDialogueTree(p),t({lastTrigger:n});return}}t({mode:"team-select",pendingBattleEncounterId:o,lastTrigger:n,currentBattleConfig:s()});return}if(n.type==="npc"){const o=n.data.npcId;o&&be[o]?r().startDialogueTree(be[o]):o&&console.warn(`Dialogue ${o} not found`),t({lastTrigger:n});return}if(n.type==="story"){const o=n.data.storyId;o&&be[o]?r().startDialogueTree(be[o]):o&&console.warn(`Story dialogue ${o} not found`),t({lastTrigger:n});return}if(n.type==="shop"){const o=n.data.shopId;if(!o){console.error("Shop trigger missing shopId");return}t({lastTrigger:n,currentShopId:o,mode:"shop"});return}if(n.type==="tower"){const{enterTowerFromOverworld:o}=r(),g=r().currentMapId;g&&o({mapId:g,position:n.position});return}if(n.type==="transition"){t({lastTrigger:n});return}t({lastTrigger:n})},resetLastTrigger:()=>t({lastTrigger:null}),confirmBattleTeam:()=>{const n=r(),{pendingBattleEncounterId:i,currentBattleConfig:o,equipment:g,roster:p,team:c,currentMapId:l,playerPosition:u}=n;if(!i){console.error("No pending battle encounter");return}if(!o){console.error("Missing battle configuration when confirming battle");return}const f=Ia(o,g,p,c);if(!f.valid){console.error("Battle configuration validation failed",f.message);return}const _=Le[i];if(!_){console.error(`Encounter ${i} not found`);return}const k=a();if(!k){console.error("Could not resolve team for battle");return}const w={mapId:l,position:{x:u.x,y:u.y}},I=Date.now(),h=ne(I);try{const m=Ir(i,k,h);if(!m||!m.battle){console.error(`Failed to create battle from encounter ${i}`);return}r().setBattle(m.battle,I),r().setTeam(k),t({currentEncounter:_,mode:"battle",preBattlePosition:w,pendingBattleEncounterId:null,currentBattleConfig:null})}catch(m){console.error("Error creating battle:",m)}},updateBattleConfigSlot:(n,i)=>t(o=>{const{currentBattleConfig:g}=o;if(!g)return o;const p=g.slots.map(c=>c.slotIndex===n?{...c,unitId:i}:c);return{currentBattleConfig:{...g,slots:p}}}),updateBattleSlotEquipment:(n,i,o)=>t(g=>{const{currentBattleConfig:p}=g;if(!p)return g;const c=p.slots.map(l=>l.slotIndex===n?{...l,equipmentLoadout:{...l.equipmentLoadout,[i]:o}}:l);return{currentBattleConfig:{...p,slots:c}}}),setBattleConfigDjinnSlot:(n,i)=>t(o=>{const{currentBattleConfig:g}=o;if(!g)return o;const p=i??null;if(p&&g.djinnSlots.some((l,u)=>u!==n&&l===p))return console.warn("Cannot equip the same Djinn more than once",p),o;const c=fs(g.djinnSlots,n,p);return{currentBattleConfig:{...g,djinnSlots:c}}}),clearBattleConfig:()=>{t({currentBattleConfig:null})},returnToOverworld:()=>{const{preBattlePosition:n,teleportPlayer:i}=r();n&&i(n.mapId,n.position),t({mode:"overworld",preBattlePosition:null,currentEncounter:null,lastTrigger:null,currentBattleConfig:null})}}},Ta=Ke["vale-village"];if(!Ta)throw new Error('Starting map "vale-village" not found');const ws=Ta,Ss=(t,r)=>{const a=()=>r();return{currentMapId:"vale-village",playerPosition:ws.spawnPoint,facing:"down",currentTrigger:null,setFacing:s=>t({facing:s}),movePlayer:s=>{const n=a(),i=Ke[n.currentMapId];if(!i)return;const o=Tr(i,n.playerPosition,s);if(!o.blocked){const g=o.trigger??null;let p=g;if(g?.type==="battle"){const c=g.data.encounterId;if(c){const l=n.story;l.flags[c]===!0?p=null:ma(l,c)||(p=null)}}if(g?.type==="transition"&&g.id==="house-01-door"&&!!!n.story.flags.first_djinn_intro_completed){const l=be["tutorial:djinn-intro"];l&&(n.startDialogueTree(l),p=null)}if(t({playerPosition:o.newPos,facing:s,currentTrigger:p}),g?.type==="npc"){const c=g.data.npcId;c&&be[c]&&n.startDialogueTree(be[c])}n.handleTrigger(p)}},teleportPlayer:(s,n)=>{Ke[s]&&t({currentMapId:s,playerPosition:n,facing:"down"})},clearTrigger:()=>t({currentTrigger:null})}},ks=(t,r)=>({currentDialogueTree:null,currentDialogueState:null,startDialogueTree:a=>{const s=Cr(a);t({currentDialogueTree:a,currentDialogueState:s,mode:"dialogue"})},makeChoice:a=>{const{currentDialogueTree:s,currentDialogueState:n}=r();if(!s||!n)return;const g=s.nodes.find(c=>c.id===n.currentNodeId)?.choices?.find(c=>c.id===a)?.effects,p=Dr(s,n,a);t({currentDialogueState:p}),g&&Object.keys(g).length>0&&Qt(g,r)},advanceCurrentDialogue:()=>{const{currentDialogueTree:a,currentDialogueState:s}=r();if(!a||!s)return;const n=a.id,i=s.treeId,o=a.nodes.find(l=>l.id===s.currentNodeId);if(o?.effects&&Object.keys(o.effects).length>0){Qt(o.effects,r);const{mode:l}=r();if(l!=="dialogue"){r().endDialogue();return}}const g=r().currentDialogueState,p=r().currentDialogueTree;if(!p||!g||g.treeId!==i||p.id!==n)return;const c=xr(p,g);c?t({currentDialogueState:c}):r().endDialogue()},endDialogue:()=>{const a=r().mode;t({currentDialogueTree:null,currentDialogueState:null,mode:a==="battle"||a==="team-select"?a:"overworld"})}});function _s(t,r){const a=[];if(t.questAccepted===!0&&(a.push({kind:"quest-accepted"}),a.push({kind:"set-story-flag",key:"questAccepted",value:!0})),t.openShop===!0&&a.push({kind:"open-shop"}),typeof t.startBattle=="string"){const n=t.startBattle,i=Ya(r);a.push({kind:"start-battle",encounterId:n,skipPreBattleDialogue:i})}typeof t.recruitUnit=="string"&&a.push({kind:"recruit-unit",unitId:t.recruitUnit}),typeof t.grantDjinn=="string"&&a.push({kind:"grant-djinn",djinnId:t.grantDjinn});let s=!1;for(const[n,i]of Object.entries(t))typeof i=="boolean"&&n!=="questAccepted"&&n!=="openShop"&&(a.push({kind:"set-story-flag",key:n,value:i}),s=!0);return(s||t.questAccepted===!0)&&a.push({kind:"auto-save"}),a}function Is(t,r){const a=r(),s=typeof a.setStoryFlag=="function";for(const n of t)switch(n.kind){case"quest-accepted":{s?(a.setStoryFlag("questAccepted",!0),console.warn("Quest accepted!")):console.warn("setStoryFlag not available - quest flag not saved");break}case"open-shop":{const i=a.currentShopId||"vale-armory";a.handleTrigger({id:"dialogue-shop",type:"shop",position:{x:0,y:0},data:{shopId:i}});break}case"start-battle":{const{encounterId:i,skipPreBattleDialogue:o}=n;console.warn(`Starting battle from dialogue: ${i}`),a.handleTrigger({id:"dialogue-battle",type:"battle",position:{x:0,y:0},data:{encounterId:i}},o);break}case"recruit-unit":{const i=n.unitId,o=Ne[i];if(o&&a.team){const g=Math.max(1,Math.floor(a.team.units.reduce((c,l)=>c+l.level,0)/a.team.units.length)),p=ve(o,g,0);a.addUnitToRoster(p),a.setRecruitmentFlag&&a.setRecruitmentFlag(i,!0),console.warn(`ðŸŽ‰ Recruited ${p.name} via dialogue effect!`)}else console.error(`Failed to recruit unit: ${i} (definition not found or no team)`);break}case"grant-djinn":{const i=n.djinnId,o=a.team;if(o){const g=Ct(o,i);if(g.ok){const p=g.value,c=Er(p,i),l=c.ok?c.value:p;a.updateTeam(l),console.warn(`ðŸŽ‰ Granted Djinn ${i} via dialogue effect!`),c.ok||console.warn(`Failed to auto-equip Djinn ${i}: ${c.error}`)}else console.warn(`Failed to grant Djinn ${i}: ${g.error}`)}else console.warn(`Cannot grant Djinn ${i}: no team available`);break}case"set-story-flag":{s&&(a.setStoryFlag(n.key,n.value),console.warn(`Story flag set via dialogue: ${n.key} = ${n.value}`));break}case"auto-save":{try{const i=r();typeof i.autoSave=="function"&&i.autoSave()}catch(i){console.warn("Auto-save failed after dialogue:",i)}break}}}function Qt(t,r){const a=r().currentDialogueTree?.id,s=_s(t,a);s.length!==0&&Is(s,r)}const Ts=t=>({devModeEnabled:!1,selectedHouseId:null,toggleDevMode:()=>t(r=>({devModeEnabled:!r.devModeEnabled})),setDevModeEnabled:r=>t({devModeEnabled:r}),setSelectedHouse:r=>t({selectedHouseId:r})}),xs=(t,r,a)=>({...Kr(t,r),...Yr(t,r),...Vr(t,r),...cs(t,r),...gs(t,r),...ps(t),...us(t,r),...vs(t,r),...Ss(t,r),...ks(t,r),...Ts(t),...es(t,r)});function Ds(){return ga()(xs)}const M=Ds(),si=M,Fe=[{name:"Isaac Axe Attack1",path:"/sprites/battle/party/isaac/Isaac_Axe_Attack1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe Attack2",path:"/sprites/battle/party/isaac/Isaac_Axe_Attack2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe Back",path:"/sprites/battle/party/isaac/Isaac_Axe_Back.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe CastBack1",path:"/sprites/battle/party/isaac/Isaac_Axe_CastBack1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe CastBack2",path:"/sprites/battle/party/isaac/Isaac_Axe_CastBack2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe CastFront1",path:"/sprites/battle/party/isaac/Isaac_Axe_CastFront1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe CastFront2",path:"/sprites/battle/party/isaac/Isaac_Axe_CastFront2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe DownedBack",path:"/sprites/battle/party/isaac/Isaac_Axe_DownedBack.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe DownedFront",path:"/sprites/battle/party/isaac/Isaac_Axe_DownedFront.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe Front",path:"/sprites/battle/party/isaac/Isaac_Axe_Front.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe HitBack",path:"/sprites/battle/party/isaac/Isaac_Axe_HitBack.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Axe HitFront",path:"/sprites/battle/party/isaac/Isaac_Axe_HitFront.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade Attack1",path:"/sprites/battle/party/isaac/Isaac_lBlade_Attack1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade Attack2",path:"/sprites/battle/party/isaac/Isaac_lBlade_Attack2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade Back",path:"/sprites/battle/party/isaac/Isaac_lBlade_Back.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade CastBack1",path:"/sprites/battle/party/isaac/Isaac_lBlade_CastBack1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade CastBack2",path:"/sprites/battle/party/isaac/Isaac_lBlade_CastBack2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade CastFront1",path:"/sprites/battle/party/isaac/Isaac_lBlade_CastFront1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade CastFront2",path:"/sprites/battle/party/isaac/Isaac_lBlade_CastFront2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade DownedBack",path:"/sprites/battle/party/isaac/Isaac_lBlade_DownedBack.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade DownedFront",path:"/sprites/battle/party/isaac/Isaac_lBlade_DownedFront.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade Front",path:"/sprites/battle/party/isaac/Isaac_lBlade_Front.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade HitBack",path:"/sprites/battle/party/isaac/Isaac_lBlade_HitBack.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lBlade HitFront",path:"/sprites/battle/party/isaac/Isaac_lBlade_HitFront.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword Attack1",path:"/sprites/battle/party/isaac/Isaac_lSword_Attack1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword Attack2",path:"/sprites/battle/party/isaac/Isaac_lSword_Attack2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword Back",path:"/sprites/battle/party/isaac/Isaac_lSword_Back.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword CastBack1",path:"/sprites/battle/party/isaac/Isaac_lSword_CastBack1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword CastBack2",path:"/sprites/battle/party/isaac/Isaac_lSword_CastBack2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword CastFront1",path:"/sprites/battle/party/isaac/Isaac_lSword_CastFront1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword CastFront2",path:"/sprites/battle/party/isaac/Isaac_lSword_CastFront2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword DownedBack",path:"/sprites/battle/party/isaac/Isaac_lSword_DownedBack.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword DownedFront",path:"/sprites/battle/party/isaac/Isaac_lSword_DownedFront.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword Front",path:"/sprites/battle/party/isaac/Isaac_lSword_Front.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword HitBack",path:"/sprites/battle/party/isaac/Isaac_lSword_HitBack.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac lSword HitFront",path:"/sprites/battle/party/isaac/Isaac_lSword_HitFront.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace Attack1",path:"/sprites/battle/party/isaac/Isaac_Mace_Attack1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace Attack2",path:"/sprites/battle/party/isaac/Isaac_Mace_Attack2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace Back",path:"/sprites/battle/party/isaac/Isaac_Mace_Back.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace CastBack1",path:"/sprites/battle/party/isaac/Isaac_Mace_CastBack1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace CastBack2",path:"/sprites/battle/party/isaac/Isaac_Mace_CastBack2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace CastFront1",path:"/sprites/battle/party/isaac/Isaac_Mace_CastFront1.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace CastFront2",path:"/sprites/battle/party/isaac/Isaac_Mace_CastFront2.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace DownedBack",path:"/sprites/battle/party/isaac/Isaac_Mace_DownedBack.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace DownedFront",path:"/sprites/battle/party/isaac/Isaac_Mace_DownedFront.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace Front",path:"/sprites/battle/party/isaac/Isaac_Mace_Front.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace HitBack",path:"/sprites/battle/party/isaac/Isaac_Mace_HitBack.gif",category:"battle-party",subcategory:"isaac"},{name:"Isaac Mace HitFront",path:"/sprites/battle/party/isaac/Isaac_Mace_HitFront.gif",category:"battle-party",subcategory:"isaac"},{name:"Garet Axe Attack1",path:"/sprites/battle/party/garet/Garet_Axe_Attack1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe Attack2",path:"/sprites/battle/party/garet/Garet_Axe_Attack2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe Back",path:"/sprites/battle/party/garet/Garet_Axe_Back.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe CastBack1",path:"/sprites/battle/party/garet/Garet_Axe_CastBack1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe CastBack2",path:"/sprites/battle/party/garet/Garet_Axe_CastBack2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe CastFront1",path:"/sprites/battle/party/garet/Garet_Axe_CastFront1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe CastFront2",path:"/sprites/battle/party/garet/Garet_Axe_CastFront2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe DownedBack",path:"/sprites/battle/party/garet/Garet_Axe_DownedBack.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe DownedFront",path:"/sprites/battle/party/garet/Garet_Axe_DownedFront.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe Front",path:"/sprites/battle/party/garet/Garet_Axe_Front.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe HitBack",path:"/sprites/battle/party/garet/Garet_Axe_HitBack.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Axe HitFront",path:"/sprites/battle/party/garet/Garet_Axe_HitFront.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword Attack1",path:"/sprites/battle/party/garet/Garet_lSword_Attack1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword Attack2",path:"/sprites/battle/party/garet/Garet_lSword_Attack2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword Back",path:"/sprites/battle/party/garet/Garet_lSword_Back.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword CastBack1",path:"/sprites/battle/party/garet/Garet_lSword_CastBack1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword CastBack2",path:"/sprites/battle/party/garet/Garet_lSword_CastBack2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword CastFront1",path:"/sprites/battle/party/garet/Garet_lSword_CastFront1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword CastFront2",path:"/sprites/battle/party/garet/Garet_lSword_CastFront2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword DownedBack",path:"/sprites/battle/party/garet/Garet_lSword_DownedBack.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword DownedFront",path:"/sprites/battle/party/garet/Garet_lSword_DownedFront.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword Front",path:"/sprites/battle/party/garet/Garet_lSword_Front.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword HitBack",path:"/sprites/battle/party/garet/Garet_lSword_HitBack.gif",category:"battle-party",subcategory:"garet"},{name:"Garet lSword HitFront",path:"/sprites/battle/party/garet/Garet_lSword_HitFront.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace Attack1",path:"/sprites/battle/party/garet/Garet_Mace_Attack1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace Attack2",path:"/sprites/battle/party/garet/Garet_Mace_Attack2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace Back",path:"/sprites/battle/party/garet/Garet_Mace_Back.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace CastBack1",path:"/sprites/battle/party/garet/Garet_Mace_CastBack1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace CastBack2",path:"/sprites/battle/party/garet/Garet_Mace_CastBack2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace CastFront1",path:"/sprites/battle/party/garet/Garet_Mace_CastFront1.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace CastFront2",path:"/sprites/battle/party/garet/Garet_Mace_CastFront2.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace DownedBack",path:"/sprites/battle/party/garet/Garet_Mace_DownedBack.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace DownedFront",path:"/sprites/battle/party/garet/Garet_Mace_DownedFront.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace Front",path:"/sprites/battle/party/garet/Garet_Mace_Front.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace HitBack",path:"/sprites/battle/party/garet/Garet_Mace_HitBack.gif",category:"battle-party",subcategory:"garet"},{name:"Garet Mace HitFront",path:"/sprites/battle/party/garet/Garet_Mace_HitFront.gif",category:"battle-party",subcategory:"garet"},{name:"Ivan lBlade Attack1",path:"/sprites/battle/party/ivan/Ivan_lBlade_Attack1.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade Attack2",path:"/sprites/battle/party/ivan/Ivan_lBlade_Attack2.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade Back",path:"/sprites/battle/party/ivan/Ivan_lBlade_Back.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade CastBack1",path:"/sprites/battle/party/ivan/Ivan_lBlade_CastBack1.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade CastBack2",path:"/sprites/battle/party/ivan/Ivan_lBlade_CastBack2.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade CastFront1",path:"/sprites/battle/party/ivan/Ivan_lBlade_CastFront1.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade CastFront2",path:"/sprites/battle/party/ivan/Ivan_lBlade_CastFront2.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade DownedBack",path:"/sprites/battle/party/ivan/Ivan_lBlade_DownedBack.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade DownedFront",path:"/sprites/battle/party/ivan/Ivan_lBlade_DownedFront.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade Front",path:"/sprites/battle/party/ivan/Ivan_lBlade_Front.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade HitBack",path:"/sprites/battle/party/ivan/Ivan_lBlade_HitBack.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan lBlade HitFront",path:"/sprites/battle/party/ivan/Ivan_lBlade_HitFront.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff Attack1",path:"/sprites/battle/party/ivan/Ivan_Staff_Attack1.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff Attack2",path:"/sprites/battle/party/ivan/Ivan_Staff_Attack2.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff Back",path:"/sprites/battle/party/ivan/Ivan_Staff_Back.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff CastBack1",path:"/sprites/battle/party/ivan/Ivan_Staff_CastBack1.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff CastBack2",path:"/sprites/battle/party/ivan/Ivan_Staff_CastBack2.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff CastFront1",path:"/sprites/battle/party/ivan/Ivan_Staff_CastFront1.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff CastFront2",path:"/sprites/battle/party/ivan/Ivan_Staff_CastFront2.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff DownedBack",path:"/sprites/battle/party/ivan/Ivan_Staff_DownedBack.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff DownedFront",path:"/sprites/battle/party/ivan/Ivan_Staff_DownedFront.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff Front",path:"/sprites/battle/party/ivan/Ivan_Staff_Front.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff HitBack",path:"/sprites/battle/party/ivan/Ivan_Staff_HitBack.gif",category:"battle-party",subcategory:"ivan"},{name:"Ivan Staff HitFront",path:"/sprites/battle/party/ivan/Ivan_Staff_HitFront.gif",category:"battle-party",subcategory:"ivan"},{name:"Mia Mace Attack1",path:"/sprites/battle/party/mia/Mia_Mace_Attack1.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace Attack2",path:"/sprites/battle/party/mia/Mia_Mace_Attack2.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace Back",path:"/sprites/battle/party/mia/Mia_Mace_Back.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace CastBack1",path:"/sprites/battle/party/mia/Mia_Mace_CastBack1.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace CastBack2",path:"/sprites/battle/party/mia/Mia_Mace_CastBack2.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace CastFront1",path:"/sprites/battle/party/mia/Mia_Mace_CastFront1.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace CastFront2",path:"/sprites/battle/party/mia/Mia_Mace_CastFront2.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace DownedBack",path:"/sprites/battle/party/mia/Mia_Mace_DownedBack.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace DownedFront",path:"/sprites/battle/party/mia/Mia_Mace_DownedFront.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace Front",path:"/sprites/battle/party/mia/Mia_Mace_Front.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace HitBack",path:"/sprites/battle/party/mia/Mia_Mace_HitBack.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Mace HitFront",path:"/sprites/battle/party/mia/Mia_Mace_HitFront.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff Attack1",path:"/sprites/battle/party/mia/Mia_Staff_Attack1.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff Attack2",path:"/sprites/battle/party/mia/Mia_Staff_Attack2.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff Back",path:"/sprites/battle/party/mia/Mia_Staff_Back.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff CastBack1",path:"/sprites/battle/party/mia/Mia_Staff_CastBack1.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff CastBack2",path:"/sprites/battle/party/mia/Mia_Staff_CastBack2.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff CastFront1",path:"/sprites/battle/party/mia/Mia_Staff_CastFront1.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff CastFront2",path:"/sprites/battle/party/mia/Mia_Staff_CastFront2.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff DownedBack",path:"/sprites/battle/party/mia/Mia_Staff_DownedBack.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff DownedFront",path:"/sprites/battle/party/mia/Mia_Staff_DownedFront.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff Front",path:"/sprites/battle/party/mia/Mia_Staff_Front.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff HitBack",path:"/sprites/battle/party/mia/Mia_Staff_HitBack.gif",category:"battle-party",subcategory:"mia"},{name:"Mia Staff HitFront",path:"/sprites/battle/party/mia/Mia_Staff_HitFront.gif",category:"battle-party",subcategory:"mia"},{name:"Acid Maggot",path:"/sprites/battle/enemies/Acid_Maggot.gif",category:"battle-enemies",subcategory:null},{name:"Alec Goblin",path:"/sprites/battle/enemies/Alec_Goblin.gif",category:"battle-enemies",subcategory:null},{name:"Amaze",path:"/sprites/battle/enemies/Amaze.gif",category:"battle-enemies",subcategory:null},{name:"Angle Worm",path:"/sprites/battle/enemies/Angle_Worm.gif",category:"battle-enemies",subcategory:null},{name:"Ant Lion",path:"/sprites/battle/enemies/Ant_Lion.gif",category:"battle-enemies",subcategory:null},{name:"Ape",path:"/sprites/battle/enemies/Ape.gif",category:"battle-enemies",subcategory:null},{name:"Armored Rat",path:"/sprites/battle/enemies/Armored_Rat.gif",category:"battle-enemies",subcategory:null},{name:"Assassin",path:"/sprites/battle/enemies/Assassin.gif",category:"battle-enemies",subcategory:null},{name:"Bat",path:"/sprites/battle/enemies/Bat.gif",category:"battle-enemies",subcategory:null},{name:"Bombander",path:"/sprites/battle/enemies/Bombander.gif",category:"battle-enemies",subcategory:null},{name:"Bone Fighter",path:"/sprites/battle/enemies/Bone_Fighter.gif",category:"battle-enemies",subcategory:null},{name:"Boulder Beast",path:"/sprites/battle/enemies/Boulder_Beast.gif",category:"battle-enemies",subcategory:null},{name:"Brigand",path:"/sprites/battle/enemies/Brigand.gif",category:"battle-enemies",subcategory:null},{name:"Brutal Troll",path:"/sprites/battle/enemies/Brutal_Troll.gif",category:"battle-enemies",subcategory:null},{name:"Calamar",path:"/sprites/battle/enemies/Calamar.gif",category:"battle-enemies",subcategory:null},{name:"Cannibal Ghoul",path:"/sprites/battle/enemies/Cannibal_Ghoul.gif",category:"battle-enemies",subcategory:null},{name:"Cave Troll",path:"/sprites/battle/enemies/Cave_Troll.gif",category:"battle-enemies",subcategory:null},{name:"Cerebus",path:"/sprites/battle/enemies/Cerebus.gif",category:"battle-enemies",subcategory:null},{name:"Chimera",path:"/sprites/battle/enemies/Chimera.gif",category:"battle-enemies",subcategory:null},{name:"Chimera Mage",path:"/sprites/battle/enemies/Chimera_Mage.gif",category:"battle-enemies",subcategory:null},{name:"Chimera Worm",path:"/sprites/battle/enemies/Chimera_Worm.gif",category:"battle-enemies",subcategory:null},{name:"Clay Gargoyle",path:"/sprites/battle/enemies/Clay_Gargoyle.gif",category:"battle-enemies",subcategory:null},{name:"Creeper",path:"/sprites/battle/enemies/Creeper.gif",category:"battle-enemies",subcategory:null},{name:"Cruel Dragon",path:"/sprites/battle/enemies/Cruel_Dragon.gif",category:"battle-enemies",subcategory:null},{name:"Cuttle",path:"/sprites/battle/enemies/Cuttle.gif",category:"battle-enemies",subcategory:null},{name:"Death Cap",path:"/sprites/battle/enemies/Death_Cap.gif",category:"battle-enemies",subcategory:null},{name:"Death Head",path:"/sprites/battle/enemies/Death_Head.gif",category:"battle-enemies",subcategory:null},{name:"Devil Frog",path:"/sprites/battle/enemies/Devil_Frog.gif",category:"battle-enemies",subcategory:null},{name:"Devil Scorpion",path:"/sprites/battle/enemies/Devil_Scorpion.gif",category:"battle-enemies",subcategory:null},{name:"Dino",path:"/sprites/battle/enemies/Dino.gif",category:"battle-enemies",subcategory:null},{name:"Dinox",path:"/sprites/battle/enemies/Dinox.gif",category:"battle-enemies",subcategory:null},{name:"Dire Wolf",path:"/sprites/battle/enemies/Dire_Wolf.gif",category:"battle-enemies",subcategory:null},{name:"Dirge",path:"/sprites/battle/enemies/Dirge.gif",category:"battle-enemies",subcategory:null},{name:"Dirty Ape",path:"/sprites/battle/enemies/Dirty_Ape.gif",category:"battle-enemies",subcategory:null},{name:"Doodle Bug",path:"/sprites/battle/enemies/Doodle_Bug.gif",category:"battle-enemies",subcategory:null},{name:"Doomsayer",path:"/sprites/battle/enemies/Doomsayer.gif",category:"battle-enemies",subcategory:null},{name:"Dread Hound",path:"/sprites/battle/enemies/Dread_Hound.gif",category:"battle-enemies",subcategory:null},{name:"Drone Bee",path:"/sprites/battle/enemies/Drone_Bee.gif",category:"battle-enemies",subcategory:null},{name:"Druj",path:"/sprites/battle/enemies/Druj.gif",category:"battle-enemies",subcategory:null},{name:"Earth Golem",path:"/sprites/battle/enemies/Earth_Golem.gif",category:"battle-enemies",subcategory:null},{name:"Earth Lizard",path:"/sprites/battle/enemies/Earth_Lizard.gif",category:"battle-enemies",subcategory:null},{name:"Emu",path:"/sprites/battle/enemies/Emu.gif",category:"battle-enemies",subcategory:null},{name:"Faery",path:"/sprites/battle/enemies/Faery.gif",category:"battle-enemies",subcategory:null},{name:"Fenrir",path:"/sprites/battle/enemies/Fenrir.gif",category:"battle-enemies",subcategory:null},{name:"Fiendish Ghoul",path:"/sprites/battle/enemies/Fiendish_Ghoul.gif",category:"battle-enemies",subcategory:null},{name:"Fighter Bee",path:"/sprites/battle/enemies/Fighter_Bee.gif",category:"battle-enemies",subcategory:null},{name:"Fire Worm",path:"/sprites/battle/enemies/Fire_Worm.gif",category:"battle-enemies",subcategory:null},{name:"Flash Ant",path:"/sprites/battle/enemies/Flash_Ant.gif",category:"battle-enemies",subcategory:null},{name:"Foul Dirge",path:"/sprites/battle/enemies/Foul_Dirge.gif",category:"battle-enemies",subcategory:null},{name:"Foul Mummy",path:"/sprites/battle/enemies/Foul_Mummy.gif",category:"battle-enemies",subcategory:null},{name:"Gargoyle",path:"/sprites/battle/enemies/Gargoyle.gif",category:"battle-enemies",subcategory:null},{name:"Ghost",path:"/sprites/battle/enemies/Ghost.gif",category:"battle-enemies",subcategory:null},{name:"Ghost Army",path:"/sprites/battle/enemies/Ghost_Army.gif",category:"battle-enemies",subcategory:null},{name:"Ghost Mage",path:"/sprites/battle/enemies/Ghost_Mage.gif",category:"battle-enemies",subcategory:null},{name:"Ghoul",path:"/sprites/battle/enemies/Ghoul.gif",category:"battle-enemies",subcategory:null},{name:"Gillman",path:"/sprites/battle/enemies/Gillman.gif",category:"battle-enemies",subcategory:null},{name:"Gnome",path:"/sprites/battle/enemies/Gnome.gif",category:"battle-enemies",subcategory:null},{name:"Gnome Mage",path:"/sprites/battle/enemies/Gnome_Mage.gif",category:"battle-enemies",subcategory:null},{name:"Gnome Wizard",path:"/sprites/battle/enemies/Gnome_Wizard.gif",category:"battle-enemies",subcategory:null},{name:"Goblin",path:"/sprites/battle/enemies/Goblin.gif",category:"battle-enemies",subcategory:null},{name:"Golem",path:"/sprites/battle/enemies/Golem.gif",category:"battle-enemies",subcategory:null},{name:"Grand Chimera",path:"/sprites/battle/enemies/Grand_Chimera.gif",category:"battle-enemies",subcategory:null},{name:"Grand Golem",path:"/sprites/battle/enemies/Grand_Golem.gif",category:"battle-enemies",subcategory:null},{name:"Grave Wight",path:"/sprites/battle/enemies/Grave_Wight.gif",category:"battle-enemies",subcategory:null},{name:"Grizzly",path:"/sprites/battle/enemies/Grizzly.gif",category:"battle-enemies",subcategory:null},{name:"Grub",path:"/sprites/battle/enemies/Grub.gif",category:"battle-enemies",subcategory:null},{name:"Gryphon",path:"/sprites/battle/enemies/Gryphon.gif",category:"battle-enemies",subcategory:null},{name:"Harpy",path:"/sprites/battle/enemies/Harpy.gif",category:"battle-enemies",subcategory:null},{name:"Harridan",path:"/sprites/battle/enemies/Harridan.gif",category:"battle-enemies",subcategory:null},{name:"Hobgoblin",path:"/sprites/battle/enemies/Hobgoblin.gif",category:"battle-enemies",subcategory:null},{name:"Horned Ghost",path:"/sprites/battle/enemies/Horned_Ghost.gif",category:"battle-enemies",subcategory:null},{name:"Hydra",path:"/sprites/battle/enemies/Hydra.gif",category:"battle-enemies",subcategory:null},{name:"Ice Gargoyle",path:"/sprites/battle/enemies/Ice_Gargoyle.gif",category:"battle-enemies",subcategory:null},{name:"Kobold",path:"/sprites/battle/enemies/Kobold.gif",category:"battle-enemies",subcategory:null},{name:"Kobold 2",path:"/sprites/battle/enemies/Kobold_2.gif",category:"battle-enemies",subcategory:null},{name:"Lich",path:"/sprites/battle/enemies/Lich.gif",category:"battle-enemies",subcategory:null},{name:"Lich 2",path:"/sprites/battle/enemies/Lich_2.gif",category:"battle-enemies",subcategory:null},{name:"Little Death",path:"/sprites/battle/enemies/Little_Death.gif",category:"battle-enemies",subcategory:null},{name:"Living Armor",path:"/sprites/battle/enemies/Living_Armor.gif",category:"battle-enemies",subcategory:null},{name:"Living Statue",path:"/sprites/battle/enemies/Living_Statue.gif",category:"battle-enemies",subcategory:null},{name:"Lizard Fighter",path:"/sprites/battle/enemies/Lizard_Fighter.gif",category:"battle-enemies",subcategory:null},{name:"Lizard King",path:"/sprites/battle/enemies/Lizard_King.gif",category:"battle-enemies",subcategory:null},{name:"Lizard Man",path:"/sprites/battle/enemies/Lizard_Man.gif",category:"battle-enemies",subcategory:null},{name:"Macetail",path:"/sprites/battle/enemies/Macetail.gif",category:"battle-enemies",subcategory:null},{name:"Mad Demon",path:"/sprites/battle/enemies/Mad_Demon.gif",category:"battle-enemies",subcategory:null},{name:"Mad Mole",path:"/sprites/battle/enemies/Mad_Mole.gif",category:"battle-enemies",subcategory:null},{name:"Mad Plant",path:"/sprites/battle/enemies/Mad_Plant.gif",category:"battle-enemies",subcategory:null},{name:"Mad Vermin",path:"/sprites/battle/enemies/Mad_Vermin.gif",category:"battle-enemies",subcategory:null},{name:"Magicore",path:"/sprites/battle/enemies/Magicore.gif",category:"battle-enemies",subcategory:null},{name:"Manticore King",path:"/sprites/battle/enemies/Manticore_King.gif",category:"battle-enemies",subcategory:null},{name:"Man o War",path:"/sprites/battle/enemies/Man_o_War.gif",category:"battle-enemies",subcategory:null},{name:"Mauler",path:"/sprites/battle/enemies/Mauler.gif",category:"battle-enemies",subcategory:null},{name:"Merman",path:"/sprites/battle/enemies/Merman.gif",category:"battle-enemies",subcategory:null},{name:"Mimic",path:"/sprites/battle/enemies/Mimic.gif",category:"battle-enemies",subcategory:null},{name:"Mini Goblin",path:"/sprites/battle/enemies/Mini-Goblin.gif",category:"battle-enemies",subcategory:null},{name:"Minos Warrior",path:"/sprites/battle/enemies/Minos_Warrior.gif",category:"battle-enemies",subcategory:null},{name:"Minotaurus",path:"/sprites/battle/enemies/Minotaurus.gif",category:"battle-enemies",subcategory:null},{name:"Mole",path:"/sprites/battle/enemies/Mole.gif",category:"battle-enemies",subcategory:null},{name:"Mole Mage",path:"/sprites/battle/enemies/Mole_Mage.gif",category:"battle-enemies",subcategory:null},{name:"Momonga",path:"/sprites/battle/enemies/Momonga.gif",category:"battle-enemies",subcategory:null},{name:"Mummy",path:"/sprites/battle/enemies/Mummy.gif",category:"battle-enemies",subcategory:null},{name:"Needle Egg",path:"/sprites/battle/enemies/Needle_Egg.gif",category:"battle-enemies",subcategory:null},{name:"Nightmare",path:"/sprites/battle/enemies/Nightmare.gif",category:"battle-enemies",subcategory:null},{name:"Numb Ant",path:"/sprites/battle/enemies/Numb_Ant.gif",category:"battle-enemies",subcategory:null},{name:"Ooze",path:"/sprites/battle/enemies/Ooze.gif",category:"battle-enemies",subcategory:null},{name:"Orc",path:"/sprites/battle/enemies/Orc.gif",category:"battle-enemies",subcategory:null},{name:"Orc Captain",path:"/sprites/battle/enemies/Orc_Captain.gif",category:"battle-enemies",subcategory:null},{name:"Orc Lord",path:"/sprites/battle/enemies/Orc_Lord.gif",category:"battle-enemies",subcategory:null},{name:"Phoenix",path:"/sprites/battle/enemies/Phoenix.gif",category:"battle-enemies",subcategory:null},{name:"Pixie",path:"/sprites/battle/enemies/Pixie.gif",category:"battle-enemies",subcategory:null},{name:"Plated Rat",path:"/sprites/battle/enemies/Plated_Rat.gif",category:"battle-enemies",subcategory:null},{name:"Poison Toad",path:"/sprites/battle/enemies/Poison_Toad.gif",category:"battle-enemies",subcategory:null},{name:"Pteranodon",path:"/sprites/battle/enemies/Pteranodon.gif",category:"battle-enemies",subcategory:null},{name:"Punch Ant",path:"/sprites/battle/enemies/Punch_Ant.gif",category:"battle-enemies",subcategory:null},{name:"Rabid Bat",path:"/sprites/battle/enemies/Rabid_Bat.gif",category:"battle-enemies",subcategory:null},{name:"Raging Rock",path:"/sprites/battle/enemies/Raging_Rock.gif",category:"battle-enemies",subcategory:null},{name:"Raptor",path:"/sprites/battle/enemies/Raptor.gif",category:"battle-enemies",subcategory:null},{name:"Rat",path:"/sprites/battle/enemies/Rat.gif",category:"battle-enemies",subcategory:null},{name:"Rat Fighter",path:"/sprites/battle/enemies/Rat_Fighter.gif",category:"battle-enemies",subcategory:null},{name:"Rat Soldier",path:"/sprites/battle/enemies/Rat_Soldier.gif",category:"battle-enemies",subcategory:null},{name:"Rat Warrior",path:"/sprites/battle/enemies/Rat_Warrior.gif",category:"battle-enemies",subcategory:null},{name:"Ravager",path:"/sprites/battle/enemies/Ravager.gif",category:"battle-enemies",subcategory:null},{name:"Recluse",path:"/sprites/battle/enemies/Recluse.gif",category:"battle-enemies",subcategory:null},{name:"Red Demon",path:"/sprites/battle/enemies/Red_Demon.gif",category:"battle-enemies",subcategory:null},{name:"Roach",path:"/sprites/battle/enemies/Roach.gif",category:"battle-enemies",subcategory:null},{name:"Roc",path:"/sprites/battle/enemies/Roc.gif",category:"battle-enemies",subcategory:null},{name:"Ruffian",path:"/sprites/battle/enemies/Ruffian.gif",category:"battle-enemies",subcategory:null},{name:"Salamander",path:"/sprites/battle/enemies/Salamander.gif",category:"battle-enemies",subcategory:null},{name:"Seabird",path:"/sprites/battle/enemies/Seabird.gif",category:"battle-enemies",subcategory:null},{name:"Seafowl",path:"/sprites/battle/enemies/Seafowl.gif",category:"battle-enemies",subcategory:null},{name:"Siren",path:"/sprites/battle/enemies/Siren.gif",category:"battle-enemies",subcategory:null},{name:"Skeleton",path:"/sprites/battle/enemies/Skeleton.gif",category:"battle-enemies",subcategory:null},{name:"Skull Warrior",path:"/sprites/battle/enemies/Skull_Warrior.gif",category:"battle-enemies",subcategory:null},{name:"Sky Dragon",path:"/sprites/battle/enemies/Sky_Dragon.gif",category:"battle-enemies",subcategory:null},{name:"Slayer",path:"/sprites/battle/enemies/Slayer.gif",category:"battle-enemies",subcategory:null},{name:"Slime",path:"/sprites/battle/enemies/Slime.gif",category:"battle-enemies",subcategory:null},{name:"Slime Beast",path:"/sprites/battle/enemies/Slime_Beast.gif",category:"battle-enemies",subcategory:null},{name:"Spider",path:"/sprites/battle/enemies/Spider.gif",category:"battle-enemies",subcategory:null},{name:"Spiral Shell",path:"/sprites/battle/enemies/Spiral_Shell.gif",category:"battle-enemies",subcategory:null},{name:"Spirit",path:"/sprites/battle/enemies/Spirit.gif",category:"battle-enemies",subcategory:null},{name:"Squirrelfang",path:"/sprites/battle/enemies/Squirrelfang.gif",category:"battle-enemies",subcategory:null},{name:"Stone Soldier",path:"/sprites/battle/enemies/Stone_Soldier.gif",category:"battle-enemies",subcategory:null},{name:"Succubus",path:"/sprites/battle/enemies/Succubus.gif",category:"battle-enemies",subcategory:null},{name:"Talon Runner",path:"/sprites/battle/enemies/Talon_Runner.gif",category:"battle-enemies",subcategory:null},{name:"Tarantula",path:"/sprites/battle/enemies/Tarantula.gif",category:"battle-enemies",subcategory:null},{name:"Thief",path:"/sprites/battle/enemies/Thief.gif",category:"battle-enemies",subcategory:null},{name:"Thunder Lizard",path:"/sprites/battle/enemies/Thunder_Lizard.gif",category:"battle-enemies",subcategory:null},{name:"Tornado Lizard",path:"/sprites/battle/enemies/Tornado_Lizard.gif",category:"battle-enemies",subcategory:null},{name:"Troll",path:"/sprites/battle/enemies/Troll.gif",category:"battle-enemies",subcategory:null},{name:"Turtle Dragon",path:"/sprites/battle/enemies/Turtle_Dragon.gif",category:"battle-enemies",subcategory:null},{name:"Undead",path:"/sprites/battle/enemies/Undead.gif",category:"battle-enemies",subcategory:null},{name:"Urchin Beast",path:"/sprites/battle/enemies/Urchin_Beast.gif",category:"battle-enemies",subcategory:null},{name:"Vermin",path:"/sprites/battle/enemies/Vermin.gif",category:"battle-enemies",subcategory:null},{name:"Vile Dirge",path:"/sprites/battle/enemies/Vile_Dirge.gif",category:"battle-enemies",subcategory:null},{name:"Virago",path:"/sprites/battle/enemies/Virago.gif",category:"battle-enemies",subcategory:null},{name:"Wargold",path:"/sprites/battle/enemies/Wargold.gif",category:"battle-enemies",subcategory:null},{name:"Warrior Bee",path:"/sprites/battle/enemies/Warrior_Bee.gif",category:"battle-enemies",subcategory:null},{name:"Wight",path:"/sprites/battle/enemies/Wight.gif",category:"battle-enemies",subcategory:null},{name:"Wild Ape",path:"/sprites/battle/enemies/Wild_Ape.gif",category:"battle-enemies",subcategory:null},{name:"Wild Gryphon",path:"/sprites/battle/enemies/Wild_Gryphon.gif",category:"battle-enemies",subcategory:null},{name:"Wild Mushroom",path:"/sprites/battle/enemies/Wild_Mushroom.gif",category:"battle-enemies",subcategory:null},{name:"Wild Wolf",path:"/sprites/battle/enemies/Wild_Wolf.gif",category:"battle-enemies",subcategory:null},{name:"Willowisp",path:"/sprites/battle/enemies/Willowisp.gif",category:"battle-enemies",subcategory:null},{name:"Will Head",path:"/sprites/battle/enemies/Will_Head.gif",category:"battle-enemies",subcategory:null},{name:"Wise Gryphon",path:"/sprites/battle/enemies/Wise_Gryphon.gif",category:"battle-enemies",subcategory:null},{name:"Wolfkin",path:"/sprites/battle/enemies/Wolfkin.gif",category:"battle-enemies",subcategory:null},{name:"Wolfkin Cub",path:"/sprites/battle/enemies/Wolfkin_Cub.gif",category:"battle-enemies",subcategory:null},{name:"Wonder Bird",path:"/sprites/battle/enemies/Wonder_Bird.gif",category:"battle-enemies",subcategory:null},{name:"Wood Walker",path:"/sprites/battle/enemies/Wood_Walker.gif",category:"battle-enemies",subcategory:null},{name:"Worm",path:"/sprites/battle/enemies/Worm.gif",category:"battle-enemies",subcategory:null},{name:"Wyvern",path:"/sprites/battle/enemies/Wyvern.gif",category:"battle-enemies",subcategory:null},{name:"Wyvern Chick",path:"/sprites/battle/enemies/Wyvern_Chick.gif",category:"battle-enemies",subcategory:null},{name:"Zombie",path:"/sprites/battle/enemies/Zombie.gif",category:"battle-enemies",subcategory:null},{name:"Jupiter Djinn Front",path:"/sprites/battle/djinn/Jupiter_Djinn_Front.gif",category:"battle-djinn",subcategory:null},{name:"Mars Djinn Front",path:"/sprites/battle/djinn/Mars_Djinn_Front.gif",category:"battle-djinn",subcategory:null},{name:"Mercury Djinn Front",path:"/sprites/battle/djinn/Mercury_Djinn_Front.gif",category:"battle-djinn",subcategory:null},{name:"Venus Djinn Front",path:"/sprites/battle/djinn/Venus_Djinn_Front.gif",category:"battle-djinn",subcategory:null},{name:"Altin Peak",path:"/sprites/backgrounds/gs1/Altin_Peak.gif",category:"backgrounds-gs1",subcategory:null},{name:"Altmillar Cave",path:"/sprites/backgrounds/gs1/Altmillar_Cave.gif",category:"backgrounds-gs1",subcategory:null},{name:"Babi Lighthouse",path:"/sprites/backgrounds/gs1/Babi_Lighthouse.gif",category:"backgrounds-gs1",subcategory:null},{name:"Cave",path:"/sprites/backgrounds/gs1/Cave.gif",category:"backgrounds-gs1",subcategory:null},{name:"Colosso",path:"/sprites/backgrounds/gs1/Colosso.gif",category:"backgrounds-gs1",subcategory:null},{name:"Crossbone Isle Cave",path:"/sprites/backgrounds/gs1/Crossbone_Isle_Cave.gif",category:"backgrounds-gs1",subcategory:null},{name:"Dark Sky",path:"/sprites/backgrounds/gs1/Dark_Sky.gif",category:"backgrounds-gs1",subcategory:null},{name:"Deadbeard's Ship",path:"/sprites/backgrounds/gs1/Deadbeard's_Ship.gif",category:"backgrounds-gs1",subcategory:null},{name:"Desert",path:"/sprites/backgrounds/gs1/Desert.gif",category:"backgrounds-gs1",subcategory:null},{name:"Dice Game",path:"/sprites/backgrounds/gs1/Dice_Game.gif",category:"backgrounds-gs1",subcategory:null},{name:"Final Battle",path:"/sprites/backgrounds/gs1/Final_Battle.gif",category:"backgrounds-gs1",subcategory:null},{name:"Fuchin Cave",path:"/sprites/backgrounds/gs1/Fuchin_Cave.gif",category:"backgrounds-gs1",subcategory:null},{name:"Kolima Forest",path:"/sprites/backgrounds/gs1/Kolima_Forest.gif",category:"backgrounds-gs1",subcategory:null},{name:"Lamakan Desert",path:"/sprites/backgrounds/gs1/Lamakan_Desert.gif",category:"backgrounds-gs1",subcategory:null},{name:"Mercury Lighthouse",path:"/sprites/backgrounds/gs1/Mercury_Lighthouse.gif",category:"backgrounds-gs1",subcategory:null},{name:"Meteor",path:"/sprites/backgrounds/gs1/Meteor.gif",category:"backgrounds-gs1",subcategory:null},{name:"Mogall Forest",path:"/sprites/backgrounds/gs1/Mogall_Forest.gif",category:"backgrounds-gs1",subcategory:null},{name:"Overworld",path:"/sprites/backgrounds/gs1/Overworld.gif",category:"backgrounds-gs1",subcategory:null},{name:"Sky",path:"/sprites/backgrounds/gs1/Sky.gif",category:"backgrounds-gs1",subcategory:null},{name:"Sol Sanctum",path:"/sprites/backgrounds/gs1/Sol_Sanctum.gif",category:"backgrounds-gs1",subcategory:null},{name:"Suhalla Desert",path:"/sprites/backgrounds/gs1/Suhalla_Desert.gif",category:"backgrounds-gs1",subcategory:null},{name:"Suhalla Gate",path:"/sprites/backgrounds/gs1/Suhalla_Gate.gif",category:"backgrounds-gs1",subcategory:null},{name:"Tolbi Bound Ship Abovedeck",path:"/sprites/backgrounds/gs1/Tolbi_Bound_Ship_Abovedeck.gif",category:"backgrounds-gs1",subcategory:null},{name:"Tolbi Bound Ship Belowdecks",path:"/sprites/backgrounds/gs1/Tolbi_Bound_Ship_Belowdecks.gif",category:"backgrounds-gs1",subcategory:null},{name:"Tret Tree",path:"/sprites/backgrounds/gs1/Tret_Tree.gif",category:"backgrounds-gs1",subcategory:null},{name:"Tret Tree Branches",path:"/sprites/backgrounds/gs1/Tret_Tree_Branches.gif",category:"backgrounds-gs1",subcategory:null},{name:"Tunnel Ruins",path:"/sprites/backgrounds/gs1/Tunnel_Ruins.gif",category:"backgrounds-gs1",subcategory:null},{name:"Vale",path:"/sprites/backgrounds/gs1/Vale.gif",category:"backgrounds-gs1",subcategory:null},{name:"Vault Inn",path:"/sprites/backgrounds/gs1/Vault_Inn.gif",category:"backgrounds-gs1",subcategory:null},{name:"Venus Lighthouse",path:"/sprites/backgrounds/gs1/Venus_Lighthouse.gif",category:"backgrounds-gs1",subcategory:null},{name:"Venus Lighthouse Aerie",path:"/sprites/backgrounds/gs1/Venus_Lighthouse_Aerie.gif",category:"backgrounds-gs1",subcategory:null},{name:"VL Final Battle",path:"/sprites/backgrounds/gs1/VL_Final_Battle.gif",category:"backgrounds-gs1",subcategory:null},{name:"World Map",path:"/sprites/backgrounds/gs1/World_Map.gif",category:"backgrounds-gs1",subcategory:null},{name:"World Map Forest",path:"/sprites/backgrounds/gs1/World_Map_Forest.gif",category:"backgrounds-gs1",subcategory:null},{name:"World Map Shore",path:"/sprites/backgrounds/gs1/World_Map_Shore.gif",category:"backgrounds-gs1",subcategory:null},{name:"World Map Snow",path:"/sprites/backgrounds/gs1/World_Map_Snow.gif",category:"backgrounds-gs1",subcategory:null},{name:"Airs Rock Inside",path:"/sprites/backgrounds/gs2/Airs_Rock_Inside.gif",category:"backgrounds-gs2",subcategory:null},{name:"Airs Rock Outside",path:"/sprites/backgrounds/gs2/Airs_Rock_Outside.gif",category:"backgrounds-gs2",subcategory:null},{name:"Anemos Inner Sanctum",path:"/sprites/backgrounds/gs2/Anemos_Inner_Sanctum.gif",category:"backgrounds-gs2",subcategory:null},{name:"Ankohl Ruins",path:"/sprites/backgrounds/gs2/Ankohl_Ruins.gif",category:"backgrounds-gs2",subcategory:null},{name:"Aqua Rock Inside",path:"/sprites/backgrounds/gs2/Aqua_Rock_Inside.gif",category:"backgrounds-gs2",subcategory:null},{name:"Aqua Rock Outside",path:"/sprites/backgrounds/gs2/Aqua_Rock_Outside.gif",category:"backgrounds-gs2",subcategory:null},{name:"Camelot",path:"/sprites/backgrounds/gs2/Camelot.gif",category:"backgrounds-gs2",subcategory:null},{name:"Catastrophe",path:"/sprites/backgrounds/gs2/Catastrophe.gif",category:"backgrounds-gs2",subcategory:null},{name:"Cave",path:"/sprites/backgrounds/gs2/Cave.gif",category:"backgrounds-gs2",subcategory:null},{name:"Cave2",path:"/sprites/backgrounds/gs2/Cave2.gif",category:"backgrounds-gs2",subcategory:null},{name:"Cliffs",path:"/sprites/backgrounds/gs2/Cliffs.gif",category:"backgrounds-gs2",subcategory:null},{name:"Eclipse",path:"/sprites/backgrounds/gs2/Eclipse.gif",category:"backgrounds-gs2",subcategory:null},{name:"Gaia Rock Inside",path:"/sprites/backgrounds/gs2/Gaia_Rock_Inside.gif",category:"backgrounds-gs2",subcategory:null},{name:"Gaia Rock Outside",path:"/sprites/backgrounds/gs2/Gaia_Rock_Outside.gif",category:"backgrounds-gs2",subcategory:null},{name:"Great Gabomba Statue",path:"/sprites/backgrounds/gs2/Great_Gabomba_Statue.gif",category:"backgrounds-gs2",subcategory:null},{name:"Iris",path:"/sprites/backgrounds/gs2/Iris.gif",category:"backgrounds-gs2",subcategory:null},{name:"Iris2",path:"/sprites/backgrounds/gs2/Iris2.gif",category:"backgrounds-gs2",subcategory:null},{name:"Islet Cave",path:"/sprites/backgrounds/gs2/Islet_Cave.gif",category:"backgrounds-gs2",subcategory:null},{name:"Jupiter Lighthouse",path:"/sprites/backgrounds/gs2/Jupiter_Lighthouse.gif",category:"backgrounds-gs2",subcategory:null},{name:"Jupiter Lighthouse Aerie",path:"/sprites/backgrounds/gs2/Jupiter_Lighthouse_Aerie.gif",category:"backgrounds-gs2",subcategory:null},{name:"Kibombo Mountains",path:"/sprites/backgrounds/gs2/Kibombo_Mountains.gif",category:"backgrounds-gs2",subcategory:null},{name:"Lemurian Ship",path:"/sprites/backgrounds/gs2/Lemurian_Ship.gif",category:"backgrounds-gs2",subcategory:null},{name:"Magma Rock",path:"/sprites/backgrounds/gs2/Magma_Rock.gif",category:"backgrounds-gs2",subcategory:null},{name:"Map",path:"/sprites/backgrounds/gs2/Map.gif",category:"backgrounds-gs2",subcategory:null},{name:"Mars Lighthouse",path:"/sprites/backgrounds/gs2/Mars_Lighthouse.gif",category:"backgrounds-gs2",subcategory:null},{name:"Mars Lighthouse Aerie",path:"/sprites/backgrounds/gs2/Mars_Lighthouse_Aerie.gif",category:"backgrounds-gs2",subcategory:null},{name:"Nintendo",path:"/sprites/backgrounds/gs2/Nintendo.gif",category:"backgrounds-gs2",subcategory:null},{name:"Opening",path:"/sprites/backgrounds/gs2/Opening.gif",category:"backgrounds-gs2",subcategory:null},{name:"Prox",path:"/sprites/backgrounds/gs2/Prox.gif",category:"backgrounds-gs2",subcategory:null},{name:"Sea of Time",path:"/sprites/backgrounds/gs2/Sea_of_Time.gif",category:"backgrounds-gs2",subcategory:null},{name:"Title Screen",path:"/sprites/backgrounds/gs2/Title_Screen.gif",category:"backgrounds-gs2",subcategory:null},{name:"Tundaria Tower",path:"/sprites/backgrounds/gs2/Tundaria_Tower.gif",category:"backgrounds-gs2",subcategory:null},{name:"World Map",path:"/sprites/backgrounds/gs2/World_Map.gif",category:"backgrounds-gs2",subcategory:null},{name:"World Map Desert",path:"/sprites/backgrounds/gs2/World_Map_Desert.gif",category:"backgrounds-gs2",subcategory:null},{name:"World Map Shore",path:"/sprites/backgrounds/gs2/World_Map_Shore.gif",category:"backgrounds-gs2",subcategory:null},{name:"Yampi Desert",path:"/sprites/backgrounds/gs2/Yampi_Desert.gif",category:"backgrounds-gs2",subcategory:null},{name:"fallen Felix",path:"/sprites/overworld/protagonists/fallen_Felix.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Garet",path:"/sprites/overworld/protagonists/fallen_Garet.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Isaac",path:"/sprites/overworld/protagonists/fallen_Isaac.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Isaac 2",path:"/sprites/overworld/protagonists/fallen_Isaac_2.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Ivan",path:"/sprites/overworld/protagonists/fallen_Ivan.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Ivan 2",path:"/sprites/overworld/protagonists/fallen_Ivan_2.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Jenna",path:"/sprites/overworld/protagonists/fallen_Jenna.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Mia",path:"/sprites/overworld/protagonists/fallen_Mia.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Piers",path:"/sprites/overworld/protagonists/fallen_Piers.gif",category:"overworld-protagonists",subcategory:null},{name:"fallen Sheba",path:"/sprites/overworld/protagonists/fallen_Sheba.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix",path:"/sprites/overworld/protagonists/Felix.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix Back",path:"/sprites/overworld/protagonists/Felix_Back.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix Checkarm",path:"/sprites/overworld/protagonists/Felix_Checkarm.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix Checkleg",path:"/sprites/overworld/protagonists/Felix_Checkleg.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix Checkleg2",path:"/sprites/overworld/protagonists/Felix_Checkleg2.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix E",path:"/sprites/overworld/protagonists/Felix_E.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix NE",path:"/sprites/overworld/protagonists/Felix_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix NW",path:"/sprites/overworld/protagonists/Felix_NW.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix Run",path:"/sprites/overworld/protagonists/Felix_Run.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix SE",path:"/sprites/overworld/protagonists/Felix_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix Situp",path:"/sprites/overworld/protagonists/Felix_Situp.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix SW",path:"/sprites/overworld/protagonists/Felix_SW.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix W",path:"/sprites/overworld/protagonists/Felix_W.gif",category:"overworld-protagonists",subcategory:null},{name:"Felix Walk",path:"/sprites/overworld/protagonists/Felix_Walk.gif",category:"overworld-protagonists",subcategory:null},{name:"Garet",path:"/sprites/overworld/protagonists/Garet.gif",category:"overworld-protagonists",subcategory:null},{name:"Garet Back",path:"/sprites/overworld/protagonists/Garet_Back.gif",category:"overworld-protagonists",subcategory:null},{name:"Garet Left",path:"/sprites/overworld/protagonists/Garet_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Garet NE",path:"/sprites/overworld/protagonists/Garet_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Garet NW",path:"/sprites/overworld/protagonists/Garet_NW.gif",category:"overworld-protagonists",subcategory:null},{name:"Garet Right",path:"/sprites/overworld/protagonists/Garet_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Garet SE",path:"/sprites/overworld/protagonists/Garet_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Garet SW",path:"/sprites/overworld/protagonists/Garet_SW.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac",path:"/sprites/overworld/protagonists/Isaac.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Back",path:"/sprites/overworld/protagonists/Isaac_Back.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Left",path:"/sprites/overworld/protagonists/Isaac_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac NE",path:"/sprites/overworld/protagonists/Isaac_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac NW",path:"/sprites/overworld/protagonists/Isaac_NW.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Right",path:"/sprites/overworld/protagonists/Isaac_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Run",path:"/sprites/overworld/protagonists/Isaac_Run.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Run Left",path:"/sprites/overworld/protagonists/Isaac_Run_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Run NE",path:"/sprites/overworld/protagonists/Isaac_Run_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Run NW",path:"/sprites/overworld/protagonists/Isaac_Run_NW.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Run Right",path:"/sprites/overworld/protagonists/Isaac_Run_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Run SE",path:"/sprites/overworld/protagonists/Isaac_Run_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Run SW",path:"/sprites/overworld/protagonists/Isaac_Run_SW.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Run Up",path:"/sprites/overworld/protagonists/Isaac_Run_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac SE",path:"/sprites/overworld/protagonists/Isaac_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac SW",path:"/sprites/overworld/protagonists/Isaac_SW.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac TossCoin",path:"/sprites/overworld/protagonists/Isaac_TossCoin.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Walk",path:"/sprites/overworld/protagonists/Isaac_Walk.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Walk Left",path:"/sprites/overworld/protagonists/Isaac_Walk_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Walk NE",path:"/sprites/overworld/protagonists/Isaac_Walk_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Walk NW",path:"/sprites/overworld/protagonists/Isaac_Walk_NW.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Walk Right",path:"/sprites/overworld/protagonists/Isaac_Walk_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Walk SE",path:"/sprites/overworld/protagonists/Isaac_Walk_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Walk SW",path:"/sprites/overworld/protagonists/Isaac_Walk_SW.gif",category:"overworld-protagonists",subcategory:null},{name:"Isaac Walk Up",path:"/sprites/overworld/protagonists/Isaac_Walk_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Ivan",path:"/sprites/overworld/protagonists/Ivan.gif",category:"overworld-protagonists",subcategory:null},{name:"Ivan Back",path:"/sprites/overworld/protagonists/Ivan_Back.gif",category:"overworld-protagonists",subcategory:null},{name:"Ivan Left",path:"/sprites/overworld/protagonists/Ivan_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Ivan NE",path:"/sprites/overworld/protagonists/Ivan_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Ivan NW",path:"/sprites/overworld/protagonists/Ivan_NW.gif",category:"overworld-protagonists",subcategory:null},{name:"Ivan Right",path:"/sprites/overworld/protagonists/Ivan_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Ivan SE",path:"/sprites/overworld/protagonists/Ivan_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Ivan SW",path:"/sprites/overworld/protagonists/Ivan_SW.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna",path:"/sprites/overworld/protagonists/Jenna.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna Back",path:"/sprites/overworld/protagonists/Jenna_Back.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna Left",path:"/sprites/overworld/protagonists/Jenna_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna NE",path:"/sprites/overworld/protagonists/Jenna_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna NW",path:"/sprites/overworld/protagonists/Jenna_NW.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna Right",path:"/sprites/overworld/protagonists/Jenna_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna Run",path:"/sprites/overworld/protagonists/Jenna_Run.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna SE",path:"/sprites/overworld/protagonists/Jenna_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna SW",path:"/sprites/overworld/protagonists/Jenna_SW.gif",category:"overworld-protagonists",subcategory:null},{name:"Jenna Walk",path:"/sprites/overworld/protagonists/Jenna_Walk.gif",category:"overworld-protagonists",subcategory:null},{name:"Kraden",path:"/sprites/overworld/protagonists/Kraden.gif",category:"overworld-protagonists",subcategory:null},{name:"Kraden Right",path:"/sprites/overworld/protagonists/Kraden_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Kraden Up",path:"/sprites/overworld/protagonists/Kraden_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Kraden Walk Down",path:"/sprites/overworld/protagonists/Kraden_Walk_Down.gif",category:"overworld-protagonists",subcategory:null},{name:"Kraden Walk Right",path:"/sprites/overworld/protagonists/Kraden_Walk_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Kraden Walk Up",path:"/sprites/overworld/protagonists/Kraden_Walk_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia",path:"/sprites/overworld/protagonists/Mia.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia Back",path:"/sprites/overworld/protagonists/Mia_Back.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia Kneel",path:"/sprites/overworld/protagonists/Mia_Kneel.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia Left",path:"/sprites/overworld/protagonists/Mia_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia NE",path:"/sprites/overworld/protagonists/Mia_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia NW",path:"/sprites/overworld/protagonists/Mia_NW.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia Right",path:"/sprites/overworld/protagonists/Mia_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia SE",path:"/sprites/overworld/protagonists/Mia_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Mia SW",path:"/sprites/overworld/protagonists/Mia_SW.gif",category:"overworld-protagonists",subcategory:null},{name:"Piers",path:"/sprites/overworld/protagonists/Piers.gif",category:"overworld-protagonists",subcategory:null},{name:"Sheba",path:"/sprites/overworld/protagonists/Sheba.gif",category:"overworld-protagonists",subcategory:null},{name:"Sheba Situp",path:"/sprites/overworld/protagonists/Sheba_Situp.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet",path:"/sprites/overworld/protagonists/Young_Garet.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet NE",path:"/sprites/overworld/protagonists/Young_Garet_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet Right",path:"/sprites/overworld/protagonists/Young_Garet_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet SE",path:"/sprites/overworld/protagonists/Young_Garet_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet Up",path:"/sprites/overworld/protagonists/Young_Garet_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet Walk Down",path:"/sprites/overworld/protagonists/Young_Garet_Walk_Down.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet Walk NE",path:"/sprites/overworld/protagonists/Young_Garet_Walk_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet Walk Right",path:"/sprites/overworld/protagonists/Young_Garet_Walk_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet Walk SE",path:"/sprites/overworld/protagonists/Young_Garet_Walk_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Garet Walk Up",path:"/sprites/overworld/protagonists/Young_Garet_Walk_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac",path:"/sprites/overworld/protagonists/Young_Isaac.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac NE",path:"/sprites/overworld/protagonists/Young_Isaac_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac Right",path:"/sprites/overworld/protagonists/Young_Isaac_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac SE",path:"/sprites/overworld/protagonists/Young_Isaac_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac Up",path:"/sprites/overworld/protagonists/Young_Isaac_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac Walk Down",path:"/sprites/overworld/protagonists/Young_Isaac_Walk_Down.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac Walk NE",path:"/sprites/overworld/protagonists/Young_Isaac_Walk_NE.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac Walk Right",path:"/sprites/overworld/protagonists/Young_Isaac_Walk_Right.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac Walk SE",path:"/sprites/overworld/protagonists/Young_Isaac_Walk_SE.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Isaac Walk Up",path:"/sprites/overworld/protagonists/Young_Isaac_Walk_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Jenna",path:"/sprites/overworld/protagonists/Young_Jenna.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Jenna Down",path:"/sprites/overworld/protagonists/Young_Jenna_Down.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Jenna Left",path:"/sprites/overworld/protagonists/Young_Jenna_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Jenna Up",path:"/sprites/overworld/protagonists/Young_Jenna_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Jenna Walk Down",path:"/sprites/overworld/protagonists/Young_Jenna_Walk_Down.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Jenna Walk Left",path:"/sprites/overworld/protagonists/Young_Jenna_Walk_Left.gif",category:"overworld-protagonists",subcategory:null},{name:"Young Jenna Walk Up",path:"/sprites/overworld/protagonists/Young_Jenna_Walk_Up.gif",category:"overworld-protagonists",subcategory:null},{name:"Aaron Jerra",path:"/sprites/overworld/majornpcs/Aaron_Jerra.gif",category:"overworld-majornpcs",subcategory:null},{name:"Akafubu",path:"/sprites/overworld/majornpcs/Akafubu.gif",category:"overworld-majornpcs",subcategory:null},{name:"Armorshop Keeper",path:"/sprites/overworld/majornpcs/Armorshop_Keeper.gif",category:"overworld-majornpcs",subcategory:null},{name:"Armorshop Owner",path:"/sprites/overworld/majornpcs/Armorshop_Owner.gif",category:"overworld-majornpcs",subcategory:null},{name:"Briggs",path:"/sprites/overworld/majornpcs/Briggs.gif",category:"overworld-majornpcs",subcategory:null},{name:"Dojo Leader",path:"/sprites/overworld/majornpcs/Dojo_Leader.gif",category:"overworld-majornpcs",subcategory:null},{name:"Dora",path:"/sprites/overworld/majornpcs/Dora.gif",category:"overworld-majornpcs",subcategory:null},{name:"Elder",path:"/sprites/overworld/majornpcs/Elder.gif",category:"overworld-majornpcs",subcategory:null},{name:"fallen Kraden",path:"/sprites/overworld/majornpcs/fallen_Kraden.gif",category:"overworld-majornpcs",subcategory:null},{name:"fallen Ouranos",path:"/sprites/overworld/majornpcs/fallen_Ouranos.gif",category:"overworld-majornpcs",subcategory:null},{name:"fallen Sean",path:"/sprites/overworld/majornpcs/fallen_Sean.gif",category:"overworld-majornpcs",subcategory:null},{name:"Fiezhi",path:"/sprites/overworld/majornpcs/Fiezhi.gif",category:"overworld-majornpcs",subcategory:null},{name:"Fortune Teller",path:"/sprites/overworld/majornpcs/Fortune_Teller.gif",category:"overworld-majornpcs",subcategory:null},{name:"Great Healer",path:"/sprites/overworld/majornpcs/Great_Healer.gif",category:"overworld-majornpcs",subcategory:null},{name:"Innkeeper",path:"/sprites/overworld/majornpcs/Innkeeper.gif",category:"overworld-majornpcs",subcategory:null},{name:"Innkeepers Wife",path:"/sprites/overworld/majornpcs/Innkeepers_Wife.gif",category:"overworld-majornpcs",subcategory:null},{name:"Innkeeper 2",path:"/sprites/overworld/majornpcs/Innkeeper_2.gif",category:"overworld-majornpcs",subcategory:null},{name:"Kaja",path:"/sprites/overworld/majornpcs/Kaja.gif",category:"overworld-majornpcs",subcategory:null},{name:"Kay Jerra",path:"/sprites/overworld/majornpcs/Kay_Jerra.gif",category:"overworld-majornpcs",subcategory:null},{name:"Kyle",path:"/sprites/overworld/majornpcs/Kyle.gif",category:"overworld-majornpcs",subcategory:null},{name:"Lady Layana",path:"/sprites/overworld/majornpcs/Lady_Layana.gif",category:"overworld-majornpcs",subcategory:null},{name:"Lady McCoy",path:"/sprites/overworld/majornpcs/Lady_McCoy.gif",category:"overworld-majornpcs",subcategory:null},{name:"Laurel Asleep",path:"/sprites/overworld/majornpcs/Laurel_Asleep.gif",category:"overworld-majornpcs",subcategory:null},{name:"Laurel Awake",path:"/sprites/overworld/majornpcs/Laurel_Awake.gif",category:"overworld-majornpcs",subcategory:null},{name:"Lord Hammet",path:"/sprites/overworld/majornpcs/Lord_Hammet.gif",category:"overworld-majornpcs",subcategory:null},{name:"Lord McCoy",path:"/sprites/overworld/majornpcs/Lord_McCoy.gif",category:"overworld-majornpcs",subcategory:null},{name:"Maha",path:"/sprites/overworld/majornpcs/Maha.gif",category:"overworld-majornpcs",subcategory:null},{name:"Master Poi",path:"/sprites/overworld/majornpcs/Master_Poi.gif",category:"overworld-majornpcs",subcategory:null},{name:"Mrs Jerra",path:"/sprites/overworld/majornpcs/Mrs_Jerra.gif",category:"overworld-majornpcs",subcategory:null},{name:"Mr Jerra",path:"/sprites/overworld/majornpcs/Mr_Jerra.gif",category:"overworld-majornpcs",subcategory:null},{name:"Ouranos",path:"/sprites/overworld/majornpcs/Ouranos.gif",category:"overworld-majornpcs",subcategory:null},{name:"Potionshop Keeper",path:"/sprites/overworld/majornpcs/Potionshop_Keeper.gif",category:"overworld-majornpcs",subcategory:null},{name:"Potionshop Owner",path:"/sprites/overworld/majornpcs/Potionshop_Owner.gif",category:"overworld-majornpcs",subcategory:null},{name:"Prox Elder",path:"/sprites/overworld/majornpcs/Prox_Elder.gif",category:"overworld-majornpcs",subcategory:null},{name:"Puelle",path:"/sprites/overworld/majornpcs/Puelle.gif",category:"overworld-majornpcs",subcategory:null},{name:"Sean",path:"/sprites/overworld/majornpcs/Sean.gif",category:"overworld-majornpcs",subcategory:null},{name:"Sea Captain",path:"/sprites/overworld/majornpcs/Sea_Captain.gif",category:"overworld-majornpcs",subcategory:null},{name:"Sunshine",path:"/sprites/overworld/majornpcs/Sunshine.gif",category:"overworld-majornpcs",subcategory:null},{name:"Susa",path:"/sprites/overworld/majornpcs/Susa.gif",category:"overworld-majornpcs",subcategory:null},{name:"Susa Right",path:"/sprites/overworld/majornpcs/Susa_Right.gif",category:"overworld-majornpcs",subcategory:null},{name:"Susa Up",path:"/sprites/overworld/majornpcs/Susa_Up.gif",category:"overworld-majornpcs",subcategory:null},{name:"Susa Walk",path:"/sprites/overworld/majornpcs/Susa_Walk.gif",category:"overworld-majornpcs",subcategory:null},{name:"Susa Walk Right",path:"/sprites/overworld/majornpcs/Susa_Walk_Right.gif",category:"overworld-majornpcs",subcategory:null},{name:"Susa Walk Up",path:"/sprites/overworld/majornpcs/Susa_Walk_Up.gif",category:"overworld-majornpcs",subcategory:null},{name:"Thief1",path:"/sprites/overworld/majornpcs/Thief1.gif",category:"overworld-majornpcs",subcategory:null},{name:"Tret Asleep",path:"/sprites/overworld/majornpcs/Tret_Asleep.gif",category:"overworld-majornpcs",subcategory:null},{name:"Tret Awake",path:"/sprites/overworld/majornpcs/Tret_Awake.gif",category:"overworld-majornpcs",subcategory:null},{name:"Weaponshop Keeper",path:"/sprites/overworld/majornpcs/Weaponshop_Keeper.gif",category:"overworld-majornpcs",subcategory:null},{name:"Weaponshop Owner",path:"/sprites/overworld/majornpcs/Weaponshop_Owner.gif",category:"overworld-majornpcs",subcategory:null},{name:"Wise One",path:"/sprites/overworld/majornpcs/Wise_One.gif",category:"overworld-majornpcs",subcategory:null},{name:"Wise One 2",path:"/sprites/overworld/majornpcs/Wise_One_2.gif",category:"overworld-majornpcs",subcategory:null},{name:"Wise One Glare",path:"/sprites/overworld/majornpcs/Wise_One_Glare.gif",category:"overworld-majornpcs",subcategory:null},{name:"Wise One Lookaround",path:"/sprites/overworld/majornpcs/Wise_One_Lookaround.gif",category:"overworld-majornpcs",subcategory:null},{name:"Wise One Spin",path:"/sprites/overworld/majornpcs/Wise_One_Spin.gif",category:"overworld-majornpcs",subcategory:null},{name:"Artifacts",path:"/sprites/icons/buttons/Artifacts.gif",category:"icons-buttons",subcategory:null},{name:"Attack",path:"/sprites/icons/buttons/Attack.gif",category:"icons-buttons",subcategory:null},{name:"Battle",path:"/sprites/icons/buttons/Battle.gif",category:"icons-buttons",subcategory:null},{name:"Bronze Password",path:"/sprites/icons/buttons/Bronze_Password.gif",category:"icons-buttons",subcategory:null},{name:"Buy",path:"/sprites/icons/buttons/Buy.gif",category:"icons-buttons",subcategory:null},{name:"Coins",path:"/sprites/icons/buttons/Coins.gif",category:"icons-buttons",subcategory:null},{name:"Continue",path:"/sprites/icons/buttons/Continue.gif",category:"icons-buttons",subcategory:null},{name:"Copy File",path:"/sprites/icons/buttons/Copy_File.gif",category:"icons-buttons",subcategory:null},{name:"Cure Poison",path:"/sprites/icons/buttons/Cure_Poison.gif",category:"icons-buttons",subcategory:null},{name:"Defend",path:"/sprites/icons/buttons/Defend.gif",category:"icons-buttons",subcategory:null},{name:"Djinni",path:"/sprites/icons/buttons/Djinni.gif",category:"icons-buttons",subcategory:null},{name:"Erase File",path:"/sprites/icons/buttons/Erase_File.gif",category:"icons-buttons",subcategory:null},{name:"Fight",path:"/sprites/icons/buttons/Fight.gif",category:"icons-buttons",subcategory:null},{name:"Flee",path:"/sprites/icons/buttons/Flee.gif",category:"icons-buttons",subcategory:null},{name:"Gold Password",path:"/sprites/icons/buttons/Gold_Password.gif",category:"icons-buttons",subcategory:null},{name:"Item",path:"/sprites/icons/buttons/Item.gif",category:"icons-buttons",subcategory:null},{name:"Link Cable",path:"/sprites/icons/buttons/Link_Cable.gif",category:"icons-buttons",subcategory:null},{name:"Lucky Medals",path:"/sprites/icons/buttons/Lucky_Medals.gif",category:"icons-buttons",subcategory:null},{name:"New Quest",path:"/sprites/icons/buttons/New_Quest.gif",category:"icons-buttons",subcategory:null},{name:"no",path:"/sprites/icons/buttons/no.gif",category:"icons-buttons",subcategory:null},{name:"Options",path:"/sprites/icons/buttons/Options.gif",category:"icons-buttons",subcategory:null},{name:"Options2",path:"/sprites/icons/buttons/Options2.gif",category:"icons-buttons",subcategory:null},{name:"Password",path:"/sprites/icons/buttons/Password.gif",category:"icons-buttons",subcategory:null},{name:"Psynergy",path:"/sprites/icons/buttons/Psynergy.gif",category:"icons-buttons",subcategory:null},{name:"Remove Curse",path:"/sprites/icons/buttons/Remove_Curse.gif",category:"icons-buttons",subcategory:null},{name:"Repair",path:"/sprites/icons/buttons/Repair.gif",category:"icons-buttons",subcategory:null},{name:"Repel Evil",path:"/sprites/icons/buttons/Repel_Evil.gif",category:"icons-buttons",subcategory:null},{name:"Revive",path:"/sprites/icons/buttons/Revive.gif",category:"icons-buttons",subcategory:null},{name:"Run",path:"/sprites/icons/buttons/Run.gif",category:"icons-buttons",subcategory:null},{name:"Save Game",path:"/sprites/icons/buttons/Save_Game.gif",category:"icons-buttons",subcategory:null},{name:"Save Game2",path:"/sprites/icons/buttons/Save_Game2.gif",category:"icons-buttons",subcategory:null},{name:"Sell",path:"/sprites/icons/buttons/Sell.gif",category:"icons-buttons",subcategory:null},{name:"Send",path:"/sprites/icons/buttons/Send.gif",category:"icons-buttons",subcategory:null},{name:"Silver Password",path:"/sprites/icons/buttons/Silver_Password.gif",category:"icons-buttons",subcategory:null},{name:"Sleep",path:"/sprites/icons/buttons/Sleep.gif",category:"icons-buttons",subcategory:null},{name:"Sleep2",path:"/sprites/icons/buttons/Sleep2.gif",category:"icons-buttons",subcategory:null},{name:"Sleep Mode Off",path:"/sprites/icons/buttons/Sleep_Mode_Off.gif",category:"icons-buttons",subcategory:null},{name:"Sleep Mode Off2",path:"/sprites/icons/buttons/Sleep_Mode_Off2.gif",category:"icons-buttons",subcategory:null},{name:"Sleep Mode On",path:"/sprites/icons/buttons/Sleep_Mode_On.gif",category:"icons-buttons",subcategory:null},{name:"Sleep Mode On2",path:"/sprites/icons/buttons/Sleep_Mode_On2.gif",category:"icons-buttons",subcategory:null},{name:"Speech Off",path:"/sprites/icons/buttons/Speech_Off.gif",category:"icons-buttons",subcategory:null},{name:"Speech Off2",path:"/sprites/icons/buttons/Speech_Off2.gif",category:"icons-buttons",subcategory:null},{name:"Speech On",path:"/sprites/icons/buttons/Speech_On.gif",category:"icons-buttons",subcategory:null},{name:"Speech On2",path:"/sprites/icons/buttons/Speech_On2.gif",category:"icons-buttons",subcategory:null},{name:"Status",path:"/sprites/icons/buttons/Status.gif",category:"icons-buttons",subcategory:null},{name:"Summon",path:"/sprites/icons/buttons/Summon.gif",category:"icons-buttons",subcategory:null},{name:"Switch",path:"/sprites/icons/buttons/Switch.gif",category:"icons-buttons",subcategory:null},{name:"Text Speed Fast",path:"/sprites/icons/buttons/Text_Speed_Fast.gif",category:"icons-buttons",subcategory:null},{name:"Text Speed Fast2",path:"/sprites/icons/buttons/Text_Speed_Fast2.gif",category:"icons-buttons",subcategory:null},{name:"Text Speed Medium",path:"/sprites/icons/buttons/Text_Speed_Medium.gif",category:"icons-buttons",subcategory:null},{name:"Text Speed Medium2",path:"/sprites/icons/buttons/Text_Speed_Medium2.gif",category:"icons-buttons",subcategory:null},{name:"Text Speed Slow",path:"/sprites/icons/buttons/Text_Speed_Slow.gif",category:"icons-buttons",subcategory:null},{name:"Text Speed Slow2",path:"/sprites/icons/buttons/Text_Speed_Slow2.gif",category:"icons-buttons",subcategory:null},{name:"transfer file",path:"/sprites/icons/buttons/transfer_file.gif",category:"icons-buttons",subcategory:null},{name:"yes",path:"/sprites/icons/buttons/yes.gif",category:"icons-buttons",subcategory:null},{name:"Aaron Jerra",path:"/sprites/icons/characters/Aaron_Jerra.gif",category:"icons-characters",subcategory:null},{name:"Agatio",path:"/sprites/icons/characters/Agatio.gif",category:"icons-characters",subcategory:null},{name:"Akafubu",path:"/sprites/icons/characters/Akafubu.gif",category:"icons-characters",subcategory:null},{name:"Alex",path:"/sprites/icons/characters/Alex.gif",category:"icons-characters",subcategory:null},{name:"Armor Shopkeeper",path:"/sprites/icons/characters/Armor_Shopkeeper.gif",category:"icons-characters",subcategory:null},{name:"Armor Shopkeeper2",path:"/sprites/icons/characters/Armor_Shopkeeper2.gif",category:"icons-characters",subcategory:null},{name:"Armor Shopkeeper 2",path:"/sprites/icons/characters/Armor_Shopkeeper_2.gif",category:"icons-characters",subcategory:null},{name:"Babi",path:"/sprites/icons/characters/Babi.gif",category:"icons-characters",subcategory:null},{name:"Briggs",path:"/sprites/icons/characters/Briggs.gif",category:"icons-characters",subcategory:null},{name:"Champa Shopkeeper",path:"/sprites/icons/characters/Champa_Shopkeeper.gif",category:"icons-characters",subcategory:null},{name:"Chaucha",path:"/sprites/icons/characters/Chaucha.gif",category:"icons-characters",subcategory:null},{name:"Conservato",path:"/sprites/icons/characters/Conservato.gif",category:"icons-characters",subcategory:null},{name:"Dodonpa",path:"/sprites/icons/characters/Dodonpa.gif",category:"icons-characters",subcategory:null},{name:"Dojo Leader",path:"/sprites/icons/characters/Dojo_Leader.gif",category:"icons-characters",subcategory:null},{name:"Donpa",path:"/sprites/icons/characters/Donpa.gif",category:"icons-characters",subcategory:null},{name:"Dora",path:"/sprites/icons/characters/Dora.gif",category:"icons-characters",subcategory:null},{name:"Elder",path:"/sprites/icons/characters/Elder.gif",category:"icons-characters",subcategory:null},{name:"Elder of Madra",path:"/sprites/icons/characters/Elder_of_Madra.gif",category:"icons-characters",subcategory:null},{name:"Eoleo",path:"/sprites/icons/characters/Eoleo.gif",category:"icons-characters",subcategory:null},{name:"Faran",path:"/sprites/icons/characters/Faran.gif",category:"icons-characters",subcategory:null},{name:"Felix1",path:"/sprites/icons/characters/Felix1.gif",category:"icons-characters",subcategory:null},{name:"Felix2",path:"/sprites/icons/characters/Felix2.gif",category:"icons-characters",subcategory:null},{name:"Fiezhi",path:"/sprites/icons/characters/Fiezhi.gif",category:"icons-characters",subcategory:null},{name:"Fortune Teller",path:"/sprites/icons/characters/Fortune_Teller.gif",category:"icons-characters",subcategory:null},{name:"Fortune Teller2",path:"/sprites/icons/characters/Fortune_Teller2.gif",category:"icons-characters",subcategory:null},{name:"frame",path:"/sprites/icons/characters/frame.gif",category:"icons-characters",subcategory:null},{name:"Garet's Grandfather",path:"/sprites/icons/characters/Garet's_Grandfather.gif",category:"icons-characters",subcategory:null},{name:"Garet's Grandmother",path:"/sprites/icons/characters/Garet's_Grandmother.gif",category:"icons-characters",subcategory:null},{name:"Garet1",path:"/sprites/icons/characters/Garet1.gif",category:"icons-characters",subcategory:null},{name:"Garet2",path:"/sprites/icons/characters/Garet2.gif",category:"icons-characters",subcategory:null},{name:"GreatHealer",path:"/sprites/icons/characters/GreatHealer.gif",category:"icons-characters",subcategory:null},{name:"Hsu",path:"/sprites/icons/characters/Hsu.gif",category:"icons-characters",subcategory:null},{name:"Innkeeper",path:"/sprites/icons/characters/Innkeeper.gif",category:"icons-characters",subcategory:null},{name:"Innkeepers Wife",path:"/sprites/icons/characters/Innkeepers_Wife.gif",category:"icons-characters",subcategory:null},{name:"Innkeeper 2",path:"/sprites/icons/characters/Innkeeper_2.gif",category:"icons-characters",subcategory:null},{name:"Innkeeper Wife",path:"/sprites/icons/characters/Innkeeper_Wife.gif",category:"icons-characters",subcategory:null},{name:"Iodem",path:"/sprites/icons/characters/Iodem.gif",category:"icons-characters",subcategory:null},{name:"Isaac1",path:"/sprites/icons/characters/Isaac1.gif",category:"icons-characters",subcategory:null},{name:"Isaac2",path:"/sprites/icons/characters/Isaac2.gif",category:"icons-characters",subcategory:null},{name:"Item Shopkeeper",path:"/sprites/icons/characters/Item_Shopkeeper.gif",category:"icons-characters",subcategory:null},{name:"Ivan",path:"/sprites/icons/characters/Ivan.gif",category:"icons-characters",subcategory:null},{name:"Izumo Innkeeper",path:"/sprites/icons/characters/Izumo_Innkeeper.gif",category:"icons-characters",subcategory:null},{name:"Izumo Innkeepers Wife",path:"/sprites/icons/characters/Izumo_Innkeepers_Wife.gif",category:"icons-characters",subcategory:null},{name:"Izumo Shopkeeper",path:"/sprites/icons/characters/Izumo_Shopkeeper.gif",category:"icons-characters",subcategory:null},{name:"Jenna's Father",path:"/sprites/icons/characters/Jenna's_Father.gif",category:"icons-characters",subcategory:null},{name:"Jenna's Mother",path:"/sprites/icons/characters/Jenna's_Mother.gif",category:"icons-characters",subcategory:null},{name:"Jenna",path:"/sprites/icons/characters/Jenna.gif",category:"icons-characters",subcategory:null},{name:"Jenna1",path:"/sprites/icons/characters/Jenna1.gif",category:"icons-characters",subcategory:null},{name:"Jenna2",path:"/sprites/icons/characters/Jenna2.gif",category:"icons-characters",subcategory:null},{name:"Jupiter",path:"/sprites/icons/characters/Jupiter.gif",category:"icons-characters",subcategory:null},{name:"Kaja",path:"/sprites/icons/characters/Kaja.gif",category:"icons-characters",subcategory:null},{name:"Karst",path:"/sprites/icons/characters/Karst.gif",category:"icons-characters",subcategory:null},{name:"Kay Jerra",path:"/sprites/icons/characters/Kay_Jerra.gif",category:"icons-characters",subcategory:null},{name:"King Hydros",path:"/sprites/icons/characters/King_Hydros.gif",category:"icons-characters",subcategory:null},{name:"Kraden",path:"/sprites/icons/characters/Kraden.gif",category:"icons-characters",subcategory:null},{name:"Kushinada",path:"/sprites/icons/characters/Kushinada.gif",category:"icons-characters",subcategory:null},{name:"Kyle",path:"/sprites/icons/characters/Kyle.gif",category:"icons-characters",subcategory:null},{name:"Lady Layana",path:"/sprites/icons/characters/Lady_Layana.gif",category:"icons-characters",subcategory:null},{name:"Laurel",path:"/sprites/icons/characters/Laurel.gif",category:"icons-characters",subcategory:null},{name:"LordMcCoy Wife",path:"/sprites/icons/characters/LordMcCoy_Wife.gif",category:"icons-characters",subcategory:null},{name:"Lord Hammet",path:"/sprites/icons/characters/Lord_Hammet.gif",category:"icons-characters",subcategory:null},{name:"Lord McCoy",path:"/sprites/icons/characters/Lord_McCoy.gif",category:"icons-characters",subcategory:null},{name:"Lunpa",path:"/sprites/icons/characters/Lunpa.gif",category:"icons-characters",subcategory:null},{name:"Maha",path:"/sprites/icons/characters/Maha.gif",category:"icons-characters",subcategory:null},{name:"Mars",path:"/sprites/icons/characters/Mars.gif",category:"icons-characters",subcategory:null},{name:"Master Hama",path:"/sprites/icons/characters/Master_Hama.gif",category:"icons-characters",subcategory:null},{name:"Master Poi",path:"/sprites/icons/characters/Master_Poi.gif",category:"icons-characters",subcategory:null},{name:"Mayor of Alhafra",path:"/sprites/icons/characters/Mayor_of_Alhafra.gif",category:"icons-characters",subcategory:null},{name:"Mayor of Madra",path:"/sprites/icons/characters/Mayor_of_Madra.gif",category:"icons-characters",subcategory:null},{name:"Menardi",path:"/sprites/icons/characters/Menardi.gif",category:"icons-characters",subcategory:null},{name:"Mercury",path:"/sprites/icons/characters/Mercury.gif",category:"icons-characters",subcategory:null},{name:"Mia",path:"/sprites/icons/characters/Mia.gif",category:"icons-characters",subcategory:null},{name:"Moapa",path:"/sprites/icons/characters/Moapa.gif",category:"icons-characters",subcategory:null},{name:"MrJerra",path:"/sprites/icons/characters/MrJerra.gif",category:"icons-characters",subcategory:null},{name:"MrsJerra",path:"/sprites/icons/characters/MrsJerra.gif",category:"icons-characters",subcategory:null},{name:"Nyunpa",path:"/sprites/icons/characters/Nyunpa.gif",category:"icons-characters",subcategory:null},{name:"Obaba",path:"/sprites/icons/characters/Obaba.gif",category:"icons-characters",subcategory:null},{name:"Ouranos",path:"/sprites/icons/characters/Ouranos.gif",category:"icons-characters",subcategory:null},{name:"Picard",path:"/sprites/icons/characters/Picard.gif",category:"icons-characters",subcategory:null},{name:"Potion Shopkeeper",path:"/sprites/icons/characters/Potion_Shopkeeper.gif",category:"icons-characters",subcategory:null},{name:"Potion Shopkeeper 2",path:"/sprites/icons/characters/Potion_Shopkeeper_2.gif",category:"icons-characters",subcategory:null},{name:"Prox Elder",path:"/sprites/icons/characters/Prox_Elder.gif",category:"icons-characters",subcategory:null},{name:"Puelle",path:"/sprites/icons/characters/Puelle.gif",category:"icons-characters",subcategory:null},{name:"Riki",path:"/sprites/icons/characters/Riki.gif",category:"icons-characters",subcategory:null},{name:"Saturos",path:"/sprites/icons/characters/Saturos.gif",category:"icons-characters",subcategory:null},{name:"Sean",path:"/sprites/icons/characters/Sean.gif",category:"icons-characters",subcategory:null},{name:"Sea Captain",path:"/sprites/icons/characters/Sea_Captain.gif",category:"icons-characters",subcategory:null},{name:"Shadow Babi",path:"/sprites/icons/characters/Shadow_Babi.gif",category:"icons-characters",subcategory:null},{name:"Sheba",path:"/sprites/icons/characters/Sheba.gif",category:"icons-characters",subcategory:null},{name:"Sunshine",path:"/sprites/icons/characters/Sunshine.gif",category:"icons-characters",subcategory:null},{name:"Susa",path:"/sprites/icons/characters/Susa.gif",category:"icons-characters",subcategory:null},{name:"Tavi",path:"/sprites/icons/characters/Tavi.gif",category:"icons-characters",subcategory:null},{name:"Tret1",path:"/sprites/icons/characters/Tret1.gif",category:"icons-characters",subcategory:null},{name:"Tret2",path:"/sprites/icons/characters/Tret2.gif",category:"icons-characters",subcategory:null},{name:"Unidentified",path:"/sprites/icons/characters/Unidentified.gif",category:"icons-characters",subcategory:null},{name:"Uzume",path:"/sprites/icons/characters/Uzume.gif",category:"icons-characters",subcategory:null},{name:"Venus",path:"/sprites/icons/characters/Venus.gif",category:"icons-characters",subcategory:null},{name:"Weapon Shopkeeper",path:"/sprites/icons/characters/Weapon_Shopkeeper.gif",category:"icons-characters",subcategory:null},{name:"Weapon Shopkeeper 2",path:"/sprites/icons/characters/Weapon_Shopkeeper_2.gif",category:"icons-characters",subcategory:null},{name:"Young Felix",path:"/sprites/icons/characters/Young_Felix.gif",category:"icons-characters",subcategory:null},{name:"Angel Spear",path:"/sprites/icons/psynergy/Angel_Spear.gif",category:"icons-psynergy",subcategory:null},{name:"Annihalation",path:"/sprites/icons/psynergy/Annihalation.gif",category:"icons-psynergy",subcategory:null},{name:"Arrow",path:"/sprites/icons/psynergy/Arrow.gif",category:"icons-psynergy",subcategory:null},{name:"Astral Blast",path:"/sprites/icons/psynergy/Astral_Blast.gif",category:"icons-psynergy",subcategory:null},{name:"Aura",path:"/sprites/icons/psynergy/Aura.gif",category:"icons-psynergy",subcategory:null},{name:"Avalanche",path:"/sprites/icons/psynergy/Avalanche.gif",category:"icons-psynergy",subcategory:null},{name:"Avoid",path:"/sprites/icons/psynergy/Avoid.gif",category:"icons-psynergy",subcategory:null},{name:"Backstab",path:"/sprites/icons/psynergy/Backstab.gif",category:"icons-psynergy",subcategory:null},{name:"Baffle Card",path:"/sprites/icons/psynergy/Baffle_Card.gif",category:"icons-psynergy",subcategory:null},{name:"Beam",path:"/sprites/icons/psynergy/Beam.gif",category:"icons-psynergy",subcategory:null},{name:"Bind",path:"/sprites/icons/psynergy/Bind.gif",category:"icons-psynergy",subcategory:null},{name:"Blast1",path:"/sprites/icons/psynergy/Blast1.gif",category:"icons-psynergy",subcategory:null},{name:"Blast2",path:"/sprites/icons/psynergy/Blast2.gif",category:"icons-psynergy",subcategory:null},{name:"Blaze",path:"/sprites/icons/psynergy/Blaze.gif",category:"icons-psynergy",subcategory:null},{name:"Blue Bolt",path:"/sprites/icons/psynergy/Blue_Bolt.gif",category:"icons-psynergy",subcategory:null},{name:"Blunt",path:"/sprites/icons/psynergy/Blunt.gif",category:"icons-psynergy",subcategory:null},{name:"Bolt",path:"/sprites/icons/psynergy/Bolt.gif",category:"icons-psynergy",subcategory:null},{name:"Bramble Card",path:"/sprites/icons/psynergy/Bramble_Card.gif",category:"icons-psynergy",subcategory:null},{name:"Break",path:"/sprites/icons/psynergy/Break.gif",category:"icons-psynergy",subcategory:null},{name:"Briar",path:"/sprites/icons/psynergy/Briar.gif",category:"icons-psynergy",subcategory:null},{name:"Burst",path:"/sprites/icons/psynergy/Burst.gif",category:"icons-psynergy",subcategory:null},{name:"Call Demon",path:"/sprites/icons/psynergy/Call_Demon.gif",category:"icons-psynergy",subcategory:null},{name:"Call Dullahan",path:"/sprites/icons/psynergy/Call_Dullahan.gif",category:"icons-psynergy",subcategory:null},{name:"Call Zombie",path:"/sprites/icons/psynergy/Call_Zombie.gif",category:"icons-psynergy",subcategory:null},{name:"Carpet Bomb",path:"/sprites/icons/psynergy/Carpet_Bomb.gif",category:"icons-psynergy",subcategory:null},{name:"Carry",path:"/sprites/icons/psynergy/Carry.gif",category:"icons-psynergy",subcategory:null},{name:"Catch",path:"/sprites/icons/psynergy/Catch.gif",category:"icons-psynergy",subcategory:null},{name:"Cerberus",path:"/sprites/icons/psynergy/Cerberus.gif",category:"icons-psynergy",subcategory:null},{name:"Chimera",path:"/sprites/icons/psynergy/Chimera.gif",category:"icons-psynergy",subcategory:null},{name:"Clay Spire",path:"/sprites/icons/psynergy/Clay Spire.gif",category:"icons-psynergy",subcategory:null},{name:"Cloak",path:"/sprites/icons/psynergy/Cloak.gif",category:"icons-psynergy",subcategory:null},{name:"Cluster Bomb",path:"/sprites/icons/psynergy/Cluster_Bomb.gif",category:"icons-psynergy",subcategory:null},{name:"Condemn",path:"/sprites/icons/psynergy/Condemn.gif",category:"icons-psynergy",subcategory:null},{name:"Cool",path:"/sprites/icons/psynergy/Cool.gif",category:"icons-psynergy",subcategory:null},{name:"Cool Aura",path:"/sprites/icons/psynergy/Cool_Aura.gif",category:"icons-psynergy",subcategory:null},{name:"Cure",path:"/sprites/icons/psynergy/Cure.gif",category:"icons-psynergy",subcategory:null},{name:"Cure Poison",path:"/sprites/icons/psynergy/Cure_Poison.gif",category:"icons-psynergy",subcategory:null},{name:"Cure Well",path:"/sprites/icons/psynergy/Cure_Well.gif",category:"icons-psynergy",subcategory:null},{name:"Curse",path:"/sprites/icons/psynergy/Curse.gif",category:"icons-psynergy",subcategory:null},{name:"Cutting Edge",path:"/sprites/icons/psynergy/Cutting_Edge.gif",category:"icons-psynergy",subcategory:null},{name:"Cycle Beam",path:"/sprites/icons/psynergy/Cycle_Beam.gif",category:"icons-psynergy",subcategory:null},{name:"Cyclone",path:"/sprites/icons/psynergy/Cyclone.gif",category:"icons-psynergy",subcategory:null},{name:"Death Card",path:"/sprites/icons/psynergy/Death_Card.gif",category:"icons-psynergy",subcategory:null},{name:"Death Leap",path:"/sprites/icons/psynergy/Death_Leap.gif",category:"icons-psynergy",subcategory:null},{name:"Death Plunge",path:"/sprites/icons/psynergy/Death_Plunge.gif",category:"icons-psynergy",subcategory:null},{name:"Debilitate",path:"/sprites/icons/psynergy/Debilitate.gif",category:"icons-psynergy",subcategory:null},{name:"Delude",path:"/sprites/icons/psynergy/Delude.gif",category:"icons-psynergy",subcategory:null},{name:"Deluge",path:"/sprites/icons/psynergy/Deluge.gif",category:"icons-psynergy",subcategory:null},{name:"Demon Night",path:"/sprites/icons/psynergy/Demon_Night.gif",category:"icons-psynergy",subcategory:null},{name:"Demon Spear",path:"/sprites/icons/psynergy/Demon_Spear.gif",category:"icons-psynergy",subcategory:null},{name:"Destruct Ray",path:"/sprites/icons/psynergy/Destruct_Ray.gif",category:"icons-psynergy",subcategory:null},{name:"Diamond Berg",path:"/sprites/icons/psynergy/Diamond_Berg.gif",category:"icons-psynergy",subcategory:null},{name:"Diamond Dust",path:"/sprites/icons/psynergy/Diamond_Dust.gif",category:"icons-psynergy",subcategory:null},{name:"Dinox",path:"/sprites/icons/psynergy/Dinox.gif",category:"icons-psynergy",subcategory:null},{name:"Dire Inferno",path:"/sprites/icons/psynergy/Dire_Inferno.gif",category:"icons-psynergy",subcategory:null},{name:"Douse",path:"/sprites/icons/psynergy/Douse.gif",category:"icons-psynergy",subcategory:null},{name:"Dragon Fire",path:"/sprites/icons/psynergy/Dragon_Fire.gif",category:"icons-psynergy",subcategory:null},{name:"Dragon Fume",path:"/sprites/icons/psynergy/Dragon_Fume.gif",category:"icons-psynergy",subcategory:null},{name:"Drain",path:"/sprites/icons/psynergy/Drain.gif",category:"icons-psynergy",subcategory:null},{name:"Drench",path:"/sprites/icons/psynergy/Drench.gif",category:"icons-psynergy",subcategory:null},{name:"Dull",path:"/sprites/icons/psynergy/Dull.gif",category:"icons-psynergy",subcategory:null},{name:"Earthquake",path:"/sprites/icons/psynergy/Earthquake.gif",category:"icons-psynergy",subcategory:null},{name:"Emu",path:"/sprites/icons/psynergy/Emu.gif",category:"icons-psynergy",subcategory:null},{name:"Enfeeble",path:"/sprites/icons/psynergy/Enfeeble.gif",category:"icons-psynergy",subcategory:null},{name:"Epicenter",path:"/sprites/icons/psynergy/Epicenter.gif",category:"icons-psynergy",subcategory:null},{name:"Eruption",path:"/sprites/icons/psynergy/Eruption.gif",category:"icons-psynergy",subcategory:null},{name:"Fiery Abyss",path:"/sprites/icons/psynergy/Fiery_Abyss.gif",category:"icons-psynergy",subcategory:null},{name:"Fiery Blast",path:"/sprites/icons/psynergy/Fiery_Blast.gif",category:"icons-psynergy",subcategory:null},{name:"Fiery Juggle",path:"/sprites/icons/psynergy/Fiery_Juggle.gif",category:"icons-psynergy",subcategory:null},{name:"Fire",path:"/sprites/icons/psynergy/Fire.gif",category:"icons-psynergy",subcategory:null},{name:"Fireball",path:"/sprites/icons/psynergy/Fireball.gif",category:"icons-psynergy",subcategory:null},{name:"Fire Bomb",path:"/sprites/icons/psynergy/Fire_Bomb.gif",category:"icons-psynergy",subcategory:null},{name:"Fire Breath",path:"/sprites/icons/psynergy/Fire_Breath.gif",category:"icons-psynergy",subcategory:null},{name:"Fire Puppet",path:"/sprites/icons/psynergy/Fire_Puppet.gif",category:"icons-psynergy",subcategory:null},{name:"Flame Card",path:"/sprites/icons/psynergy/Flame_Card.gif",category:"icons-psynergy",subcategory:null},{name:"Flare",path:"/sprites/icons/psynergy/Flare.gif",category:"icons-psynergy",subcategory:null},{name:"Flare Storm",path:"/sprites/icons/psynergy/Flare_Storm.gif",category:"icons-psynergy",subcategory:null},{name:"Flare Wall",path:"/sprites/icons/psynergy/Flare_Wall.gif",category:"icons-psynergy",subcategory:null},{name:"Flash Bolt",path:"/sprites/icons/psynergy/Flash_Bolt.gif",category:"icons-psynergy",subcategory:null},{name:"Force",path:"/sprites/icons/psynergy/Force.gif",category:"icons-psynergy",subcategory:null},{name:"Freeze Prism",path:"/sprites/icons/psynergy/Freeze_Prism.gif",category:"icons-psynergy",subcategory:null},{name:"Frost",path:"/sprites/icons/psynergy/Frost.gif",category:"icons-psynergy",subcategory:null},{name:"Frost Card",path:"/sprites/icons/psynergy/Frost_Card.gif",category:"icons-psynergy",subcategory:null},{name:"Froth",path:"/sprites/icons/psynergy/Froth.gif",category:"icons-psynergy",subcategory:null},{name:"Froth Sphere",path:"/sprites/icons/psynergy/Froth_Sphere.gif",category:"icons-psynergy",subcategory:null},{name:"Froth Spiral",path:"/sprites/icons/psynergy/Froth_Spiral.gif",category:"icons-psynergy",subcategory:null},{name:"Fume",path:"/sprites/icons/psynergy/Fume.gif",category:"icons-psynergy",subcategory:null},{name:"Gaia",path:"/sprites/icons/psynergy/Gaia.gif",category:"icons-psynergy",subcategory:null},{name:"Gale",path:"/sprites/icons/psynergy/Gale.gif",category:"icons-psynergy",subcategory:null},{name:"Gaurd",path:"/sprites/icons/psynergy/Gaurd.gif",category:"icons-psynergy",subcategory:null},{name:"Gaurdian",path:"/sprites/icons/psynergy/Gaurdian.gif",category:"icons-psynergy",subcategory:null},{name:"Glacier",path:"/sprites/icons/psynergy/Glacier.gif",category:"icons-psynergy",subcategory:null},{name:"Grand Gaia",path:"/sprites/icons/psynergy/Grand_Gaia.gif",category:"icons-psynergy",subcategory:null},{name:"Grind",path:"/sprites/icons/psynergy/Grind.gif",category:"icons-psynergy",subcategory:null},{name:"Growth",path:"/sprites/icons/psynergy/Growth.gif",category:"icons-psynergy",subcategory:null},{name:"Hail",path:"/sprites/icons/psynergy/Hail.gif",category:"icons-psynergy",subcategory:null},{name:"Hail Prism",path:"/sprites/icons/psynergy/Hail_Prism.gif",category:"icons-psynergy",subcategory:null},{name:"Halt",path:"/sprites/icons/psynergy/Halt.gif",category:"icons-psynergy",subcategory:null},{name:"Haunt",path:"/sprites/icons/psynergy/Haunt.gif",category:"icons-psynergy",subcategory:null},{name:"Healing Aura",path:"/sprites/icons/psynergy/Healing_Aura.gif",category:"icons-psynergy",subcategory:null},{name:"Heat Juggle",path:"/sprites/icons/psynergy/Heat_Juggle.gif",category:"icons-psynergy",subcategory:null},{name:"Heat Wave",path:"/sprites/icons/psynergy/Heat_Wave.gif",category:"icons-psynergy",subcategory:null},{name:"high impact",path:"/sprites/icons/psynergy/high_impact.gif",category:"icons-psynergy",subcategory:null},{name:"Hover",path:"/sprites/icons/psynergy/Hover.gif",category:"icons-psynergy",subcategory:null},{name:"Hurricane",path:"/sprites/icons/psynergy/Hurricane.gif",category:"icons-psynergy",subcategory:null},{name:"Ice",path:"/sprites/icons/psynergy/Ice.gif",category:"icons-psynergy",subcategory:null},{name:"Ice Horn",path:"/sprites/icons/psynergy/Ice_Horn.gif",category:"icons-psynergy",subcategory:null},{name:"Ice Missile",path:"/sprites/icons/psynergy/Ice_Missile.gif",category:"icons-psynergy",subcategory:null},{name:"impact",path:"/sprites/icons/psynergy/impact.gif",category:"icons-psynergy",subcategory:null},{name:"Impair",path:"/sprites/icons/psynergy/Impair.gif",category:"icons-psynergy",subcategory:null},{name:"Inferno",path:"/sprites/icons/psynergy/Inferno.gif",category:"icons-psynergy",subcategory:null},{name:"Juggle",path:"/sprites/icons/psynergy/Juggle.gif",category:"icons-psynergy",subcategory:null},{name:"Lash",path:"/sprites/icons/psynergy/Lash.gif",category:"icons-psynergy",subcategory:null},{name:"Lava Shower",path:"/sprites/icons/psynergy/Lava_Shower.gif",category:"icons-psynergy",subcategory:null},{name:"Lift",path:"/sprites/icons/psynergy/Lift.gif",category:"icons-psynergy",subcategory:null},{name:"Liquifier",path:"/sprites/icons/psynergy/Liquifier.gif",category:"icons-psynergy",subcategory:null},{name:"Mad Blast",path:"/sprites/icons/psynergy/Mad_Blast.gif",category:"icons-psynergy",subcategory:null},{name:"Mad Growth",path:"/sprites/icons/psynergy/Mad_Growth.gif",category:"icons-psynergy",subcategory:null},{name:"Magic Shell",path:"/sprites/icons/psynergy/Magic_Shell.gif",category:"icons-psynergy",subcategory:null},{name:"Magic Shield",path:"/sprites/icons/psynergy/Magic_Shield.gif",category:"icons-psynergy",subcategory:null},{name:"Magma Storm",path:"/sprites/icons/psynergy/Magma_Storm.gif",category:"icons-psynergy",subcategory:null},{name:"Magnet",path:"/sprites/icons/psynergy/Magnet.gif",category:"icons-psynergy",subcategory:null},{name:"Megacool",path:"/sprites/icons/psynergy/Megacool.gif",category:"icons-psynergy",subcategory:null},{name:"Mind Read",path:"/sprites/icons/psynergy/Mind_Read.gif",category:"icons-psynergy",subcategory:null},{name:"Mist",path:"/sprites/icons/psynergy/Mist.gif",category:"icons-psynergy",subcategory:null},{name:"Molten Bath",path:"/sprites/icons/psynergy/Molten_Bath.gif",category:"icons-psynergy",subcategory:null},{name:"Mother Gaia",path:"/sprites/icons/psynergy/Mother_Gaia.gif",category:"icons-psynergy",subcategory:null},{name:"Move",path:"/sprites/icons/psynergy/Move.gif",category:"icons-psynergy",subcategory:null},{name:"Nettle",path:"/sprites/icons/psynergy/Nettle.gif",category:"icons-psynergy",subcategory:null},{name:"Nova",path:"/sprites/icons/psynergy/Nova.gif",category:"icons-psynergy",subcategory:null},{name:"Odyssey",path:"/sprites/icons/psynergy/Odyssey.gif",category:"icons-psynergy",subcategory:null},{name:"Parch",path:"/sprites/icons/psynergy/Parch.gif",category:"icons-psynergy",subcategory:null},{name:"Planetary",path:"/sprites/icons/psynergy/Planetary.gif",category:"icons-psynergy",subcategory:null},{name:"Planet Diver",path:"/sprites/icons/psynergy/Planet_Diver.gif",category:"icons-psynergy",subcategory:null},{name:"Plasma",path:"/sprites/icons/psynergy/Plasma.gif",category:"icons-psynergy",subcategory:null},{name:"Plume Edge",path:"/sprites/icons/psynergy/Plume_Edge.gif",category:"icons-psynergy",subcategory:null},{name:"Ply",path:"/sprites/icons/psynergy/Ply.gif",category:"icons-psynergy",subcategory:null},{name:"Ply Well",path:"/sprites/icons/psynergy/Ply_Well.gif",category:"icons-psynergy",subcategory:null},{name:"Poison Flow",path:"/sprites/icons/psynergy/Poison_Flow.gif",category:"icons-psynergy",subcategory:null},{name:"Potent Cure",path:"/sprites/icons/psynergy/Potent_Cure.gif",category:"icons-psynergy",subcategory:null},{name:"Pound",path:"/sprites/icons/psynergy/Pound.gif",category:"icons-psynergy",subcategory:null},{name:"Protect",path:"/sprites/icons/psynergy/Protect.gif",category:"icons-psynergy",subcategory:null},{name:"Protector",path:"/sprites/icons/psynergy/Protector.gif",category:"icons-psynergy",subcategory:null},{name:"Psy Drain",path:"/sprites/icons/psynergy/Psy_Drain.gif",category:"icons-psynergy",subcategory:null},{name:"Punji",path:"/sprites/icons/psynergy/Punji.gif",category:"icons-psynergy",subcategory:null},{name:"Punji Strike",path:"/sprites/icons/psynergy/Punji_Strike.gif",category:"icons-psynergy",subcategory:null},{name:"Punji Trap",path:"/sprites/icons/psynergy/Punji_Trap.gif",category:"icons-psynergy",subcategory:null},{name:"Pure Ply",path:"/sprites/icons/psynergy/Pure_Ply.gif",category:"icons-psynergy",subcategory:null},{name:"Pure Wish",path:"/sprites/icons/psynergy/Pure_Wish.gif",category:"icons-psynergy",subcategory:null},{name:"Pyroclasm",path:"/sprites/icons/psynergy/Pyroclasm.gif",category:"icons-psynergy",subcategory:null},{name:"Quake",path:"/sprites/icons/psynergy/Quake.gif",category:"icons-psynergy",subcategory:null},{name:"Quake Sphere",path:"/sprites/icons/psynergy/Quake_Sphere.gif",category:"icons-psynergy",subcategory:null},{name:"Quick Strike",path:"/sprites/icons/psynergy/Quick_Strike.gif",category:"icons-psynergy",subcategory:null},{name:"Raging Heat",path:"/sprites/icons/psynergy/Raging_Heat.gif",category:"icons-psynergy",subcategory:null},{name:"Ragnarok",path:"/sprites/icons/psynergy/Ragnarok.gif",category:"icons-psynergy",subcategory:null},{name:"range 1",path:"/sprites/icons/psynergy/range-1.gif",category:"icons-psynergy",subcategory:null},{name:"range 11",path:"/sprites/icons/psynergy/range-11.gif",category:"icons-psynergy",subcategory:null},{name:"range 3",path:"/sprites/icons/psynergy/range-3.gif",category:"icons-psynergy",subcategory:null},{name:"range 5",path:"/sprites/icons/psynergy/range-5.gif",category:"icons-psynergy",subcategory:null},{name:"range 7",path:"/sprites/icons/psynergy/range-7.gif",category:"icons-psynergy",subcategory:null},{name:"range 9",path:"/sprites/icons/psynergy/range-9.gif",category:"icons-psynergy",subcategory:null},{name:"Ray",path:"/sprites/icons/psynergy/Ray.gif",category:"icons-psynergy",subcategory:null},{name:"Reflect",path:"/sprites/icons/psynergy/Reflect.gif",category:"icons-psynergy",subcategory:null},{name:"Resist",path:"/sprites/icons/psynergy/Resist.gif",category:"icons-psynergy",subcategory:null},{name:"Restore",path:"/sprites/icons/psynergy/Restore.gif",category:"icons-psynergy",subcategory:null},{name:"Retreat",path:"/sprites/icons/psynergy/Retreat.gif",category:"icons-psynergy",subcategory:null},{name:"Reveal",path:"/sprites/icons/psynergy/Reveal.gif",category:"icons-psynergy",subcategory:null},{name:"Revive",path:"/sprites/icons/psynergy/Revive.gif",category:"icons-psynergy",subcategory:null},{name:"Roc",path:"/sprites/icons/psynergy/Roc.gif",category:"icons-psynergy",subcategory:null},{name:"Rockfall",path:"/sprites/icons/psynergy/Rockfall.gif",category:"icons-psynergy",subcategory:null},{name:"Rockslide",path:"/sprites/icons/psynergy/Rockslide.gif",category:"icons-psynergy",subcategory:null},{name:"Sabre Dance",path:"/sprites/icons/psynergy/Sabre_Dance.gif",category:"icons-psynergy",subcategory:null},{name:"Salamander",path:"/sprites/icons/psynergy/Salamander.gif",category:"icons-psynergy",subcategory:null},{name:"Sand",path:"/sprites/icons/psynergy/Sand.gif",category:"icons-psynergy",subcategory:null},{name:"Scoop",path:"/sprites/icons/psynergy/Scoop.gif",category:"icons-psynergy",subcategory:null},{name:"Searing Beam",path:"/sprites/icons/psynergy/Searing_Beam.gif",category:"icons-psynergy",subcategory:null},{name:"Serpent Fume",path:"/sprites/icons/psynergy/Serpent_Fume.gif",category:"icons-psynergy",subcategory:null},{name:"Shine Plasma",path:"/sprites/icons/psynergy/Shine_Plasma.gif",category:"icons-psynergy",subcategory:null},{name:"Shuriken",path:"/sprites/icons/psynergy/Shuriken.gif",category:"icons-psynergy",subcategory:null},{name:"Skull Splitter",path:"/sprites/icons/psynergy/Skull_Splitter.gif",category:"icons-psynergy",subcategory:null},{name:"Slash",path:"/sprites/icons/psynergy/Slash.gif",category:"icons-psynergy",subcategory:null},{name:"Sleep",path:"/sprites/icons/psynergy/Sleep.gif",category:"icons-psynergy",subcategory:null},{name:"Sleep Card",path:"/sprites/icons/psynergy/Sleep_Card.gif",category:"icons-psynergy",subcategory:null},{name:"Sonic Slash",path:"/sprites/icons/psynergy/Sonic_Slash.gif",category:"icons-psynergy",subcategory:null},{name:"Spark Plasma",path:"/sprites/icons/psynergy/Spark_Plasma.gif",category:"icons-psynergy",subcategory:null},{name:"Spire",path:"/sprites/icons/psynergy/Spire.gif",category:"icons-psynergy",subcategory:null},{name:"Stone Spire",path:"/sprites/icons/psynergy/Stone_Spire.gif",category:"icons-psynergy",subcategory:null},{name:"Storm Ray",path:"/sprites/icons/psynergy/Storm_Ray.gif",category:"icons-psynergy",subcategory:null},{name:"Supercool",path:"/sprites/icons/psynergy/Supercool.gif",category:"icons-psynergy",subcategory:null},{name:"Supernova",path:"/sprites/icons/psynergy/Supernova.gif",category:"icons-psynergy",subcategory:null},{name:"Sword Card",path:"/sprites/icons/psynergy/Sword_Card.gif",category:"icons-psynergy",subcategory:null},{name:"Teleport",path:"/sprites/icons/psynergy/Teleport.gif",category:"icons-psynergy",subcategory:null},{name:"Tempest",path:"/sprites/icons/psynergy/Tempest.gif",category:"icons-psynergy",subcategory:null},{name:"Thorn",path:"/sprites/icons/psynergy/Thorn.gif",category:"icons-psynergy",subcategory:null},{name:"Thorny Grave",path:"/sprites/icons/psynergy/Thorny_Grave.gif",category:"icons-psynergy",subcategory:null},{name:"Thunderbolt",path:"/sprites/icons/psynergy/Thunderbolt.gif",category:"icons-psynergy",subcategory:null},{name:"Thunderclap",path:"/sprites/icons/psynergy/Thunderclap.gif",category:"icons-psynergy",subcategory:null},{name:"Thunderstorm",path:"/sprites/icons/psynergy/Thunderstorm.gif",category:"icons-psynergy",subcategory:null},{name:"Thunder Card",path:"/sprites/icons/psynergy/Thunder_Card.gif",category:"icons-psynergy",subcategory:null},{name:"Thunder Mine",path:"/sprites/icons/psynergy/Thunder_Mine.gif",category:"icons-psynergy",subcategory:null},{name:"Tornado",path:"/sprites/icons/psynergy/Tornado.gif",category:"icons-psynergy",subcategory:null},{name:"Tremor",path:"/sprites/icons/psynergy/Tremor.gif",category:"icons-psynergy",subcategory:null},{name:"Tundra",path:"/sprites/icons/psynergy/Tundra.gif",category:"icons-psynergy",subcategory:null},{name:"Typhoon",path:"/sprites/icons/psynergy/Typhoon.gif",category:"icons-psynergy",subcategory:null},{name:"Volcano",path:"/sprites/icons/psynergy/Volcano.gif",category:"icons-psynergy",subcategory:null},{name:"Ward",path:"/sprites/icons/psynergy/Ward.gif",category:"icons-psynergy",subcategory:null},{name:"Weaken",path:"/sprites/icons/psynergy/Weaken.gif",category:"icons-psynergy",subcategory:null},{name:"Whiplash",path:"/sprites/icons/psynergy/Whiplash.gif",category:"icons-psynergy",subcategory:null},{name:"Whirlwind",path:"/sprites/icons/psynergy/Whirlwind.gif",category:"icons-psynergy",subcategory:null},{name:"Wild Growth",path:"/sprites/icons/psynergy/Wild_Growth.gif",category:"icons-psynergy",subcategory:null},{name:"Wild Wolf",path:"/sprites/icons/psynergy/Wild_Wolf.gif",category:"icons-psynergy",subcategory:null},{name:"Wind Slash",path:"/sprites/icons/psynergy/Wind_Slash.gif",category:"icons-psynergy",subcategory:null},{name:"Wish",path:"/sprites/icons/psynergy/Wish.gif",category:"icons-psynergy",subcategory:null},{name:"Wish Well",path:"/sprites/icons/psynergy/Wish_Well.gif",category:"icons-psynergy",subcategory:null},{name:"agitated",path:"/sprites/icons/misc/agitated.gif",category:"icons-misc",subcategory:null},{name:"Angry",path:"/sprites/icons/misc/Angry.gif",category:"icons-misc",subcategory:null},{name:"attack up",path:"/sprites/icons/misc/attack_up.gif",category:"icons-misc",subcategory:null},{name:"curse",path:"/sprites/icons/misc/curse.gif",category:"icons-misc",subcategory:null},{name:"cursor",path:"/sprites/icons/misc/cursor.gif",category:"icons-misc",subcategory:null},{name:"defense up",path:"/sprites/icons/misc/defense_up.gif",category:"icons-misc",subcategory:null},{name:"delusion",path:"/sprites/icons/misc/delusion.gif",category:"icons-misc",subcategory:null},{name:"Down Arrow",path:"/sprites/icons/misc/Down_Arrow.gif",category:"icons-misc",subcategory:null},{name:"Exclamatory",path:"/sprites/icons/misc/Exclamatory.gif",category:"icons-misc",subcategory:null},{name:"frown",path:"/sprites/icons/misc/frown.gif",category:"icons-misc",subcategory:null},{name:"Green Arrow",path:"/sprites/icons/misc/Green_Arrow.gif",category:"icons-misc",subcategory:null},{name:"Happy",path:"/sprites/icons/misc/Happy.gif",category:"icons-misc",subcategory:null},{name:"Haunted",path:"/sprites/icons/misc/Haunted.gif",category:"icons-misc",subcategory:null},{name:"huh",path:"/sprites/icons/misc/huh.gif",category:"icons-misc",subcategory:null},{name:"idea",path:"/sprites/icons/misc/idea.gif",category:"icons-misc",subcategory:null},{name:"item qty bar",path:"/sprites/icons/misc/item_qty-bar.gif",category:"icons-misc",subcategory:null},{name:"joy",path:"/sprites/icons/misc/joy.gif",category:"icons-misc",subcategory:null},{name:"Jupiter Star",path:"/sprites/icons/misc/Jupiter_Star.gif",category:"icons-misc",subcategory:null},{name:"Mars Star",path:"/sprites/icons/misc/Mars_Star.gif",category:"icons-misc",subcategory:null},{name:"Mercury Star",path:"/sprites/icons/misc/Mercury_Star.gif",category:"icons-misc",subcategory:null},{name:"Poison",path:"/sprites/icons/misc/Poison.gif",category:"icons-misc",subcategory:null},{name:"Psynergy Seal",path:"/sprites/icons/misc/Psynergy_Seal.gif",category:"icons-misc",subcategory:null},{name:"Psy Seal",path:"/sprites/icons/misc/Psy_Seal.gif",category:"icons-misc",subcategory:null},{name:"resist up",path:"/sprites/icons/misc/resist_up.gif",category:"icons-misc",subcategory:null},{name:"Silence",path:"/sprites/icons/misc/Silence.gif",category:"icons-misc",subcategory:null},{name:"Stat Down",path:"/sprites/icons/misc/Stat-Down.gif",category:"icons-misc",subcategory:null},{name:"Stat Up",path:"/sprites/icons/misc/Stat-Up.gif",category:"icons-misc",subcategory:null},{name:"Sweatdrop",path:"/sprites/icons/misc/Sweatdrop.gif",category:"icons-misc",subcategory:null},{name:"Update",path:"/sprites/icons/misc/Update.gif",category:"icons-misc",subcategory:null},{name:"Up Arrow",path:"/sprites/icons/misc/Up_Arrow.gif",category:"icons-misc",subcategory:null},{name:"Venus Star",path:"/sprites/icons/misc/Venus_Star.gif",category:"icons-misc",subcategory:null},{name:"Blue Bolt",path:"/sprites/psynergy/Blue_Bolt.gif",category:"psynergy",subcategory:null},{name:"Deluge",path:"/sprites/psynergy/Deluge.gif",category:"psynergy",subcategory:null},{name:"Destruct Ray",path:"/sprites/psynergy/Destruct_Ray.gif",category:"psynergy",subcategory:null},{name:"Dragon Fire",path:"/sprites/psynergy/Dragon_Fire.gif",category:"psynergy",subcategory:null},{name:"Fiery Blast",path:"/sprites/psynergy/Fiery_Blast.gif",category:"psynergy",subcategory:null},{name:"Freeze Prism",path:"/sprites/psynergy/Freeze_Prism.gif",category:"psynergy",subcategory:null},{name:"Froth Spiral",path:"/sprites/psynergy/Froth_Spiral.gif",category:"psynergy",subcategory:null},{name:"Fume",path:"/sprites/psynergy/Fume.gif",category:"psynergy",subcategory:null},{name:"Glacier",path:"/sprites/psynergy/Glacier.gif",category:"psynergy",subcategory:null},{name:"Grand Gaia",path:"/sprites/psynergy/Grand_Gaia.gif",category:"psynergy",subcategory:null},{name:"Heat Wave",path:"/sprites/psynergy/Heat_Wave.gif",category:"psynergy",subcategory:null},{name:"Ice Missile",path:"/sprites/psynergy/Ice_Missile.gif",category:"psynergy",subcategory:null},{name:"Inferno",path:"/sprites/psynergy/Inferno.gif",category:"psynergy",subcategory:null},{name:"Nettle",path:"/sprites/psynergy/Nettle.gif",category:"psynergy",subcategory:null},{name:"Pyroclasm",path:"/sprites/psynergy/Pyroclasm.gif",category:"psynergy",subcategory:null},{name:"Sonic Slash",path:"/sprites/psynergy/Sonic_Slash.gif",category:"psynergy",subcategory:null},{name:"Spark Plasma",path:"/sprites/psynergy/Spark_Plasma.gif",category:"psynergy",subcategory:null},{name:"Supernova",path:"/sprites/psynergy/Supernova.gif",category:"psynergy",subcategory:null},{name:"Tempest",path:"/sprites/psynergy/Tempest.gif",category:"psynergy",subcategory:null},{name:"Bush",path:"/sprites/scenery/plants/Bush.gif",category:"scenery-plants",subcategory:null},{name:"Bush2",path:"/sprites/scenery/plants/Bush2.gif",category:"scenery-plants",subcategory:null},{name:"Bush3",path:"/sprites/scenery/plants/Bush3.gif",category:"scenery-plants",subcategory:null},{name:"Cactus1",path:"/sprites/scenery/plants/Cactus1.gif",category:"scenery-plants",subcategory:null},{name:"Cactus2",path:"/sprites/scenery/plants/Cactus2.gif",category:"scenery-plants",subcategory:null},{name:"Cactus3",path:"/sprites/scenery/plants/Cactus3.gif",category:"scenery-plants",subcategory:null},{name:"Desert Shrub1",path:"/sprites/scenery/plants/Desert_Shrub1.gif",category:"scenery-plants",subcategory:null},{name:"Desert Shrub2",path:"/sprites/scenery/plants/Desert_Shrub2.gif",category:"scenery-plants",subcategory:null},{name:"Flowers",path:"/sprites/scenery/plants/Flowers.gif",category:"scenery-plants",subcategory:null},{name:"Leaf",path:"/sprites/scenery/plants/Leaf.gif",category:"scenery-plants",subcategory:null},{name:"Leaf2",path:"/sprites/scenery/plants/Leaf2.gif",category:"scenery-plants",subcategory:null},{name:"Leaf3",path:"/sprites/scenery/plants/Leaf3.gif",category:"scenery-plants",subcategory:null},{name:"lilypad1",path:"/sprites/scenery/plants/lilypad1.gif",category:"scenery-plants",subcategory:null},{name:"lilypad2",path:"/sprites/scenery/plants/lilypad2.gif",category:"scenery-plants",subcategory:null},{name:"lilypad3",path:"/sprites/scenery/plants/lilypad3.gif",category:"scenery-plants",subcategory:null},{name:"lilypad4",path:"/sprites/scenery/plants/lilypad4.gif",category:"scenery-plants",subcategory:null},{name:"Palm",path:"/sprites/scenery/plants/Palm.gif",category:"scenery-plants",subcategory:null},{name:"Palm2",path:"/sprites/scenery/plants/Palm2.gif",category:"scenery-plants",subcategory:null},{name:"palmtree",path:"/sprites/scenery/plants/palmtree.gif",category:"scenery-plants",subcategory:null},{name:"Shrub",path:"/sprites/scenery/plants/Shrub.gif",category:"scenery-plants",subcategory:null},{name:"Shrub1",path:"/sprites/scenery/plants/Shrub1.gif",category:"scenery-plants",subcategory:null},{name:"Shrub2",path:"/sprites/scenery/plants/Shrub2.gif",category:"scenery-plants",subcategory:null},{name:"Shrub3",path:"/sprites/scenery/plants/Shrub3.gif",category:"scenery-plants",subcategory:null},{name:"Shrub4",path:"/sprites/scenery/plants/Shrub4.gif",category:"scenery-plants",subcategory:null},{name:"Shrub5",path:"/sprites/scenery/plants/Shrub5.gif",category:"scenery-plants",subcategory:null},{name:"Shrub6",path:"/sprites/scenery/plants/Shrub6.gif",category:"scenery-plants",subcategory:null},{name:"Sickly Tree",path:"/sprites/scenery/plants/Sickly_Tree.gif",category:"scenery-plants",subcategory:null},{name:"Sickly Tree2",path:"/sprites/scenery/plants/Sickly_Tree2.gif",category:"scenery-plants",subcategory:null},{name:"Small Tree1",path:"/sprites/scenery/plants/Small_Tree1.gif",category:"scenery-plants",subcategory:null},{name:"Small Tree2",path:"/sprites/scenery/plants/Small_Tree2.gif",category:"scenery-plants",subcategory:null},{name:"Small Tree3",path:"/sprites/scenery/plants/Small_Tree3.gif",category:"scenery-plants",subcategory:null},{name:"Small Tree4",path:"/sprites/scenery/plants/Small_Tree4.gif",category:"scenery-plants",subcategory:null},{name:"Small Tree5",path:"/sprites/scenery/plants/Small_Tree5.gif",category:"scenery-plants",subcategory:null},{name:"Stump",path:"/sprites/scenery/plants/Stump.gif",category:"scenery-plants",subcategory:null},{name:"Tree",path:"/sprites/scenery/plants/Tree.gif",category:"scenery-plants",subcategory:null},{name:"Tree1",path:"/sprites/scenery/plants/Tree1.gif",category:"scenery-plants",subcategory:null},{name:"Tree10",path:"/sprites/scenery/plants/Tree10.gif",category:"scenery-plants",subcategory:null},{name:"Tree11",path:"/sprites/scenery/plants/Tree11.gif",category:"scenery-plants",subcategory:null},{name:"Tree12",path:"/sprites/scenery/plants/Tree12.gif",category:"scenery-plants",subcategory:null},{name:"Tree2",path:"/sprites/scenery/plants/Tree2.gif",category:"scenery-plants",subcategory:null},{name:"Tree3",path:"/sprites/scenery/plants/Tree3.gif",category:"scenery-plants",subcategory:null},{name:"Tree4",path:"/sprites/scenery/plants/Tree4.gif",category:"scenery-plants",subcategory:null},{name:"Tree5",path:"/sprites/scenery/plants/Tree5.gif",category:"scenery-plants",subcategory:null},{name:"Tree6",path:"/sprites/scenery/plants/Tree6.gif",category:"scenery-plants",subcategory:null},{name:"Tree7",path:"/sprites/scenery/plants/Tree7.gif",category:"scenery-plants",subcategory:null},{name:"Tree8",path:"/sprites/scenery/plants/Tree8.gif",category:"scenery-plants",subcategory:null},{name:"Tree9",path:"/sprites/scenery/plants/Tree9.gif",category:"scenery-plants",subcategory:null},{name:"Alhafra Statue",path:"/sprites/scenery/statues/Alhafra_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Bilibin Statue",path:"/sprites/scenery/statues/Bilibin_Statue.gif",category:"scenery-statues",subcategory:null},{name:"crystal statue",path:"/sprites/scenery/statues/crystal_statue.gif",category:"scenery-statues",subcategory:null},{name:"desert statue",path:"/sprites/scenery/statues/desert_statue.gif",category:"scenery-statues",subcategory:null},{name:"Dragon",path:"/sprites/scenery/statues/Dragon.gif",category:"scenery-statues",subcategory:null},{name:"Dragonhead",path:"/sprites/scenery/statues/Dragonhead.gif",category:"scenery-statues",subcategory:null},{name:"Dragonhead2",path:"/sprites/scenery/statues/Dragonhead2.gif",category:"scenery-statues",subcategory:null},{name:"Gaia Rock Statue",path:"/sprites/scenery/statues/Gaia_Rock_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Jupiter Statue",path:"/sprites/scenery/statues/Jupiter_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Jupiter Statue2",path:"/sprites/scenery/statues/Jupiter_Statue2.gif",category:"scenery-statues",subcategory:null},{name:"Loho Statue",path:"/sprites/scenery/statues/Loho_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Mars Statue",path:"/sprites/scenery/statues/Mars_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Mercury Statue",path:"/sprites/scenery/statues/Mercury_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Sol Entry Statue",path:"/sprites/scenery/statues/Sol_Entry_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Sol Sanctum Statue",path:"/sprites/scenery/statues/Sol_Sanctum_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Sol Sanctum Statue2",path:"/sprites/scenery/statues/Sol_Sanctum_Statue2.gif",category:"scenery-statues",subcategory:null},{name:"Sol Sanctum Statue3",path:"/sprites/scenery/statues/Sol_Sanctum_Statue3.gif",category:"scenery-statues",subcategory:null},{name:"Sol Sanctum Statue4",path:"/sprites/scenery/statues/Sol_Sanctum_Statue4.gif",category:"scenery-statues",subcategory:null},{name:"statue",path:"/sprites/scenery/statues/statue.gif",category:"scenery-statues",subcategory:null},{name:"stone face",path:"/sprites/scenery/statues/stone_face.gif",category:"scenery-statues",subcategory:null},{name:"Venus Aerie Statue",path:"/sprites/scenery/statues/Venus_Aerie_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Venus Statue",path:"/sprites/scenery/statues/Venus_Statue.gif",category:"scenery-statues",subcategory:null},{name:"Venus Statue Blue",path:"/sprites/scenery/statues/Venus_Statue_Blue.gif",category:"scenery-statues",subcategory:null},{name:"Venus Statue Green",path:"/sprites/scenery/statues/Venus_Statue_Green.gif",category:"scenery-statues",subcategory:null},{name:"Venus Statue Purple",path:"/sprites/scenery/statues/Venus_Statue_Purple.gif",category:"scenery-statues",subcategory:null},{name:"Venus Statue Red",path:"/sprites/scenery/statues/Venus_Statue_Red.gif",category:"scenery-statues",subcategory:null},{name:"Venus Statue Yellow",path:"/sprites/scenery/statues/Venus_Statue_Yellow.gif",category:"scenery-statues",subcategory:null}];function Me(t){return t.replace(/([a-z])([A-Z])/g,"$1 $2").replace(/\.(gif|png)$/gi,"").replace(/[_\-\s]+/g," ").trim().toLowerCase()}function Xt(t){const r=t.lastIndexOf("/");return(r>=0?t.slice(r+1):t).replace(/\.(gif|png)$/gi,"")}function Cs(t){return Me(t).split(" ").filter(Boolean)}function xa(t){return Fe.find(r=>r.path===t)??null}function Da(t){return Fe.filter(r=>r.category===t)}function Ca(t){const r=Me(t),a=Cs(t),s=Fe.find(i=>Me(i.name)===r);if(s)return s;const n=Fe.find(i=>Me(Xt(i.path))===r);if(n)return n;if(a.length>0){const i=Fe.find(o=>{const g=[Me(o.name),Me(Xt(o.path))];return a.every(p=>g.some(c=>c.includes(p)))});if(i)return i}return null}function Es(t){const r=t?Da(t):Fe,a=Math.floor(Math.random()*r.length);return r[a]}function Ms(t,r,a){let s=0;for(let g=0;g<t.length;g++)s=t.charCodeAt(g)+((s<<5)-s);const n=Math.abs(s%360),i=40+Math.abs(s)%30,o=60+Math.abs(s)%20;return e("div",{style:{width:r,height:a,backgroundColor:`hsl(${n}, ${i}%, ${o}%)`,display:"flex",alignItems:"center",justifyContent:"center",fontSize:Math.min(r,a)/4,color:"#fff",fontWeight:"bold",textAlign:"center",padding:"4px",border:"2px dashed rgba(0,0,0,0.3)",boxSizing:"border-box"},title:`Placeholder: ${t}`,children:e("div",{style:{wordBreak:"break-word",lineHeight:1},children:t.length>10?t.substring(0,10)+"...":t})})}function Bs(t){if(t.startsWith("/"))return{entry:xa(t),method:"path"};const r=Ca(t);return r?{entry:r,method:"catalog"}:{entry:null,method:"none"}}function H({id:t,width:r,height:a,style:s,className:n,debug:i=!1,fallback:o,alt:g,imageRendering:p="pixelated",objectFit:c="contain",onLoad:l,onError:u}){const[f,_]=F(null),[k,w]=F(null),[I,h]=F(!1),[m,T]=F(!1),v=`searchSprites('${t.split("-")[0]??t}')`;P(()=>{const E=Bs(t);_(E),w(null),h(!1),i&&E.entry?console.log("[SimpleSprite] Found sprite",{id:t,method:E.method,name:E.entry.name,path:E.entry.path,category:E.entry.category}):i&&!E.entry&&console.warn("[SimpleSprite] Sprite not found:",{id:t,method:E.method,suggestion:t.includes("-")?`Try searching catalog for: ${t.split("-").join(" ")}`:"Try using direct path or check catalog"})},[t,i]);const b=()=>{h(!0),w(null),l?.()},d=()=>{const E=f?.entry?`Failed to load sprite at ${f.entry.path} (method: ${f.method})`:`Sprite not found for id "${t}" (method: ${f?.method??"none"})`;w(E),h(!1),u?.(E),i&&console.error("[SimpleSprite] Load error:",E)},x=f?.entry?.path||null;return!x||k?o?e(ie,{children:o}):e("div",{className:n,style:{width:r,height:a,...s},onMouseEnter:()=>i&&T(!0),onMouseLeave:()=>i&&T(!1),children:[Ms(t,r,a),i&&m&&e("div",{style:{position:"absolute",backgroundColor:"rgba(0, 0, 0, 0.9)",color:"#fff",padding:"8px",borderRadius:"4px",fontSize:"12px",zIndex:1e3,marginTop:"4px",maxWidth:"300px"},children:[e("div",{children:[e("strong",{children:"Sprite ID:"})," ",t]}),f&&e("div",{children:[e("strong",{children:"Lookup Method:"})," ",f.method]}),k&&e("div",{style:{color:"#ff6b6b"},children:[e("strong",{children:"Error:"})," ",k]}),!x&&e("div",{style:{color:"#ffd93d"},children:[e("strong",{children:"Tip:"})," Sprite not found in catalog. Try:",e("ul",{style:{margin:"4px 0",paddingLeft:"20px"},children:[e("li",{children:["Using direct path: ",e("code",{children:"/sprites/..."})]}),e("li",{children:["Checking catalog: ",e("code",{children:v})]})]})]})]})]}):e("div",{className:n,style:{width:r,height:a,position:"relative",display:"inline-block",...s},onMouseEnter:()=>i&&T(!0),onMouseLeave:()=>i&&T(!1),children:[e("img",{src:x,alt:g||f?.entry?.name||t,width:r,height:a,style:{width:"100%",height:"100%",objectFit:c,imageRendering:p,display:"block"},onLoad:b,onError:d}),i&&m&&f&&f.entry&&e("div",{style:{position:"absolute",bottom:"100%",left:0,backgroundColor:"rgba(0, 0, 0, 0.9)",color:"#fff",padding:"8px",borderRadius:"4px",fontSize:"12px",zIndex:1e3,marginBottom:"4px",maxWidth:"300px",whiteSpace:"nowrap"},children:[e("div",{children:[e("strong",{children:"Name:"})," ",f.entry.name]}),e("div",{children:[e("strong",{children:"Path:"})," ",f.entry.path]}),e("div",{children:[e("strong",{children:"Category:"})," ",f.entry.category]}),f.entry.subcategory&&e("div",{children:[e("strong",{children:"Subcategory:"})," ",f.entry.subcategory]}),e("div",{children:[e("strong",{children:"Lookup:"})," ",f.method]}),e("div",{children:[e("strong",{children:"Status:"})," ",I?"âœ… Loaded":"â³ Loading..."]})]})]})}const As={strike:"arrow","heavy-strike":"blast1","guard-break":"break","precise-jab":"backstab",fireball:"fire-ball","fire-burst":"burst",flare:"flare-wall","burn-touch":"fire-bomb","flame-burst-damage":"burst","fire-ward-utility":"fire-shield",ignite:"fire","flame-wall":"flare-wall","inferno-slash":"inferno","blazing-fury":"flare-storm",pyroclasm:"volcano","fire-aura":"cool-aura","meteor-strike":"meteor","phoenix-flames":"phoenix","magma-burst":"molten","flame-shield":"fire-shield",supernova:"supernova","infernal-rage":"dire-inferno","dragon-breath":"dragon-fire","ragnarok-flames":"ragnarok","flame-blade":"fire","battle-cry":"ward","inferno-strike":"inferno",pyroblast:"volcano","warrior-flame":"fire","molten-slash":"molten","fire-nova":"nova","blazing-assault":"flare-storm","magma-wave":"molten","berserker-rage":"dire-inferno","crimson-fury":"fire","meteor-crash":"meteor","phoenix-aura":"phoenix","solar-flare":"flare","ultimate-warrior":"ragnarok","inferno-barrage":"inferno","supernova-strike":"supernova","flame-jab":"fire","inferno-assault":"inferno","flame-tornado":"fire-bomb","ice-shard":"frost","freeze-blast":"ice-horn",heal:"cure","party-heal":"cure-well",cure:"pure-ply","ice-lance-damage":"ice-missile","aqua-heal-utility":"ply",cleanse:"cure-poison","frost-wave":"icicle",regen:"healing-aura","diamond-dust":"diamond-dust","mass-regen":"wish-well","glacial-shield":"ice-shield","deep-freeze":"freeze-prism",sanctuary:"sanctuary",blizzard:"ice-horn",restoration:"restore","frozen-tomb":"ice","aqua-barrier":"water-shield","absolute-zero":"tundra","leviathan-grace":"wish-well","frost-shield":"ice-shield",purify:"cure-poison","ice-spear":"ice-missile","scholar-wisdom":"reveal","glacial-wave":"tundra",renewal:"wish","frozen-spikes":"icicle","crystal-barrier":"ice-shield","ice-storm":"hail-prism","mass-restoration":"restore","frozen-tomb-karis":"ice","scholar-sanctuary":"sanctuary","blizzard-cascade":"diamond-berg","divine-renewal":"wish-well","absolute-zero-karis":"tundra","aqua-resurrection":"revive",quake:"quake","earth-spike":"spire","earth-spike-damage":"spire","stone-skin-utility":"guard",fortify:"guard",tremor:"tremor","guardian-stance":"ward","rock-breaker":"quake-sphere",earthquake:"earthquake","stone-wall":"stone-spire",unbreakable:"guard","titan-grip":"titan-blade","gaia-shield":"gaia","petrify-strike":"petra","mountain-endurance":"ward",landslide:"avalanche","earth-blessing":"gaia","gaia-rebirth":"revive",taunt:"taunt","shield-bash":"impact","iron-wall":"guard","counter-stance":"ward","tremor-strike":"tremor","fortified-guard":"gaurdian",bulwark:"guard","crushing-blow":"impact","earthen-armor":"guard",shockwave:"earthquake","guardian-resolve":"gaurdian","titan-grip-sentinel":"titan-blade","stone-fortress":"guard",avalanche:"avalanche","immortal-bulwark":"guard","earth-splitter":"quake-sphere","atlas-stand":"ward","earth-strike":"spire","warrior-resolve":"ward","sunder-armor":"break","stone-fist":"clay","earth-shaker":"earthquake","battle-master":"ward","crushing-impact":"impact","mountain-strength":"ward","ragnarok-strike":"ragnarok","terra-shield":"gaia","grand-impact":"impact","legendary-warrior":"ragnarok","titan-fall":"titan-blade","earth-judgment":"judgment","master-aura":"cool-aura","gaia-blade":"gaia",gust:"gust","chain-lightning":"spark-plasma","paralyze-shock":"thunder-mine","gale-force-damage":"whirlwind","wind-barrier-utility":"wind-shield","swift-strike":"quick-strike","shock-bolt":"bolt",tempest:"tempest","hurricane-slash":"hurricane","plasma-shot":"plasma",cyclone:"cyclone","thunder-god-fury":"judgement-bolt","storm-blessing":"wish","judgment-bolt":"judgement-bolt","static-field":"lightning-bomb","wind-walker":"quick-strike",maelstrom:"tornado","zeus-wrath":"thoron","storm-sovereign":"thor","thunder-clap":"thunderclap","storm-call":"storm-ray","static-charge":"spark-plasma","lightning-arc":"slash","shock-pulse":"shock","wind-mastery":"whirlwind","thunder-storm":"thunderstorm","electric-overload":"plasma","storm-shield":"wind-shield","bolt-barrage":"thoron","hurricane-force":"hurricane","thor-hammer":"thor","lightning-sanctuary":"sanctuary","apocalyptic-storm":"tempest","god-thunder":"thor","world-storm":"storm-ray","tempest-tyrant":"tempest",blind:"baffle-card","poison-strike":"venom-fang","weaken-def":"debilitate","boost-atk":"boost","boost-def":"resist",guard:"ward","focus-strike-neutral":"quick-strike","wooden-strike":"arrow","bronze-slash":"slash","iron-bulwark":"guard","arcane-bolt":"bolt","iron-thrust":"arrow","steel-focus":"quick-strike","steel-ward":"ward","axe-cleave":"slash","iron-mind":"ward","silver-shield":"guard","mythril-wisdom":"reveal","hyper-speed":"quick-strike","mythril-edge":"slash","dragon-ward":"ward","oracle-vision":"reveal","steel-slash":"slash","crystal-blast":"blast1","silver-strike":"slash","great-cleave":"slash","zodiac-bolt":"bolt","rapid-strikes":"quick-strike",assassinate:"backstab","combat-focus":"quick-strike",flurry:"quick-strike","precision-strike":"backstab","blood-rush":"quick-strike","death-strike":"backstab","perfect-form":"ward",obliterate:"blast2","unstoppable-force":"impact","supreme-focus":"quick-strike",annihilation:"blast2","one-thousand-cuts":"quick-strike"};function Fs(t){return As[t]||"psynergy"}const Zt={Isaac:"isaac1",isaac:"isaac1",Garet:"garet1",garet:"garet1",Mia:"mia",mia:"mia",Ivan:"ivan",ivan:"ivan",Felix:"felix1",felix:"felix1",Jenna:"jenna1",jenna:"jenna1",Piers:"piers",piers:"piers",Sheba:"sheba",sheba:"sheba",adept:"isaac1","war-mage":"garet1",mystic:"mia",ranger:"ivan",blaze:"garet1",karis:"ivan",sentinel:"felix1",stormcaller:"jenna1",tyrell:"garet1","tower-champion":"isaac1","test-warrior-1":"isaac1","test-warrior-2":"garet1","test-warrior-3":"mia","test-warrior-4":"ivan",Saturos:"saturos",saturos:"saturos",Menardi:"menardi",menardi:"menardi",Alex:"alex",alex:"alex",Agatio:"agatio",agatio:"agatio",Karst:"karst",karst:"karst",Elder:"elder",elder:"elder",Merchant:"armor-shopkeeper",merchant:"armor-shopkeeper",Villager:"villager",villager:"villager"};function Re(t){const r=Zt[t];if(r)return r;const a=t.toLowerCase(),s=Zt[a];return s||"isaac1"}const Rs="/sprites/overworld/protagonists",js="/sprites/overworld/majornpcs",Ps={adept:"Isaac","war-mage":"Garet",mystic:"Mia",ranger:"Ivan",sentinel:"Felix",stormcaller:"Jenna","test-warrior-1":"Isaac","test-warrior-2":"Garet","test-warrior-3":"Mia","test-warrior-4":"Ivan"},Ea={front:"Isaac.gif",back:"Isaac_Back.gif",side:"Isaac_Right.gif"},Gs={Isaac:Ea,Garet:{front:"Garet.gif",back:"Garet_Back.gif",side:"Garet_Right.gif"},Mia:{front:"Mia.gif",back:"Mia_Back.gif",side:"Mia_Right.gif"},Ivan:{front:"Ivan.gif",back:"Ivan_Back.gif",side:"Ivan_Right.gif"},Felix:{front:"Felix.gif",back:"Felix_Back.gif",side:"Felix_E.gif"},Jenna:{front:"Jenna.gif",back:"Jenna_Back.gif",side:"Jenna_Right.gif"}},Ls=Ea;function Ws(t){return`${Rs}/${t}`}function Ns(t){return Gs[t]??Ls}function qs(t,r){const a=Ps[t]||"Isaac",s=Ns(a),n=(()=>{switch(r){case"up":return s.back;case"down":return s.front;case"right":case"left":return s.side;default:return s.front}})();return Ws(n)}const ee={elder:"Elder.gif",merchant:"Weaponshop_Owner.gif",shopkeeper:"Weaponshop_Keeper.gif",villagerMale:"Mr_Jerra.gif",villagerFemale:"Mrs_Jerra.gif",guard:"Thief1.gif",enemy:"Thief1.gif",default:"Innkeeper.gif"},$s={"elder-vale":ee.elder,"shopkeeper-weapons":ee.shopkeeper,"tower-attendant":ee.elder,"djinn-guide":ee.elder};function ce(t){return`${js}/${t}`}function Us(t){const r=$s[t];if(r)return ce(r);if(/house-\d+-enemy/.test(t))return ce(ee.enemy);if(t.includes("elder"))return ce(ee.elder);if(t.includes("shopkeeper")||t.includes("merchant"))return ce(ee.merchant);if(t.includes("blacksmith"))return ce(ee.shopkeeper);if(t.includes("guard"))return ce(ee.guard);if(t.includes("villager")){const a=t.match(/villager-(\d+)/);if(a&&a[1]){const n=parseInt(a[1],10)%2===0?ee.villagerFemale:ee.villagerMale;return ce(n)}return ce(ee.villagerMale)}return ce(ee.default)}function Os(t){return t==="left"}const zs=5,Hs=new Set(["vs1-garet"]);function Ys(t){const r=t.match(/^house-(\d+)/);return r?Number(r[1])<=zs:Hs.has(t)}function Js(){const t=new Set;for(const[r,a]of Object.entries(Le))Ys(r)&&a.enemies.forEach(s=>t.add(s));return Array.from(t).sort()}function X(t,r){const a=`/sprites/battle/party/${t.toLowerCase()}/${t}_${r}`;return{idle:`${a}_Back.gif`,attack:`${a}_Attack1.gif`,hit:`${a}_HitBack.gif`}}function C(t){return{idle:t,attack:t,hit:t}}const Vs={adept:X("Isaac","lBlade"),"war-mage":X("Garet","Axe"),mystic:X("Mia","Staff"),ranger:X("Ivan","Staff"),sentinel:X("Isaac","lBlade"),blaze:X("Garet","Axe"),karis:X("Mia","Staff"),tyrell:X("Garet","Axe"),stormcaller:X("Ivan","Staff"),felix:X("Isaac","lBlade"),"tower-champion":X("Isaac","lBlade"),"test-warrior-1":X("Isaac","lBlade"),"test-warrior-2":X("Garet","Axe"),"test-warrior-3":X("Mia","Staff"),"test-warrior-4":X("Ivan","Staff")},Ks={"enemy-1":C("/sprites/battle/enemies/Goblin.gif"),"enemy-2":C("/sprites/battle/enemies/Alec_Goblin.gif"),"garet-enemy":C("/sprites/battle/enemies/Brigand.gif"),"war-mage":C("/sprites/battle/enemies/Brigand.gif"),"earth-scout":C("/sprites/battle/enemies/Goblin.gif"),"venus-wolf":C("/sprites/battle/enemies/Wild_Wolf.gif"),"venus-beetle":C("/sprites/battle/enemies/Punch_Ant.gif"),"flame-scout":C("/sprites/battle/enemies/Hobgoblin.gif"),"mars-wolf":C("/sprites/battle/enemies/Dire_Wolf.gif"),"frost-scout":C("/sprites/battle/enemies/Mini-Goblin.gif"),"mercury-wolf":C("/sprites/battle/enemies/Wolfkin.gif"),"gale-scout":C("/sprites/battle/enemies/Alec_Goblin.gif"),"jupiter-wolf":C("/sprites/battle/enemies/Wolfkin_Cub.gif"),"terra-soldier":C("/sprites/battle/enemies/Stone_Soldier.gif"),"venus-bear":C("/sprites/battle/enemies/Grizzly.gif"),"wind-soldier":C("/sprites/battle/enemies/Tornado_Lizard.gif"),"jupiter-bear":C("/sprites/battle/enemies/Grizzly.gif"),"tide-soldier":C("/sprites/battle/enemies/Merman.gif"),"mercury-bear":C("/sprites/battle/enemies/Grizzly.gif"),"ice-elemental":C("/sprites/battle/enemies/Ice_Gargoyle.gif"),"blaze-soldier":C("/sprites/battle/enemies/Salamander.gif"),"mars-bear":C("/sprites/battle/enemies/Grizzly.gif"),"flame-elemental":C("/sprites/battle/enemies/Fire_Worm.gif"),"stone-captain":C("/sprites/battle/enemies/Living_Statue.gif"),"rock-elemental":C("/sprites/battle/enemies/Earth_Golem.gif"),"inferno-captain":C("/sprites/battle/enemies/Grand_Chimera.gif"),phoenix:C("/sprites/battle/enemies/Phoenix.gif"),"glacier-captain":C("/sprites/battle/enemies/Ice_Gargoyle.gif"),"blizzard-warlord":C("/sprites/battle/enemies/Ice_Gargoyle.gif"),leviathan:C("/sprites/battle/enemies/Man_o_War.gif"),"thunder-captain":C("/sprites/battle/enemies/Thunder_Lizard.gif"),thunderbird:C("/sprites/battle/enemies/Roc.gif"),"lightning-commander":C("/sprites/battle/enemies/Thunder_Lizard.gif"),"storm-elemental":C("/sprites/battle/enemies/Tornado_Lizard.gif"),"mountain-commander":C("/sprites/battle/enemies/Grand_Golem.gif"),"granite-warlord":C("/sprites/battle/enemies/Grand_Golem.gif"),basilisk:C("/sprites/battle/enemies/Lizard_King.gif"),"fire-commander":C("/sprites/battle/enemies/Red_Demon.gif"),"volcano-warlord":C("/sprites/battle/enemies/Grand_Chimera.gif"),"storm-commander":C("/sprites/battle/enemies/Tornado_Lizard.gif"),hydra:C("/sprites/battle/enemies/Hydra.gif"),overseer:C("/sprites/battle/enemies/Chimera.gif"),chimera:C("/sprites/battle/enemies/Chimera.gif"),"tempest-warlord":C("/sprites/battle/enemies/Thunder_Lizard.gif"),"bandit-minion":C("/sprites/battle/enemies/Thief.gif"),"bandit-captain":C("/sprites/battle/enemies/Brigand.gif"),"sentinel-enemy":C("/sprites/battle/enemies/Living_Armor.gif"),"stormcaller-enemy":C("/sprites/battle/enemies/Ghost_Mage.gif"),"mercury-slime":C("/sprites/battle/enemies/Slime.gif"),"mars-bandit":C("/sprites/battle/enemies/Brigand.gif"),"mars-sprite":C("/sprites/battle/enemies/Spirit.gif"),"mercury-sprite":C("/sprites/battle/enemies/Will_Head.gif"),"venus-sprite":C("/sprites/battle/enemies/Faery.gif"),"jupiter-sprite":C("/sprites/battle/enemies/Pixie.gif")};Js();function Qs(t,r){const a=Vs[t];return a?a[r]??null:null}function Ma(t,r){const a=Ks[t];return a?a[r]??null:null}function ni(){const t=se(d=>d.flow.screen),r=se(d=>d.flow.modal),a=se(d=>d.startTransition),s=se(d=>d.openModal),n=se(d=>d.closeModal),{currentMapId:i,playerPosition:o,facing:g,movePlayer:p,currentTrigger:c,clearTrigger:l,teleportPlayer:u,resetLastTrigger:f,team:_,mode:k,handleTrigger:w,story:I}=M(d=>({currentMapId:d.currentMapId,playerPosition:d.playerPosition,facing:d.facing,movePlayer:d.movePlayer,currentTrigger:d.currentTrigger,clearTrigger:d.clearTrigger,teleportPlayer:d.teleportPlayer,resetLastTrigger:d.resetLastTrigger,team:d.team,mode:d.mode,handleTrigger:d.handleTrigger,story:d.story}));P(()=>{k==="team-select"?a("team-select"):k==="battle"?a("battle"):k==="shop"?a("shop"):k==="rewards"?a("rewards"):k==="dialogue"?s("dialogue"):k==="overworld"&&n()},[k,a,s,n]);const h=Ke[i],m=()=>{const d={up:{x:0,y:-1},down:{x:0,y:1},left:{x:-1,y:0},right:{x:1,y:0}};return{x:o.x+d[g].x,y:o.y+d[g].y}},T=()=>{if(!h)return;let d=Ut(h,o);if(!d){const E=m();d=Ut(h,E)}if(!d)return;let x=!0;if(d.type==="battle"){const E=d.data.encounterId;E&&(I.flags[E]===!0?x=!1:ma(I,E)||(x=!1))}x&&w(d)};if(P(()=>{if(t!=="overworld"||r!==null)return;const d=x=>{t!=="overworld"||r!==null||(x.key==="ArrowUp"?(x.preventDefault(),p("up")):x.key==="ArrowDown"?(x.preventDefault(),p("down")):x.key==="ArrowLeft"?(x.preventDefault(),p("left")):x.key==="ArrowRight"?(x.preventDefault(),p("right")):x.key===" "||x.key==="Enter"?(x.preventDefault(),T()):x.key==="Escape"&&(x.preventDefault(),s("pause")))};return window.addEventListener("keydown",d),()=>window.removeEventListener("keydown",d)},[p,s,t,r,o,g,h,w,I]),P(()=>{if(c){if(c.type==="transition"){const d=c.data;d.targetMap&&d.targetPos&&u(d.targetMap,d.targetPos)}l(),f()}},[c,l,u,f]),!h)return e("div",{children:"No overworld map loaded."});const v=h.encounterRate?Math.round(h.encounterRate*100):0,b=h.encounterRate&&h.encounterPool&&h.encounterPool.length>0;return e("div",{class:"overworld-shell",children:[e("div",{class:"location-banner",children:[e("div",{class:"location-title",children:h.name}),e("div",{class:"location-meta",children:[b&&e("span",{class:"location-chip",children:["Encounters ",v,"%"]}),e("span",{class:"location-chip location-chip--ghost",children:"ESC for pause menu"})]})]}),e("div",{class:"overworld-stage",children:e("div",{class:"overworld-container",children:h.tiles.map((d,x)=>e("div",{class:"tile-row",children:d.map((E,$)=>{const K=o.x===$&&o.y===x,Y=h.npcs.find(G=>G.position.x===$&&G.position.y===x);return e("div",{class:`tile tile-${E.type}`,style:{backgroundImage:E.spriteId&&(E.spriteId.startsWith("/")||E.spriteId.startsWith("http"))?`url(${E.spriteId})`:void 0,position:"relative"},"data-sprite":E.spriteId??void 0,children:[Y&&!K&&e(H,{id:(()=>{const G=Y.spriteId;return G&&(G.startsWith("/")||G.startsWith("http"))?G:Us(Y.id)})(),width:32,height:32,style:{position:"absolute",top:0,left:0,zIndex:2}}),K&&_&&_.units[0]&&e(H,{id:qs(_.units[0].id,g),width:32,height:32,style:{position:"absolute",top:0,left:0,zIndex:3,transform:Os(g)?"scaleX(-1)":"none"}})]},`${$}-${x}`)})},x))})})]})}function mt(t){switch(t.type){case"turn-start":return`Turn ${t.turn} â€” ${t.actorId}`;case"ability":return`${t.casterId} used ${t.abilityId}`;case"hit":return`${t.targetId} took ${t.amount}${t.element?` [${t.element}]`:""}`;case"heal":return`${t.targetId} recovered ${t.amount} HP`;case"auto-heal":return`âœ¨ ${t.message}`;case"mana-generated":return`âš¡ ${t.source} generated +${t.amount} mana! (${t.newTotal} total)`;case"status-applied":{const a={poison:"Poisoned",burn:"Burned",freeze:"Frozen",paralyze:"Paralyzed"}[t.status.type]||t.status.type;return`${t.targetId} is ${a}!`}case"status-expired":{const a={poison:"Poison",burn:"Burn",freeze:"Freeze",paralyze:"Paralysis"}[t.status.type]||t.status.type;return`${t.targetId} recovered from ${a}`}case"ko":return`${t.unitId} is down!`;case"xp":return`${t.unitId} gained ${t.xp} XP${t.levelUp?` (Lv ${t.levelUp.to})`:""}`;case"battle-end":return`Battle ended: ${t.result}`;case"encounter-finished":return`Encounter completed: ${t.outcome}`;case"djinn-standby":case"djinn-recovered":{const r=t.djinnIds.map(n=>oe[n]?.name??n).filter(Boolean).join(", ")||"Djinn",a=t.type==="djinn-standby"?"Standby":"Recovered",s=n=>n>=0?`+${n}`:`${n}`;return`${r} ${a} â€” ${t.unitId} ATK ${s(t.atkDelta)}, DEF ${s(t.defDelta)}`}default:return console.warn("Unhandled event type:",t),""}}function Xs({events:t,renderText:r}){const a=t.length>0?t.slice(0,3).map(r).join(". "):"";return e("div",{className:"battle-log",role:"log","aria-live":"polite","aria-label":"Battle log",style:{marginTop:"1rem",padding:"1rem",backgroundColor:"#1e1e1e",color:"#fff",borderRadius:"4px",maxHeight:"200px",overflowY:"auto"},children:[e("h4",{style:{marginTop:0},children:"Battle Log"}),e("div",{style:{display:"flex",flexDirection:"column",gap:"0.25rem"},children:t.length===0?e("div",{style:{color:"#888",fontStyle:"italic"},children:"No events yet..."}):t.map((s,n)=>e("div",{style:{fontSize:"0.875rem",padding:"0.25rem",backgroundColor:n===0?"#333":"transparent",borderRadius:"2px"},children:r(s)},n))}),a&&e("div",{"aria-hidden":"true",style:{position:"absolute",left:"-9999px"},children:a})]})}function Zs({victory:t,onComplete:r}){const[a,s]=F(0),n=t?["You are victorious!","The enemies have been defeated!","Your skills have improved from this battle."]:["Your party has been defeated...","You must retreat and recover."],i=n[a],o=a===n.length-1,g=()=>{o?r():s(p=>p+1)};return P(()=>{const p=c=>{(c.key==="Enter"||c.key===" ")&&(c.preventDefault(),c.stopPropagation(),g())};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[a,o,r]),e("div",{className:`post-battle-cutscene ${t?"victory":"defeat"}`,children:e("div",{className:"cutscene-container",children:[e("div",{className:"cutscene-background",children:t&&e("div",{className:"victory-particles"})}),e("div",{className:"cutscene-message-box",children:[e("div",{className:"cutscene-header",children:e("h2",{children:t?"VICTORY":"DEFEAT"})}),e("div",{className:"cutscene-content",children:e("p",{className:"cutscene-text",children:i})}),e("div",{className:"cutscene-footer",children:[e("div",{className:"progress-indicator",children:n.map((p,c)=>e("span",{className:`progress-dot ${c===a?"active":""} ${c<a?"completed":""}`},c))}),e("button",{onClick:g,className:"cutscene-button","aria-label":o?"Continue to rewards":"Next message",children:o?t?"CLAIM REWARDS":"RETURN":"CONTINUE"})]}),e("div",{className:"cutscene-hint",children:"Press [ENTER] or [SPACE] to continue"})]})]})})}function en({onComplete:t,duration:r=2e3}){const[a,s]=F("fanfare");return P(()=>{const n=setTimeout(()=>{s("sparkles")},800),i=setTimeout(()=>{s("complete"),t()},r);return()=>{clearTimeout(n),clearTimeout(i)}},[r,t]),a==="complete"?null:e("div",{className:"victory-overlay",children:[e("div",{className:"victory-flash"}),e("div",{className:"victory-text",children:[e("h1",{className:"victory-title",children:"VICTORY!"}),e("div",{className:"victory-stars",children:[e("span",{className:"star star-1",children:"*"}),e("span",{className:"star star-2",children:"*"}),e("span",{className:"star star-3",children:"*"})]})]}),a==="sparkles"&&e("div",{className:"victory-particles",children:[...Array(20)].map((n,i)=>e("div",{className:"particle",style:{left:`${Math.random()*100}%`,animationDelay:`${Math.random()*.5}s`,animationDuration:`${1+Math.random()}s`}},i))})]})}function tn({onComplete:t,duration:r=2500}){const[a,s]=F("fadeIn");return P(()=>{const n=setTimeout(()=>{s("text")},500),i=setTimeout(()=>{s("complete"),t()},r);return()=>{clearTimeout(n),clearTimeout(i)}},[r,t]),a==="complete"?null:e("div",{class:"defeat-overlay",children:[e("div",{class:"defeat-vignette"}),e("div",{class:"defeat-text",children:[e("h1",{class:"defeat-title",children:"DEFEAT..."}),e("p",{class:"defeat-subtitle",children:"Your party has fallen."})]}),e("button",{class:"defeat-continue",onClick:t,children:"Continue"})]})}function an({currentMana:t,maxMana:r,pendingThisRound:a,pendingNextRound:s}){const n=Array.from({length:r},(i,o)=>o<t?"solid":o<t+a?"pending":"empty");return e("div",{style:{display:"flex",alignItems:"center",gap:8,background:"rgba(0,0,0,0.7)",padding:"6px 12px",borderRadius:6,border:"2px solid rgba(255,215,0,0.5)",boxShadow:"0 2px 8px rgba(0,0,0,0.5)"},"aria-label":`Mana ${t}/${r}`,children:[e("span",{style:{color:"#ffd87f",fontSize:"0.75rem",fontWeight:700,textShadow:"1px 1px 2px #000",letterSpacing:"0.5px"},children:"MANA"}),e("div",{style:{display:"flex",gap:4,alignItems:"center"},children:n.map((i,o)=>e("div",{style:{width:14,height:14,borderRadius:"50%",border:"2px solid rgba(255, 215, 0, 0.7)",backgroundColor:i==="solid"?"#FFD54A":i==="pending"?"rgba(255, 213, 74, 0.4)":"rgba(0,0,0,0.5)",boxShadow:i==="solid"?"0 0 6px rgba(255,215,0,0.8), inset 0 -2px 4px rgba(0,0,0,0.3)":i==="pending"?"0 0 4px rgba(255,215,0,0.4)":"inset 0 2px 4px rgba(0,0,0,0.5)",transition:"all 0.2s ease"},title:i==="solid"?"Available mana":i==="pending"?"Pending this round":"Empty"},o))}),s>0&&e("span",{style:{fontSize:"0.75rem",color:"#90EE90",fontWeight:600,textShadow:"1px 1px 2px #000"},children:["+",s]})]})}const rn={burn:"/sprites/icons/misc/Poison.gif",poison:"/sprites/icons/misc/Poison.gif",paralyze:"/sprites/icons/misc/Psynergy_Seal.gif",freeze:"/sprites/icons/misc/Haunted.gif",stun:"/sprites/icons/misc/Exclamatory.gif",buff:"/sprites/icons/misc/Stat-Up.gif",debuff:"/sprites/icons/misc/Stat-Down.gif",elementalResistance:"/sprites/icons/misc/Venus_Star.gif",damageReduction:"/sprites/icons/misc/Stat-Up.gif",shield:"/sprites/icons/misc/Stat-Up.gif",invulnerable:"/sprites/icons/misc/Stat-Up.gif",immunity:"/sprites/icons/misc/Stat-Up.gif",autoRevive:"/sprites/icons/misc/Up_Arrow.gif"};function sn(t){const r="/sprites/icons/characters",s={Venus:"Isaac1.gif",Mars:"Garet1.gif",Mercury:"Mia.gif",Jupiter:"Ivan.gif"}[t.element];if(s)return`${r}/${s}`;const n="/sprites/battle/party",o={folder:"isaac",prefix:"Isaac",weapon:"lSword"};return`${n}/${o.folder}/${o.prefix}_${o.weapon}_Front.gif`}function nn({unit:t}){const a=t.statusEffects.slice(0,3);return e("div",{style:{display:"flex",gap:4},children:a.map((s,n)=>e("div",{title:s.type,style:{display:"flex",alignItems:"center",gap:2,background:"rgba(0,0,0,0.45)",padding:"2px 4px",borderRadius:3,border:"1px solid rgba(255,216,127,0.25)",minWidth:18},children:[e("img",{src:rn[s.type]??"/sprites/icons/misc/Stat-Up.gif",alt:s.type,width:14,height:14,style:{imageRendering:"pixelated"}}),e("span",{style:{fontSize:"0.7rem",color:"#f6e8b1"},children:"duration"in s&&typeof s.duration=="number"?s.duration:"remainingCharges"in s?s.remainingCharges:""})]},`${s.type}-${n}`))})}function on({units:t,activeIndex:r,queuedActions:a,critCounters:s,critThresholds:n,critFlashes:i,onSelect:o}){return e("div",{style:{display:"flex",gap:6,background:"rgba(0,0,0,0.7)",padding:"6px 8px",border:"2px solid rgba(255,215,0,0.5)",borderRadius:8,boxShadow:"0 4px 12px rgba(0,0,0,0.6)"},children:t.map((g,p)=>{const c=Mr(g),l=Math.max(0,Math.min(1,g.currentHp/c)),u=s[g.id]??0,f=n[g.id]??10,_=a[p]!==null,k=p===r,w=i?.[g.id];return e("button",{onClick:()=>o?.(p),style:{width:56,height:56,position:"relative",border:k?"3px solid #FFD54A":"2px solid rgba(255,215,0,0.3)",borderRadius:8,padding:0,background:"linear-gradient(180deg, #1a1a2e 0%, #0f0f18 100%)",boxShadow:w?"0 0 15px 4px rgba(255, 216, 74, 0.95), inset 0 0 10px rgba(255,215,0,0.3)":k?"0 0 10px rgba(255, 216, 74, 0.7), inset 0 0 5px rgba(255,215,0,0.2)":"inset 0 2px 4px rgba(0,0,0,0.5)",overflow:"hidden",cursor:o?"pointer":"default",transition:"all 0.15s ease"},children:[e("div",{style:{position:"absolute",top:2,right:2,fontSize:"0.65rem",color:"#FFD54A",background:"rgba(0,0,0,0.85)",padding:"1px 4px",borderRadius:3,border:"1px solid #FFD54A",fontWeight:700,textShadow:"0 0 4px rgba(255,215,0,0.8)",letterSpacing:"-0.5px"},title:"Crit counter",children:[u,"/",f]}),_&&e("div",{title:"Queued (click to cancel)",style:{position:"absolute",bottom:4,right:4,background:"#4CAF50",color:"#fff",width:18,height:18,display:"flex",alignItems:"center",justifyContent:"center",fontSize:"0.75rem",borderRadius:4,cursor:"pointer",boxShadow:"0 0 4px rgba(76, 175, 80, 0.8)"},children:"OK"}),e("div",{style:{position:"absolute",bottom:0,left:0,width:"100%",height:6,background:"rgba(0,0,0,0.7)",borderTop:"1px solid rgba(255,255,255,0.1)"},children:e("div",{style:{width:`${l*100}%`,height:"100%",background:l>.5?"linear-gradient(90deg, #4CAF50, #8BC34A)":l>.25?"linear-gradient(90deg, #FF9800, #FFC107)":"linear-gradient(90deg, #f44336, #FF5722)",transition:"width 0.3s ease",boxShadow:"0 0 4px rgba(255,255,255,0.3)"}})}),e(nn,{unit:g}),e("img",{src:sn(g),alt:`${g.name} portrait`,width:64,height:64,style:{imageRendering:"pixelated",width:"100%",height:"100%",objectFit:"contain",background:"radial-gradient(circle at 50% 40%, rgba(255,255,255,0.08), transparent 60%)"}})]},g.id)})})}const ht={attack:"/sprites/icons/buttons/Attack.gif",abilities:"/sprites/icons/buttons/Psynergy.gif",summon:"/sprites/icons/buttons/Summon.gif"},ea={Venus:"/sprites/icons/misc/Venus_Star.gif",Mars:"/sprites/icons/misc/Mars_Star.gif",Mercury:"/sprites/icons/misc/Mercury_Star.gif",Jupiter:"/sprites/icons/misc/Jupiter_Star.gif",Neutral:"/sprites/icons/buttons/Attack.gif",neutral:"/sprites/icons/buttons/Psynergy.gif"},ln={physical:"/sprites/icons/buttons/Attack.gif",healing:"/sprites/icons/misc/Mercury_Star.gif",buff:"/sprites/icons/misc/Stat-Up.gif",debuff:"/sprites/icons/misc/Stat-Down.gif",summon:"/sprites/icons/buttons/Summon.gif",psynergy:"/sprites/icons/buttons/Psynergy.gif"},ta={Venus:{border:"#D4A855",glow:"rgba(212, 168, 85, 0.6)",bg:"rgba(139, 119, 42, 0.25)"},Mars:{border:"#E85D3B",glow:"rgba(232, 93, 59, 0.6)",bg:"rgba(139, 54, 38, 0.25)"},Mercury:{border:"#5BA3D4",glow:"rgba(91, 163, 212, 0.6)",bg:"rgba(42, 95, 139, 0.25)"},Jupiter:{border:"#A855D4",glow:"rgba(168, 85, 212, 0.6)",bg:"rgba(95, 42, 139, 0.25)"},Neutral:{border:"#888888",glow:"rgba(136, 136, 136, 0.4)",bg:"rgba(60, 60, 60, 0.25)"}},aa={"single-enemy":{icon:"T",label:"1"},"all-enemies":{icon:"A",label:"ALL"},"single-ally":{icon:"+",label:"1"},"all-allies":{icon:"++",label:"ALL"},self:{icon:"*",label:"SELF"}},cn={strike:"/sprites/icons/buttons/Attack.gif","heavy-strike":"/sprites/icons/buttons/Attack.gif","focus-strike":"/sprites/icons/buttons/Attack.gif","guard-break":"/sprites/icons/buttons/Attack.gif","precise-jab":"/sprites/icons/buttons/Attack.gif",fortify:"/sprites/icons/buttons/Defend.gif","guardian-stance":"/sprites/icons/buttons/Defend.gif",guard:"/sprites/icons/buttons/Defend.gif","stone-wall":"/sprites/icons/buttons/Defend.gif","iron-wall":"/sprites/icons/buttons/Defend.gif",quake:"/sprites/psynergy/Grand_Gaia.gif",tremor:"/sprites/psynergy/Grand_Gaia.gif","rock-breaker":"/sprites/psynergy/Grand_Gaia.gif",earthquake:"/sprites/psynergy/Grand_Gaia.gif","earth-spike":"/sprites/psynergy/Grand_Gaia.gif","stone-fist":"/sprites/psynergy/Grand_Gaia.gif","granite-guard":"/sprites/psynergy/Grand_Gaia.gif","terra-break":"/sprites/psynergy/Grand_Gaia.gif",nettle:"/sprites/psynergy/Nettle.gif","froth-spiral":"/sprites/psynergy/Froth_Spiral.gif",fireball:"/sprites/psynergy/Heat_Wave.gif","flame-burst":"/sprites/psynergy/Dragon_Fire.gif","fire-burst":"/sprites/psynergy/Dragon_Fire.gif","dragon-fire":"/sprites/psynergy/Dragon_Fire.gif",inferno:"/sprites/psynergy/Inferno.gif","inferno-blaze":"/sprites/psynergy/Inferno.gif","heat-wave":"/sprites/psynergy/Heat_Wave.gif",supernova:"/sprites/psynergy/Supernova.gif",pyroclasm:"/sprites/psynergy/Pyroclasm.gif",fume:"/sprites/psynergy/Fume.gif","fiery-blast":"/sprites/psynergy/Fiery_Blast.gif","flame-strike":"/sprites/psynergy/Heat_Wave.gif",scorch:"/sprites/psynergy/Heat_Wave.gif","ember-wave":"/sprites/psynergy/Heat_Wave.gif","ice-shard":"/sprites/psynergy/Ice_Missile.gif","ice-missile":"/sprites/psynergy/Ice_Missile.gif",freeze:"/sprites/psynergy/Freeze_Prism.gif","freeze-blast":"/sprites/psynergy/Freeze_Prism.gif","freeze-prism":"/sprites/psynergy/Freeze_Prism.gif",glacier:"/sprites/psynergy/Glacier.gif","glacial-wave":"/sprites/psynergy/Glacier.gif",deluge:"/sprites/psynergy/Deluge.gif","aqua-pulse":"/sprites/psynergy/Deluge.gif","frost-storm":"/sprites/psynergy/Glacier.gif",heal:"/sprites/icons/misc/Mercury_Star.gif","party-heal":"/sprites/icons/misc/Mercury_Star.gif",cure:"/sprites/icons/misc/Mercury_Star.gif",gust:"/sprites/psynergy/Sonic_Slash.gif",plasma:"/sprites/psynergy/Spark_Plasma.gif","spark-plasma":"/sprites/psynergy/Spark_Plasma.gif","chain-lightning":"/sprites/psynergy/Blue_Bolt.gif","blue-bolt":"/sprites/psynergy/Blue_Bolt.gif","destruct-ray":"/sprites/psynergy/Destruct_Ray.gif","sonic-slash":"/sprites/psynergy/Sonic_Slash.gif",tempest:"/sprites/psynergy/Tempest.gif","gale-force":"/sprites/psynergy/Sonic_Slash.gif","storm-burst":"/sprites/psynergy/Spark_Plasma.gif","chain-gale":"/sprites/psynergy/Tempest.gif","boost-atk":"/sprites/icons/misc/Stat-Up.gif","boost-def":"/sprites/icons/misc/Stat-Up.gif","boost-attack":"/sprites/icons/misc/Stat-Up.gif","boost-defense":"/sprites/icons/misc/Stat-Up.gif","stone-skin":"/sprites/icons/misc/Stat-Up.gif",weaken:"/sprites/icons/misc/Stat-Down.gif",slow:"/sprites/icons/misc/Stat-Down.gif"};function bt({title:t}){return e("div",{style:{color:"#f6e8b1",fontSize:"0.75rem",marginBottom:4,letterSpacing:.5},children:t})}function ra({abilities:t,selectedAbilityId:r,battle:a,lockedAbilityIds:s,currentUnit:n,onSelect:i}){const o=a.queuedActions[a.currentQueueIndex],g=o?.unitId===n.id?o.manaCost:0,p=a.remainingMana+g;return e("div",{style:{display:"grid",gridTemplateColumns:"repeat(2, 1fr)",gap:6,maxHeight:240,overflowY:"auto",padding:"2px"},children:t.map(c=>{const l=Fr(c.id,c),u=Rr(p,l),f=!!It[c.id],_=s.includes(c.id),k=r===c.id,w=c.element||"Neutral",I=ta[w]??ta.Neutral,h=c.targets||"single-enemy",m=aa[h]||aa["single-enemy"],T=c.basePower||0,v=c.type||"psynergy";return e("button",{onClick:()=>u&&!_&&i(c.id,c),disabled:!u||_,style:{textAlign:"left",background:k?`linear-gradient(135deg, ${I.bg}, rgba(255,213,74,0.15))`:"rgba(0,0,0,0.6)",border:`2px solid ${k?I.border:f?"rgba(186,104,200,0.5)":"rgba(255,255,255,0.15)"}`,borderLeft:`4px solid ${I.border}`,padding:"6px 8px",color:!u||_?"#555":"#f6e8b1",borderRadius:6,fontSize:"0.85rem",cursor:u&&!_?"pointer":"not-allowed",opacity:u&&!_?1:.5,display:"flex",flexDirection:"column",gap:4,transition:"all 0.15s",boxShadow:k?`0 0 12px ${I.glow}`:"none",minHeight:70},children:[e("div",{style:{display:"flex",alignItems:"center",gap:6},children:[e("img",{src:cn[c.id]||ea[w]||ln[v]||ea.neutral,alt:"",width:18,height:18,style:{imageRendering:"pixelated",flexShrink:0,filter:u?"none":"grayscale(100%)"}}),e("span",{style:{color:f?"#ce93d8":I.border,fontWeight:700,fontSize:"0.8rem",textShadow:"1px 1px 2px #000",flex:1,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:c.name}),e("div",{style:{color:u?"#ffd700":"#555",fontWeight:700,fontSize:"0.7rem",background:"rgba(0,0,0,0.5)",padding:"2px 5px",borderRadius:3,border:"1px solid rgba(255,215,0,0.4)"},children:l})]}),e("div",{style:{display:"flex",alignItems:"center",gap:4,fontSize:"0.65rem"},children:[e("div",{style:{color:"#aaa",background:"rgba(0,0,0,0.4)",padding:"1px 4px",borderRadius:2,display:"flex",alignItems:"center",gap:2},title:h,children:[e("span",{children:m.icon}),e("span",{children:m.label})]}),T>0&&e("div",{style:{color:v==="healing"?"#7FFFD4":"#ff9999",background:"rgba(0,0,0,0.4)",padding:"1px 4px",borderRadius:2},title:`Base power: ${T}`,children:[v==="healing"?"+":"x",T]}),(v==="buff"||v==="debuff")&&e("div",{style:{color:v==="buff"?"#90EE90":"#FFB6C1",background:"rgba(0,0,0,0.4)",padding:"1px 4px",borderRadius:2},children:v==="buff"?"^BUFF":"vDEBUFF"})]})]},c.id)})})}function gn({battle:t,currentUnit:r,selectedAbilityId:a,mode:s,onModeChange:n,onSelectAttack:i,onSelectAbility:o}){const g=M(m=>m.queueDjinnActivation),p=M(m=>m.setSummonScreenOpen),[c,l]=F([]),u=U(()=>r?Br(r,t.playerTeam).map(m=>m.abilityId):[],[r,t.playerTeam]),f=U(()=>Ar(t.playerTeam),[t.playerTeam]);if(!r)return e("div",{style:{background:"rgba(0,0,0,0.85)",border:"2px solid rgba(255,215,0,0.4)",padding:12,borderRadius:8,color:"#888",minHeight:80,textAlign:"center",fontStyle:"italic"},children:"Select a unit to begin."});const _=r.abilities.filter(m=>r.unlockedAbilityIds.includes(m.id)),k=_.filter(m=>It[m.id]),w=_.filter(m=>!It[m.id]),I=m=>{l(T=>T.includes(m)?T.filter(v=>v!==m):T.length>=3?T:[...T,m])},h=()=>{c.forEach(m=>g(m)),p(!1),l([]),n("root")};return s==="abilities"?e("div",{style:{background:"rgba(0,0,0,0.9)",border:"2px solid #ffd700",padding:10,borderRadius:8,width:360,maxHeight:320,overflowY:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.8)"},children:[e("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e(bt,{title:"PSYNERGY"}),e("button",{onClick:()=>n("root"),style:{background:"rgba(0,0,0,0.6)",border:"2px solid #ffd700",color:"#ffd87f",borderRadius:4,padding:"4px 12px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,textShadow:"1px 1px 2px #000"},children:["<"," BACK"]})]}),w.length>0&&e(ie,{children:[e("div",{style:{color:"#aaa",fontSize:"0.7rem",marginBottom:4,letterSpacing:.5},children:"UNIT ABILITIES"}),e(ra,{abilities:w,selectedAbilityId:a,battle:t,lockedAbilityIds:u,currentUnit:r,onSelect:o})]}),k.length>0&&e("div",{style:{marginTop:12,paddingTop:10,borderTop:"2px solid rgba(186, 104, 200, 0.5)",background:"linear-gradient(180deg, rgba(186, 104, 200, 0.15) 0%, transparent 100%)",borderRadius:"0 0 6px 6px",padding:"10px 6px 6px 6px",marginLeft:-6,marginRight:-6,marginBottom:-4},children:[e("div",{style:{display:"flex",alignItems:"center",gap:6,color:"#ce93d8",fontSize:"0.75rem",marginBottom:6,letterSpacing:.5,fontWeight:600},children:[e("img",{src:"/sprites/icons/buttons/Djinni.gif",alt:"",width:16,height:16,style:{imageRendering:"pixelated"}}),"DJINN ABILITIES"]}),e(ra,{abilities:k,selectedAbilityId:a,battle:t,lockedAbilityIds:u,currentUnit:r,onSelect:o})]}),w.length===0&&k.length===0&&e("div",{style:{color:"#888",fontStyle:"italic",textAlign:"center",padding:16},children:"No abilities available"})]}):s==="summon"?e("div",{style:{background:"rgba(0,0,0,0.9)",border:"2px solid #ffd700",padding:10,borderRadius:8,width:360,maxHeight:320,overflowY:"auto",boxShadow:"0 4px 20px rgba(0,0,0,0.8)"},children:[e("div",{style:{display:"flex",justifyContent:"space-between",marginBottom:8},children:[e(bt,{title:"SUMMON"}),e("button",{onClick:()=>{l([]),n("root")},style:{background:"rgba(0,0,0,0.6)",border:"2px solid #ffd700",color:"#ffd87f",borderRadius:4,padding:"4px 12px",cursor:"pointer",fontSize:"0.8rem",fontWeight:600,textShadow:"1px 1px 2px #000"},children:["<"," BACK"]})]}),f.length===0?e("div",{style:{color:"#888",fontStyle:"italic",textAlign:"center",padding:16},children:"No Djinn are set. Equip Djinn to summon."}):e("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[f.map(m=>{const T=oe[m];if(!T)return null;const v=c.includes(m);return e("label",{style:{display:"flex",gap:10,alignItems:"center",padding:"8px 10px",border:`2px solid ${v?"#ffd700":"rgba(255,255,255,0.2)"}`,borderRadius:6,background:v?"rgba(255,213,74,0.1)":"rgba(0,0,0,0.5)",cursor:"pointer",color:"#f6e8b1",textShadow:"1px 1px 2px #000"},children:[e("input",{type:"checkbox",checked:v,onChange:()=>I(m),style:{width:16,height:16}}),e("div",{style:{display:"flex",flexDirection:"column",gap:2},children:[e("span",{style:{fontWeight:700},children:T.name}),e("span",{style:{fontSize:"0.8rem",color:"#ccc"},children:T.summonEffect.description})]}),e("span",{style:{marginLeft:"auto",fontSize:"0.8rem",color:"#ffd87f"},children:[T.element," Djinn"]})]},m)}),e("button",{onClick:h,disabled:c.length===0,style:{padding:"8px 12px",background:c.length>0?"#FFD54A":"rgba(255,255,255,0.08)",color:c.length>0?"#000":"#888",border:"1px solid rgba(255,255,255,0.18)",borderRadius:6,cursor:c.length>0?"pointer":"not-allowed",fontWeight:700,letterSpacing:.5},children:["Summon (",c.length,"/3)"]})]})]}):e("div",{style:{background:"rgba(0,0,0,0.85)",border:"2px solid #ffd700",padding:10,borderRadius:8,width:200,boxShadow:"0 4px 20px rgba(0,0,0,0.7)"},children:[e(bt,{title:"ACTIONS"}),e("div",{style:{display:"flex",flexDirection:"column",gap:8},children:[e("button",{onClick:i,style:{display:"flex",alignItems:"center",gap:10,width:"100%",background:"rgba(0,0,0,0.5)",border:"2px solid rgba(255, 213, 74, 0.7)",borderRadius:6,padding:"8px 10px",cursor:"pointer",transition:"all 0.15s"},children:[e("img",{src:ht.attack,alt:"",width:24,height:24,style:{imageRendering:"pixelated",transform:"scale(1.5)",transformOrigin:"center"}}),e("div",{style:{textAlign:"left"},children:[e("div",{style:{color:"#ffd87f",fontWeight:600,fontSize:"0.95rem",textShadow:"1px 1px 2px #000"},children:"ATTACK"}),e("div",{style:{color:"#aaa",fontSize:"0.75rem"},children:"+1 mana"})]})]}),e("button",{onClick:()=>n("abilities"),style:{display:"flex",alignItems:"center",gap:10,width:"100%",background:"rgba(0,0,0,0.5)",border:"2px solid rgba(255,255,255,0.3)",borderRadius:6,padding:"8px 10px",cursor:"pointer"},children:[e("img",{src:ht.abilities,alt:"",width:24,height:24,style:{imageRendering:"pixelated",transform:"scale(1.5)",transformOrigin:"center"}}),e("div",{style:{textAlign:"left"},children:[e("div",{style:{color:"#f6e8b1",fontWeight:600,fontSize:"0.95rem",textShadow:"1px 1px 2px #000"},children:"PSYNERGY"}),e("div",{style:{color:"#888",fontSize:"0.75rem"},children:"Abilities"})]})]}),e("button",{onClick:()=>{p(!0),n("summon")},disabled:f.length===0,style:{display:"flex",alignItems:"center",gap:10,width:"100%",background:"rgba(0,0,0,0.5)",border:"2px solid rgba(255,215,0,0.3)",borderRadius:6,padding:"8px 10px",cursor:f.length>0?"pointer":"not-allowed",opacity:f.length>0?1:.6},children:[e("img",{src:ht.summon,alt:"",width:24,height:24,style:{imageRendering:"pixelated",transform:"scale(1.5)",transformOrigin:"center"}}),e("div",{style:{textAlign:"left"},children:[e("div",{style:{color:"#f6e8b1",fontWeight:600,fontSize:"0.95rem",textShadow:"1px 1px 2px #000"},children:"SUMMON"}),e("div",{style:{color:"#888",fontSize:"0.75rem"},children:[f.length," Djinn ready"]})]})]})]})]})}function pn({battleType:t,locationName:r,floorNumber:a}){const n=t==="tower"&&a?`Battle Tower - Floor ${a}`:r;return e("div",{style:{background:"rgba(0,0,0,0.75)",border:"2px solid rgba(255,215,0,0.65)",borderRadius:8,padding:"6px 12px",color:"#ffd87f",fontWeight:700,letterSpacing:.5,textShadow:"1px 1px 2px #000",boxShadow:"0 4px 12px rgba(0,0,0,0.5)",display:"flex",alignItems:"center",gap:8},children:[e("span",{style:{padding:"2px 6px",borderRadius:4,background:"rgba(0,0,0,0.5)",border:"1px solid rgba(255,215,0,0.5)",color:"#ffe9a1",fontSize:"0.8rem"},children:t==="tower"?"Battle Tower":t==="demo"?"Demo":"Story Battle"}),e("span",{style:{fontSize:"0.9rem"},children:n})]})}const un={small:{width:32,height:32},medium:{width:48,height:48},large:{width:64,height:64}},dn={idle:"idle",attack:"attack",hit:"hit",damage:"hit"};function tt({unitId:t,state:r="idle",isPlayer:a=!0,size:s="medium",className:n,style:i}){const o=un[s],g=dn[r]??"idle",p=Qs(t,g)??Ma(t,g)??null,c=p??`missing-battle-sprite-${t}-${g}`,l=[];a||(r==="attack"?l.push("enemy-lunge"):r==="hit"&&l.push("enemy-shake"));const u=[n,...l].filter(Boolean).join(" ")||void 0;return e(H,{id:c,width:o.width,height:o.height,className:u,style:i,alt:p?`${t} sprite`:`Missing battle sprite for ${t}`})}function yn(t){if(!t)return"idle";switch(t){case"planning":return"planning";case"executing":return"executing";case"victory":return"victory";case"defeat":return"defeat";default:return"idle"}}const mn={WINDUP:200,EXECUTE:{ABILITY:1800,HEAL:1400,STATUS:1e3},IMPACT:{DAMAGE:400,HEAL:350,KO:800,STATUS:300},INTER_EVENT:350,MIN_DISPLAY:800};function hn(t,r){const a=mn;switch(t){case"ability":return a.WINDUP+a.EXECUTE.ABILITY+a.IMPACT.DAMAGE+a.INTER_EVENT;case"hit":return a.IMPACT.DAMAGE+a.INTER_EVENT;case"heal":return a.WINDUP+a.EXECUTE.HEAL+a.IMPACT.HEAL+a.INTER_EVENT;case"status-applied":case"status-expired":return a.EXECUTE.STATUS+a.IMPACT.STATUS+a.INTER_EVENT;case"ko":return a.IMPACT.KO+a.INTER_EVENT;case"auto-heal":return a.EXECUTE.HEAL+a.INTER_EVENT;default:return a.MIN_DISPLAY+a.INTER_EVENT}}const bn={slow:1.5,normal:1,fast:.6,instant:.1};function fn(){const[t,r]=F(()=>typeof window>"u"?"normal":localStorage.getItem("battleSpeed")||"normal"),a=fe(o=>{r(o),typeof window<"u"&&localStorage.setItem("battleSpeed",o)},[]),s=U(()=>bn[t],[t]),n=fe(o=>Math.round(o*s),[s]),i=fe(()=>{const o=["slow","normal","fast","instant"],p=(o.indexOf(t)+1)%o.length;a(o[p])},[t,a]);return{speedPreset:t,multiplier:s,setSpeed:a,applySpeed:n,cycleSpeed:i}}const Ee={BATTLE_LOG:45,BOTTOM_BAR:50,MODE_LABEL:55,TARGET_MODAL:60,RESOLVING_CARD:80,FX_CARD:90},B={grandGaia:"/sprites/psynergy/Grand_Gaia.gif",pyroclasm:"/sprites/psynergy/Pyroclasm.gif",sparkPlasma:"/sprites/psynergy/Spark_Plasma.gif",deluge:"/sprites/psynergy/Deluge.gif",blueBolt:"/sprites/psynergy/Blue_Bolt.gif",heatWave:"/sprites/psynergy/Heat_Wave.gif",tempest:"/sprites/psynergy/Tempest.gif",glacier:"/sprites/psynergy/Glacier.gif",freezePrism:"/sprites/psynergy/Freeze_Prism.gif",inferno:"/sprites/psynergy/Inferno.gif",supernova:"/sprites/psynergy/Supernova.gif",dragonFire:"/sprites/psynergy/Dragon_Fire.gif",fieryBlast:"/sprites/psynergy/Fiery_Blast.gif",iceMissile:"/sprites/psynergy/Ice_Missile.gif",fume:"/sprites/psynergy/Fume.gif",sonicSlash:"/sprites/psynergy/Sonic_Slash.gif"},vn=B.sonicSlash,sa={strike:B.sonicSlash,"heavy-strike":B.sonicSlash,"guard-break":B.sonicSlash,"precise-jab":B.sonicSlash,"wooden-strike":B.sonicSlash,"bronze-slash":B.sonicSlash,"iron-thrust":B.sonicSlash,"iron-bulwark":B.sonicSlash,"arcane-bolt":B.blueBolt,"steel-focus":B.sonicSlash,fireball:B.heatWave,"fire-burst":B.heatWave,flare:B.heatWave,"burn-touch":B.heatWave,"inferno-slash":B.inferno,supernova:B.supernova,pyroclasm:B.pyroclasm,"dragon-breath":B.dragonFire,"flame-burst-damage":B.fieryBlast,"blazing-fury":B.fieryBlast,"meteor-strike":B.pyroclasm,"ice-shard":B.glacier,"freeze-blast":B.freezePrism,blizzard:B.freezePrism,"ice-lance-damage":B.iceMissile,heal:B.deluge,"party-heal":B.deluge,cure:B.deluge,"chain-lightning":B.sparkPlasma,"paralyze-shock":B.sparkPlasma,tempest:B.tempest,gust:B.tempest,"plasma-shot":B.blueBolt,quake:B.grandGaia,earthquake:B.grandGaia,"earth-spike":B.grandGaia,"poison-strike":B.fume,"boost-atk":B.heatWave,"boost-def":B.grandGaia,"weaken-def":B.fume,blind:B.fume,guard:B.grandGaia};function na(t){if(!t||t.type!=="ability")return null;const r=t.abilityId;if(["strike","heavy-strike","guard-break","precise-jab"].includes(r))return B.sonicSlash;if(sa[r])return sa[r];const a=ua[r];if(a?.element)switch(a.element){case"Mars":return B.heatWave;case"Mercury":return B.deluge;case"Jupiter":return B.sparkPlasma;case"Venus":return B.grandGaia}return B.sonicSlash}const wn=[{id:"venus",name:"Flint",path:"/sprites/battle/djinn/Venus_Djinn_Front.gif"},{id:"mars",name:"Granite",path:"/sprites/battle/djinn/Mars_Djinn_Front.gif"},{id:"mercury",name:"Echo",path:"/sprites/battle/djinn/Mercury_Djinn_Front.gif"}];function ii(){const t=se(y=>y.setScreen),r=M(y=>y.battle),a=M(y=>y.events),s=M(y=>y.dequeueEvent),n=M(y=>y.queueUnitAction),i=M(y=>y.clearUnitAction),o=M(y=>y.executeQueuedRound),g=M(y=>y.setMode),p=M(y=>y.mode),c=M(y=>y.startDialogueTree),l=M(y=>y.returnToOverworld),u=M(y=>y.activePortraitIndex),f=M(y=>y.setActivePortrait),_=M(y=>y.currentMana),k=M(y=>y.maxMana),w=M(y=>y.pendingManaThisRound),I=M(y=>y.pendingManaNextRound),h=M(y=>y.towerStatus),m=M(y=>y.activeTowerEncounterId),T=M(y=>y.getCurrentTowerFloor),v=M(y=>y.critCounters),b=M(y=>y.critThresholds),d=M(y=>y.critFlash),x=M(y=>y.incrementCritCounter),E=M(y=>y.resetCritCounter),$=M(y=>y.triggerCritFlash),K=M(y=>y.lastBattleRewards),Y=M(y=>y.processVictory),G=M(y=>y.lastError),pe=M(y=>y.clearError),we=()=>{l(),t("overworld")},q=a.length>0?"executing":yn(r?.phase),{speedPreset:je,applySpeed:Q,cycleSpeed:ue}=fn(),[Z,S]=F(void 0),[R,j]=F("root"),[J,O]=F(!1),[te,qe]=F(!1),[Ba,at]=F(!1),[de,$e]=F(null),Ue=re(new Set),[Et,Oe]=F([]),Mt=re(0),De=re(new Map),rt=re(void 0),st=re(void 0),Pe=re(void 0);P(()=>{r&&Ue.current.clear()},[r]),P(()=>{!r&&(h==="in-run"||h==="completed")&&(g("tower"),t("tower"))},[r,h,g,t]),P(()=>{if(q==="planning"&&u===null&&r){const y=ut(r);y.length>0&&y[0]!==void 0&&f(y[0])}},[q,u,r,f]),P(()=>{if(!r){$e(null),O(!1),qe(!1),at(!1);return}if(q==="victory"){$e("victory"),O(!0);return}if(q==="defeat"){$e("defeat"),O(!0);return}$e(null),O(!1),qe(!1)},[q,r]),P(()=>{!r||de!=="victory"||h==="in-run"&&m||!J&&!te&&p!=="rewards"&&!K&&Y(r)},[r,de,p,K,Y,h,m,J,te]);const Bt=U(()=>na(a[0]),[a]);P(()=>(De.current.forEach(y=>clearTimeout(y)),De.current.clear(),Oe([]),rt.current=void 0,st.current=void 0,()=>{De.current.forEach(y=>clearTimeout(y)),De.current.clear()}),[r]),P(()=>()=>{Oe([])},[]),P(()=>{if(!r||q!=="executing")return;const y=a[0];if(y&&y!==rt.current&&(rt.current=y,y.type==="hit"||y.type==="heal")){const D=Mt.current+1;Mt.current=D;const W=y.type==="heal"?"heal":"damage";Oe(L=>[...L,{id:D,unitId:y.targetId,amount:y.amount,kind:W}]);const N=setTimeout(()=>{Oe(L=>L.filter(le=>le.id!==D)),De.current.delete(D)},1150);De.current.set(D,N)}},[q,a,r]);const Aa=["strike","heavy-strike","guard-break","precise-jab"];P(()=>{if(!r||q!=="executing")return;const y=a[0];if(y&&y!==st.current&&(st.current=y,y.type==="ability"&&Aa.includes(y.abilityId))){const D=y.casterId;if(r.playerTeam.units.some(N=>N.id===D)){const N=(v[D]??0)+1,L=b[D]??10;N>=L?(E(D),$(D)):x(D)}}},[q,a,r,v,b,x,E,$]),P(()=>{if(!r||q!=="executing"||a.length===0)return;const y=a[0],D=`${y.type}-${y.type==="ability"?y.casterId:y.type==="turn-start"?y.actorId:"event"}-${Date.now()}`;Pe.current=D;const W=hn(y?.type??"unknown",Ue.current.has(Bt??"")),N=Q(W),L=setTimeout(()=>{Pe.current===D&&(s(),Pe.current=void 0)},N);return()=>{clearTimeout(L),Pe.current===D&&(Pe.current=void 0)}},[q,a,s,Bt,r,Q]);const ae=U(()=>!r||u==null?null:r.playerTeam.units[u]??null,[r,u]),At=U(()=>r?.queuedActions.reduce((y,D)=>y+(D?.manaCost||0),0)||0,[r?.queuedActions]),nt=U(()=>{if(!r)return!1;const y=r.playerTeam.units.filter(W=>!he(W));let D=0;for(let W=0;W<r.playerTeam.units.length;W++){const N=r.playerTeam.units[W],L=r.queuedActions[W];N&&!he(N)&&L!==null&&D++}return y.length===D&&At<=r.maxMana},[r,At]),Fa=U(()=>h==="in-run"?T():null,[h,T]),Ra=h==="in-run"?"tower":"story",ja=r?.meta?.encounterId||r?.encounterId||"Story Battle",z=a[0],Ft=z?.type==="ability"?z.casterId:z?.type==="hit"||z?.type==="heal"||z?.type==="status-applied"||z?.type==="status-expired"?void 0:z?.type==="ko"?z.unitId:void 0,Ge=new Set;z&&(z.type==="ability"?z.targets.forEach(y=>Ge.add(y)):z.type==="hit"||z.type==="heal"||z.type==="status-applied"||z.type==="status-expired"?Ge.add(z.targetId):z.type==="ko"&&Ge.add(z.unitId));const Pa=()=>{if((r?Ae(r):null)===Ja){const D=be[Va];if(D){c(D),g("dialogue");return}}we()},Ga=()=>{qe(!1),!(h==="in-run"&&m)&&de==="victory"&&(r&&!K?Y(r):K&&g("rewards"))},Rt=()=>{S(null),j("root")},La=(y,D)=>{if(Z===y){S(void 0);return}S(y),j("root")},it=(y,D)=>{if(!ae||u===null||!r)return;const W=D??Z,N=W?ae.abilities.find(V=>V.id===W):void 0;let L=[y];const le=r.enemies.filter(V=>!he(V)).map(V=>V.id),A=r.playerTeam.units.filter(V=>!he(V)).map(V=>V.id);switch(N?.targets){case"all-enemies":L=le;break;case"all-allies":L=A;break;case"self":L=[ae.id];break;default:L=[y]}if(r.queuedActions[u]!==null){const V=ut(r),qa=V.indexOf(u);for(let ct=qa+1;ct<V.length;ct++){const gt=V[ct];if(gt!==void 0&&r.queuedActions[gt]===null){f(gt);break}}S(void 0);return}if(!n(u,W??null,L,N))return;S(void 0);const ot=ut(r),lt=ot.indexOf(u);if(lt!==-1&&lt<ot.length-1){const V=ot[lt+1];V!==void 0&&f(V)}},jt=fe(()=>{if(!r||q!=="planning"||!ae||u===null||he(ae))return;const D=Ot(null,ae,r.playerTeam,r.enemies)[0];D&&(Rt(),it(D.id,null))},[r,q,ae,u]);P(()=>{const y=D=>{D.key!=="q"&&D.key!=="Q"||D.repeat||jt()};return window.addEventListener("keydown",y),()=>{window.removeEventListener("keydown",y)}},[jt]),P(()=>{const y=D=>{(D.key==="s"||D.key==="S")&&(D.repeat||ue())};return window.addEventListener("keydown",y),()=>window.removeEventListener("keydown",y)},[ue]);const Wa=()=>{nt&&q==="planning"&&o()},ze=nt&&q==="planning";if(!r)return e("div",{children:"Loading Battle..."});if(J&&de)return e(Zs,{victory:de==="victory",onComplete:()=>{O(!1),de==="victory"?qe(!0):at(!0)}});if(de==="victory"&&te)return e(en,{onComplete:Ga});if(de==="defeat"&&Ba)return e(tn,{onComplete:()=>{at(!1),Pa()}});let He=[];if(q==="planning"&&Z!==void 0&&ae){const y=Z?ae.abilities.find(D=>D.id===Z):void 0;He=Ot(y||null,ae,r.playerTeam,r.enemies)}const Pt=new Set(He.map(y=>y.id)),Na=Z!==void 0&&He.length>0,ye=q==="executing";return e("div",{"data-testid":"battle-view",style:{width:"100vw",height:"100vh",background:"#000",display:"flex",justifyContent:"center",alignItems:"center",overflow:"hidden",position:"fixed",inset:0,zIndex:999},children:e("div",{style:{width:900,height:600,position:"relative",background:"#000",overflow:"hidden",imageRendering:"pixelated",color:"#fff"},children:[e("style",{children:`
            @keyframes floatNumber {
              0% { opacity: 1; transform: translate(-50%, 0) scale(1); }
              60% { opacity: 1; transform: translate(-50%, -6px) scale(1.02); }
              100% { opacity: 0; transform: translate(-50%, -24px) scale(1.05); }
            }
          `}),e("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,overflow:"hidden"},children:[e("div",{style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",backgroundImage:"url(/sprites/backgrounds/gs1/Kolima_Forest.gif)",backgroundSize:"cover",backgroundPosition:"center 70%",imageRendering:"pixelated",zIndex:0}}),e("div",{style:{position:"absolute",top:8,left:8,zIndex:Ee.MODE_LABEL},children:e(pn,{battleType:Ra,locationName:ja,floorNumber:Fa?.floorNumber})}),ye&&e("div",{style:{position:"absolute",top:16,left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.7)",border:"1px solid rgba(255,216,127,0.4)",borderRadius:8,padding:"8px 12px",color:"#FFD87F",fontWeight:700,letterSpacing:.5,zIndex:5},children:"âš”ï¸ Executing round..."}),e("div",{style:{display:"flex",flexDirection:"column",justifyContent:"center",alignItems:"center",gap:48,height:"100%",position:"relative",zIndex:1},children:[e("div",{style:{position:"absolute",bottom:"42%",left:"8%",display:"flex",gap:"3rem",zIndex:10},children:r.enemies.map(y=>{const D=Pt.has(y.id),W=Ge.has(y.id),N=Ft===y.id,L=a.some(A=>!!(A.type==="ability"&&A.casterId===y.id||A.type==="ability"&&A.targets.includes(y.id)||A.type==="hit"&&A.targetId===y.id||A.type==="heal"&&A.targetId===y.id||A.type==="ko"&&A.unitId===y.id||A.type==="status-applied"&&A.targetId===y.id||A.type==="status-expired"&&A.targetId===y.id));if(he(y)&&!L)return null;const le=N?"attack":W?"hit":"idle";return e("div",{onClick:()=>D&&it(y.id),style:{position:"relative",cursor:D?"pointer":"default",textAlign:"center"},children:[e("div",{style:{position:"absolute",bottom:0,left:"50%",transform:"translateX(-50%)",width:70,height:24,background:"rgba(0,0,0,0.6)",borderRadius:"50%",filter:"blur(4px)",pointerEvents:"none",zIndex:0}}),e("div",{style:{position:"relative",transform:N?"scale(3.2)":"scale(3)",zIndex:1,filter:W?"drop-shadow(0 0 14px rgba(255,216,127,0.9))":D?"drop-shadow(0 0 8px rgba(255,216,127,0.7))":"none"},children:e(tt,{unitId:y.id,state:le,size:"large",isPlayer:!1})}),Et.filter(A=>A.unitId===y.id).map((A,me)=>{const Ce=Math.abs(A.amount);return e("div",{style:{position:"absolute",bottom:`calc(100% + ${me*16+6}px)`,left:"50%",color:A.kind==="heal"?"#6df0a2":"#ff6b6b",fontWeight:800,textShadow:"0 0 6px rgba(0,0,0,0.8)",animation:"floatNumber 1.05s ease-out forwards",pointerEvents:"none",zIndex:12},children:A.kind==="heal"?`+${Ce}`:`-${Ce}`},A.id)}),e("div",{style:{marginTop:4,fontSize:"0.8rem",color:D?"#FFD87F":"#aaa"},children:y.name}),D&&e("div",{style:{color:"#FFD87F",fontSize:"0.75rem"},children:"Click to target"}),W&&e("div",{style:{position:"absolute",top:-12,left:"50%",transform:"translateX(-50%)",color:"#FFD87F",fontSize:"1.2rem",fontWeight:900,textShadow:"0 0 8px rgba(255,216,127,0.9)",pointerEvents:"none",zIndex:15},children:"â¯ˆ"})]},y.id)})}),e("div",{style:{position:"absolute",bottom:"28%",right:"15%",width:260,height:160,zIndex:10},children:r.playerTeam.units.map((y,D)=>{const W=a.some(A=>!!(A.type==="ability"&&A.casterId===y.id||A.type==="ability"&&A.targets.includes(y.id)||A.type==="hit"&&A.targetId===y.id||A.type==="heal"&&A.targetId===y.id||A.type==="ko"&&A.unitId===y.id||A.type==="status-applied"&&A.targetId===y.id||A.type==="status-expired"&&A.targetId===y.id));if(he(y)&&!W)return null;const N=Ft===y.id,L=Ge.has(y.id),le=N?"attack":L?"hit":"idle";return e("div",{style:{position:"absolute",left:D*55,bottom:D*12,textAlign:"center"},children:[e("div",{style:{position:"absolute",bottom:4,left:"50%",transform:"translateX(-50%)",width:48,height:16,background:N||L?"rgba(255,216,127,0.3)":"rgba(0,0,0,0.6)",borderRadius:"50%",filter:"blur(4px)",pointerEvents:"none",zIndex:0}}),e("div",{style:{position:"relative",transform:N?"scale(2.7)":"scale(2.5)",zIndex:1,filter:L?"drop-shadow(0 0 12px rgba(255,216,127,0.8))":"none"},children:e(tt,{unitId:y.id,state:le,size:"large"})}),L&&e("div",{style:{position:"absolute",top:-12,left:"50%",transform:"translateX(-50%)",color:"#FFD87F",fontSize:"1.2rem",fontWeight:900,textShadow:"0 0 8px rgba(255,216,127,0.9)",pointerEvents:"none",zIndex:15},children:"â¯ˆ"}),Et.filter(A=>A.unitId===y.id).map((A,me)=>{const Ce=Math.abs(A.amount);return e("div",{style:{position:"absolute",bottom:`calc(100% + ${me*16+6}px)`,left:"50%",color:A.kind==="heal"?"#6df0a2":"#ff6b6b",fontWeight:800,textShadow:"0 0 6px rgba(0,0,0,0.8)",animation:"floatNumber 1.05s ease-out forwards",pointerEvents:"none",zIndex:12},children:A.kind==="heal"?`+${Ce}`:`-${Ce}`},A.id)})]},y.id)})}),e("div",{style:{position:"absolute",right:"6%",bottom:"34%",display:"flex",flexDirection:"column",gap:4,zIndex:8},children:wn.map((y,D)=>e("div",{style:{position:"relative",left:D%2===0?0:6},children:e("img",{src:y.path,alt:y.name,width:32,height:32,style:{imageRendering:"pixelated",transform:"scale(2.5)"}})},y.id))})]}),He.length>0&&e("div",{style:{position:"absolute",bottom:24,left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.8)",padding:"12px 16px",borderRadius:8,border:"1px solid rgba(255,216,127,0.4)",textAlign:"center",zIndex:Ee.TARGET_MODAL},children:[e("div",{style:{color:"#FFD87F",fontWeight:700,marginBottom:4},children:"Select target"}),e("div",{style:{color:"#ccc",fontSize:"0.9rem"},children:"Click a highlighted target to confirm"}),e("button",{onClick:()=>{S(void 0)},style:{marginTop:8,background:"transparent",border:"1px solid rgba(255,255,255,0.25)",color:"#eaeaea",padding:"6px 10px",borderRadius:6,cursor:"pointer"},children:"Cancel"})]}),ye&&e("div",{style:{position:"absolute",right:16,bottom:16,width:340,maxHeight:"45vh",overflow:"auto",background:"rgba(0,0,0,0.35)",border:"1px solid rgba(255,255,255,0.08)",borderRadius:8,padding:8,zIndex:Ee.BATTLE_LOG},children:e(Xs,{events:a,renderText:mt})})]}),e("div",{style:{position:"absolute",bottom:0,left:0,right:0,height:100,background:"linear-gradient(to top, rgba(8,8,10,0.95), transparent)",display:"flex",justifyContent:"center",alignItems:"center",gap:16,padding:"10px 20px",zIndex:Ee.BOTTOM_BAR},children:[e(an,{currentMana:_,maxMana:k,pendingThisRound:w,pendingNextRound:I}),e(on,{units:r.playerTeam.units,activeIndex:u,queuedActions:r.queuedActions,critCounters:v,critThresholds:b,critFlashes:d,onSelect:y=>{const D=r.playerTeam.units[y];if(Na&&D&&Pt.has(D.id)){it(D.id);return}q==="planning"&&(r.queuedActions[y]!==null?(i(y),f(y),S(void 0)):(f(y),S(void 0)))}}),e("div",{style:{alignSelf:"flex-end",position:"relative",zIndex:60,opacity:ye?.5:1,pointerEvents:ye?"none":"auto",transition:"opacity 0.2s ease"},children:[e(gn,{battle:r,currentUnit:ae,selectedAbilityId:Z??null,mode:R,onModeChange:j,onSelectAttack:Rt,onSelectAbility:La}),ye&&e("div",{style:{position:"absolute",inset:0,background:"rgba(0,0,0,0.4)",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:8,color:"#FFD87F",fontWeight:700,fontSize:"0.9rem"},children:"Resolving..."})]}),e("div",{style:{display:"flex",flexDirection:"column",gap:6,minWidth:200},children:[e("button",{onClick:ue,style:{padding:"6px 10px",background:"rgba(255,255,255,0.1)",color:"#ccc",border:"1px solid rgba(255,255,255,0.2)",borderRadius:6,cursor:"pointer",fontSize:"0.8rem",marginBottom:4},title:"Click to change battle speed (S key)",children:["Speed: ",je.charAt(0).toUpperCase()+je.slice(1)]}),e("button",{onClick:Wa,disabled:!ze,style:{padding:"10px 14px",background:ze?"#FFD54A":"rgba(255,255,255,0.08)",color:ze?"#000":"#888",border:"1px solid rgba(255,255,255,0.18)",borderRadius:8,cursor:ze?"pointer":"not-allowed",fontWeight:700,letterSpacing:.5},children:ye?"Executing...":nt?"Execute Round":"Queue all actions first"}),G&&e("div",{style:{color:"#ffb3b3",fontSize:"0.85rem",background:"rgba(0,0,0,0.6)",border:"1px solid rgba(255,99,71,0.4)",borderRadius:6,padding:"6px 8px",maxWidth:240},children:e("div",{style:{display:"flex",alignItems:"center",gap:8},children:[e("span",{style:{flex:1},children:G}),e("button",{onClick:pe,style:{background:"transparent",border:"none",color:"#ffb3b3",cursor:"pointer",fontWeight:700},"aria-label":"Dismiss error",children:"x"})]})})]})]}),ye&&a.length>0&&e("div",{style:{position:"absolute",top:16,left:"50%",transform:"translateX(-50%)",background:"rgba(0, 0, 0, 0.65)",padding:"8px 14px",borderRadius:8,border:"1px solid rgba(255, 215, 127, 0.4)",color:"#f9e0a8",fontWeight:700,boxShadow:"0 4px 12px rgba(0,0,0,0.45)",zIndex:Ee.RESOLVING_CARD,minWidth:260,textAlign:"center",transition:"transform 0.2s ease, opacity 0.2s ease"},children:["Resolving: ",a[0]?mt(a[0]):"Loading..."]}),ye&&a.length>0&&a[0]?.type==="ability"&&e("div",{style:{position:"absolute",top:"12%",left:"50%",transform:"translateX(-50%)",background:"rgba(0,0,0,0.25)",padding:"14px 18px",borderRadius:12,border:"1px solid rgba(255, 215, 127, 0.45)",boxShadow:"0 12px 28px rgba(0,0,0,0.55)",display:"flex",alignItems:"center",gap:14,zIndex:Ee.FX_CARD,minWidth:420,justifyContent:"center"},children:(()=>{const y=a[0];if(!y||y.type!=="ability")return null;const D=na(y),W=ua[y.abilityId]?.name??y.abilityId,N=y.targets.map(L=>{const le=r.enemies.find(me=>me.id===L),A=r.playerTeam.units.find(me=>me.id===L);return le?.name||A?.name||"Unknown"}).join(", ");return e(ie,{children:[D&&e("img",{src:D,width:180,height:180,style:{borderRadius:10,imageRendering:"pixelated",objectFit:"cover",boxShadow:"0 0 24px rgba(255,255,255,0.65)",mixBlendMode:"screen"},onLoad:()=>Ue.current.add(D),onError:()=>{Ue.current.add(vn)},alt:"Ability effect"}),e("div",{style:{display:"flex",flexDirection:"column",gap:4},children:[e("div",{style:{fontWeight:800,color:"#ffd87f",fontSize:"1.05rem"},children:W}),N&&e("div",{style:{color:"#FFD87F",fontSize:"0.85rem",fontWeight:600},children:["Target: ",N]}),e("div",{style:{color:"#e0e0e0",fontSize:"0.95rem",maxWidth:320},children:mt(y)})]})]})})()})]})})}const ia={left:[{name:"Isaac",sprite:"/sprites/overworld/protagonists/Isaac.gif"},{name:"Garet",sprite:"/sprites/overworld/protagonists/Garet.gif"}],right:[{name:"Ivan",sprite:"/sprites/overworld/protagonists/Ivan.gif"},{name:"Mia",sprite:"/sprites/overworld/protagonists/Mia.gif"}]};function oi(){const t=se(w=>w.startTransition),r=se(w=>w.openModal),a=M(w=>w.setTeam),s=M(w=>w.addUnitToRoster),n=M(w=>w.openTowerFromMainMenu),i=M(w=>w.hasSaveSlot),[o,g]=F(0),[p,c]=F(!1);P(()=>{const w=i(0)||i(1)||i(2);c(w)},[i]);const l=[{id:"new-game",label:"New Game",enabled:!0},{id:"continue",label:"Continue",enabled:p},{id:"compendium",label:"Compendium",enabled:!0},{id:"battle-tower",label:"Battle Tower (Beta)",enabled:!0}],u=l.filter(w=>w.enabled),f=Math.min(o,u.length-1),_=u[f]||u[0];P(()=>{o>=u.length&&g(0)},[u.length,o]),P(()=>{const w=I=>{if(I.key==="ArrowUp"||I.key==="ArrowDown"){I.preventDefault(),I.stopPropagation(),I.key==="ArrowUp"?g(h=>h>0?h-1:u.length-1):g(h=>h<u.length-1?h+1:0);return}if(I.key==="Enter"||I.key===" "){I.preventDefault(),I.stopPropagation(),_&&k(_.id);return}if(I.key==="Escape"){I.preventDefault(),I.stopPropagation(),t("title");return}};return window.addEventListener("keydown",w),()=>window.removeEventListener("keydown",w)},[_,u.length,t]);const k=w=>{if(w==="new-game"){const I=ve(Gt,1,0);s(I);const h=Qe([I]);a(h),t("overworld")}else if(w==="continue")p&&r("save");else if(w==="compendium")t("compendium");else if(w==="battle-tower"){const I=M.getState();if(!I.team||I.team.units.length===0){const h=ve(Gt,1,0);s(h);const m=Qe([h]);a(m)}n(),t("tower")}};return e("div",{class:"main-menu",children:[e("div",{class:"main-menu-characters main-menu-characters--left",children:ia.left.map((w,I)=>e("img",{src:w.sprite,alt:w.name,class:"main-menu-sprite",style:{animationDelay:`${I*.3}s`}},w.name))}),e("div",{class:"main-menu-content",children:[e("h1",{class:"main-menu-title",children:"Vale Chronicles"}),e("div",{class:"main-menu-options",children:l.map(w=>{const I=w.enabled,m=u.findIndex(T=>T.id===w.id)===f&&I;return e("button",{class:`main-menu-option ${m?"selected":""} ${I?"":"disabled"}`,onClick:()=>I&&k(w.id),disabled:!I,children:w.label},w.id)})})]}),e("div",{class:"main-menu-characters main-menu-characters--right",children:ia.right.map((w,I)=>e("img",{src:w.sprite,alt:w.name,class:"main-menu-sprite",style:{animationDelay:`${I*.3}s`}},w.name))})]})}const Sn={small:{width:24,height:24},medium:{width:32,height:32},large:{width:48,height:48}};function kn(t){switch(t){case"weapon":return"âš”ï¸";case"armor":return"ðŸ›¡ï¸";case"helm":return"â›‘ï¸";case"boots":return"ðŸ‘¢";case"accessory":return"ðŸ’";default:return"ðŸ“¦"}}function _n(t){switch(t){case"basic":return"#9ca3af";case"bronze":return"#cd7f32";case"iron":return"#4a5568";case"steel":return"#718096";case"silver":return"#c0c0c0";case"mythril":return"#a0a0ff";case"legendary":return"#ffd700";case"artifact":return"#ff00ff";default:return"#9ca3af"}}function Ie({equipment:t,size:r="medium",className:a,style:s}){const n=Sn[r],i=kn(t.slot),o=_n(t.tier);return e(H,{id:t.id.toLowerCase(),width:n.width,height:n.height,className:a,style:s,fallback:e("div",{style:{...n,backgroundColor:o,color:"#fff",display:"flex",alignItems:"center",justifyContent:"center",borderRadius:"4px",fontSize:r==="small"?"12px":r==="medium"?"16px":"24px",border:"2px solid rgba(0,0,0,0.2)"},title:`${t.name} (${t.tier})`,children:i})})}function In({encounterId:t}){const r=Le[t];if(!r)return e("div",{class:"enemies-section",children:e("div",{class:"enemy-portal",children:[e("div",{class:"portal-title",children:"ENEMIES"}),e("div",{class:"portal-enemies",children:"Unknown"})]})});const a=r.enemies.map(n=>Lt[n]?.name||n).join(" â€¢ "),s=r.enemies.map(n=>{const i=Lt[n];return{id:n,name:i?.name??n,spriteId:Ma(n,"idle")}});return e("div",{class:"enemies-section",children:e("div",{class:"enemy-portal",children:[e("div",{class:"portal-icon",children:"âš”ï¸"}),e("div",{class:"portal-title",children:"ENEMIES"}),e("div",{class:"portal-enemies",children:a||"None"}),e("div",{class:"enemy-portraits",children:s.map(n=>e("div",{class:"enemy-portrait-chip",children:[n.spriteId?e(H,{id:n.spriteId,width:36,height:36,alt:n.name}):e("div",{class:"enemy-portrait-fallback",children:"?"}),e("span",{children:n.name})]},n.id))})]})})}const Tn=["1st","2nd","3rd","4th"],xn=["weapon","armor","helm","boots","accessory"],Dn={weapon:"Weapon",armor:"Armor",helm:"Helm",boots:"Boots",accessory:"Accessory"};function li({encounterId:t,onConfirm:r,onCancel:a}){const{roster:s,team:n,currentBattleConfig:i,updateBattleConfigSlot:o,equipment:g}=M(b=>({roster:b.roster,team:b.team,currentBattleConfig:b.currentBattleConfig,updateBattleConfigSlot:b.updateBattleConfigSlot,equipment:b.equipment})),p=Le[t],c=i,l=c?.slots??[],u=c?.djinnSlots??[],f=U(()=>{const b=new Map;return s.forEach(d=>b.set(d.id,d)),n?.units.forEach(d=>b.set(d.id,d)),Array.from(b.values())},[s,n]),_=U(()=>l.map(b=>b.unitId).filter(b=>!!b),[l]),k=U(()=>_.map(b=>f.find(d=>d.id===b)).filter(b=>!!b).sort((b,d)=>{const x=d.baseStats.spd-b.baseStats.spd;return x!==0?x:d.level-b.level}),[_,f]),w=U(()=>f.filter(b=>!_.includes(b.id)),[f,_]),I=U(()=>{const b=new Map;return l.forEach(d=>{d.unitId&&b.set(d.unitId,d.equipmentLoadout??Ze())}),b},[l]),h=U(()=>c?Ia(c,g,s,n):{valid:!1,message:"Battle configuration missing"},[c,g,s,n]),m=fe(b=>{if(_.includes(b.id)){const x=l.findIndex(E=>E.unitId===b.id);x!==-1&&o(x,null)}else if(_.length<4){const x=l.findIndex(E=>!E.unitId);x!==-1&&o(x,b.id)}},[_,l,o]),T=fe(b=>{const d=l.findIndex(x=>x.unitId===b);d!==-1&&o(d,null)},[l,o]),v=fe(()=>{!c||!h.valid||r()},[c,h.valid,r]);return P(()=>{const b=d=>{d.key==="Escape"?(d.preventDefault(),a()):d.key==="Enter"&&h.valid&&(d.preventDefault(),v())};return window.addEventListener("keydown",b,!0),()=>window.removeEventListener("keydown",b,!0)},[h.valid,v,a]),p?!n||!c?e("div",{class:"prebattle-v2-overlay",children:e("div",{class:"prebattle-v2-error",children:[e("div",{children:"Error: Team or battle config missing"}),e("button",{onClick:a,children:"Close"})]})}):e("div",{class:"prebattle-v2-overlay",children:e("div",{class:"prebattle-v2-container",children:[e("div",{class:"prebattle-v2-header",children:[e("div",{class:"prebattle-v2-title",children:"Select Your Team"}),e("div",{class:"prebattle-v2-subtitle",children:[p.name," â€¢ ",p.difficulty," â€¢ ",p.reward.xp," XP"]})]}),e("div",{class:"prebattle-v2-layout",children:[e("div",{class:"prebattle-v2-available",children:[e("div",{class:"panel-title",children:"Available Units"}),e("div",{class:"unit-roster",children:[w.map(b=>e("div",{class:`roster-unit ${_.length>=4?"disabled":""}`,onClick:()=>m(b),children:[e("div",{class:"roster-unit-sprite",children:e(H,{id:Re(b.id),width:40,height:40})}),e("div",{class:"roster-unit-info",children:[e("div",{class:"roster-unit-name",children:b.name}),e("div",{class:"roster-unit-stats",children:["Lv.",b.level," | SPD: ",e("span",{class:"unit-speed",children:b.baseStats.spd})]})]}),e("div",{class:`roster-unit-element element-${b.element.toLowerCase()}`,children:b.element})]},b.id)),w.length===0&&e("div",{class:"roster-empty",children:"All units selected!"})]})]}),e("div",{class:"prebattle-v2-selected",children:[e("div",{class:"panel-title",children:"Battle Party (Sorted by Speed)"}),e("div",{class:"team-slots",children:[0,1,2,3].map(b=>{const d=k[b];return e("div",{class:`team-slot ${d?"filled":"empty"}`,children:[e("span",{class:"slot-badge",children:Tn[b]}),e("span",{class:"slot-order",children:b+1}),d?e(ie,{children:[e("div",{class:"slot-sprite",children:e(H,{id:Re(d.id),width:40,height:40})}),e("div",{class:"slot-unit-info",children:[e("div",{class:"slot-unit-name",children:d.name}),e("div",{class:"slot-unit-speed",children:["SPD: ",d.baseStats.spd]})]}),e("button",{class:"remove-btn",onClick:x=>{x.stopPropagation(),T(d.id)},"aria-label":`Remove ${d.name}`,children:"Ã—"})]}):e("span",{class:"slot-empty-text",children:b===0?"Empty - Fastest":b===3?"Empty - Slowest":"Empty"})]},b)})}),e("div",{class:"enemy-preview",children:[e("div",{class:"panel-title",children:"Enemies"}),e("div",{class:"enemy-portal-wrap",children:e(In,{encounterId:t})})]}),e("div",{class:"loadout-preview",children:[e("div",{class:"panel-title",children:"Equipment & Djinn"}),e("div",{class:"loadout-columns",children:[e("div",{class:"gear-summary",children:[e("div",{class:"loadout-subtitle",children:"Selected Gear"}),k.length===0?e("div",{class:"loadout-empty",children:"Add units to see their equipped items."}):k.map(b=>{const d=I.get(b.id)??b.equipment??Ze();return e("div",{class:"gear-row",children:[e("div",{class:"gear-row-header",children:[e("div",{class:"gear-row-avatar",children:e(H,{id:Re(b.id),width:28,height:28})}),e("div",{class:"gear-row-name",children:b.name}),e("span",{class:`gear-row-element element-${b.element.toLowerCase()}`,children:b.element})]}),e("div",{class:"gear-tags",children:xn.map(x=>{const E=d[x];return e("span",{class:`gear-tag ${E?"filled":"empty"}`,children:[e("span",{class:"gear-slot-label",children:Dn[x]}),e("span",{class:"gear-item-name",children:E?E.name:"None"})]},`${b.id}-${x}`)})})]},b.id)})]}),e("div",{class:"djinn-summary",children:[e("div",{class:"loadout-subtitle",children:"Team Djinn"}),e("div",{class:"djinn-chips",children:u.map((b,d)=>{const x=b?oe[b]:void 0,E=x?.element??"Neutral",$=E.toLowerCase();return e("div",{class:`djinn-chip ${b?"filled":"empty"}`,children:[e("div",{class:"djinn-chip-row",children:[e("span",{class:"djinn-slot-label",children:["Slot ",d+1]}),b&&e("span",{class:`djinn-element-badge element-${$}`,children:E})]}),e("div",{class:"djinn-name",children:b?x?.name??b:"Empty"})]},`${b??"empty"}-${d}`)})}),e("div",{class:"djinn-note",children:"Djinn bonuses apply to every unit in this party."})]})]})]}),e("button",{class:"start-battle-btn",onClick:v,disabled:!h.valid,children:h.valid?`Start Battle (${k.length} unit${k.length!==1?"s":""})`:h.message??"Select at least 1 unit"})]})]}),e("div",{class:"prebattle-v2-footer",children:[e("button",{class:"cancel-btn",onClick:a,children:"â† Cancel"}),e("div",{class:"keyboard-hints",children:[e("span",{class:"key",children:"Enter"})," Start Â |Â  ",e("span",{class:"key",children:"Esc"})," Cancel"]})]})]})}):e("div",{class:"prebattle-v2-overlay",children:e("div",{class:"prebattle-v2-error",children:[e("div",{children:"Error: Encounter not found"}),e("button",{onClick:a,children:"Close"})]})})}function Cn({options:t,onSelect:r}){return e("div",{style:{backgroundColor:"rgba(0, 0, 0, 0.9)",padding:"2rem",borderRadius:"8px",border:"2px solid gold",marginTop:"1.5rem",textAlign:"center",maxWidth:"800px",marginLeft:"auto",marginRight:"auto"},children:[e("h3",{style:{color:"#FFD700",marginBottom:"1.5rem"},children:"ðŸ† Choose Your Reward! ðŸ†"}),e("div",{style:{display:"flex",gap:"1rem",justifyContent:"center",flexWrap:"wrap"},children:t.map(a=>e("button",{onClick:()=>r(a),style:{padding:"1rem",backgroundColor:"#2c2c2c",border:"2px solid #FFD700",borderRadius:"8px",cursor:"pointer",transition:"all 0.2s ease",minWidth:"200px",maxWidth:"260px",color:"#fff",textAlign:"left"},onMouseEnter:s=>{const n=s.currentTarget;n.style.transform="scale(1.05)",n.style.backgroundColor="#3c3c3c",n.style.borderColor="#FFA500"},onMouseLeave:s=>{const n=s.currentTarget;n.style.transform="scale(1)",n.style.backgroundColor="#2c2c2c",n.style.borderColor="#FFD700"},children:[e(Ie,{equipment:a,size:"medium"}),e("div",{style:{marginTop:"0.5rem"},children:[e("div",{style:{fontWeight:"bold",fontSize:"1.1rem",color:En(a.tier)},children:a.name}),e("div",{style:{fontSize:"0.85rem",color:"#ccc",marginTop:"0.25rem"},children:a.slot.toUpperCase()}),e("div",{style:{marginTop:"0.5rem",fontSize:"0.85rem",color:"#fff"},children:Mn(a.statBonus)}),a.unlocksAbility&&e("div",{style:{marginTop:"0.5rem",fontSize:"0.75rem",color:"#FFD700",fontStyle:"italic"},children:["Unlocks: ",a.unlocksAbility]})]})]},a.id))})]})}function En(t){return{basic:"#999999",bronze:"#CD7F32",iron:"#C0C0C0",steel:"#B0C4DE",silver:"#E8E8E8",mythril:"#9370DB",legendary:"#FFD700",artifact:"#FF1493"}[t]??"#fff"}function Mn(t){const r=[];return t.atk&&r.push(`+${t.atk} ATK`),t.def&&r.push(`+${t.def} DEF`),t.hp&&r.push(`+${t.hp} HP`),t.mag&&r.push(`+${t.mag} MAG`),t.spd&&r.push(`+${t.spd} SPD`),r.length>0?r.join(" â€¢ "):"No stat bonus"}function Bn(){return e("div",{class:"victory-sparkles","aria-hidden":"true",children:[...Array(12)].map((t,r)=>e("div",{class:"sparkle",style:{"--delay":`${r*.25}s`,"--left":`${5+r*8}%`}},r))})}function ci({rewards:t,team:r,onContinue:a,onSelectEquipment:s}){const n=U(()=>r.units.filter(l=>l.currentHp>0).slice(0,4),[r.units]),i=t.levelUps.map(l=>{const u=r.units.find(f=>f.id===l.unitId);return u?{unit:u,oldLevel:l.oldLevel,newLevel:l.newLevel,statGains:l.statGains,unlockedAbilities:l.newAbilitiesUnlocked}:null}).filter(l=>l!==null),o=t.equipmentChoice&&!t.choiceSelected,g=t.choiceSelected?[t.choiceSelected]:t.fixedEquipment?[t.fixedEquipment]:[],p=r.collectedDjinn[r.collectedDjinn.length-1],c=p?oe[p]:null;return P(()=>{const l=u=>{if(o&&t.equipmentChoice){const f=parseInt(u.key,10);if(!Number.isNaN(f)&&f>=1&&f<=t.equipmentChoice.length){u.preventDefault(),u.stopPropagation();const _=t.equipmentChoice[f-1];_&&s(_);return}}if((!o||t.choiceSelected)&&(u.key==="Enter"||u.key===" "||u.code==="Enter"||u.code==="Space")){u.preventDefault(),u.stopPropagation(),a();return}};return window.addEventListener("keydown",l,!0),()=>window.removeEventListener("keydown",l,!0)},[o,t.equipmentChoice,t.choiceSelected,a,s]),e("div",{class:"rewards-screen rewards-screen--golden-sun",children:[e(Bn,{}),e("div",{class:"rewards-container",children:[e("div",{class:"victory-banner",role:"banner",children:[e("h1",{children:"VICTORY!"}),e("div",{class:"victory-sub",children:"All enemies defeated!"})]}),e("div",{class:"party-display","aria-label":"Victorious party members",children:n.map((l,u)=>e("div",{class:"party-member",style:{"--index":u},children:[e("div",{class:"party-sprite",children:e(H,{id:Re(l.id),width:64,height:64})}),e("div",{class:"party-name",children:l.name})]},l.id))}),e("div",{class:"rewards-grid",children:[e("div",{class:"reward-card",role:"article","aria-label":`${t.rewards.totalXp} experience points gained`,children:[e("div",{class:"reward-icon","aria-hidden":"true",children:"XP"}),e("div",{class:"reward-details",children:[e("div",{class:"reward-label",children:"Experience"}),e("div",{class:"reward-value highlight",children:["+",t.rewards.totalXp," XP"]}),t.rewards.survivorCount>0&&e("div",{class:"reward-subtext",children:["Split among ",t.rewards.survivorCount," survivors"]})]})]}),e("div",{class:"reward-card",role:"article","aria-label":`${t.goldEarned} gold coins gained`,children:[e("div",{class:"reward-icon","aria-hidden":"true",children:"G"}),e("div",{class:"reward-details",children:[e("div",{class:"reward-label",children:"Gold"}),e("div",{class:"reward-value highlight",children:["+",t.goldEarned," G"]})]})]})]}),o&&e(Cn,{options:t.equipmentChoice,onSelect:s}),g.length>0&&e("section",{class:"items-panel","aria-label":"Equipment obtained",children:[e("h2",{children:"EQUIPMENT OBTAINED"}),e("div",{class:"items-grid",children:g.map(l=>e("div",{class:"item-card",children:[e(Ie,{equipment:l,size:"small",className:"item-icon"}),e("div",{class:"item-name",children:l.name}),e("div",{class:"item-quantity",children:"x1"})]},l.id))})]}),t.recruitedUnit&&e("section",{class:"recruitment-panel",role:"alert","aria-label":`Recruited ${t.recruitedUnit.name}`,children:[e("h2",{children:"NEW RECRUIT!"}),e("div",{class:"recruitment-unit",children:[e("div",{class:"recruitment-sprite",children:e(tt,{unitId:t.recruitedUnit.id,state:"idle",size:"medium"})}),e("div",{class:"recruitment-details",children:[e("div",{class:"recruitment-name",children:t.recruitedUnit.name}),e("div",{class:"recruitment-level",children:["Level ",t.recruitedUnit.level]}),e("div",{class:"recruitment-element",children:t.recruitedUnit.element}),e("div",{class:"recruitment-message",children:"has joined your roster!"})]})]})]}),t.recruitedUnit&&c&&e("section",{class:"djinn-panel",role:"alert","aria-label":`Djinn ${c.name} acquired`,children:[e("h2",{children:"DJINN ACQUIRED"}),e("div",{class:"djinn-acquisition",children:[e("div",{class:"djinn-name",children:c.name}),e("div",{class:"djinn-element",children:c.element}),e("div",{class:"djinn-message",children:"has been added to your collection!"})]})]}),i.length>0&&e("section",{class:"level-up-panel",role:"alert","aria-label":`${i.length} units leveled up`,children:[e("h2",{children:"LEVEL UP!"}),e("div",{class:"level-up-units",children:i.map((l,u)=>e("div",{class:"level-up-unit",style:{animationDelay:`${.6+u*.1}s`},children:[e("div",{class:"level-up-sprite",children:e(tt,{unitId:l.unit.id,state:"idle",size:"medium"})}),e("div",{class:"level-up-name",children:l.unit.name}),e("div",{class:"level-up-arrow",children:["Lv ",l.oldLevel," -> Lv ",l.newLevel]}),e("div",{class:"level-up-stats",children:[l.statGains.hp>0&&e("span",{children:["+",l.statGains.hp," HP"]}),l.statGains.atk>0&&e("span",{children:["+",l.statGains.atk," ATK"]}),l.statGains.def>0&&e("span",{children:["+",l.statGains.def," DEF"]}),l.statGains.mag>0&&e("span",{children:["+",l.statGains.mag," MAG"]}),l.statGains.spd>0&&e("span",{children:["+",l.statGains.spd," SPD"]})]}),l.unlockedAbilities.length>0&&e("div",{class:"level-up-abilities",children:["Unlocked: ",l.unlockedAbilities.join(", ")]})]},l.unit.id))})]}),e("div",{class:"continue-container",children:e("button",{onClick:a,class:"continue-btn","aria-label":"Continue to next screen",disabled:o&&!t.choiceSelected,style:{opacity:o&&!t.choiceSelected?.5:1,cursor:o&&!t.choiceSelected?"not-allowed":"pointer"},children:o&&!t.choiceSelected?"SELECT EQUIPMENT FIRST":"CONTINUE"})})]})]})}function gi({shopId:t,onClose:r}){const{gold:a,addGold:s,addEquipment:n,team:i,updateTeamUnits:o}=M(m=>({gold:m.gold,addGold:m.addGold,addEquipment:m.addEquipment,team:m.team,updateTeamUnits:m.updateTeamUnits})),g=M(m=>m.story.flags),[p,c]=F(null),l=da[t];if(!l)return e("div",{class:"shop-screen-overlay",onClick:r,children:e("div",{class:"shop-screen-container",onClick:m=>m.stopPropagation(),children:[e("div",{class:"shop-error",children:["Shop not found: ",t]}),e("button",{class:"close-btn",onClick:r,children:"Close"})]})});const u=!l.unlockCondition||l.unlockCondition(g),f=u?l.availableItems.map(m=>Te[m]).filter(m=>!!m).filter(xe):[],_=m=>{c(null);const T=fa(a,m);if(!T.ok){c(T.error);return}s(T.value.newGold-a),n([T.value.item])},k=i?i.units.map(m=>({unit:m,kit:ya(m)})).filter(({kit:m,unit:T})=>!!m&&!T.storeUnlocked).map(({unit:m,kit:T})=>({unit:m,kit:T})):[],w=i?i.units.filter(m=>m.storeUnlocked):[],I=m=>{if(!i)return;const T=i.units.find(d=>d.id===m);if(!T)return;c(null);const v=ha(T,a);if(!v.ok){c(v.error);return}s(v.value.newGold-a),n(v.value.equipment);const b=i.units.map(d=>d.id===m?{...d,storeUnlocked:!0}:d);o(b)},h=(m,T)=>{c(null);const v=ba(m,a,T);if(!v.ok){c(v.error);return}s(v.value.newGold-a),n([v.value.item])};return e("div",{class:"shop-screen-overlay",onClick:r,children:e("div",{class:"shop-screen-container",onClick:m=>m.stopPropagation(),children:[e("div",{class:"shop-header",children:[e("h1",{children:l.name}),e("button",{class:"close-btn",onClick:r,"aria-label":"Close shop",children:"Ã—"})]}),e("div",{class:"shop-note",style:{fontSize:"0.85rem",color:"#a8b3c0",padding:"0 1rem",marginBottom:"0.5rem"},children:"Unlock shared, element-locked equipment for your roster here. Each item lives in the shared inventory and the Pre-Battle screen determines who wields it during the next encounter."}),e("div",{class:"shop-gold",children:[e("span",{class:"gold-label",children:"Gold:"}),e("span",{class:"gold-value",children:[a,"g"]})]}),p&&e("div",{class:"shop-error",role:"alert",children:p}),e("div",{class:"shop-content",children:[e("section",{class:"starter-kits-section",children:[e("h2",{children:"Starter Kits"}),k.length===0?e("div",{class:"shop-empty",children:"All Starter Kits unlocked."}):e("div",{class:"shop-items-grid",children:k.map(({unit:m,kit:T})=>{const v=a>=T.cost;return e("div",{class:`shop-item-card ${v?"":"unaffordable"}`,children:[e("div",{class:"item-details",children:[e("div",{class:"item-name",children:T.name}),e("div",{class:"item-stats",children:[e("span",{class:"stat-badge",children:m.name}),e("span",{class:"stat-badge",children:[T.cost,"g"]})]})]}),e("button",{class:"buy-btn",onClick:()=>I(m.id),disabled:!v,children:"Purchase Starter Kit"})]},m.id)})})]}),w.map(m=>{const T=Object.values(Te).filter(v=>xe(v)&&v.allowedElements.includes(m.element));return e("section",{class:"unit-store-section",children:[e("h2",{children:[m.name,"'s Equipment"]}),T.length===0?e("div",{class:"shop-empty",children:"No equipment available yet."}):e("div",{class:"shop-items-grid",children:T.map(v=>{const b=et(a,v.id);return e("div",{class:`shop-item-card ${b?"":"unaffordable"}`,children:[e("div",{class:"item-icon",children:e(Ie,{equipment:v})}),e("div",{class:"item-details",children:[e("div",{class:"item-name",children:v.name}),e("div",{class:"item-stats",children:Object.entries(v.statBonus).map(([d,x])=>e("span",{class:"stat-badge",children:["+",x," ",d.toUpperCase()]},d))}),e("div",{class:"item-price",children:[v.cost,"g"]})]}),e("button",{class:"buy-btn",onClick:()=>h(m,v.id),disabled:!b,children:["Purchase for ",m.name]})]},`${m.id}-${v.id}`)})})]},m.id)}),e("section",{class:"shop-general-section",children:u?f.length===0?e("div",{class:"shop-empty",children:"No items available."}):e("div",{class:"shop-items-grid",children:f.map(m=>{const T=et(a,m.id);return e("div",{class:`shop-item-card ${T?"":"unaffordable"}`,children:[e("div",{class:"item-icon",children:e(Ie,{equipment:m})}),e("div",{class:"item-details",children:[e("div",{class:"item-name",children:m.name}),e("div",{class:"item-stats",children:Object.entries(m.statBonus).map(([v,b])=>e("span",{class:"stat-badge",children:["+",b," ",v.toUpperCase()]},v))}),e("div",{class:"item-price",children:[m.cost,"g"]})]}),e("button",{class:"buy-btn",onClick:()=>_(m.id),disabled:!T,children:"Unlock Equipment"})]},m.id)})}):e("div",{class:"shop-locked",children:"This shop is not yet available."})})]})]})})}function An({onClose:t}){const{team:r,roster:a}=M(p=>({team:p.team,roster:p.roster})),[s,n]=F(null);if(!r)return e("div",{class:"party-management-overlay",onClick:t,children:e("div",{class:"party-management-container",onClick:p=>p.stopPropagation(),children:[e("div",{class:"party-error",children:"No team data available"}),e("button",{class:"close-btn",onClick:t,children:"Close"})]})});const i=new Set(r.units.map(p=>p.id)),o=a.find(p=>p.id===s),g=o?Dt(o,r):null;return e("div",{class:"party-management-overlay",onClick:t,children:e("div",{class:"party-management-container",onClick:p=>p.stopPropagation(),children:[e("div",{class:"party-management-header",children:[e("h1",{children:"Unit Compendium"}),e("button",{class:"close-btn",onClick:t,"aria-label":"Close compendium",children:"Ã—"})]}),e("div",{class:"party-instructions",children:e("p",{children:"Browse your full roster and review each unit's stats. The battle formation and loadouts you see here are only a snapshotâ€”final selections happen on the Pre-Battle screen before each fight."})}),e("div",{class:"party-content",children:[e("div",{class:"party-section",children:[e("h2",{children:["Roster (",a.length,")"]}),e("div",{class:"party-grid",children:a.map(p=>{const c=i.has(p.id),l=s===p.id;return e("div",{class:`party-member-card ${l?"selected":""} ${c?"active":""}`,onClick:()=>n(p.id),children:[e("div",{class:"member-icon",children:(()=>{const u=Re(p.id);return e(H,{id:u,width:64,height:64,style:{borderRadius:"8px"}})})()}),e("div",{class:"member-info",children:[e("div",{class:"member-name",children:p.name}),e("div",{class:"member-stats",children:["Lv: ",p.level]}),e("div",{class:"member-element",children:p.element}),e("div",{class:"member-role",children:p.role}),c&&e("div",{class:"active-badge",children:"Roster Slot"})]}),l&&e("div",{class:"selection-indicator",children:"Selected"})]},p.id)})})]}),o&&g&&e("div",{class:"party-section unit-details",children:[e("h2",{children:o.name}),e("div",{class:"detail-grid",children:[e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"Level:"}),e("span",{class:"detail-value",children:o.level})]}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"Element:"}),e("span",{class:"detail-value",children:o.element})]}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"Role:"}),e("span",{class:"detail-value",children:o.role})]}),e("div",{class:"detail-divider"}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"HP:"}),e("span",{class:"detail-value",children:[o.currentHp," / ",g.hp]})]}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"ATK:"}),e("span",{class:"detail-value",children:g.atk})]}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"DEF:"}),e("span",{class:"detail-value",children:g.def})]}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"MAG:"}),e("span",{class:"detail-value",children:g.mag})]}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"SPD:"}),e("span",{class:"detail-value",children:g.spd})]}),e("div",{class:"detail-divider"}),e("div",{class:"detail-section",children:[e("h3",{children:["Abilities (",o.abilities.length,")"]}),e("div",{class:"ability-list",children:o.abilities.map(p=>e("div",{class:"ability-item",children:[(()=>{const c=Fs(p.id);return e(H,{id:c,width:24,height:24,style:{marginRight:"8px",borderRadius:"4px"}})})(),e("span",{class:"ability-name",children:p.name}),p.manaCost>0&&e("span",{class:"ability-cost",children:["[",p.manaCost,"]"]})]},p.id))})]})]})]})]})]})})}const Fn=["weapon","armor","helm","boots","accessory"],Rn=["hp","pp","atk","def","mag","spd"],jn=[{id:"all",label:"All"},{id:"basic",label:"Basic"},{id:"bronze",label:"Bronze"},{id:"iron",label:"Iron"},{id:"steel",label:"Steel"},{id:"mythril-plus",label:"Mythril+"}];function oa(t,r){return r==="all"||!t?!0:r==="mythril-plus"?t==="mythril"||t==="legendary"||t==="artifact":r==="steel"?t==="steel"||t==="silver":t===r}function ft(t,r){return Rn.map(a=>{const s=t.statBonus[a]??0,n=r?.statBonus[a]??0,i=s-n;return{stat:a,delta:i}}).filter(({delta:a})=>a!==0)}function vt({deltas:t}){return t.length===0?null:e("div",{class:"item-deltas",children:t.map(({stat:r,delta:a})=>e("span",{class:`delta-badge ${a>0?"delta-up":"delta-down"}`,children:[a>0?"+":"",a," ",r.toUpperCase()]},r))})}function Pn({shopId:t,onClose:r}){const{gold:a,addGold:s,addEquipment:n,removeEquipment:i,team:o,updateTeamUnits:g,equipment:p}=M(S=>({gold:S.gold,addGold:S.addGold,addEquipment:S.addEquipment,removeEquipment:S.removeEquipment,team:S.team,updateTeamUnits:S.updateTeamUnits,equipment:S.equipment})),c=M(S=>S.story.flags),[l,u]=F("shop"),[f,_]=F(o?.units[0]?.id??null),[k,w]=F(null),[I,h]=F(null),[m,T]=F("all"),v=o?.units.find(S=>S.id===f)??null,b=t?da[t]:null,d=!b||!b.unlockCondition||b.unlockCondition(c),x=b&&d?b.availableItems.map(S=>Te[S]).filter(S=>!!S).filter(xe):[],E=x.filter(S=>oa(S.tier,m)),$=o?o.units.map(S=>({unit:S,kit:ya(S)})).filter(({kit:S,unit:R})=>!!S&&!R.storeUnlocked).map(({unit:S,kit:R})=>({unit:S,kit:R})):[],K=o?o.units.filter(S=>S.storeUnlocked):[],Y=S=>{h(null);const R=fa(a,S);if(!R.ok){h(R.error);return}s(R.value.newGold-a),n([R.value.item])},G=S=>{if(!o)return;const R=o.units.find(O=>O.id===S);if(!R)return;h(null);const j=ha(R,a);if(!j.ok){h(j.error);return}s(j.value.newGold-a),n(j.value.equipment);const J=o.units.map(O=>O.id===S?{...O,storeUnlocked:!0}:O);g(J)},pe=(S,R)=>{h(null);const j=ba(S,a,R);if(!j.ok){h(j.error);return}s(j.value.newGold-a),n([j.value.item])},we=S=>{if(!v||!k)return;const R=v.equipment[k];R&&n([R]),i(S.id);const j={...v.equipment,[k]:S},J=We(v,{equipment:j}),O=o.units.map(te=>te.id===v.id?J:te);g(O),w(null)},q=S=>{if(!v)return;const R=v.equipment[S],j={...v.equipment,[S]:null},J=We(v,{equipment:j});R&&n([R]);const O=o.units.map(te=>te.id===v.id?J:te);g(O)},je=v&&k?p.filter(S=>S.slot===k&&(S.allowedElements.length===0||S.allowedElements.includes(v.element))):[],Q=v?jr(v.equipment):{},ue=v?Pr(v):{},Z=v?{atk:v.baseStats.atk+(ue.atk||0)+(Q.atk||0),def:v.baseStats.def+(ue.def||0)+(Q.def||0),mag:v.baseStats.mag+(ue.mag||0)+(Q.mag||0),spd:v.baseStats.spd+(ue.spd||0)+(Q.spd||0)}:null;return e("div",{class:"shop-equip-overlay",onClick:r,children:e("div",{class:"shop-equip-container",onClick:S=>S.stopPropagation(),children:[e("div",{class:"shop-equip-header",children:[e("h1",{children:b?b.name:"Shop & Equipment"}),e("button",{class:"close-btn",onClick:r,"aria-label":"Close",children:"Ã—"})]}),e("div",{class:"shop-equip-gold",children:[e("span",{class:"gold-label",children:"Gold:"}),e("span",{class:"gold-value",children:[a,"g"]})]}),e("div",{class:"shop-equip-note",style:{fontSize:"0.8rem",color:"#a9b1c8",padding:"0 1rem",marginBottom:"0.5rem"},children:"Equipment in your inventory is shared across the roster and locked to elements. Use the Pre-Battle screen to finalize which pieces each unit actually carries into combat."}),I&&e("div",{class:"shop-equip-error",role:"alert",children:I}),e("div",{class:"shop-equip-tabs",children:[e("button",{class:`tab-btn ${l==="shop"?"active":""}`,onClick:()=>u("shop"),children:"Shop"}),e("button",{class:`tab-btn ${l==="equip"?"active":""}`,onClick:()=>u("equip"),children:"Equipment"})]}),e("div",{class:"shop-equip-content",children:[l==="shop"&&e("div",{class:"shop-tab-content",children:b?d?e(ie,{children:[e("div",{class:"tier-filter-bar",children:[e("span",{class:"tier-filter-label",children:"Tier:"}),e("div",{class:"tier-filter-buttons",children:jn.map(S=>e("button",{class:`tier-filter-btn ${m===S.id?"active":""}`,onClick:()=>T(S.id),children:S.label},S.id))})]}),$.length>0&&e("section",{class:"starter-kits-section",children:[e("h2",{children:"Starter Kits"}),e("div",{class:"shop-items-grid",children:$.map(({unit:S,kit:R})=>{const j=a>=R.cost;return e("div",{class:`shop-item-card ${j?"":"unaffordable"}`,children:[e("div",{class:"item-details",children:[e("div",{class:"item-name",children:R.name}),e("div",{class:"item-stats",children:[e("span",{class:"stat-badge",children:S.name}),e("span",{class:"stat-badge",children:[R.cost,"g"]})]})]}),e("button",{class:"buy-btn",onClick:()=>G(S.id),disabled:!j,children:"Purchase Starter Kit"})]},S.id)})})]}),K.map(S=>{const R=Object.values(Te).filter(j=>xe(j)&&j.allowedElements.includes(S.element)&&oa(j.tier,m));return e("section",{class:"unit-store-section",children:[e("h2",{children:[S.name,"'s Equipment (",S.element,")"]}),R.length===0?e("div",{class:"shop-empty",children:"No equipment available yet."}):e("div",{class:"shop-items-grid",children:R.map(j=>{const J=et(a,j.id);return e("div",{class:`shop-item-card ${J?"":"unaffordable"}`,children:[e("div",{class:"item-icon",children:e(Ie,{equipment:j})}),e("div",{class:"item-details",children:[e("div",{class:"item-name",children:j.name}),e("div",{class:"item-stats",children:Object.entries(j.statBonus).map(([O,te])=>e("span",{class:"stat-badge",children:["+",te," ",O.toUpperCase()]},O))}),v&&e(vt,{deltas:ft(j,v.equipment[j.slot])}),e("div",{class:"item-price",children:[j.cost,"g"]})]}),e("button",{class:"buy-btn",onClick:()=>pe(S,j.id),disabled:!J,children:["Purchase for ",S.name]})]},`${S.id}-${j.id}`)})})]},S.id)}),E.length>0&&e("section",{class:"shop-general-section",children:[e("h2",{children:"General Equipment"}),e("div",{class:"shop-items-grid",children:E.map(S=>{const R=et(a,S.id);return e("div",{class:`shop-item-card ${R?"":"unaffordable"}`,children:[e("div",{class:"item-icon",children:e(Ie,{equipment:S})}),e("div",{class:"item-details",children:[e("div",{class:"item-name",children:S.name}),e("div",{class:"item-stats",children:Object.entries(S.statBonus).map(([j,J])=>e("span",{class:"stat-badge",children:["+",J," ",j.toUpperCase()]},j))}),v&&e(vt,{deltas:ft(S,v.equipment[S.slot])}),e("div",{class:"item-price",children:[S.cost,"g"]})]}),e("button",{class:"buy-btn",onClick:()=>Y(S.id),disabled:!R,children:"Unlock Equipment"})]},S.id)})})]}),$.length===0&&K.length===0&&x.length===0&&e("div",{class:"shop-empty",children:"No items available."}),$.length===0&&K.length===0&&x.length>0&&E.length===0&&e("div",{class:"shop-empty",children:"No items match this tier filter."})]}):e("div",{class:"shop-locked",children:"This shop is not yet available."}):e("div",{class:"shop-empty",children:"No shop available"})}),l==="equip"&&e("div",{class:"equip-tab-content",children:[e("div",{class:"equipment-tab-note",style:{fontSize:"0.8rem",color:"#9ea6b7",marginBottom:"0.5rem",textAlign:"center"},children:"This view shows each unit's preferred loadout. The Pre-Battle screen is still the final say for actual gear per battle."}),!o||o.units.length===0?e("div",{class:"shop-empty",children:"No units available."}):e("div",{class:"equip-layout",children:[e("div",{class:"unit-selector-panel",children:[e("h2",{children:"Select Unit"}),e("div",{class:"unit-list",children:o.units.map(S=>e("div",{class:`unit-card ${f===S.id?"selected":""}`,onClick:()=>{_(S.id),w(null)},children:e("div",{class:"unit-info",children:[e("div",{class:"unit-name",children:S.name}),e("div",{class:"unit-level",children:["Lv. ",S.level]})]})},S.id))})]}),v&&e("div",{class:"equipment-management-panel",children:[e("div",{class:"equipment-slots-section",children:[e("h2",{children:[v.name,"'s Equipment"]}),e("div",{class:"equipment-grid",children:Fn.map(S=>{const R=v.equipment[S],j=k===S;return e("div",{class:`equipment-slot ${S} ${j?"selected":""}`,onClick:()=>w(j?null:S),children:[e("div",{class:"equipment-label",children:S.toUpperCase()}),R?e(ie,{children:[e("div",{class:"equipment-value",children:R.name}),e("div",{class:"equipment-bonuses",children:[R.statBonus.atk&&e("span",{class:"bonus-badge",children:["+",R.statBonus.atk," ATK"]}),R.statBonus.def&&e("span",{class:"bonus-badge",children:["+",R.statBonus.def," DEF"]}),R.statBonus.mag&&e("span",{class:"bonus-badge",children:["+",R.statBonus.mag," MAG"]}),R.statBonus.spd&&e("span",{class:"bonus-badge",children:["+",R.statBonus.spd," SPD"]})]}),j&&e("button",{class:"unequip-btn",onClick:J=>{J.stopPropagation(),q(S),w(null)},children:"Unequip"})]}):e("div",{class:"equipment-value empty",children:"[None]"})]},S)})}),Z&&e("div",{class:"stat-preview",children:[e("div",{class:"stat-preview-title",children:"STAT PREVIEW"}),e("div",{class:"stat-preview-values",children:[e("span",{children:["ATK: ",Z.atk,Q.atk?` (+${Q.atk})`:""]}),e("span",{children:["DEF: ",Z.def,Q.def?` (+${Q.def})`:""]}),e("span",{children:["MAG: ",Z.mag,Q.mag?` (+${Q.mag})`:""]}),e("span",{children:["SPD: ",Z.spd,Q.spd?` (+${Q.spd})`:""]})]})]})]}),e("div",{class:"equipment-inventory-section",children:k?e(ie,{children:[e("div",{class:"slot-indicator",children:["Equipping to: ",e("strong",{children:k.toUpperCase()})]}),je.length===0?e("div",{class:"inventory-empty",children:["No ",k," available in inventory"]}):e("div",{class:"inventory-grid",children:je.map(S=>e("div",{class:"inventory-item",onClick:()=>we(S),children:[e("div",{class:"inventory-item-icon",children:e(Ie,{equipment:S})}),e("div",{class:"inventory-item-name",children:S.name}),e("div",{class:"inventory-item-stats",children:[S.statBonus.atk&&`+${S.statBonus.atk} ATK `,S.statBonus.def&&`+${S.statBonus.def} DEF `,S.statBonus.mag&&`+${S.statBonus.mag} MAG `,S.statBonus.spd&&`+${S.statBonus.spd} SPD `]}),e(vt,{deltas:ft(S,v.equipment[S.slot])})]},S.id))})]}):e("div",{class:"slot-prompt",children:"Select an equipment slot to view available items"})})]})]})]})]})]})})}function Gn({djinnId:t,onClose:r}){const{team:a,updateTeam:s}=M(h=>({team:h.team,updateTeam:h.updateTeam})),n=oe[t];if(!n||!a)return null;const i=a.collectedDjinn.includes(t),o=a.equippedDjinn.includes(t),g=a.equippedDjinn.indexOf(t),c=a.djinnTrackers[t]?.state||"Set",l=h=>{if(!a)return;const m=[];for(a.equippedDjinn.forEach((b,d)=>{b!==t&&d!==h&&m.push(b)});m.length<h;)m.push("");m[h]=t;const T=m.filter(Boolean).slice(0,3),v={...a.djinnTrackers};if(v[t]||(v[t]={djinnId:t,state:"Set",lastActivatedTurn:0}),o&&g!==h){const b=a.equippedDjinn[h];b&&b!==t&&delete v[b]}s({equippedDjinn:T,djinnTrackers:v})},u=()=>{if(!a||!o)return;const h=a.equippedDjinn.filter(T=>T!==t),m={...a.djinnTrackers};delete m[t],s({equippedDjinn:h,djinnTrackers:m})},f=[...a.equippedDjinn];o||(f[0]=t);const _=f.filter(Boolean).map(h=>oe[h]).filter(h=>h!=null),k=Gr(_.map(h=>h.element)),w=h=>{switch(h){case"Venus":return"#8B4513";case"Mars":return"#DC143C";case"Mercury":return"#1E90FF";case"Jupiter":return"#32CD32";default:return"#666"}},I=h=>`${h.toLowerCase()}-djinn-front`;return e("div",{class:"djinn-detail-overlay",onClick:r,children:e("div",{class:"djinn-detail-container",onClick:h=>h.stopPropagation(),children:[e("div",{class:"djinn-detail-header",children:[e("h2",{children:n.name}),e("button",{class:"close-btn",onClick:r,"aria-label":"Close Djinn details",children:"Ã—"})]}),e("div",{class:"djinn-detail-content",children:[e("div",{class:"djinn-main-info",children:[e("div",{class:"djinn-icon-large",style:{backgroundColor:w(n.element)+"40"},children:(()=>{const h=I(n.element);return e(H,{id:h,width:64,height:64,style:{display:"block"}})})()}),e("div",{class:"djinn-details",children:[e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"Element:"}),e("span",{class:"detail-value",style:{color:w(n.element)},children:n.element})]}),e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"Tier:"}),e("span",{class:"detail-value",children:["Tier ",n.tier]})]}),o&&e("div",{class:"detail-row",children:[e("span",{class:"detail-label",children:"Status:"}),e("span",{class:"detail-value",children:c})]})]})]}),e("div",{class:"djinn-detail-note",style:{fontSize:"0.85rem",color:"#ccc",margin:"0.5rem 0",padding:"0 0.25rem"},children:"Djinn live in the shared 3-slot team pool. Updates here affect that pool, and the Pre-Battle screen lets you choose which of the equipped Djinn apply to the next encounter."}),e("div",{class:"djinn-summon-effect",children:[e("h3",{children:"Summon Effect"}),e("p",{children:n.summonEffect.description})]}),i&&e("div",{class:"djinn-assignment",children:[e("h3",{children:"Global Team Slots"}),e("div",{class:"slot-buttons",children:[0,1,2].map(h=>{const m=a.equippedDjinn[h],T=m?oe[m]:null,v=m===t;return e("button",{class:`slot-btn ${v?"active":""} ${T&&!v?"occupied":""}`,onClick:()=>l(h),disabled:!i,children:[e("div",{class:"slot-number",children:["Slot ",h+1]}),T?e("div",{class:"slot-djinn-name",children:T.name}):e("div",{class:"slot-empty",children:"Empty"})]},h)})}),o&&e("button",{class:"unequip-btn",onClick:u,children:"Unequip"})]}),_.length>0&&e("div",{class:"djinn-synergy-preview",children:[e("h3",{children:"Synergy Preview"}),e("div",{class:"synergy-info",children:[e("div",{class:"synergy-row",children:[e("span",{children:"Class:"}),e("span",{class:"synergy-value",children:k.classChange})]}),e("div",{class:"synergy-row",children:[e("span",{children:"ATK Bonus:"}),e("span",{class:"synergy-value",children:["+",k.atk]})]}),e("div",{class:"synergy-row",children:[e("span",{children:"DEF Bonus:"}),e("span",{class:"synergy-value",children:["+",k.def]})]}),k.spd!==void 0&&e("div",{class:"synergy-row",children:[e("span",{children:"SPD Bonus:"}),e("span",{class:"synergy-value",children:["+",k.spd]})]}),k.abilitiesUnlocked.length>0&&e("div",{class:"synergy-row",children:[e("span",{children:"Abilities:"}),e("span",{class:"synergy-value",children:k.abilitiesUnlocked.join(", ")})]})]})]})]})]})})}function Ln({onClose:t}){const{team:r}=M(c=>({team:c.team})),[a,s]=F(null);if(!r)return e("div",{class:"djinn-collection-overlay",onClick:t,children:e("div",{class:"djinn-collection-container",onClick:c=>c.stopPropagation(),children:[e("div",{class:"djinn-error",children:"No team data available"}),e("button",{class:"close-btn",onClick:t,children:"Close"})]})});const n=r.collectedDjinn||[],i=r.equippedDjinn||[],o={Venus:[],Mars:[],Mercury:[],Jupiter:[]};n.forEach(c=>{const l=oe[c];if(l){const u=o[l.element];u&&u.push(l)}}),Object.keys(o).forEach(c=>{const l=o[c];l&&l.sort((u,f)=>parseInt(u.tier,10)-parseInt(f.tier,10))});const g=c=>{switch(c){case"Venus":return"#8B4513";case"Mars":return"#DC143C";case"Mercury":return"#1E90FF";case"Jupiter":return"#32CD32";default:return"#666"}},p=c=>`${c.toLowerCase()}-djinn-front`;return e("div",{class:"djinn-collection-overlay",onClick:t,children:e("div",{class:"djinn-collection-container",onClick:c=>c.stopPropagation(),children:[e("div",{class:"djinn-collection-header",children:[e("h1",{children:"Djinn Collection"}),e("button",{class:"close-btn",onClick:t,"aria-label":"Close Djinn collection",children:"Ã—"})]}),e("div",{class:"djinn-collection-note",style:{padding:"0 1rem",fontSize:"0.85rem",color:"#ccc"},children:"Your collected Djinn live in a global 3-slot team configuration. Use the Pre-Battle screen to lock in which Djinn you want active for the upcoming fightâ€”the bonuses apply to every unit at once."}),e("div",{class:"djinn-stats",children:[e("div",{class:"stat-item",children:[e("span",{class:"stat-label",children:"Collected:"}),e("span",{class:"stat-value",children:[n.length," / 12"]})]}),e("div",{class:"stat-item",children:[e("span",{class:"stat-label",children:"Equipped:"}),e("span",{class:"stat-value",children:[i.length," / 3"]})]})]}),e("div",{class:"djinn-collection-subnote",style:{fontSize:"0.8rem",color:"#888",textAlign:"center",marginBottom:"0.25rem"},children:"Equipped Djinn occupy the shared team slots; swapping them is done here, but final confirmation happens pre-battle."}),e("div",{class:"djinn-collection-content",children:Object.entries(o).map(([c,l])=>e("div",{class:"djinn-element-section",children:[e("h2",{class:"element-header",style:{color:g(c)},children:[c," Djinn"]}),l.length===0?e("div",{class:"no-djinn-message",children:["No ",c," Djinn collected yet"]}):e("div",{class:"djinn-grid",children:l.map(u=>{const f=i.includes(u.id),k=r.djinnTrackers[u.id]?.state||"Set";return e("div",{class:`djinn-card ${f?"equipped":""} ${k.toLowerCase()}`,onClick:()=>s(u.id),children:[e("div",{class:"djinn-icon",style:{backgroundColor:g(c)+"40"},children:(()=>{const w=p(c);return e(H,{id:w,width:48,height:48,style:{filter:k==="Standby"?"brightness(0.6)":"none"}})})()}),e("div",{class:"djinn-info",children:[e("div",{class:"djinn-name",children:u.name}),e("div",{class:"djinn-tier",children:["Tier ",u.tier]}),f&&e("div",{class:"djinn-status",children:["Equipped Â· Team Slot (",k,")"]})]})]},u.id)})})]},c))}),a&&e(Gn,{djinnId:a,onClose:()=>s(null)})]})})}function pi(){const t=se(G=>G.startTransition),{towerRun:r,towerStatus:a,towerRecord:s,getCurrentTowerFloor:n,startTowerRun:i,beginTowerFloorBattle:o,applyTowerRest:g,quitTowerRun:p,exitTowerMode:c,towerEntryContext:l,team:u,mode:f}=M(G=>({towerRun:G.towerRun,towerStatus:G.towerStatus,towerRecord:G.towerRecord,getCurrentTowerFloor:G.getCurrentTowerFloor,startTowerRun:G.startTowerRun,beginTowerFloorBattle:G.beginTowerFloorBattle,applyTowerRest:G.applyTowerRest,quitTowerRun:G.quitTowerRun,exitTowerMode:G.exitTowerMode,towerEntryContext:G.towerEntryContext,team:G.team,mode:G.mode}));P(()=>{f==="team-select"?t("team-select"):f==="battle"?t("battle"):f==="rewards"&&t("rewards")},[f,t]);const _=n(),k=_?.type==="rest",w=a==="completed",I=U(()=>$n(r),[r]),h=U(()=>Un(u),[u]),m=U(()=>On(u),[u]),[T,v]=F(null),[b,d]=F(null),x=()=>{if(a==="idle"||!r){i({difficulty:"normal"});return}v("restart")},E=()=>{T==="quit"?p():T==="restart"&&i({difficulty:r?.difficulty??"normal"}),v(null)},$=()=>{v("quit")},K=()=>d(null);if(a==="idle"||!r)return e("div",{class:"tower-hub",children:[e("section",{class:"tower-card intro",children:[e("h1",{children:"Battle Tower"}),e("p",{children:"Step into an infinite gauntlet built on the queue battle engine. Assemble any four heroes, keep their HP between fights, and chase your highest floor on this save-independent sandbox."}),e("div",{class:"tower-actions",children:[e("button",{class:"primary",onClick:x,children:"Start Tower Run"}),e("button",{onClick:c,children:l?.type==="overworld"?"Return to Vale":"Back to Menu"})]})]}),e(la,{towerRecord:s})]});const Y=r.stats;return e("div",{class:"tower-hub",children:[e("section",{class:"tower-card status",children:[e("header",{children:[e("div",{children:[e("p",{class:"label",children:"Difficulty"}),e("p",{class:"value",children:r.difficulty})]}),e("div",{children:[e("p",{class:"label",children:"Highest Floor"}),e("p",{class:"value",children:Y.highestFloor})]}),e("div",{children:[e("p",{class:"label",children:"Battles Won"}),e("p",{class:"value",children:Y.victories})]})]}),e("div",{class:"timeline",children:[e("p",{class:"label",children:"Current Floor"}),Nn(_)]}),e("div",{class:"next-reward","data-testid":"tower-next-reward",children:[e("p",{class:"label",children:"Next Reward Floor"}),I?e("div",{class:"reward-row",children:[e("span",{class:"floor-pill reward",children:`Floor ${I.floorNumber}`}),e("span",{children:qn(I.rewards)})]}):e("span",{class:"value",children:"All milestone rewards claimed"})]})]}),e("section",{class:"tower-card actions",children:w?e(ie,{children:[e("h2",{children:"Run Complete"}),e("p",{children:r.isFailed?"The party fell, but their record stands in the archive.":"You cleared every defined floor for this phase."}),e("div",{class:"tower-actions",children:[e("button",{class:"primary",onClick:x,children:"Start New Run"}),e("button",{onClick:c,children:l?.type==="overworld"?"Return to Vale":"Back to Menu"})]})]}):k?e(ie,{children:[e("h2",{children:"Rest Floor"}),e("p",{children:["Restore ",Math.round(Wn*100),"% HP and reset Djinn before the next stretch."]}),e("div",{class:"tower-actions",children:[e("button",{class:"primary",onClick:g,children:"Take Rest"}),e("button",{onClick:o,children:"Skip Rest"}),e("button",{class:"ghost",onClick:$,children:"Quit Run"})]}),e("div",{class:"tower-loadout-actions",children:[e("span",{children:"Adjust loadouts:"}),e("div",{class:"tower-rest-buttons",children:[e("button",{onClick:()=>d("party"),children:"Party"}),e("button",{onClick:()=>d("equipment"),children:"Equipment"}),e("button",{onClick:()=>d("djinn"),children:"Djinn"})]})]})]}):e(ie,{children:[e("h2",{children:_?`Floor ${_.floorNumber}`:"All Floors Cleared"}),e("p",{children:_?`Encounter: ${_.encounterId}`:"There are no more encounters defined for this build."}),e("div",{class:"tower-actions",children:[e("button",{class:"primary",disabled:!_||k,onClick:o,children:"Begin Battle"}),e("button",{class:"ghost",onClick:$,children:"Quit Run"}),e("button",{onClick:c,children:l?.type==="overworld"?"Return to Vale":"Back to Menu"})]})]})}),e("section",{class:"tower-card stats",children:[e("h3",{children:"Run Stats"}),e("ul",{children:[e("li",{children:[e("span",{children:"Turns Taken"}),e("span",{children:Y.turnsTaken})]}),e("li",{children:[e("span",{children:"Total Damage Dealt"}),e("span",{children:Y.totalDamageDealt})]}),e("li",{children:[e("span",{children:"Total Damage Taken"}),e("span",{children:Y.totalDamageTaken})]}),e("li",{children:[e("span",{children:"Retreats"}),e("span",{children:Y.retreats})]})]})]}),e("section",{class:"tower-card party","data-testid":"tower-party-summary",children:[e("h3",{children:"Party Status"}),h.length===0?e("p",{class:"value",children:"No party data available."}):e("div",{class:"party-grid",children:h.map(G=>e("div",{class:"party-unit",children:[e("div",{class:"unit-header",children:[e("span",{children:G.name}),e("span",{children:[G.currentHp," / ",G.maxHp]})]}),e("div",{class:"hp-bar",children:e("div",{style:{width:`${G.hpPercent}%`}})}),G.djinn.length>0&&e("div",{class:"djinn-badges",children:G.djinn.map(pe=>{const we=m[pe];return e("span",{class:`djinn-pill state-${we?.state??"Set"}`,children:[we?.name??pe," Â· ",we?.state??"Set"]},pe)})})]},G.id))})]}),e(la,{towerRecord:s}),T&&e("div",{class:"tower-modal",role:"dialog","aria-modal":"true",children:e("div",{class:"tower-modal-content",children:[e("p",{children:T==="quit"?"Are you sure? This will end the current Tower run.":"Start a new run? Your existing Tower progress will be lost."}),e("div",{class:"tower-modal-actions",children:[e("button",{class:"primary",onClick:E,children:T==="quit"?"Confirm Quit":"Start New Run"}),e("button",{onClick:()=>v(null),children:"Cancel"})]})]})}),b==="party"&&e(An,{onClose:K}),b==="equipment"&&e(Pn,{shopId:"vale-armory",onClose:K}),b==="djinn"&&e(Ln,{onClose:K})]})}const Wn=Tt.healFractionAtRest;function Nn(t){if(!t)return e("p",{class:"value",children:"No remaining floors"});const r=t.type==="boss"?"boss":t.type==="rest"?"rest":"normal",a=t.type==="boss"?"Boss":t.type==="rest"?"Rest":"Battle";return e("div",{class:"floor-display","data-testid":"tower-current-floor",children:[e("span",{class:`floor-pill ${r}`,children:a}),t.type==="rest"?e("p",{class:"value rest",children:["Floor ",t.floorNumber," Â· Heal & Regroup"]}):e("p",{class:`value ${r}`,children:["Floor ",t.floorNumber," Â· ",t.encounterId]})]})}function qn(t){return t.map(r=>{const a=r.ids.join(", ");switch(r.type){case"equipment":return`Equipment: ${a}`;case"djinn":return`Djinn: ${a}`;case"recruit":return`Recruit: ${a}`;default:return a}}).join(" Â· ")}function $n(t){if(!t)return _t[0]??null;const r=new Set(t.history.filter(n=>n.rewardsGranted.length>0).map(n=>n.floorNumber)),s=t.history[t.floorIndex]?.floorNumber??(t.history[t.history.length-1]?.floorNumber??0)+(t.isCompleted?0:1);return _t.find(n=>!r.has(n.floorNumber)&&n.floorNumber>=s)??null}function Un(t){return t?t.units.map(r=>{const{hp:a}=Dt(r,t),s=a>0?Math.round(Math.max(r.currentHp,0)/a*100):0;return{id:r.id,name:r.name,currentHp:r.currentHp,maxHp:a,hpPercent:Math.max(0,Math.min(100,s)),djinn:r.djinn}}):[]}function On(t){if(!t)return{};const r={};for(const[a,s]of Object.entries(t.djinnTrackers))r[a]={name:oe[a]?.name??a,state:s.state};return r}function la({towerRecord:t}){return e("section",{class:"tower-card record","data-testid":"tower-record-panel",children:[e("h3",{children:"Tower Record"}),e("div",{class:"record-grid",children:[e("div",{children:[e("span",{class:"label",children:"Highest Floor Ever"}),e("span",{class:"value",children:t.highestFloorEver})]}),e("div",{children:[e("span",{class:"label",children:"Total Runs"}),e("span",{class:"value",children:t.totalRuns})]}),e("div",{children:[e("span",{class:"label",children:"Best Run (Turns)"}),e("span",{class:"value",children:t.bestRunTurns??"â€”"})]}),e("div",{children:[e("span",{class:"label",children:"Best Run (Damage)"}),e("span",{class:"value",children:t.bestRunDamageDealt??"â€”"})]})]})]})}const zn=[{title:"Design & Code",entries:["Vale Chronicles Team"]},{title:"Art",entries:["Placeholder Sprites","Coming Soon"]},{title:"Music & Sound",entries:["TBD"]},{title:"Special Thanks",entries:["Golden Sun Series","All Playtesters"]}],Hn={scrollSpeed:40,music:null},Yn={sections:zn,options:Hn},Jn=St({title:kt(),entries:pa(kt())}),Vn=St({sections:pa(Jn),options:St({scrollSpeed:Ua().positive(),music:kt().nullable()})}),xt=Vn.safeParse(Yn);if(!xt.success)throw new Error(`Invalid credits data: ${xt.error.message}`);const ca=xt.data;function ui({onExit:t}){const[r,a]=F(0),[s,n]=F(!1),i=re(null),o=re(null),g=ca.options.scrollSpeed||40;return P(()=>{if(s)return;const p=()=>{a(c=>{const l=i.current;if(!l)return c;const u=l.scrollHeight-l.clientHeight;return c>=u?c:c+g/60}),o.current=requestAnimationFrame(p)};return o.current=requestAnimationFrame(p),()=>{o.current!==null&&cancelAnimationFrame(o.current)}},[s,g]),P(()=>{const p=i.current;p&&(p.scrollTop=r)},[r]),P(()=>{const p=c=>{c.key==="Escape"||c.key==="Enter"?(c.preventDefault(),c.stopPropagation(),t()):c.key===" "&&(c.preventDefault(),c.stopPropagation(),n(l=>!l))};return window.addEventListener("keydown",p),()=>window.removeEventListener("keydown",p)},[t]),e("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"#000",color:"#fff",overflow:"hidden",display:"flex",flexDirection:"column",zIndex:1e3},role:"dialog","aria-label":"Credits","aria-modal":"true",children:[e("div",{ref:i,style:{flex:1,overflow:"auto",padding:"2rem",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"flex-start"},children:e("div",{style:{maxWidth:"600px",width:"100%",paddingTop:"100vh",paddingBottom:"100vh"},children:[e("h1",{style:{fontSize:"3rem",textAlign:"center",marginBottom:"3rem",fontWeight:"bold"},children:"Credits"}),ca.sections.map((p,c)=>e("div",{style:{marginBottom:"4rem",textAlign:"center"},children:[e("h2",{style:{fontSize:"2rem",marginBottom:"1.5rem",fontWeight:"bold",color:"#ffd700"},children:p.title}),p.entries.map((l,u)=>e("p",{style:{fontSize:"1.25rem",marginBottom:"0.75rem",lineHeight:"1.6"},children:l},u))]},c)),e("div",{style:{marginTop:"4rem",textAlign:"center",fontSize:"1.5rem"},children:e("p",{children:"Thank you for playing!"})})]})}),e("div",{style:{position:"absolute",bottom:"2rem",left:"50%",transform:"translateX(-50%)",textAlign:"center",fontSize:"0.9rem",color:"#888"},children:e("p",{children:"Press ESC or Enter to exit | Space to pause/resume"})})]})}const wt=[{character:"Isaac",portrait:"isaac",text:"Isaac returned to Vale as a hero. Though he missed the thrill of adventure, he found purpose in training the next generation of Adepts. On quiet evenings, he still watches the sunset from the hill overlooking the village, remembering his friends."},{character:"Sentinel",portrait:"sentinel",text:"Sentinel chose to remain in the liberated village, helping rebuild what the Overseer had destroyed. His earth psynergy proved invaluable for reconstruction. The villagers say the stones themselves seem happier now, placed by gentle hands instead of cruel ones."},{character:"Stormcaller",portrait:"stormcaller",text:"True to form, Stormcaller couldn't stay in one place for long. She traveled the land, seeking other villages oppressed by tyranny. Wherever storms gather, they say it's Stormcaller - bringing justice like lightning from a clear sky."},{character:"The Liberated Creatures",portrait:"creatures",text:"The beasts freed from the Overseer's control gradually returned to their natural habitats. Some, like the Phoenix and Leviathan, became legends once more. Others stayed near the village, guardians now instead of prisoners."},{character:"The Village",portrait:"village",text:"The twenty houses, once cages of suffering, became homes again. Families returned. Children played in streets that had known only silence. And in the center of town, a monument was built - not to the heroes, but to those who endured."},{character:"The Future",portrait:"sunset",text:"Peace returned to the land. But as old Adepts know, peace is not an ending - it's a beginning. New threats will rise. New heroes will answer. And when they do, they'll remember the tale of Isaac and his friends, who proved that courage and friendship can overcome any darkness."}];function di({onComplete:t}){const[r,a]=F(0),[s,n]=F("in"),i=wt[r],o=r===wt.length-1;P(()=>{if(s==="in"){const c=setTimeout(()=>n("visible"),500);return()=>clearTimeout(c)}},[s]),P(()=>{const c=l=>{l.key==="Enter"||l.key===" "||l.key==="ArrowRight"?(l.preventDefault(),l.stopPropagation(),g()):l.key==="Escape"&&(l.preventDefault(),l.stopPropagation(),t())};return window.addEventListener("keydown",c),()=>window.removeEventListener("keydown",c)},[r,s,t]);const g=()=>{s==="visible"&&(o?(n("out"),setTimeout(()=>t(),500)):(n("out"),setTimeout(()=>{a(c=>c+1),n("in")},500)))};return e("div",{style:{position:"fixed",top:0,left:0,right:0,bottom:0,backgroundColor:"#0a0a1a",color:"#fff",display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",zIndex:1e3,padding:"2rem"},onClick:g,role:"dialog","aria-label":"Epilogue","aria-modal":"true",children:[e("div",{style:{position:"absolute",top:0,left:0,right:0,bottom:0,background:"radial-gradient(ellipse at center, #1a1a3a 0%, #0a0a1a 100%)",opacity:.8}}),e("div",{style:{position:"relative",maxWidth:"700px",width:"100%",textAlign:"center",opacity:(()=>{switch(s){case"in":return 0;case"visible":return 1;case"out":return 0;default:return 0}})(),transition:"opacity 0.5s ease-in-out"},children:[e("h2",{style:{fontSize:"2.5rem",fontWeight:"bold",color:"#ffd700",marginBottom:"2rem",textShadow:"0 0 20px rgba(255, 215, 0, 0.5)"},children:i.character}),e("p",{style:{fontSize:"1.4rem",lineHeight:"2",color:"#e0e0e0",fontStyle:"italic",textShadow:"0 2px 4px rgba(0, 0, 0, 0.5)"},children:i.text}),e("div",{style:{marginTop:"3rem",display:"flex",justifyContent:"center",gap:"0.5rem"},children:wt.map((c,l)=>e("div",{style:{width:"12px",height:"12px",borderRadius:"50%",backgroundColor:l===r?"#ffd700":"#444",transition:"background-color 0.3s ease"}},l))})]}),e("div",{style:{position:"absolute",bottom:"2rem",textAlign:"center",fontSize:"0.9rem",color:"#666"},children:[e("p",{children:o?"Press Enter to finish":"Press Enter or click to continue"}),e("p",{style:{marginTop:"0.5rem"},children:"ESC to skip"})]})]})}function yi({onClose:t,onTeamManagement:r,onInventory:a,onDjinnCollection:s,onCompendium:n,onSaveGame:i,onSettings:o,onHowToPlay:g,onReturnToTitle:p}){const[c,l]=F(0),[u,f]=F(null),_=re(null),k=M(T=>T.story),w=M(T=>T.gold),I=M(T=>T.roster),h=[{id:"resume",icon:"â–¶ï¸",label:"Resume Game",shortcut:"ESC",action:t},{id:"team",icon:"ðŸ‘¥",label:"Team Management",shortcut:"T",action:r},{id:"inventory",icon:"ðŸŽ’",label:"Inventory",shortcut:"I",action:a},{id:"djinn",icon:"âœ¨",label:"Djinn Collection",shortcut:"D",action:s},{id:"compendium",icon:"ðŸ“š",label:"Compendium",shortcut:"C",action:n,dividerAfter:!0},{id:"save",icon:"ðŸ’¾",label:"Save Game",shortcut:"S",action:i},{id:"settings",icon:"âš™ï¸",label:"Settings",shortcut:"O",action:o},{id:"help",icon:"â“",label:"How to Play",shortcut:"H",action:g,dividerAfter:!0},{id:"title",icon:"ðŸ ",label:"Return to Title",shortcut:"Q",action:p}],m=fe(T=>{const v=h[T];v?.action&&(f(T),setTimeout(()=>{f(null),v.action?.()},150))},[h]);return P(()=>{const T=v=>{switch(["ArrowUp","ArrowDown","Enter"," ","Escape"].includes(v.key)&&(v.preventDefault(),v.stopPropagation()),v.key){case"ArrowDown":l(b=>(b+1)%h.length);break;case"ArrowUp":l(b=>(b-1+h.length)%h.length);break;case"Enter":case" ":m(c);break;case"Escape":t();break;case"t":case"T":if(r){const b=h.findIndex(d=>d.id==="team");m(b)}break;case"i":case"I":if(a){const b=h.findIndex(d=>d.id==="inventory");m(b)}break;case"d":case"D":if(s){const b=h.findIndex(d=>d.id==="djinn");m(b)}break;case"c":case"C":if(n){const b=h.findIndex(d=>d.id==="compendium");m(b)}break;case"s":case"S":if(i){const b=h.findIndex(d=>d.id==="save");m(b)}break;case"o":case"O":if(o){const b=h.findIndex(d=>d.id==="settings");m(b)}break;case"h":case"H":if(g){const b=h.findIndex(d=>d.id==="help");m(b)}break;case"q":case"Q":if(p){const b=h.findIndex(d=>d.id==="title");m(b)}break}};return window.addEventListener("keydown",T,!0),()=>window.removeEventListener("keydown",T,!0)},[c,h,m,t,r,a,s,i,o,g,p]),P(()=>{_.current?.focus()},[]),e("div",{class:"pause-overlay",role:"dialog","aria-modal":"true","aria-label":"Pause Menu",children:[e("div",{class:"pause-status-bar",children:[e("div",{class:"status-item",children:[e("span",{class:"status-label",children:"Chapter:"}),e("span",{class:"status-value",children:k.chapter})]}),e("div",{class:"status-item",children:[e("span",{class:"status-label",children:"Units:"}),e("span",{class:"status-value",children:[I.length,"/10"]})]}),e("div",{class:"status-item",children:[e("span",{class:"status-label",children:"Gold:"}),e("span",{class:"status-value",children:w.toLocaleString()})]})]}),e("div",{class:"pause-menu",ref:_,tabIndex:-1,children:[e("h1",{class:"pause-title",children:"PAUSED"}),e("div",{class:"menu-options",role:"menu",children:h.map((T,v)=>e("div",{children:[e("button",{class:`menu-option ${c===v?"selected":""} ${u===v?"flash":""}`,onClick:()=>{l(v),m(v)},onMouseEnter:()=>l(v),role:"menuitem","aria-selected":c===v,disabled:!T.action,children:[e("span",{class:"menu-icon","aria-hidden":"true",children:T.icon}),e("span",{class:"menu-label",children:T.label}),e("span",{class:"menu-hint",children:T.shortcut})]}),T.dividerAfter&&e("div",{class:"menu-divider"})]},T.id))}),e("div",{class:"pause-footer",children:e("div",{class:"keyboard-hints",children:[e("div",{class:"hint",children:[e("span",{class:"key",children:"â†‘â†“"}),e("span",{children:"Navigate"})]}),e("div",{class:"hint",children:[e("span",{class:"key",children:"Enter"}),e("span",{children:"Select"})]}),e("div",{class:"hint",children:[e("span",{class:"key",children:"ESC"}),e("span",{children:"Resume"})]})]})})]})]})}function mi(){const{currentDialogueTree:t,currentDialogueState:r,makeChoice:a,advanceCurrentDialogue:s,endDialogue:n,story:i,gold:o,equipment:g,team:p}=M(d=>({currentDialogueTree:d.currentDialogueTree,currentDialogueState:d.currentDialogueState,makeChoice:d.makeChoice,advanceCurrentDialogue:d.advanceCurrentDialogue,endDialogue:d.endDialogue,story:d.story,gold:d.gold,equipment:d.equipment,team:d.team})),c=t&&r?Lr(t,r):null,l=c?Wr(c,{flags:i.flags||{},inventory:{items:g.map(d=>d.id)},gold:o,level:p?.units?.[0]?.level||1}):[],u=l.length>0,[f,_]=F(""),[k,w]=F(!1),I=re(null),h=re("");P(()=>{if(!c?.text){_(""),w(!1);return}if(h.current!==c.text){h.current=c.text,_(""),w(!0),I.current&&clearInterval(I.current);let d=0;const x=30;I.current=setInterval(()=>{d<c.text.length?(_(c.text.substring(0,d+1)),d++):(w(!1),I.current&&(clearInterval(I.current),I.current=null))},x)}return()=>{I.current&&(clearInterval(I.current),I.current=null)}},[c?.text]);const m=()=>{k&&c?.text&&(I.current&&(clearInterval(I.current),I.current=null),_(c.text),w(!1))},T=()=>{k?m():s()};if(P(()=>{const d=x=>{if(!t||!r)return;if(x.key==="Escape"){x.preventDefault(),x.stopPropagation(),n();return}if(!u&&(x.key===" "||x.key==="Enter"||x.code==="Space"||x.code==="Enter")){x.preventDefault(),x.stopPropagation(),T();return}const E=parseInt(x.key,10);if(!Number.isNaN(E)&&E>=1&&E<=l.length){x.preventDefault(),x.stopPropagation();const $=l[E-1];$&&a($.id)}};return window.addEventListener("keydown",d,!0),()=>window.removeEventListener("keydown",d,!0)},[t,r,l,u,s,a,n,k,T]),!t||!r||!c)return null;const b=e("div",{class:"dialogue-overlay-v2",onClick:d=>{u||d.target.closest(".dialogue-choice-v2")||T()},style:{cursor:u?"default":"pointer"},children:e("div",{class:"dialogue-box-v2",children:e("div",{class:"dialogue-panel-v2",children:[e("div",{class:"corner-ornament-v2 top-left"}),e("div",{class:"corner-ornament-v2 top-right"}),e("div",{class:"corner-ornament-v2 bottom-left"}),e("div",{class:"corner-ornament-v2 bottom-right"}),c.speaker&&e("div",{class:"portrait-section-v2",children:[e("div",{class:"speaker-name-v2",children:c.speaker}),e("div",{class:"portrait-frame-v2",children:e("div",{class:"portrait-inner-v2",children:(()=>{const d=Re(c.speaker);return e(H,{id:d,width:84,height:84,style:{borderRadius:"50%",imageRendering:"pixelated"}})})()})})]}),e("div",{class:"dialogue-content-v2",children:[e("div",{class:"dialogue-text-v2",children:[f,k&&e("span",{class:"cursor-v2"})]}),u&&e("div",{class:"dialogue-choices-v2",children:l.map((d,x)=>e("button",{class:"choice-button-v2","data-number":x+1,onClick:E=>{E.stopPropagation(),a(d.id)},children:d.text},d.id))})]}),!u&&e("div",{class:`continue-indicator-v2 ${k?"is-typing":""}`,children:[e("button",{type:"button",class:"dialogue-next-button-v2",onClick:d=>{d.stopPropagation(),T()},children:[e("span",{class:"next-label-v2",children:k?"Skip":"Next"}),e("span",{class:"next-icon-v2","aria-hidden":"true",children:"â–¶"})]}),e("span",{class:"dialogue-hotkey-v2",children:"Space / Enter"}),!k&&e("div",{class:"arrow-sprite-v2"})]})]})})});return typeof document>"u"||!document.body?null:Oa(b,document.body)}function Kn(t,r){if(t.toLowerCase()==="random")return r?Da(r).length===0?(console.warn(`[BackgroundSprite] No sprites found in category: ${r}`),{entry:null,method:"none"}):{entry:Es(r),method:"random"}:(console.warn("[BackgroundSprite] Random selection requires category prop"),{entry:null,method:"none"});if(t.startsWith("/"))return{entry:xa(t),method:"path"};const a=Ca(t);return a?{entry:a,method:"catalog"}:{entry:null,method:"none"}}function Qn({id:t,category:r,style:a,className:s,sizeMode:n="cover",position:i="center center",repeat:o="no-repeat",debug:g=!1,onLoad:p,onError:c}){const[l,u]=F(null),[f,_]=F(null),[k,w]=F(!1),[I,h]=F(!1),m=U(()=>Kn(t,r),[t,r]);P(()=>{u(m),_(null),w(!1),g&&m.entry?console.log("[BackgroundSprite] Found background:",{id:t,method:m.method,name:m.entry.name,path:m.entry.path,category:m.entry.category}):g&&!m.entry&&console.warn("[BackgroundSprite] Background not found:",{id:t,category:r,method:m.method})},[m,g,t,r]);const T=()=>{w(!0),_(null),p?.()},v=()=>{const d=l?.entry?`Failed to load: ${l.entry.path}`:`Background not found: ${t}`;_(d),w(!1),c?.(d),g&&console.error("[BackgroundSprite] Load error:",d)},b=l?.entry?.path||null;return!b||f?e("div",{className:s,style:{backgroundColor:"#1a1a2e",backgroundImage:"linear-gradient(135deg, #1a1a2e 0%, #16213e 50%, #0f3460 100%)",...a},onMouseEnter:()=>g&&h(!0),onMouseLeave:()=>g&&h(!1),title:f||`Background not found: ${t}`,children:g&&I&&e("div",{style:{position:"absolute",top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.9)",color:"#fff",padding:"8px",borderRadius:"4px",fontSize:"12px",zIndex:1e3},children:[e("div",{children:[e("strong",{children:"Background ID:"})," ",t]}),r&&e("div",{children:[e("strong",{children:"Category:"})," ",r]}),l&&e("div",{children:[e("strong",{children:"Lookup Method:"})," ",l.method]}),f&&e("div",{style:{color:"#ff6b6b"},children:[e("strong",{children:"Error:"})," ",f]})]})}):e("div",{className:s,style:{backgroundImage:`url(${b})`,backgroundSize:n,backgroundPosition:i,backgroundRepeat:o,width:"100%",height:"100%",...a},onMouseEnter:()=>g&&h(!0),onMouseLeave:()=>g&&h(!1),children:[e("img",{src:b,alt:l?.entry?.name||t,style:{display:"none"},onLoad:T,onError:v}),g&&I&&l&&l.entry&&e("div",{style:{position:"absolute",top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.9)",color:"#fff",padding:"8px",borderRadius:"4px",fontSize:"12px",zIndex:1e3,maxWidth:"300px"},children:[e("div",{children:[e("strong",{children:"Name:"})," ",l.entry.name]}),e("div",{children:[e("strong",{children:"Path:"})," ",l.entry.path]}),e("div",{children:[e("strong",{children:"Category:"})," ",l.entry.category]}),e("div",{children:[e("strong",{children:"Lookup:"})," ",l.method]}),e("div",{children:[e("strong",{children:"Status:"})," ",k?"âœ… Loaded":"â³ Loading..."]})]})]})}function Xn(t){return t?new Date(t).toLocaleString("en-US",{month:"short",day:"numeric",year:"numeric",hour:"2-digit",minute:"2-digit"}):"No save"}function Zn(t){if(!t)return"0:00";const r=Math.floor(t/3600),a=Math.floor(t%3600/60);return r>0?`${r}:${a.toString().padStart(2,"0")}`:`${a}:${(t%60).toString().padStart(2,"0")}`}function hi({onClose:t}){const{saveGameSlot:r,loadGameSlot:a,deleteSaveSlot:s,getSaveSlotMetadata:n}=M(),i=se(d=>d.startTransition),[o,g]=F([{exists:!1},{exists:!1},{exists:!1}]),[p,c]=F(null),[l,u]=F(null),[f,_]=F(!1),[k,w]=F(null),I=()=>{g([n(0),n(1),n(2)])};P(()=>{I()},[]);const h=d=>{l==="save"?m(d):l==="load"?T(d):l==="delete"&&c(d)},m=async d=>{_(!0),w(null);try{r(d),I(),u(null),c(null)}catch(x){w(x instanceof Error?x.message:"Failed to save game")}finally{_(!1)}},T=async d=>{if(!o[d]?.exists){w("No save file found in this slot");return}_(!0),w(null);try{a(d),i("overworld"),t()}catch(x){w(x instanceof Error?x.message:"Failed to load game")}finally{_(!1)}},v=d=>{o[d]?.exists&&(s(d),I(),c(null),u(null))},b=()=>{p!==null&&v(p)};return e("div",{class:"save-menu-overlay",onClick:t,children:e("div",{class:"save-menu-container",onClick:d=>d.stopPropagation(),children:[e(Qn,{id:"random",category:"backgrounds-gs1",style:{position:"absolute",top:0,left:0,width:"100%",height:"100%",opacity:.3,borderRadius:"12px",zIndex:-1}}),e("div",{class:"save-menu-header",children:[e("h1",{children:"Save / Load Game"}),e("button",{class:"close-btn",onClick:t,"aria-label":"Close save menu",children:"Ã—"})]}),k&&e("div",{class:"save-menu-error",role:"alert",children:k}),f&&e("div",{class:"save-menu-loading",children:l==="save"?"Saving...":"Loading..."}),e("div",{class:"save-menu-actions",children:[e("button",{class:`action-btn ${l==="save"?"active":""}`,onClick:()=>{u(l==="save"?null:"save"),c(null)},disabled:f,children:[e(H,{id:"save-game",width:24,height:24,style:{marginRight:"8px"}}),"New Save"]}),e("button",{class:`action-btn ${l==="load"?"active":""}`,onClick:()=>{u(l==="load"?null:"load"),c(null)},disabled:f,children:[e(H,{id:"continue",width:24,height:24,style:{marginRight:"8px"}}),"Load Save"]})]}),e("div",{class:"save-slots",children:o.map((d,x)=>e("div",{class:`save-slot ${p===x?"selected":""} ${d.exists?"":"empty"}`,onClick:()=>h(x),children:[e("div",{class:"save-slot-header",children:[e("h2",{children:["Slot ",x+1]}),l==="save"&&e("span",{class:"action-indicator",children:"Click to save"}),l==="load"&&d.exists&&e("span",{class:"action-indicator",children:"Click to load"}),l==="delete"&&d.exists&&e("span",{class:"action-indicator",children:"Click to delete"})]}),d.exists?e("div",{class:"save-slot-content",children:e("div",{style:{display:"flex",gap:"16px",alignItems:"flex-start"},children:[e("div",{class:"save-slot-portrait",children:e(H,{id:"isaac1",width:64,height:64})}),e("div",{class:"save-slot-meta",children:[e("div",{class:"meta-row",children:[e("span",{class:"meta-label",children:"Date:"}),e("span",{class:"meta-value",children:Xn(d.timestamp)})]}),e("div",{class:"meta-row",children:[e("span",{class:"meta-label",children:"Playtime:"}),e("span",{class:"meta-value",children:Zn(d.playtime)})]}),e("div",{class:"meta-row",children:[e("span",{class:"meta-label",children:"Team Level:"}),e("span",{class:"meta-value",children:["Lv. ",d.teamLevel??1]})]}),e("div",{class:"meta-row",children:[e("span",{class:"meta-label",children:"Gold:"}),e("span",{class:"meta-value",children:[d.gold??0,"g"]})]}),d.chapter&&e("div",{class:"meta-row",children:[e("span",{class:"meta-label",children:"Chapter:"}),e("span",{class:"meta-value",children:d.chapter})]})]})]})}):e("div",{class:"save-slot-empty",children:e("span",{children:"Empty Slot"})})]},x))}),l==="delete"&&p!==null&&o[p]?.exists&&e("div",{class:"delete-confirmation",children:[e("p",{children:"Are you sure you want to delete this save?"}),e("div",{class:"confirmation-buttons",children:[e("button",{class:"confirm-btn",onClick:b,children:"Yes, Delete"}),e("button",{class:"cancel-btn",onClick:()=>{c(null),u(null)},children:"Cancel"})]})]}),l!=="delete"&&e("div",{class:"save-menu-footer",children:e("button",{class:"delete-action-btn",onClick:()=>{u("delete"),c(null)},disabled:f,children:[e(H,{id:"erase-file",width:24,height:24,style:{marginRight:"8px"}}),"Delete Save"]})})]})})}class bi extends za{constructor(r){super(r),this.state={hasError:!1,error:null}}static getDerivedStateFromError(r){return{hasError:!0,error:r}}componentDidCatch(r,a){console.error("Game error caught by boundary:",r,a)}handleReset=()=>{this.setState({hasError:!1,error:null})};handleReload=()=>{window.location.reload()};render(){return this.state.hasError?this.props.fallback?this.props.fallback:e("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:"100vh",padding:"2rem",backgroundColor:"#1a1a2e",color:"#fff"},children:[e("h1",{style:{fontSize:"2rem",marginBottom:"1rem",color:"#FFD87F"},children:"Arena Reset Required"}),e("p",{style:{fontSize:"1.2rem",marginBottom:"2rem",textAlign:"center",maxWidth:"600px"},children:"Hang tight, the arena needs a reset. An unexpected error occurred during battle."}),this.state.error&&e("details",{style:{marginBottom:"2rem",padding:"1rem",backgroundColor:"#2a2a3e",borderRadius:"4px",maxWidth:"800px",width:"100%"},children:[e("summary",{style:{cursor:"pointer",marginBottom:"0.5rem"},children:"Error Details (for debugging)"}),e("pre",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",fontSize:"0.9rem",color:"#ff6b6b"},children:[this.state.error.toString(),this.state.error.stack&&`

${this.state.error.stack}`]})]}),e("div",{style:{display:"flex",gap:"1rem"},children:[e("button",{onClick:this.handleReset,style:{padding:"0.75rem 1.5rem",fontSize:"1rem",backgroundColor:"#4CAF50",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Try Again"}),e("button",{onClick:this.handleReload,style:{padding:"0.75rem 1.5rem",fontSize:"1rem",backgroundColor:"#2196F3",color:"#fff",border:"none",borderRadius:"4px",cursor:"pointer",fontWeight:"bold"},children:"Reload Game"})]})]}):this.props.children}}export{ui as C,Ln as D,Ie as E,bi as G,oi as M,ni as O,An as P,ii as Q,ci as R,H as S,ri as T,M as a,Re as b,di as c,pi as d,yi as e,hi as f,Ma as g,mi as h,gi as i,li as j,si as s,se as u};
//# sourceMappingURL=ui-components-BQV0FG4t.js.map
